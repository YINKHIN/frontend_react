import{r as se,a as B2,N as v0,b as U2,u as Of,L as hc,O as q2,c as $a,d as W2,e as Td,f as H2,h as aa,B as $2}from"./vendor-348d559c.js";import{n as Ye,U as fi,X as zr,C as z2,a as V2,H as G2,T as Hu,P as Lr,F as Xp,b as Kp,c as mc,d as hi,e as af,S as Jp,f as In,D as Gi,g as Qp,B as If,h as Rf,i as es,L as Y2,j as X2,M as K2,k as J2,R as sn,A as Qo,l as Q2,m as y0,o as Zp,p as $u,E as nf,q as cn,r as Z2,s as ev,t as zu,u as Mu,I as Bo,v as Mf,Z as tv,w as Jh,x as An,y as rv,z as e1,G as t1,J as Rn,K as Qh,N as Zh,O as un,Q as av,V as nv,W as Go,Y as Vu,_ as Gu,$ as sv,a0 as sf,a1 as r1,a2 as iv,a3 as ov,a4 as lv,a5 as cv}from"./ui-58a945e4.js";import{R as To,B as wu,C as Rl,X as Ml,Y as Bl,T as Co,L as Po,a as ki,b as bu,P as uv,c as dv,d as fv,e as Cd}from"./charts-bc1c71da.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var a1={exports:{}},w0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hv=se,mv=Symbol.for("react.element"),pv=Symbol.for("react.fragment"),xv=Object.prototype.hasOwnProperty,gv=hv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vv={key:!0,ref:!0,__self:!0,__source:!0};function n1(e,t,r){var a,n={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)xv.call(t,a)&&!vv.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:mv,type:e,key:s,ref:o,props:n,_owner:gv.current}}w0.Fragment=pv;w0.jsx=n1;w0.jsxs=n1;a1.exports=w0;var i=a1.exports,of={},em=B2;of.createRoot=em.createRoot,of.hydrateRoot=em.hydrateRoot;function s1(e,t){return function(){return e.apply(t,arguments)}}const{toString:yv}=Object.prototype,{getPrototypeOf:Bf}=Object,{iterator:b0,toStringTag:i1}=Symbol,N0=(e=>t=>{const r=yv.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),as=e=>(e=e.toLowerCase(),t=>N0(t)===e),_0=e=>t=>typeof t===e,{isArray:al}=Array,Zo=_0("undefined");function Sc(e){return e!==null&&!Zo(e)&&e.constructor!==null&&!Zo(e.constructor)&&on(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const o1=as("ArrayBuffer");function wv(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&o1(e.buffer),t}const bv=_0("string"),on=_0("function"),l1=_0("number"),Ac=e=>e!==null&&typeof e=="object",Nv=e=>e===!0||e===!1,Bu=e=>{if(N0(e)!=="object")return!1;const t=Bf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(i1 in e)&&!(b0 in e)},_v=e=>{if(!Ac(e)||Sc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Sv=as("Date"),Av=as("File"),jv=as("Blob"),Ev=as("FileList"),Tv=e=>Ac(e)&&on(e.pipe),Cv=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||on(e.append)&&((t=N0(e))==="formdata"||t==="object"&&on(e.toString)&&e.toString()==="[object FormData]"))},Pv=as("URLSearchParams"),[Lv,Fv,kv,Dv]=["ReadableStream","Request","Response","Headers"].map(as),Ov=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function jc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),al(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{if(Sc(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(a=0;a<o;a++)l=s[a],t.call(null,e[l],l,e)}}function c1(e,t){if(Sc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const Bi=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),u1=e=>!Zo(e)&&e!==Bi;function lf(){const{caseless:e,skipUndefined:t}=u1(this)&&this||{},r={},a=(n,s)=>{const o=e&&c1(r,s)||s;Bu(r[o])&&Bu(n)?r[o]=lf(r[o],n):Bu(n)?r[o]=lf({},n):al(n)?r[o]=n.slice():(!t||!Zo(n))&&(r[o]=n)};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&jc(arguments[n],a);return r}const Iv=(e,t,r,{allOwnKeys:a}={})=>(jc(t,(n,s)=>{r&&on(n)?e[s]=s1(n,r):e[s]=n},{allOwnKeys:a}),e),Rv=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Mv=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Bv=(e,t,r,a)=>{let n,s,o;const l={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)o=n[s],(!a||a(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&Bf(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Uv=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},qv=e=>{if(!e)return null;if(al(e))return e;let t=e.length;if(!l1(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Wv=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Bf(Uint8Array)),Hv=(e,t)=>{const a=(e&&e[b0]).call(e);let n;for(;(n=a.next())&&!n.done;){const s=n.value;t.call(e,s[0],s[1])}},$v=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},zv=as("HTMLFormElement"),Vv=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),tm=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),Gv=as("RegExp"),d1=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};jc(r,(n,s)=>{let o;(o=t(n,s,e))!==!1&&(a[s]=o||n)}),Object.defineProperties(e,a)},Yv=e=>{d1(e,(t,r)=>{if(on(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(on(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Xv=(e,t)=>{const r={},a=n=>{n.forEach(s=>{r[s]=!0})};return al(e)?a(e):a(String(e).split(t)),r},Kv=()=>{},Jv=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Qv(e){return!!(e&&on(e.append)&&e[i1]==="FormData"&&e[b0])}const Zv=e=>{const t=new Array(10),r=(a,n)=>{if(Ac(a)){if(t.indexOf(a)>=0)return;if(Sc(a))return a;if(!("toJSON"in a)){t[n]=a;const s=al(a)?[]:{};return jc(a,(o,l)=>{const c=r(o,n+1);!Zo(c)&&(s[l]=c)}),t[n]=void 0,s}}return a};return r(e,0)},ey=as("AsyncFunction"),ty=e=>e&&(Ac(e)||on(e))&&on(e.then)&&on(e.catch),f1=((e,t)=>e?setImmediate:t?((r,a)=>(Bi.addEventListener("message",({source:n,data:s})=>{n===Bi&&s===r&&a.length&&a.shift()()},!1),n=>{a.push(n),Bi.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",on(Bi.postMessage)),ry=typeof queueMicrotask<"u"?queueMicrotask.bind(Bi):typeof process<"u"&&process.nextTick||f1,ay=e=>e!=null&&on(e[b0]),Be={isArray:al,isArrayBuffer:o1,isBuffer:Sc,isFormData:Cv,isArrayBufferView:wv,isString:bv,isNumber:l1,isBoolean:Nv,isObject:Ac,isPlainObject:Bu,isEmptyObject:_v,isReadableStream:Lv,isRequest:Fv,isResponse:kv,isHeaders:Dv,isUndefined:Zo,isDate:Sv,isFile:Av,isBlob:jv,isRegExp:Gv,isFunction:on,isStream:Tv,isURLSearchParams:Pv,isTypedArray:Wv,isFileList:Ev,forEach:jc,merge:lf,extend:Iv,trim:Ov,stripBOM:Rv,inherits:Mv,toFlatObject:Bv,kindOf:N0,kindOfTest:as,endsWith:Uv,toArray:qv,forEachEntry:Hv,matchAll:$v,isHTMLForm:zv,hasOwnProperty:tm,hasOwnProp:tm,reduceDescriptors:d1,freezeMethods:Yv,toObjectSet:Xv,toCamelCase:Vv,noop:Kv,toFiniteNumber:Jv,findKey:c1,global:Bi,isContextDefined:u1,isSpecCompliantForm:Qv,toJSONObject:Zv,isAsyncFn:ey,isThenable:ty,setImmediate:f1,asap:ry,isIterable:ay};function Wt(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Be.inherits(Wt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Be.toJSONObject(this.config),code:this.code,status:this.status}}});const h1=Wt.prototype,m1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{m1[e]={value:e}});Object.defineProperties(Wt,m1);Object.defineProperty(h1,"isAxiosError",{value:!0});Wt.from=(e,t,r,a,n,s)=>{const o=Object.create(h1);Be.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Wt.call(o,l,c,r,a,n),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const ny=null;function cf(e){return Be.isPlainObject(e)||Be.isArray(e)}function p1(e){return Be.endsWith(e,"[]")?e.slice(0,-2):e}function rm(e,t,r){return e?e.concat(t).map(function(n,s){return n=p1(n),!r&&s?"["+n+"]":n}).join(r?".":""):t}function sy(e){return Be.isArray(e)&&!e.some(cf)}const iy=Be.toFlatObject(Be,{},null,function(t){return/^is[A-Z]/.test(t)});function S0(e,t,r){if(!Be.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Be.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,y){return!Be.isUndefined(y[p])});const a=r.metaTokens,n=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Be.isSpecCompliantForm(t);if(!Be.isFunction(n))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(Be.isDate(x))return x.toISOString();if(Be.isBoolean(x))return x.toString();if(!c&&Be.isBlob(x))throw new Wt("Blob is not supported. Use a Buffer instead.");return Be.isArrayBuffer(x)||Be.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,p,y){let _=x;if(x&&!y&&typeof x=="object"){if(Be.endsWith(p,"{}"))p=a?p:p.slice(0,-2),x=JSON.stringify(x);else if(Be.isArray(x)&&sy(x)||(Be.isFileList(x)||Be.endsWith(p,"[]"))&&(_=Be.toArray(x)))return p=p1(p),_.forEach(function(E,C){!(Be.isUndefined(E)||E===null)&&t.append(o===!0?rm([p],C,s):o===null?p:p+"[]",u(E))}),!1}return cf(x)?!0:(t.append(rm(y,p,s),u(x)),!1)}const m=[],g=Object.assign(iy,{defaultVisitor:d,convertValue:u,isVisitable:cf});function h(x,p){if(!Be.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+p.join("."));m.push(x),Be.forEach(x,function(_,S){(!(Be.isUndefined(_)||_===null)&&n.call(t,_,Be.isString(S)?S.trim():S,p,g))===!0&&h(_,p?p.concat(S):[S])}),m.pop()}}if(!Be.isObject(e))throw new TypeError("data must be an object");return h(e),t}function am(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Uf(e,t){this._pairs=[],e&&S0(e,this,t)}const x1=Uf.prototype;x1.append=function(t,r){this._pairs.push([t,r])};x1.toString=function(t){const r=t?function(a){return t.call(this,a,am)}:am;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function oy(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function g1(e,t,r){if(!t)return e;const a=r&&r.encode||oy;Be.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let s;if(n?s=n(t,r):s=Be.isURLSearchParams(t)?t.toString():new Uf(t,r).toString(a),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class ly{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Be.forEach(this.handlers,function(a){a!==null&&t(a)})}}const nm=ly,v1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},cy=typeof URLSearchParams<"u"?URLSearchParams:Uf,uy=typeof FormData<"u"?FormData:null,dy=typeof Blob<"u"?Blob:null,fy={isBrowser:!0,classes:{URLSearchParams:cy,FormData:uy,Blob:dy},protocols:["http","https","file","blob","url","data"]},qf=typeof window<"u"&&typeof document<"u",uf=typeof navigator=="object"&&navigator||void 0,hy=qf&&(!uf||["ReactNative","NativeScript","NS"].indexOf(uf.product)<0),my=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),py=qf&&window.location.href||"http://localhost",xy=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:qf,hasStandardBrowserEnv:hy,hasStandardBrowserWebWorkerEnv:my,navigator:uf,origin:py},Symbol.toStringTag,{value:"Module"})),Da={...xy,...fy};function gy(e,t){return S0(e,new Da.classes.URLSearchParams,{visitor:function(r,a,n,s){return Da.isNode&&Be.isBuffer(r)?(this.append(a,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function vy(e){return Be.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function yy(e){const t={},r=Object.keys(e);let a;const n=r.length;let s;for(a=0;a<n;a++)s=r[a],t[s]=e[s];return t}function y1(e){function t(r,a,n,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&Be.isArray(n)?n.length:o,c?(Be.hasOwnProp(n,o)?n[o]=[n[o],a]:n[o]=a,!l):((!n[o]||!Be.isObject(n[o]))&&(n[o]=[]),t(r,a,n[o],s)&&Be.isArray(n[o])&&(n[o]=yy(n[o])),!l)}if(Be.isFormData(e)&&Be.isFunction(e.entries)){const r={};return Be.forEachEntry(e,(a,n)=>{t(vy(a),n,r,0)}),r}return null}function wy(e,t,r){if(Be.isString(e))try{return(t||JSON.parse)(e),Be.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const Wf={transitional:v1,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,s=Be.isObject(t);if(s&&Be.isHTMLForm(t)&&(t=new FormData(t)),Be.isFormData(t))return n?JSON.stringify(y1(t)):t;if(Be.isArrayBuffer(t)||Be.isBuffer(t)||Be.isStream(t)||Be.isFile(t)||Be.isBlob(t)||Be.isReadableStream(t))return t;if(Be.isArrayBufferView(t))return t.buffer;if(Be.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(a.indexOf("application/x-www-form-urlencoded")>-1)return gy(t,this.formSerializer).toString();if((l=Be.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return S0(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||n?(r.setContentType("application/json",!1),wy(t)):t}],transformResponse:[function(t){const r=this.transitional||Wf.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Be.isResponse(t)||Be.isReadableStream(t))return t;if(t&&Be.isString(t)&&(a&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Wt.from(l,Wt.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Da.classes.FormData,Blob:Da.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Be.forEach(["delete","get","head","post","put","patch"],e=>{Wf.headers[e]={}});const Hf=Wf,by=Be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ny=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),a=o.substring(n+1).trim(),!(!r||t[r]&&by[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},sm=Symbol("internals");function Ul(e){return e&&String(e).trim().toLowerCase()}function Uu(e){return e===!1||e==null?e:Be.isArray(e)?e.map(Uu):String(e)}function _y(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const Sy=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Pd(e,t,r,a,n){if(Be.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!Be.isString(t)){if(Be.isString(a))return t.indexOf(a)!==-1;if(Be.isRegExp(a))return a.test(t)}}function Ay(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function jy(e,t){const r=Be.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,s,o){return this[a].call(this,t,n,s,o)},configurable:!0})})}class A0{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function s(l,c,u){const d=Ul(c);if(!d)throw new Error("header name must be a non-empty string");const m=Be.findKey(n,d);(!m||n[m]===void 0||u===!0||u===void 0&&n[m]!==!1)&&(n[m||c]=Uu(l))}const o=(l,c)=>Be.forEach(l,(u,d)=>s(u,d,c));if(Be.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Be.isString(t)&&(t=t.trim())&&!Sy(t))o(Ny(t),r);else if(Be.isObject(t)&&Be.isIterable(t)){let l={},c,u;for(const d of t){if(!Be.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?Be.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,a);return this}get(t,r){if(t=Ul(t),t){const a=Be.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return _y(n);if(Be.isFunction(r))return r.call(this,n,a);if(Be.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ul(t),t){const a=Be.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||Pd(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function s(o){if(o=Ul(o),o){const l=Be.findKey(a,o);l&&(!r||Pd(a,a[l],l,r))&&(delete a[l],n=!0)}}return Be.isArray(t)?t.forEach(s):s(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const s=r[a];(!t||Pd(this,this[s],s,t,!0))&&(delete this[s],n=!0)}return n}normalize(t){const r=this,a={};return Be.forEach(this,(n,s)=>{const o=Be.findKey(a,s);if(o){r[o]=Uu(n),delete r[s];return}const l=t?Ay(s):String(s).trim();l!==s&&delete r[s],r[l]=Uu(n),a[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Be.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&Be.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[sm]=this[sm]={accessors:{}}).accessors,n=this.prototype;function s(o){const l=Ul(o);a[l]||(jy(n,o),a[l]=!0)}return Be.isArray(t)?t.forEach(s):s(t),this}}A0.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Be.reduceDescriptors(A0.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});Be.freezeMethods(A0);const ts=A0;function Ld(e,t){const r=this||Hf,a=t||r,n=ts.from(a.headers);let s=a.data;return Be.forEach(e,function(l){s=l.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function w1(e){return!!(e&&e.__CANCEL__)}function nl(e,t,r){Wt.call(this,e??"canceled",Wt.ERR_CANCELED,t,r),this.name="CanceledError"}Be.inherits(nl,Wt,{__CANCEL__:!0});function b1(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new Wt("Request failed with status code "+r.status,[Wt.ERR_BAD_REQUEST,Wt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Ey(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Ty(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=a[s];o||(o=u),r[n]=c,a[n]=u;let m=s,g=0;for(;m!==n;)g+=r[m++],m=m%e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),u-o<t)return;const h=d&&u-d;return h?Math.round(g*1e3/h):void 0}}function Cy(e,t){let r=0,a=1e3/t,n,s;const o=(u,d=Date.now())=>{r=d,n=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),m=d-r;m>=a?o(u,d):(n=u,s||(s=setTimeout(()=>{s=null,o(n)},a-m)))},()=>n&&o(n)]}const Yu=(e,t,r=3)=>{let a=0;const n=Ty(50,250);return Cy(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-a,u=n(c),d=o<=l;a=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(m)},r)},im=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},om=e=>(...t)=>Be.asap(()=>e(...t)),Py=Da.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Da.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Da.origin),Da.navigator&&/(msie|trident)/i.test(Da.navigator.userAgent)):()=>!0,Ly=Da.hasStandardBrowserEnv?{write(e,t,r,a,n,s){const o=[e+"="+encodeURIComponent(t)];Be.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Be.isString(a)&&o.push("path="+a),Be.isString(n)&&o.push("domain="+n),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Fy(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ky(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function N1(e,t,r){let a=!Fy(t);return e&&(a||r==!1)?ky(e,t):t}const lm=e=>e instanceof ts?{...e}:e;function Yi(e,t){t=t||{};const r={};function a(u,d,m,g){return Be.isPlainObject(u)&&Be.isPlainObject(d)?Be.merge.call({caseless:g},u,d):Be.isPlainObject(d)?Be.merge({},d):Be.isArray(d)?d.slice():d}function n(u,d,m,g){if(Be.isUndefined(d)){if(!Be.isUndefined(u))return a(void 0,u,m,g)}else return a(u,d,m,g)}function s(u,d){if(!Be.isUndefined(d))return a(void 0,d)}function o(u,d){if(Be.isUndefined(d)){if(!Be.isUndefined(u))return a(void 0,u)}else return a(void 0,d)}function l(u,d,m){if(m in t)return a(u,d);if(m in e)return a(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>n(lm(u),lm(d),m,!0)};return Be.forEach(Object.keys({...e,...t}),function(d){const m=c[d]||n,g=m(e[d],t[d],d);Be.isUndefined(g)&&m!==l||(r[d]=g)}),r}const _1=e=>{const t=Yi({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=ts.from(o),t.url=g1(N1(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Be.isFormData(r)){if(Da.hasStandardBrowserEnv||Da.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Be.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,m])=>{u.includes(d.toLowerCase())&&o.set(d,m)})}}if(Da.hasStandardBrowserEnv&&(a&&Be.isFunction(a)&&(a=a(t)),a||a!==!1&&Py(t.url))){const c=n&&s&&Ly.read(s);c&&o.set(n,c)}return t},Dy=typeof XMLHttpRequest<"u",Oy=Dy&&function(e){return new Promise(function(r,a){const n=_1(e);let s=n.data;const o=ts.from(n.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=n,d,m,g,h,x;function p(){h&&h(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(n.method.toUpperCase(),n.url,!0),y.timeout=n.timeout;function _(){if(!y)return;const E=ts.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),F={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:E,config:e,request:y};b1(function(T){r(T),p()},function(T){a(T),p()},F),y=null}"onloadend"in y?y.onloadend=_:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(_)},y.onabort=function(){y&&(a(new Wt("Request aborted",Wt.ECONNABORTED,e,y)),y=null)},y.onerror=function(C){const F=C&&C.message?C.message:"Network Error",B=new Wt(F,Wt.ERR_NETWORK,e,y);B.event=C||null,a(B),y=null},y.ontimeout=function(){let C=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const F=n.transitional||v1;n.timeoutErrorMessage&&(C=n.timeoutErrorMessage),a(new Wt(C,F.clarifyTimeoutError?Wt.ETIMEDOUT:Wt.ECONNABORTED,e,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&Be.forEach(o.toJSON(),function(C,F){y.setRequestHeader(F,C)}),Be.isUndefined(n.withCredentials)||(y.withCredentials=!!n.withCredentials),l&&l!=="json"&&(y.responseType=n.responseType),u&&([g,x]=Yu(u,!0),y.addEventListener("progress",g)),c&&y.upload&&([m,h]=Yu(c),y.upload.addEventListener("progress",m),y.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(d=E=>{y&&(a(!E||E.type?new nl(null,e,y):E),y.abort(),y=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const S=Ey(n.url);if(S&&Da.protocols.indexOf(S)===-1){a(new Wt("Unsupported protocol "+S+":",Wt.ERR_BAD_REQUEST,e));return}y.send(s||null)})},Iy=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const s=function(u){if(!n){n=!0,l();const d=u instanceof Error?u:this.reason;a.abort(d instanceof Wt?d:new nl(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new Wt(`timeout ${t} of ms exceeded`,Wt.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=a;return c.unsubscribe=()=>Be.asap(l),c}},Ry=Iy,My=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},By=async function*(e,t){for await(const r of Uy(e))yield*My(r,t)},Uy=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},cm=(e,t,r,a)=>{const n=By(e,t);let s=0,o,l=c=>{o||(o=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){l(),c.close();return}let m=d.byteLength;if(r){let g=s+=m;r(g)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),n.return()}},{highWaterMark:2})},um=64*1024,{isFunction:Nu}=Be,qy=(({Request:e,Response:t})=>({Request:e,Response:t}))(Be.global),{ReadableStream:dm,TextEncoder:fm}=Be.global,hm=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Wy=e=>{e=Be.merge.call({skipUndefined:!0},qy,e);const{fetch:t,Request:r,Response:a}=e,n=t?Nu(t):typeof fetch=="function",s=Nu(r),o=Nu(a);if(!n)return!1;const l=n&&Nu(dm),c=n&&(typeof fm=="function"?(x=>p=>x.encode(p))(new fm):async x=>new Uint8Array(await new r(x).arrayBuffer())),u=s&&l&&hm(()=>{let x=!1;const p=new r(Da.origin,{body:new dm,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!p}),d=o&&l&&hm(()=>Be.isReadableStream(new a("").body)),m={stream:d&&(x=>x.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!m[x]&&(m[x]=(p,y)=>{let _=p&&p[x];if(_)return _.call(p);throw new Wt(`Response type '${x}' is not supported`,Wt.ERR_NOT_SUPPORT,y)})});const g=async x=>{if(x==null)return 0;if(Be.isBlob(x))return x.size;if(Be.isSpecCompliantForm(x))return(await new r(Da.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Be.isArrayBufferView(x)||Be.isArrayBuffer(x))return x.byteLength;if(Be.isURLSearchParams(x)&&(x=x+""),Be.isString(x))return(await c(x)).byteLength},h=async(x,p)=>{const y=Be.toFiniteNumber(x.getContentLength());return y??g(p)};return async x=>{let{url:p,method:y,data:_,signal:S,cancelToken:E,timeout:C,onDownloadProgress:F,onUploadProgress:B,responseType:T,headers:P,withCredentials:k="same-origin",fetchOptions:I}=_1(x),A=t||fetch;T=T?(T+"").toLowerCase():"text";let b=Ry([S,E&&E.toAbortSignal()],C),R=null;const W=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let Y;try{if(B&&u&&y!=="get"&&y!=="head"&&(Y=await h(P,_))!==0){let ee=new r(p,{method:"POST",body:_,duplex:"half"}),N;if(Be.isFormData(_)&&(N=ee.headers.get("content-type"))&&P.setContentType(N),ee.body){const[L,D]=im(Y,Yu(om(B)));_=cm(ee.body,um,L,D)}}Be.isString(k)||(k=k?"include":"omit");const q=s&&"credentials"in r.prototype,U={...I,signal:b,method:y.toUpperCase(),headers:P.normalize().toJSON(),body:_,duplex:"half",credentials:q?k:void 0};R=s&&new r(p,U);let H=await(s?A(R,I):A(p,U));const Q=d&&(T==="stream"||T==="response");if(d&&(F||Q&&W)){const ee={};["status","statusText","headers"].forEach(M=>{ee[M]=H[M]});const N=Be.toFiniteNumber(H.headers.get("content-length")),[L,D]=F&&im(N,Yu(om(F),!0))||[];H=new a(cm(H.body,um,L,()=>{D&&D(),W&&W()}),ee)}T=T||"text";let ne=await m[Be.findKey(m,T)||"text"](H,x);return!Q&&W&&W(),await new Promise((ee,N)=>{b1(ee,N,{data:ne,headers:ts.from(H.headers),status:H.status,statusText:H.statusText,config:x,request:R})})}catch(q){throw W&&W(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new Wt("Network Error",Wt.ERR_NETWORK,x,R),{cause:q.cause||q}):Wt.from(q,q&&q.code,x,R)}}},Hy=new Map,S1=e=>{let t=e?e.env:{};const{fetch:r,Request:a,Response:n}=t,s=[a,n,r];let o=s.length,l=o,c,u,d=Hy;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:Wy(t)),d=u;return u};S1();const df={http:ny,xhr:Oy,fetch:{get:S1}};Be.forEach(df,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const mm=e=>`- ${e}`,$y=e=>Be.isFunction(e)||e===null||e===!1,A1={getAdapter:(e,t)=>{e=Be.isArray(e)?e:[e];const{length:r}=e;let a,n;const s={};for(let o=0;o<r;o++){a=e[o];let l;if(n=a,!$y(a)&&(n=df[(l=String(a)).toLowerCase()],n===void 0))throw new Wt(`Unknown adapter '${l}'`);if(n&&(Be.isFunction(n)||(n=n.get(t))))break;s[l||"#"+o]=n}if(!n){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(mm).join(`
`):" "+mm(o[0]):"as no adapter specified";throw new Wt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:df};function Fd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nl(null,e)}function pm(e){return Fd(e),e.headers=ts.from(e.headers),e.data=Ld.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),A1.getAdapter(e.adapter||Hf.adapter,e)(e).then(function(a){return Fd(e),a.data=Ld.call(e,e.transformResponse,a),a.headers=ts.from(a.headers),a},function(a){return w1(a)||(Fd(e),a&&a.response&&(a.response.data=Ld.call(e,e.transformResponse,a.response),a.response.headers=ts.from(a.response.headers))),Promise.reject(a)})}const j1="1.12.2",j0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{j0[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const xm={};j0.transitional=function(t,r,a){function n(s,o){return"[Axios v"+j1+"] Transitional option '"+s+"'"+o+(a?". "+a:"")}return(s,o,l)=>{if(t===!1)throw new Wt(n(o," has been removed"+(r?" in "+r:"")),Wt.ERR_DEPRECATED);return r&&!xm[o]&&(xm[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};j0.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function zy(e,t,r){if(typeof e!="object")throw new Wt("options must be an object",Wt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const s=a[n],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new Wt("option "+s+" must be "+c,Wt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Wt("Unknown option "+s,Wt.ERR_BAD_OPTION)}}const qu={assertOptions:zy,validators:j0},us=qu.validators;class Xu{constructor(t){this.defaults=t||{},this.interceptors={request:new nm,response:new nm}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const s=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?s&&!String(a.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+s):a.stack=s}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Yi(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:s}=r;a!==void 0&&qu.assertOptions(a,{silentJSONParsing:us.transitional(us.boolean),forcedJSONParsing:us.transitional(us.boolean),clarifyTimeoutError:us.transitional(us.boolean)},!1),n!=null&&(Be.isFunction(n)?r.paramsSerializer={serialize:n}:qu.assertOptions(n,{encode:us.function,serialize:us.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),qu.assertOptions(r,{baseUrl:us.spelling("baseURL"),withXsrfToken:us.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&Be.merge(s.common,s[r.method]);s&&Be.forEach(["delete","get","head","post","put","patch","common"],x=>{delete s[x]}),r.headers=ts.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,m=0,g;if(!c){const x=[pm.bind(this),void 0];for(x.unshift(...l),x.push(...u),g=x.length,d=Promise.resolve(r);m<g;)d=d.then(x[m++],x[m++]);return d}g=l.length;let h=r;for(;m<g;){const x=l[m++],p=l[m++];try{h=x(h)}catch(y){p.call(this,y);break}}try{d=pm.call(this,h)}catch(x){return Promise.reject(x)}for(m=0,g=u.length;m<g;)d=d.then(u[m++],u[m++]);return d}getUri(t){t=Yi(this.defaults,t);const r=N1(t.baseURL,t.url,t.allowAbsoluteUrls);return g1(r,t.params,t.paramsSerializer)}}Be.forEach(["delete","get","head","options"],function(t){Xu.prototype[t]=function(r,a){return this.request(Yi(a||{},{method:t,url:r,data:(a||{}).data}))}});Be.forEach(["post","put","patch"],function(t){function r(a){return function(s,o,l){return this.request(Yi(l||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Xu.prototype[t]=r(),Xu.prototype[t+"Form"]=r(!0)});const Wu=Xu;class $f{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const a=this;this.promise.then(n=>{if(!a._listeners)return;let s=a._listeners.length;for(;s-- >0;)a._listeners[s](n);a._listeners=null}),this.promise.then=n=>{let s;const o=new Promise(l=>{a.subscribe(l),s=l}).then(n);return o.cancel=function(){a.unsubscribe(s)},o},t(function(s,o,l){a.reason||(a.reason=new nl(s,o,l),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new $f(function(n){t=n}),cancel:t}}}const Vy=$f;function Gy(e){return function(r){return e.apply(null,r)}}function Yy(e){return Be.isObject(e)&&e.isAxiosError===!0}const ff={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ff).forEach(([e,t])=>{ff[t]=e});const Xy=ff;function E1(e){const t=new Wu(e),r=s1(Wu.prototype.request,t);return Be.extend(r,Wu.prototype,t,{allOwnKeys:!0}),Be.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return E1(Yi(e,n))},r}const ea=E1(Hf);ea.Axios=Wu;ea.CanceledError=nl;ea.CancelToken=Vy;ea.isCancel=w1;ea.VERSION=j1;ea.toFormData=S0;ea.AxiosError=Wt;ea.Cancel=ea.CanceledError;ea.all=function(t){return Promise.all(t)};ea.spread=Gy;ea.isAxiosError=Yy;ea.mergeConfig=Yi;ea.AxiosHeaders=ts;ea.formToJSON=e=>y1(Be.isHTMLForm(e)?new FormData(e):e);ea.getAdapter=A1.getAdapter;ea.HttpStatusCode=Xy;ea.default=ea;const Ky=ea,Jy="https://glistening-insight.up.railway.app/api/",Qy="https://glistening-insight.up.railway.app/storage/",Is={base_api_url:Jy,base_image_url:Qy,app_name:"Inventory Management System",app_version:"1.0.0",currency:"$",date_format:"YYYY-MM-DD",pagination_limit:10},Zy="https://glistening-insight.up.railway.app/api/",Xn=Ky.create({baseURL:Zy,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!1,timeout:6e4});Xn.interceptors.request.use(e=>{var a;const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const r=(a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content");return r&&(e.headers["X-CSRF-TOKEN"]=r),e},e=>Promise.reject(e));Xn.interceptors.response.use(e=>e,e=>{var t,r,a,n;return e.response?((t=e.response)==null?void 0:t.status)===401&&!((r=e.config.url)!=null&&r.includes("/auth/"))?(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",Ye.error("Your session has expired. Please login again.")):((a=e.response)==null?void 0:a.status)===403?Ye.error("You do not have permission to perform this action"):((n=e.response)==null?void 0:n.status)>=500&&Ye.error("Server error. Please try again later."):Ye.error("Network error. Please check your connection."),Promise.reject(e)});const gm=Object.freeze(Object.defineProperty({__proto__:null,default:Xn},Symbol.toStringTag,{value:"Module"})),T1=se.createContext(null),e5={user:null,token:null,isLoading:!0,isAuthenticated:!1},t5=(e,t)=>{switch(t.type){case"LOGIN_SUCCESS":return{...e,user:t.payload.user,token:t.payload.token,isAuthenticated:!0,isLoading:!1};case"LOGOUT":return{...e,user:null,token:null,isAuthenticated:!1,isLoading:!1};case"SET_LOADING":return{...e,isLoading:t.payload};case"UPDATE_USER":return{...e,user:{...e.user,...t.payload}};default:return e}},r5=({children:e})=>{const[t,r]=se.useReducer(t5,e5);se.useEffect(()=>{(()=>{try{const u=localStorage.getItem("token"),d=localStorage.getItem("user");if(u&&d){const m=JSON.parse(d);r({type:"LOGIN_SUCCESS",payload:{user:m,token:u}})}else r({type:"SET_LOADING",payload:!1})}catch(u){console.error("Auth initialization error:",u),localStorage.removeItem("token"),localStorage.removeItem("user"),r({type:"SET_LOADING",payload:!1})}})()},[]);const a=se.useCallback(async c=>{var u,d,m,g,h;try{r({type:"SET_LOADING",payload:!0});const x=await Xn.post("/auth/login",c);if(x.data.success){let p,y;x.data.data?(p=x.data.data.user,y=x.data.data.token):(p=x.data.user,y=x.data.access_token||x.data.token);const _=C=>({sales:"staff_sale",inventory:"inventory_staff",admin:"admin",manager:"manager",user:"user"})[C]||C,S=p.type||p.user_type||"user",E={...p,type:_(S)};return localStorage.setItem("token",y),localStorage.setItem("user",JSON.stringify(E)),r({type:"LOGIN_SUCCESS",payload:{user:E,token:y}}),Ye.success(`Welcome back, ${E.name}!`),{success:!0}}else return r({type:"SET_LOADING",payload:!1}),{success:!1,message:x.data.message||"Login failed"}}catch(x){r({type:"SET_LOADING",payload:!1});let p="Login failed. Please try again.";return x.code==="ERR_NETWORK"?p="Cannot connect to server. Please ensure the Laravel API is running on http://localhost:8000":((u=x.response)==null?void 0:u.status)===401?p="Invalid email or password. Please check your credentials.":((d=x.response)==null?void 0:d.status)===422?p="Please check your input and try again.":((m=x.response)==null?void 0:m.status)>=500?p="Server error. Please try again later.":(h=(g=x.response)==null?void 0:g.data)!=null&&h.message&&(p=x.response.data.message),{success:!1,message:p}}},[r]),n=se.useCallback(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),r({type:"LOGOUT"}),Ye.success("Logged out successfully")},[r]),s=se.useCallback(c=>{const u={...t.user,...c};localStorage.setItem("user",JSON.stringify(u)),r({type:"UPDATE_USER",payload:c})},[t.user,r]),o=se.useCallback(c=>{if(!t.user)return!1;const u=t.user.type,m={admin:["view","create","read","update","delete","manage_users"],manager:["view","read","update"],staff_sale:["view","read","create_order","update_order","create_payment","update_payment"],inventory_staff:["view","read","create","update","delete","create_product","update_product","create_import","update_import"],user:["view","read"]}[u]||[];return Array.isArray(c)?c.some(g=>m.includes(g)):m.includes(c)},[t.user]),l=se.useMemo(()=>({...t,login:a,logout:n,updateUser:s,hasPermission:o}),[t,a,n,s,o]);return i.jsx(T1.Provider,{value:l,children:e})},ha=()=>{const e=se.useContext(T1);if(e===null)throw new Error("useAuth must be used within an AuthProvider");return e},Er=({size:e="md",className:t="",message:r=""})=>{const a={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},n=`flex flex-col items-center justify-center ${t}`;return i.jsxs("div",{className:n,children:[i.jsx("div",{className:`animate-spin rounded-full border-4 border-gray-300 border-t-primary-600 ${a[e]}`}),r&&i.jsx("p",{className:"mt-4 text-gray-600 text-sm font-medium",children:r})]})},a5=({children:e,requiredPermissions:t=[]})=>{const{isAuthenticated:r,isLoading:a,hasPermission:n}=ha();return a?i.jsx(Er,{}):r?t.length>0&&!n(t)?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):e:i.jsx(v0,{to:"/login",replace:!0})};function ar(e){"@babel/helpers - typeof";return ar=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ar(e)}function mi(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Ba(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function ys(e){Ba(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||ar(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function n5(e,t){Ba(2,arguments);var r=ys(e).getTime(),a=mi(t);return new Date(r+a)}var s5={};function E0(){return s5}function i5(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}var C1=6e4,P1=36e5;function o5(e){return Ba(1,arguments),e instanceof Date||ar(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function l5(e){if(Ba(1,arguments),!o5(e)&&typeof e!="number")return!1;var t=ys(e);return!isNaN(Number(t))}function c5(e,t){Ba(2,arguments);var r=mi(t);return n5(e,-r)}var u5=864e5;function d5(e){Ba(1,arguments);var t=ys(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var a=t.getTime(),n=r-a;return Math.floor(n/u5)+1}function Ku(e){Ba(1,arguments);var t=1,r=ys(e),a=r.getUTCDay(),n=(a<t?7:0)+a-t;return r.setUTCDate(r.getUTCDate()-n),r.setUTCHours(0,0,0,0),r}function L1(e){Ba(1,arguments);var t=ys(e),r=t.getUTCFullYear(),a=new Date(0);a.setUTCFullYear(r+1,0,4),a.setUTCHours(0,0,0,0);var n=Ku(a),s=new Date(0);s.setUTCFullYear(r,0,4),s.setUTCHours(0,0,0,0);var o=Ku(s);return t.getTime()>=n.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function f5(e){Ba(1,arguments);var t=L1(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var a=Ku(r);return a}var h5=6048e5;function m5(e){Ba(1,arguments);var t=ys(e),r=Ku(t).getTime()-f5(t).getTime();return Math.round(r/h5)+1}function Ju(e,t){var r,a,n,s,o,l,c,u;Ba(1,arguments);var d=E0(),m=mi((r=(a=(n=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(o=t.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&n!==void 0?n:d.weekStartsOn)!==null&&a!==void 0?a:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=ys(e),h=g.getUTCDay(),x=(h<m?7:0)+h-m;return g.setUTCDate(g.getUTCDate()-x),g.setUTCHours(0,0,0,0),g}function F1(e,t){var r,a,n,s,o,l,c,u;Ba(1,arguments);var d=ys(e),m=d.getUTCFullYear(),g=E0(),h=mi((r=(a=(n=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(o=t.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&n!==void 0?n:g.firstWeekContainsDate)!==null&&a!==void 0?a:(c=g.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var x=new Date(0);x.setUTCFullYear(m+1,0,h),x.setUTCHours(0,0,0,0);var p=Ju(x,t),y=new Date(0);y.setUTCFullYear(m,0,h),y.setUTCHours(0,0,0,0);var _=Ju(y,t);return d.getTime()>=p.getTime()?m+1:d.getTime()>=_.getTime()?m:m-1}function p5(e,t){var r,a,n,s,o,l,c,u;Ba(1,arguments);var d=E0(),m=mi((r=(a=(n=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(o=t.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&n!==void 0?n:d.firstWeekContainsDate)!==null&&a!==void 0?a:(c=d.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&r!==void 0?r:1),g=F1(e,t),h=new Date(0);h.setUTCFullYear(g,0,m),h.setUTCHours(0,0,0,0);var x=Ju(h,t);return x}var x5=6048e5;function g5(e,t){Ba(1,arguments);var r=ys(e),a=Ju(r,t).getTime()-p5(r,t).getTime();return Math.round(a/x5)+1}function cr(e,t){for(var r=e<0?"-":"",a=Math.abs(e).toString();a.length<t;)a="0"+a;return r+a}var v5={y:function(t,r){var a=t.getUTCFullYear(),n=a>0?a:1-a;return cr(r==="yy"?n%100:n,r.length)},M:function(t,r){var a=t.getUTCMonth();return r==="M"?String(a+1):cr(a+1,2)},d:function(t,r){return cr(t.getUTCDate(),r.length)},a:function(t,r){var a=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h:function(t,r){return cr(t.getUTCHours()%12||12,r.length)},H:function(t,r){return cr(t.getUTCHours(),r.length)},m:function(t,r){return cr(t.getUTCMinutes(),r.length)},s:function(t,r){return cr(t.getUTCSeconds(),r.length)},S:function(t,r){var a=r.length,n=t.getUTCMilliseconds(),s=Math.floor(n*Math.pow(10,a-3));return cr(s,r.length)}};const ei=v5;var Lo={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},y5={G:function(t,r,a){var n=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return a.era(n,{width:"abbreviated"});case"GGGGG":return a.era(n,{width:"narrow"});case"GGGG":default:return a.era(n,{width:"wide"})}},y:function(t,r,a){if(r==="yo"){var n=t.getUTCFullYear(),s=n>0?n:1-n;return a.ordinalNumber(s,{unit:"year"})}return ei.y(t,r)},Y:function(t,r,a,n){var s=F1(t,n),o=s>0?s:1-s;if(r==="YY"){var l=o%100;return cr(l,2)}return r==="Yo"?a.ordinalNumber(o,{unit:"year"}):cr(o,r.length)},R:function(t,r){var a=L1(t);return cr(a,r.length)},u:function(t,r){var a=t.getUTCFullYear();return cr(a,r.length)},Q:function(t,r,a){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return cr(n,2);case"Qo":return a.ordinalNumber(n,{unit:"quarter"});case"QQQ":return a.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,a){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return cr(n,2);case"qo":return a.ordinalNumber(n,{unit:"quarter"});case"qqq":return a.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,a){var n=t.getUTCMonth();switch(r){case"M":case"MM":return ei.M(t,r);case"Mo":return a.ordinalNumber(n+1,{unit:"month"});case"MMM":return a.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,a){var n=t.getUTCMonth();switch(r){case"L":return String(n+1);case"LL":return cr(n+1,2);case"Lo":return a.ordinalNumber(n+1,{unit:"month"});case"LLL":return a.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,a,n){var s=g5(t,n);return r==="wo"?a.ordinalNumber(s,{unit:"week"}):cr(s,r.length)},I:function(t,r,a){var n=m5(t);return r==="Io"?a.ordinalNumber(n,{unit:"week"}):cr(n,r.length)},d:function(t,r,a){return r==="do"?a.ordinalNumber(t.getUTCDate(),{unit:"date"}):ei.d(t,r)},D:function(t,r,a){var n=d5(t);return r==="Do"?a.ordinalNumber(n,{unit:"dayOfYear"}):cr(n,r.length)},E:function(t,r,a){var n=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return a.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(n,{width:"short",context:"formatting"});case"EEEE":default:return a.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,a,n){var s=t.getUTCDay(),o=(s-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return cr(o,2);case"eo":return a.ordinalNumber(o,{unit:"day"});case"eee":return a.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(s,{width:"short",context:"formatting"});case"eeee":default:return a.day(s,{width:"wide",context:"formatting"})}},c:function(t,r,a,n){var s=t.getUTCDay(),o=(s-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return cr(o,r.length);case"co":return a.ordinalNumber(o,{unit:"day"});case"ccc":return a.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(s,{width:"narrow",context:"standalone"});case"cccccc":return a.day(s,{width:"short",context:"standalone"});case"cccc":default:return a.day(s,{width:"wide",context:"standalone"})}},i:function(t,r,a){var n=t.getUTCDay(),s=n===0?7:n;switch(r){case"i":return String(s);case"ii":return cr(s,r.length);case"io":return a.ordinalNumber(s,{unit:"day"});case"iii":return a.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(n,{width:"short",context:"formatting"});case"iiii":default:return a.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,a){var n=t.getUTCHours(),s=n/12>=1?"pm":"am";switch(r){case"a":case"aa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,r,a){var n=t.getUTCHours(),s;switch(n===12?s=Lo.noon:n===0?s=Lo.midnight:s=n/12>=1?"pm":"am",r){case"b":case"bb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,r,a){var n=t.getUTCHours(),s;switch(n>=17?s=Lo.evening:n>=12?s=Lo.afternoon:n>=4?s=Lo.morning:s=Lo.night,r){case"B":case"BB":case"BBB":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,r,a){if(r==="ho"){var n=t.getUTCHours()%12;return n===0&&(n=12),a.ordinalNumber(n,{unit:"hour"})}return ei.h(t,r)},H:function(t,r,a){return r==="Ho"?a.ordinalNumber(t.getUTCHours(),{unit:"hour"}):ei.H(t,r)},K:function(t,r,a){var n=t.getUTCHours()%12;return r==="Ko"?a.ordinalNumber(n,{unit:"hour"}):cr(n,r.length)},k:function(t,r,a){var n=t.getUTCHours();return n===0&&(n=24),r==="ko"?a.ordinalNumber(n,{unit:"hour"}):cr(n,r.length)},m:function(t,r,a){return r==="mo"?a.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):ei.m(t,r)},s:function(t,r,a){return r==="so"?a.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):ei.s(t,r)},S:function(t,r){return ei.S(t,r)},X:function(t,r,a,n){var s=n._originalDate||t,o=s.getTimezoneOffset();if(o===0)return"Z";switch(r){case"X":return ym(o);case"XXXX":case"XX":return Oi(o);case"XXXXX":case"XXX":default:return Oi(o,":")}},x:function(t,r,a,n){var s=n._originalDate||t,o=s.getTimezoneOffset();switch(r){case"x":return ym(o);case"xxxx":case"xx":return Oi(o);case"xxxxx":case"xxx":default:return Oi(o,":")}},O:function(t,r,a,n){var s=n._originalDate||t,o=s.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+vm(o,":");case"OOOO":default:return"GMT"+Oi(o,":")}},z:function(t,r,a,n){var s=n._originalDate||t,o=s.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+vm(o,":");case"zzzz":default:return"GMT"+Oi(o,":")}},t:function(t,r,a,n){var s=n._originalDate||t,o=Math.floor(s.getTime()/1e3);return cr(o,r.length)},T:function(t,r,a,n){var s=n._originalDate||t,o=s.getTime();return cr(o,r.length)}};function vm(e,t){var r=e>0?"-":"+",a=Math.abs(e),n=Math.floor(a/60),s=a%60;if(s===0)return r+String(n);var o=t||"";return r+String(n)+o+cr(s,2)}function ym(e,t){if(e%60===0){var r=e>0?"-":"+";return r+cr(Math.abs(e)/60,2)}return Oi(e,t)}function Oi(e,t){var r=t||"",a=e>0?"-":"+",n=Math.abs(e),s=cr(Math.floor(n/60),2),o=cr(n%60,2);return a+s+r+o}const w5=y5;var wm=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},k1=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},b5=function(t,r){var a=t.match(/(P+)(p+)?/)||[],n=a[1],s=a[2];if(!s)return wm(t,r);var o;switch(n){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",wm(n,r)).replace("{{time}}",k1(s,r))},N5={p:k1,P:b5};const _5=N5;var S5=["D","DD"],A5=["YY","YYYY"];function j5(e){return S5.indexOf(e)!==-1}function E5(e){return A5.indexOf(e)!==-1}function bm(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var T5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},C5=function(t,r,a){var n,s=T5[t];return typeof s=="string"?n=s:r===1?n=s.one:n=s.other.replace("{{count}}",r.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+n:n+" ago":n};const P5=C5;function kd(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,a=e.formats[r]||e.formats[e.defaultWidth];return a}}var L5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},F5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},k5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},D5={date:kd({formats:L5,defaultWidth:"full"}),time:kd({formats:F5,defaultWidth:"full"}),dateTime:kd({formats:k5,defaultWidth:"full"})};const O5=D5;var I5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},R5=function(t,r,a,n){return I5[t]};const M5=R5;function ql(e){return function(t,r){var a=r!=null&&r.context?String(r.context):"standalone",n;if(a==="formatting"&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):s;n=e.formattingValues[o]||e.formattingValues[s]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[c]||e.values[l]}var u=e.argumentCallback?e.argumentCallback(t):t;return n[u]}}var B5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},U5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},q5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},W5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},H5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},$5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},z5=function(t,r){var a=Number(t),n=a%100;if(n>20||n<10)switch(n%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},V5={ordinalNumber:z5,era:ql({values:B5,defaultWidth:"wide"}),quarter:ql({values:U5,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:ql({values:q5,defaultWidth:"wide"}),day:ql({values:W5,defaultWidth:"wide"}),dayPeriod:ql({values:H5,defaultWidth:"wide",formattingValues:$5,defaultFormattingWidth:"wide"})};const G5=V5;function Wl(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=t.match(n);if(!s)return null;var o=s[0],l=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?X5(l,function(m){return m.test(o)}):Y5(l,function(m){return m.test(o)}),u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;var d=t.slice(o.length);return{value:u,rest:d}}}function Y5(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function X5(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function K5(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.match(e.matchPattern);if(!a)return null;var n=a[0],s=t.match(e.parsePattern);if(!s)return null;var o=e.valueCallback?e.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;var l=t.slice(n.length);return{value:o,rest:l}}}var J5=/^(\d+)(th|st|nd|rd)?/i,Q5=/\d+/i,Z5={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ew={any:[/^b/i,/^(a|c)/i]},tw={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},rw={any:[/1/i,/2/i,/3/i,/4/i]},aw={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},nw={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},sw={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},iw={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ow={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},lw={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},cw={ordinalNumber:K5({matchPattern:J5,parsePattern:Q5,valueCallback:function(t){return parseInt(t,10)}}),era:Wl({matchPatterns:Z5,defaultMatchWidth:"wide",parsePatterns:ew,defaultParseWidth:"any"}),quarter:Wl({matchPatterns:tw,defaultMatchWidth:"wide",parsePatterns:rw,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Wl({matchPatterns:aw,defaultMatchWidth:"wide",parsePatterns:nw,defaultParseWidth:"any"}),day:Wl({matchPatterns:sw,defaultMatchWidth:"wide",parsePatterns:iw,defaultParseWidth:"any"}),dayPeriod:Wl({matchPatterns:ow,defaultMatchWidth:"any",parsePatterns:lw,defaultParseWidth:"any"})};const uw=cw;var dw={code:"en-US",formatDistance:P5,formatLong:O5,formatRelative:M5,localize:G5,match:uw,options:{weekStartsOn:0,firstWeekContainsDate:1}};const fw=dw;var hw=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,mw=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,pw=/^'([^]*?)'?$/,xw=/''/g,gw=/[a-zA-Z]/;function Nm(e,t,r){var a,n,s,o,l,c,u,d,m,g,h,x,p,y,_,S,E,C;Ba(2,arguments);var F=String(t),B=E0(),T=(a=(n=r==null?void 0:r.locale)!==null&&n!==void 0?n:B.locale)!==null&&a!==void 0?a:fw,P=mi((s=(o=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(u=r.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&l!==void 0?l:B.firstWeekContainsDate)!==null&&o!==void 0?o:(m=B.locale)===null||m===void 0||(g=m.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(P>=1&&P<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=mi((h=(x=(p=(y=r==null?void 0:r.weekStartsOn)!==null&&y!==void 0?y:r==null||(_=r.locale)===null||_===void 0||(S=_.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&p!==void 0?p:B.weekStartsOn)!==null&&x!==void 0?x:(E=B.locale)===null||E===void 0||(C=E.options)===null||C===void 0?void 0:C.weekStartsOn)!==null&&h!==void 0?h:0);if(!(k>=0&&k<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!T.localize)throw new RangeError("locale must contain localize property");if(!T.formatLong)throw new RangeError("locale must contain formatLong property");var I=ys(e);if(!l5(I))throw new RangeError("Invalid time value");var A=i5(I),b=c5(I,A),R={firstWeekContainsDate:P,weekStartsOn:k,locale:T,_originalDate:I},W=F.match(mw).map(function(Y){var q=Y[0];if(q==="p"||q==="P"){var U=_5[q];return U(Y,T.formatLong)}return Y}).join("").match(hw).map(function(Y){if(Y==="''")return"'";var q=Y[0];if(q==="'")return vw(Y);var U=w5[q];if(U)return!(r!=null&&r.useAdditionalWeekYearTokens)&&E5(Y)&&bm(Y,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&j5(Y)&&bm(Y,t,String(e)),U(b,Y,T.localize,R);if(q.match(gw))throw new RangeError("Format string contains an unescaped latin alphabet character `"+q+"`");return Y}).join("");return W}function vw(e){var t=e.match(pw);return t?t[1].replace(xw,"'"):e}function _u(e,t){var r;Ba(1,arguments);var a=mi((r=t==null?void 0:t.additionalDigits)!==null&&r!==void 0?r:2);if(a!==2&&a!==1&&a!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=Nw(e),s;if(n.date){var o=_w(n.date,a);s=Sw(o.restDateString,o.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);var l=s.getTime(),c=0,u;if(n.time&&(c=Aw(n.time),isNaN(c)))return new Date(NaN);if(n.timezone){if(u=jw(n.timezone),isNaN(u))return new Date(NaN)}else{var d=new Date(l+c),m=new Date(0);return m.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),m.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),m}return new Date(l+c+u)}var Su={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},yw=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ww=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,bw=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Nw(e){var t={},r=e.split(Su.dateTimeDelimiter),a;if(r.length>2)return t;if(/:/.test(r[0])?a=r[0]:(t.date=r[0],a=r[1],Su.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Su.timeZoneDelimiter)[0],a=e.substr(t.date.length,e.length))),a){var n=Su.timezone.exec(a);n?(t.time=a.replace(n[1],""),t.timezone=n[1]):t.time=a}return t}function _w(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=e.match(r);if(!a)return{year:NaN,restDateString:""};var n=a[1]?parseInt(a[1]):null,s=a[2]?parseInt(a[2]):null;return{year:s===null?n:s*100,restDateString:e.slice((a[1]||a[2]).length)}}function Sw(e,t){if(t===null)return new Date(NaN);var r=e.match(yw);if(!r)return new Date(NaN);var a=!!r[4],n=Hl(r[1]),s=Hl(r[2])-1,o=Hl(r[3]),l=Hl(r[4]),c=Hl(r[5])-1;if(a)return Lw(t,l,c)?Ew(t,l,c):new Date(NaN);var u=new Date(0);return!Cw(t,s,o)||!Pw(t,n)?new Date(NaN):(u.setUTCFullYear(t,s,Math.max(n,o)),u)}function Hl(e){return e?parseInt(e):1}function Aw(e){var t=e.match(ww);if(!t)return NaN;var r=Dd(t[1]),a=Dd(t[2]),n=Dd(t[3]);return Fw(r,a,n)?r*P1+a*C1+n*1e3:NaN}function Dd(e){return e&&parseFloat(e.replace(",","."))||0}function jw(e){if(e==="Z")return 0;var t=e.match(bw);if(!t)return 0;var r=t[1]==="+"?-1:1,a=parseInt(t[2]),n=t[3]&&parseInt(t[3])||0;return kw(a,n)?r*(a*P1+n*C1):NaN}function Ew(e,t,r){var a=new Date(0);a.setUTCFullYear(e,0,4);var n=a.getUTCDay()||7,s=(t-1)*7+r+1-n;return a.setUTCDate(a.getUTCDate()+s),a}var Tw=[31,null,31,30,31,30,31,31,30,31,30,31];function D1(e){return e%400===0||e%4===0&&e%100!==0}function Cw(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Tw[t]||(D1(e)?29:28))}function Pw(e,t){return t>=1&&t<=(D1(e)?366:365)}function Lw(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Fw(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function kw(e,t){return t>=0&&t<=59}const br=(e,t="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e),Pr=(e,t="MMM dd, yyyy")=>{if(!e)return"";try{let r;if(typeof e=="string")if(e.includes("T"))r=_u(e);else if(e.includes("-")&&e.includes(" ")){const a=e.split(" "),n=a[0],s=a[1]||"00:00:00";r=_u(n+"T"+s)}else e.includes("-")?r=_u(e+"T00:00:00"):r=new Date(e);else e instanceof Date?r=e:r=new Date(e);if(isNaN(r.getTime())){if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}/)){try{const a=e.replace(" ","T"),n=_u(a);if(!isNaN(n.getTime()))return Nm(n,t)}catch{}return e}return(typeof e!="string"||!e.includes("-")&&!e.includes("/"))&&console.warn("Invalid date:",e),e}return Nm(r,t)}catch(r){return typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}/)||console.warn("Error formatting date:",e,r),e}},hf=e=>({admin:"Administrator",manager:"Manager",sales:"Sales Staff",staff_sale:"Sales Staff",inventory:"Inventory Staff",inventory_staff:"Inventory Staff",user:"User"})[e]||e,_m=e=>({active:"text-green-600 bg-green-100",inactive:"text-red-600 bg-red-100",pending:"text-yellow-600 bg-yellow-100",completed:"text-blue-600 bg-blue-100",cancelled:"text-gray-600 bg-gray-100"})[e]||"text-gray-600 bg-gray-100",pi=(e,t="http://localhost:8000/storage/")=>e?e.startsWith("http://")||e.startsWith("https://")?e:`${t}${e}`:null,Dw="modulepreload",Ow=function(e){return"/"+e},Sm={},Ga=function(t,r,a){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=Ow(s),s in Sm)return;Sm[s]=!0;const o=s.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!a)for(let d=n.length-1;d>=0;d--){const m=n[d];if(m.href===s&&(!o||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Dw,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((d,m)=>{u.addEventListener("load",d),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Uo=new Map,Od=new Map,Iw=async e=>{if(!(Uo.has(e)||Od.has(e)))try{const t=(async()=>{switch(e){case"/products":const{productService:r}=await Ga(()=>Promise.resolve().then(()=>pb),void 0),a=await r.getAll();return Uo.set(e,a),a;case"/orders":const{orderService:n}=await Ga(()=>Promise.resolve().then(()=>wb),void 0),s=await n.getAll();return Uo.set(e,s),s;case"/payments":const{paymentService:o}=await Ga(()=>Promise.resolve().then(()=>_b),void 0),l=await o.getAll();return Uo.set(e,l),l;case"/analytics":const{reportService:c}=await Ga(()=>Promise.resolve().then(()=>Ff),void 0),u={date_from:new Date(Date.now()-90*24*60*60*1e3).toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0]},[d,m,g,h]=await Promise.allSettled([c.getSalesSummary(u),c.getImportSummary(u),c.getInventorySummary(),c.getBestSellingProducts({...u,limit:10})]);return Uo.set(e,{sales:d.status==="fulfilled"?d.value:null,imports:m.status==="fulfilled"?m.value:null,inventory:g.status==="fulfilled"?g.value:null,bestSelling:h.status==="fulfilled"?h.value:null}),{sales:d,imports:m,inventory:g,bestSelling:h};default:return null}})();Od.set(e,t),await t}catch(t){console.warn(`Prefetch failed for ${e}:`,t)}finally{Od.delete(e)}},ui=e=>Uo.get(e),Am=({to:e,children:t,className:r,onClick:a})=>{const n=se.useRef(null);return se.useEffect(()=>{if(n.current&&e){let s;const o=()=>{s=setTimeout(()=>{Iw(e)},200)},l=()=>{clearTimeout(s)};return n.current.addEventListener("mouseenter",o),n.current.addEventListener("mouseleave",l),()=>{clearTimeout(s),n.current&&(n.current.removeEventListener("mouseenter",o),n.current.removeEventListener("mouseleave",l))}}},[e]),i.jsx(U2,{ref:n,to:e,onClick:a,className:r,children:t})},Rw=({isOpen:e,onClose:t})=>{var u,d,m,g;const{user:r,hasPermission:a}=ha(),[n,s]=se.useState({}),o=h=>{s(x=>({...x,[h]:!x[h]}))},c=[{name:"Dashboard",icon:G2,path:"/dashboard",permission:"read"},{name:"Analytics",icon:Hu,path:"/analytics",permission:"read"},{name:"Inventory",icon:Lr,permission:"read",dropdown:!0,children:[{name:"Products",icon:Lr,path:"/products",permission:"read"},{name:"Categories",icon:Xp,path:"/categories",permission:"read"},{name:"Brands",icon:Kp,path:"/brands",permission:"read"},{name:"Suppliers",icon:mc,path:"/suppliers",permission:"read"}]},{name:"People",icon:hi,permission:"read",dropdown:!0,children:[{name:"Customers",icon:hi,path:"/customers",permission:"read"},{name:"Staff",icon:af,path:"/staff",permission:"read"},{name:"Users",icon:Jp,path:"/users",permission:"manage_users"}]},{name:"Operations",icon:In,permission:"read",dropdown:!0,children:[{name:"Imports",icon:Gi,path:"/imports",permission:"read"},{name:"Orders",icon:In,path:"/orders",permission:"read"},{name:"Payments",icon:Qp,path:"/payments",permission:"read"}]},{name:"Reports",icon:If,permission:"manage_users",dropdown:!0,children:[{name:"Import Report",icon:Gi,path:"/reports#import",permission:"read"},{name:"Sales Report",icon:In,path:"/reports#sales",permission:"read"}]},{name:"Notifications",icon:Rf,path:"/notifications",permission:"read"}].filter(h=>a(h.permission));return i.jsxs(i.Fragment,{children:[e&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:t}),i.jsxs("div",{className:`
        fixed inset-y-0 left-0 z-50 w-72 sm:w-80 lg:w-64 bg-white  shadow-lg transform transition-transform duration-300 ease-in-out
        lg:translate-x-0 lg:static lg:inset-0
        ${e?"translate-x-0":"-translate-x-full"}
      `,children:[i.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsxs("div",{className:"w-10 h-10 rounded-full overflow-hidden mr-3 border-2 border-gray-200",children:[r.image||(u=r.profile)!=null&&u.image?i.jsx("img",{src:r.image_url||((d=r.profile)==null?void 0:d.image_url)||pi(r.image||((m=r.profile)==null?void 0:m.image),Is.base_image_url),alt:r.name,className:"w-full h-full object-cover",onError:h=>{h.target.style.display="none",h.target.nextSibling.style.display="flex"}}):null,i.jsx("div",{className:`w-full h-full bg-primary-700 flex items-center justify-center ${r.image||(g=r.profile)!=null&&g.image?"hidden":""}`,children:i.jsx(fi,{className:"w-5 h-5 text-white"})})]}),i.jsx("span",{className:"ml-2 text-lg font-semibold text-gray-800",children:i.jsx("div",{className:"font-medium text-gray-900",children:r.name})})]}),i.jsx("button",{onClick:t,className:"lg:hidden text-gray-500 hover:text-gray-700 p-1",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsxs("nav",{className:"mt-4 sm:mt-6 pb-4 overflow-y-auto max-h-[calc(100vh-120px)]",children:[i.jsx("div",{className:"px-4 sm:px-6 mb-4",children:i.jsx("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:(r==null?void 0:r.type)==="admin"?"Administrator":(r==null?void 0:r.type)==="manager"?"Manager":(r==null?void 0:r.type)==="staff_sale"?"Sales Staff":(r==null?void 0:r.type)==="inventory_staff"?"Inventory Staff":"User"})}),c.map(h=>{var x;return i.jsx("div",{children:h.dropdown?i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>o(h.name),className:"flex items-center justify-between w-full px-4 sm:px-6 py-3 sm:py-3 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors duration-200 mx-2 sm:mx-0 rounded-lg sm:rounded-none",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(h.icon,{className:"w-5 h-5 mr-3 flex-shrink-0"}),i.jsx("span",{className:"truncate",children:h.name})]}),n[h.name]?i.jsx(z2,{className:"w-4 h-4 transition-transform"}):i.jsx(V2,{className:"w-4 h-4 transition-transform"})]}),n[h.name]&&i.jsx("div",{className:"ml-4 sm:ml-6 mt-1 space-y-1",children:(x=h.children)==null?void 0:x.filter(p=>a(p.permission)).map(p=>i.jsxs(Am,{to:p.path,onClick:t,className:({isActive:y})=>`flex items-center px-4 sm:px-6 py-2 sm:py-2 text-sm font-medium transition-colors duration-200 mx-2 sm:mx-0 rounded-lg sm:rounded-none ${y?"text-primary-500 bg-primary-50 sm:border-r-2 sm:border-primary-600 sm:bg-primary-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[i.jsx(p.icon,{className:"w-4 h-4 mr-3 flex-shrink-0"}),i.jsx("span",{className:"truncate",children:p.name})]},p.name))})]}):i.jsxs(Am,{to:h.path,onClick:t,className:({isActive:p})=>`flex items-center px-4 sm:px-6 py-3 sm:py-3 text-sm font-medium transition-colors duration-200 mx-2 sm:mx-0 rounded-lg sm:rounded-none ${p?"text-primary-600 bg-primary-50 sm:border-r-2 sm:border-primary-600 sm:bg-primary-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[i.jsx(h.icon,{className:"w-5 h-5 mr-3 flex-shrink-0"}),i.jsx("span",{className:"truncate",children:h.name})]})},h.name)})]})]})]})},ut={get:(e,t={},r={})=>{const a={params:t,timeout:r.timeout||6e4,...r};return Xn.get(e,a).then(n=>n.data&&n.data.success&&n.data.data?{data:n.data.data}:n.data&&n.data.data&&!n.data.success?{data:n.data.data}:n.data&&Array.isArray(n.data)?{data:n.data}:n.data).catch(n=>{var s;throw console.error("API Error:",n),console.error("API Error Response:",(s=n.response)==null?void 0:s.data),n})},post:(e,t={})=>Xn.post(e,t).then(r=>r.data&&r.data.data?r.data.data:(r.data&&Array.isArray(r.data),r.data)),put:(e,t={})=>Xn.put(e,t).then(r=>r.data&&r.data.data?r.data.data:(r.data&&Array.isArray(r.data),r.data)),delete:e=>Xn.delete(e).then(t=>t.data&&t.data.data?t.data.data:(t.data&&Array.isArray(t.data),t.data)),patch:(e,t={})=>Xn.patch(e,t).then(r=>r.data&&r.data.data?r.data.data:(r.data&&Array.isArray(r.data),r.data))},el=(e,t)=>Xn.post(e,t,{headers:{"Content-Type":"multipart/form-data"}}),Mw=(e,t)=>{let r;return(...a)=>{clearTimeout(r),r=setTimeout(()=>e(...a),t)}},jm={product:{icon:X2,route:"/products",labelKey:"pro_name"},user:{icon:hi,route:"/users",labelKey:"name"},order:{icon:In,route:"/orders",labelKey:"id"},payment:{icon:Qp,route:"/payments",labelKey:"id"},supplier:{icon:mc,route:"/suppliers",labelKey:"supplier"},customer:{icon:hi,route:"/customers",labelKey:"cus_name"}};function Bw(){const[e,t]=se.useState(!1),[r,a]=se.useState(""),[n,s]=se.useState(!1),[o,l]=se.useState([]),[c,u]=se.useState(()=>{try{return JSON.parse(localStorage.getItem("global_search_recent")||"[]")}catch{return[]}}),d=se.useRef(null),m=Of(),g=()=>{u([]);try{localStorage.removeItem("global_search_recent")}catch{}};se.useEffect(()=>{const p=y=>{(y.ctrlKey||y.metaKey)&&y.key.toLowerCase()==="k"&&(y.preventDefault(),t(_=>!_)),y.key==="Escape"&&t(!1)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]),se.useEffect(()=>{e&&setTimeout(()=>{var p;return(p=d.current)==null?void 0:p.focus()},0)},[e]);const h=se.useMemo(()=>Mw(async p=>{if(!p||p.trim().length<2){l([]),s(!1);return}s(!0);try{const y=[{key:"product",url:"/products"},{key:"user",url:"/users"},{key:"order",url:"/orders"},{key:"payment",url:"/payments"},{key:"supplier",url:"/suppliers"},{key:"customer",url:"/customers"}],_={q:p,search:p},S=p.toLowerCase(),E=y.map(async({key:F,url:B})=>{var T;try{const P=await ut.get(B,{params:_});return(((T=P==null?void 0:P.data)==null?void 0:T.data)||(P==null?void 0:P.data)||P||[]).filter(A=>[A.pro_name,A.name,A.cus_name,A.supplier,A.email,String(A.id||"")].filter(Boolean).join(" ").toLowerCase().includes(S)).slice(0,5).map(A=>({key:F,item:A}))}catch{return[]}}),C=await Promise.all(E);l(C.flat())}finally{s(!1)}},300),[]);se.useEffect(()=>{s(r.length>=2),h(r)},[r,h]);const x=p=>{const y=jm[p.key];if(!y)return;const _=p.item[y.labelKey]??`#${p.item.id}`,E=[{q:r,key:p.key,label:_,ts:Date.now()},...c.filter(C=>C.label!==_)].slice(0,8);u(E),localStorage.setItem("global_search_recent",JSON.stringify(E)),t(!1),m(y.route)};return i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>t(!0),className:"hidden md:flex items-center px-3 py-1.5 text-sm bg-white/10 hover:bg-white/20 rounded-md border border-white/20",title:"Global search (Ctrl+K)",children:[i.jsx(es,{className:"w-4 h-4 mr-2"}),i.jsx("span",{children:"Search..."}),i.jsx("span",{className:"ml-2 text-xs opacity-70",children:"Ctrl+K"})]}),e&&i.jsx("div",{className:"fixed inset-0 z-50 bg-black/40",onClick:()=>t(!1),children:i.jsx("div",{className:"mx-auto mt-20 max-w-2xl",onClick:p=>p.stopPropagation(),children:i.jsxs("div",{className:"bg-white text-black rounded-lg shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"flex items-center px-4 py-3 border-b",children:[i.jsx(es,{className:"w-4 h-4 text-black mr-2"}),i.jsx("input",{ref:d,value:r,onChange:p=>a(p.target.value),placeholder:"Search products, users, orders...",className:"w-full outline-none text-sm text-black"}),r&&!n&&i.jsx("button",{onClick:()=>{a(""),l([]),s(!1)},"aria-label":"Clear search",className:"ml-2 p-1 rounded hover:bg-gray-100",children:i.jsx(zr,{className:"w-4 h-4 text-gray-400"})}),n&&i.jsx(Y2,{className:"w-4 h-4 animate-spin text-gray-400 ml-2"})]}),i.jsxs("div",{className:"max-h-80 overflow-auto",children:[r.length<2&&c.length>0&&i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs text-gray-500",children:[i.jsx("div",{children:"Recent"}),i.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 rounded hover:bg-gray-100 text-gray-500",onClick:g,title:"Clear recent",children:[i.jsx(zr,{className:"w-3 h-3"}),i.jsx("span",{children:"Clear"})]})]}),r.length<2&&c.map((p,y)=>i.jsx("div",{className:"px-4 py-2 text-sm hover:bg-gray-50 cursor-pointer",onClick:()=>a(p.label),children:p.label},y)),r.length>=2&&o.length===0&&!n&&i.jsx("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:"No results"}),o.map((p,y)=>{var B,T;const _=jm[p.key],S=(_==null?void 0:_.icon)||es,E=(B=p.item)==null?void 0:B[_==null?void 0:_.labelKey],C=E&&String(E).trim()||p.item.name||p.item.pro_name||p.item.cus_name||p.item.supplier||(p.item.id?`#${p.item.id}`:"Unknown"),F=p.key==="user"?p.item.email:p.key==="product"?p.item.barcode||((T=p.item.category)==null?void 0:T.name):p.key==="order"?`Total: ${p.item.total??""}`:p.key==="payment"?`Deposit: ${p.item.deposit??""}`:p.key==="customer"?p.item.cus_contact||"":p.key==="supplier"&&p.item.sup_con||"";return i.jsxs("div",{className:"px-4 py-2 text-sm hover:bg-gray-50 cursor-pointer flex items-center",onClick:()=>x(p),children:[i.jsx(S,{className:"w-4 h-4 text-gray-400 mr-2"}),i.jsxs("span",{className:"truncate text-black",children:[C,F?i.jsx("span",{className:"ml-2 text-xs text-gray-400",children:F}):null]}),i.jsx("span",{className:"ml-auto text-xs text-gray-400 capitalize",children:p.key})]},y)})]})]})})})]})}const Uw=({onMenuClick:e,toggleSidebar:t})=>{var c,u,d;const{user:r,logout:a}=ha();Of();const[n,s]=se.useState(!1),[o,l]=se.useState(0);return se.useEffect(()=>{const m=async()=>{var h;try{const x=await ut.get("/products"),y=(Array.isArray((h=x==null?void 0:x.data)==null?void 0:h.data)?x.data.data:Array.isArray(x==null?void 0:x.data)?x.data:Array.isArray(x)?x:[]).filter(_=>{const S=parseInt(_.qty||0),E=parseInt(_.reorder_point||10);return S<=E});l(y.length)}catch(x){console.error("Low stock fetch error:",x),l(0)}};m();const g=setInterval(m,6e4);return()=>clearInterval(g)},[]),i.jsx("header",{className:"bg-gradient-to-r from-primary-600 to-primary-500 shadow-lg border-b text-white border-primary-500 sticky top-0 z-40 backdrop-blur-sm",children:i.jsxs("div",{className:"flex items-center justify-between px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:[i.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[i.jsx("button",{onClick:e||t,className:"text-white hover:text-gray-700 lg:hidden mr-2 p-1",children:i.jsx(K2,{className:"w-6 h-6"})}),i.jsxs("h1",{className:"text-sm sm:text-lg md:text-xl font-semibold text-white truncate",children:[i.jsx("span",{className:"hidden sm:inline",children:"Inventory Management System"}),i.jsx("span",{className:"sm:hidden",children:"IMS"})]})]}),i.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[i.jsx(Bw,{}),i.jsxs(hc,{to:"/notifications",className:"text-white hover:text-red-500 relative p-1 transition-colors",title:`${o} low stock items`,children:[i.jsx(Rf,{className:"w-5 h-5 sm:w-6 sm:h-6"}),o>0&&i.jsx("span",{className:`absolute -top-1 -right-1 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center ${o>10?"bg-red-600":o>5?"bg-orange-500":"bg-yellow-500"}`,children:o>99?"99+":o})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>s(!n),className:"flex items-center space-x-1 sm:space-x-2 text-white hover:text-gray-900 p-1",children:[i.jsxs("div",{className:"w-8 h-8 rounded-full overflow-hidden border-2 border-gray-200",children:[r!=null&&r.photo_url||(c=r==null?void 0:r.profile)!=null&&c.image_url?i.jsx("img",{src:(r==null?void 0:r.photo_url)||((u=r==null?void 0:r.profile)==null?void 0:u.image_url),alt:r==null?void 0:r.name,className:"w-full h-full object-cover",onError:m=>{m.target.style.display="none",m.target.nextSibling.style.display="flex"}}):null,i.jsx("div",{className:`w-full h-full bg-primary-600 flex items-center justify-center ${r!=null&&r.photo_url||(d=r==null?void 0:r.profile)!=null&&d.image_url?"hidden":""}`,children:i.jsx(fi,{className:"w-4 h-4 text-white"})})]}),i.jsx("span",{className:"hidden sm:block font-medium text-sm md:text-base truncate max-w-24 md:max-w-none",children:r==null?void 0:r.name})]}),n&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border",children:[i.jsxs(hc,{to:"/profile",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>s(!1),children:[i.jsx(Jp,{className:"w-4 h-4 mr-2"}),"Profile"]}),i.jsxs("button",{onClick:()=>{a(),s(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[i.jsx(J2,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})]})]})})},qw=({isOnline:e,children:t})=>{const[r,a]=se.useState(!1);return i.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[i.jsx(Rw,{isOpen:r,onClose:()=>a(!1)}),i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[i.jsx(Uw,{isOnline:e,toggleSidebar:()=>a(!0)}),i.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gradient-to-br from-gray-50 to-gray-100 p-2 sm:p-4 md:p-6",children:i.jsx(q2,{})})]})]})};var Ec=e=>e.type==="checkbox",Ui=e=>e instanceof Date,nn=e=>e==null;const O1=e=>typeof e=="object";var Qr=e=>!nn(e)&&!Array.isArray(e)&&O1(e)&&!Ui(e),Ww=e=>Qr(e)&&e.target?Ec(e.target)?e.target.checked:e.target.value:e,Hw=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,$w=(e,t)=>e.has(Hw(t)),zw=e=>{const t=e.constructor&&e.constructor.prototype;return Qr(t)&&t.hasOwnProperty("isPrototypeOf")},zf=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ca(e){let t;const r=Array.isArray(e),a=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(zf&&(e instanceof Blob||a))&&(r||Qr(e)))if(t=r?[]:Object.create(Object.getPrototypeOf(e)),!r&&!zw(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=ca(e[n]));else return e;return t}var T0=e=>/^\w*$/.test(e),qr=e=>e===void 0,Vf=e=>Array.isArray(e)?e.filter(Boolean):[],Gf=e=>Vf(e.replace(/["|']|\]/g,"").split(/\.|\[/)),At=(e,t,r)=>{if(!t||!Qr(e))return r;const a=(T0(t)?[t]:Gf(t)).reduce((n,s)=>nn(n)?n:n[s],e);return qr(a)||a===e?qr(e[t])?r:e[t]:a},ms=e=>typeof e=="boolean",jr=(e,t,r)=>{let a=-1;const n=T0(t)?[t]:Gf(t),s=n.length,o=s-1;for(;++a<s;){const l=n[a];let c=r;if(a!==o){const u=e[l];c=Qr(u)||Array.isArray(u)?u:isNaN(+n[a+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;e[l]=c,e=e[l]}};const Em={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Kn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ps={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Vw=$a.createContext(null);Vw.displayName="HookFormContext";var Gw=(e,t,r,a=!0)=>{const n={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(n,s,{get:()=>{const o=s;return t._proxyFormState[o]!==Kn.all&&(t._proxyFormState[o]=!a||Kn.all),r&&(r[o]=!0),e[o]}});return n};const Yw=typeof window<"u"?$a.useLayoutEffect:$a.useEffect;var _n=e=>typeof e=="string",Xw=(e,t,r,a,n)=>_n(e)?(a&&t.watch.add(e),At(r,e,n)):Array.isArray(e)?e.map(s=>(a&&t.watch.add(s),At(r,s))):(a&&(t.watchAll=!0),r),mf=e=>nn(e)||!O1(e);function si(e,t,r=new WeakSet){if(mf(e)||mf(t))return e===t;if(Ui(e)&&Ui(t))return e.getTime()===t.getTime();const a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const s of a){const o=e[s];if(!n.includes(s))return!1;if(s!=="ref"){const l=t[s];if(Ui(o)&&Ui(l)||Qr(o)&&Qr(l)||Array.isArray(o)&&Array.isArray(l)?!si(o,l,r):o!==l)return!1}}return!0}var Kw=(e,t,r,a,n)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[a]:n||!0}}:{},ec=e=>Array.isArray(e)?e:[e],Tm=()=>{let e=[];return{get observers(){return e},next:n=>{for(const s of e)s.next&&s.next(n)},subscribe:n=>(e.push(n),{unsubscribe:()=>{e=e.filter(s=>s!==n)}}),unsubscribe:()=>{e=[]}}};function I1(e,t){const r={};for(const a in e)if(e.hasOwnProperty(a)){const n=e[a],s=t[a];if(n&&Qr(n)&&s){const o=I1(n,s);Qr(o)&&(r[a]=o)}else e[a]&&(r[a]=s)}return r}var an=e=>Qr(e)&&!Object.keys(e).length,Yf=e=>e.type==="file",Jn=e=>typeof e=="function",Qu=e=>{if(!zf)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},R1=e=>e.type==="select-multiple",Xf=e=>e.type==="radio",Jw=e=>Xf(e)||Ec(e),Id=e=>Qu(e)&&e.isConnected;function Qw(e,t){const r=t.slice(0,-1).length;let a=0;for(;a<r;)e=qr(e)?a++:e[t[a++]];return e}function Zw(e){for(const t in e)if(e.hasOwnProperty(t)&&!qr(e[t]))return!1;return!0}function Jr(e,t){const r=Array.isArray(t)?t:T0(t)?[t]:Gf(t),a=r.length===1?e:Qw(e,r),n=r.length-1,s=r[n];return a&&delete a[s],n!==0&&(Qr(a)&&an(a)||Array.isArray(a)&&Zw(a))&&Jr(e,r.slice(0,-1)),e}var eb=e=>{for(const t in e)if(Jn(e[t]))return!0;return!1};function M1(e){return Array.isArray(e)||Qr(e)&&!eb(e)}function pf(e,t={}){for(const r in e)M1(e[r])?(t[r]=Array.isArray(e[r])?[]:{},pf(e[r],t[r])):qr(e[r])||(t[r]=!0);return t}function qo(e,t,r){r||(r=pf(t));for(const a in e)M1(e[a])?qr(t)||mf(r[a])?r[a]=pf(e[a],Array.isArray(e[a])?[]:{}):qo(e[a],nn(t)?{}:t[a],r[a]):r[a]=!si(e[a],t[a]);return r}const Cm={value:!1,isValid:!1},Pm={value:!0,isValid:!0};var B1=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!qr(e[0].attributes.value)?qr(e[0].value)||e[0].value===""?Pm:{value:e[0].value,isValid:!0}:Pm:Cm}return Cm},U1=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:a})=>qr(e)?e:t?e===""?NaN:e&&+e:r&&_n(e)?new Date(e):a?a(e):e;const Lm={isValid:!1,value:null};var q1=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,Lm):Lm;function Fm(e){const t=e.ref;return Yf(t)?t.files:Xf(t)?q1(e.refs).value:R1(t)?[...t.selectedOptions].map(({value:r})=>r):Ec(t)?B1(e.refs).value:U1(qr(t.value)?e.ref.value:t.value,e)}var tb=(e,t,r,a)=>{const n={};for(const s of e){const o=At(t,s);o&&jr(n,s,o._f)}return{criteriaMode:r,names:[...e],fields:n,shouldUseNativeValidation:a}},Zu=e=>e instanceof RegExp,$l=e=>qr(e)?e:Zu(e)?e.source:Qr(e)?Zu(e.value)?e.value.source:e.value:e,km=e=>({isOnSubmit:!e||e===Kn.onSubmit,isOnBlur:e===Kn.onBlur,isOnChange:e===Kn.onChange,isOnAll:e===Kn.all,isOnTouch:e===Kn.onTouched});const Dm="AsyncFunction";var rb=e=>!!e&&!!e.validate&&!!(Jn(e.validate)&&e.validate.constructor.name===Dm||Qr(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===Dm)),ab=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),Om=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(a=>e.startsWith(a)&&/^\.\w+/.test(e.slice(a.length))));const tc=(e,t,r,a)=>{for(const n of r||Object.keys(e)){const s=At(e,n);if(s){const{_f:o,...l}=s;if(o){if(o.refs&&o.refs[0]&&t(o.refs[0],n)&&!a)return!0;if(o.ref&&t(o.ref,o.name)&&!a)return!0;if(tc(l,t))break}else if(Qr(l)&&tc(l,t))break}}};function Im(e,t,r){const a=At(e,r);if(a||T0(r))return{error:a,name:r};const n=r.split(".");for(;n.length;){const s=n.join("."),o=At(t,s),l=At(e,s);if(o&&!Array.isArray(o)&&r!==s)return{name:r};if(l&&l.type)return{name:s,error:l};if(l&&l.root&&l.root.type)return{name:`${s}.root`,error:l.root};n.pop()}return{name:r}}var nb=(e,t,r,a)=>{r(e);const{name:n,...s}=e;return an(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(o=>t[o]===(!a||Kn.all))},sb=(e,t,r)=>!e||!t||e===t||ec(e).some(a=>a&&(r?a===t:a.startsWith(t)||t.startsWith(a))),ib=(e,t,r,a,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(t||e):(r?a.isOnBlur:n.isOnBlur)?!e:(r?a.isOnChange:n.isOnChange)?e:!0,ob=(e,t)=>!Vf(At(e,t)).length&&Jr(e,t),lb=(e,t,r)=>{const a=ec(At(e,r));return jr(a,"root",t[r]),jr(e,r,a),e};function Rm(e,t,r="validate"){if(_n(e)||Array.isArray(e)&&e.every(_n)||ms(e)&&!e)return{type:r,message:_n(e)?e:"",ref:t}}var Fo=e=>Qr(e)&&!Zu(e)?e:{value:e,message:""},Mm=async(e,t,r,a,n,s)=>{const{ref:o,refs:l,required:c,maxLength:u,minLength:d,min:m,max:g,pattern:h,validate:x,name:p,valueAsNumber:y,mount:_}=e._f,S=At(r,p);if(!_||t.has(p))return{};const E=l?l[0]:o,C=b=>{n&&E.reportValidity&&(E.setCustomValidity(ms(b)?"":b||""),E.reportValidity())},F={},B=Xf(o),T=Ec(o),P=B||T,k=(y||Yf(o))&&qr(o.value)&&qr(S)||Qu(o)&&o.value===""||S===""||Array.isArray(S)&&!S.length,I=Kw.bind(null,p,a,F),A=(b,R,W,Y=Ps.maxLength,q=Ps.minLength)=>{const U=b?R:W;F[p]={type:b?Y:q,message:U,ref:o,...I(b?Y:q,U)}};if(s?!Array.isArray(S)||!S.length:c&&(!P&&(k||nn(S))||ms(S)&&!S||T&&!B1(l).isValid||B&&!q1(l).isValid)){const{value:b,message:R}=_n(c)?{value:!!c,message:c}:Fo(c);if(b&&(F[p]={type:Ps.required,message:R,ref:E,...I(Ps.required,R)},!a))return C(R),F}if(!k&&(!nn(m)||!nn(g))){let b,R;const W=Fo(g),Y=Fo(m);if(!nn(S)&&!isNaN(S)){const q=o.valueAsNumber||S&&+S;nn(W.value)||(b=q>W.value),nn(Y.value)||(R=q<Y.value)}else{const q=o.valueAsDate||new Date(S),U=ne=>new Date(new Date().toDateString()+" "+ne),H=o.type=="time",Q=o.type=="week";_n(W.value)&&S&&(b=H?U(S)>U(W.value):Q?S>W.value:q>new Date(W.value)),_n(Y.value)&&S&&(R=H?U(S)<U(Y.value):Q?S<Y.value:q<new Date(Y.value))}if((b||R)&&(A(!!b,W.message,Y.message,Ps.max,Ps.min),!a))return C(F[p].message),F}if((u||d)&&!k&&(_n(S)||s&&Array.isArray(S))){const b=Fo(u),R=Fo(d),W=!nn(b.value)&&S.length>+b.value,Y=!nn(R.value)&&S.length<+R.value;if((W||Y)&&(A(W,b.message,R.message),!a))return C(F[p].message),F}if(h&&!k&&_n(S)){const{value:b,message:R}=Fo(h);if(Zu(b)&&!S.match(b)&&(F[p]={type:Ps.pattern,message:R,ref:o,...I(Ps.pattern,R)},!a))return C(R),F}if(x){if(Jn(x)){const b=await x(S,r),R=Rm(b,E);if(R&&(F[p]={...R,...I(Ps.validate,R.message)},!a))return C(R.message),F}else if(Qr(x)){let b={};for(const R in x){if(!an(b)&&!a)break;const W=Rm(await x[R](S,r),E,R);W&&(b={...W,...I(R,W.message)},C(W.message),a&&(F[p]=b))}if(!an(b)&&(F[p]={ref:E,...b},!a))return F}}return C(!0),F};const cb={mode:Kn.onSubmit,reValidateMode:Kn.onChange,shouldFocusError:!0};function ub(e={}){let t={...cb,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Jn(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},a={},n=Qr(t.defaultValues)||Qr(t.values)?ca(t.defaultValues||t.values)||{}:{},s=t.shouldUnregister?{}:ca(n),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let m={...d};const g={array:Tm(),state:Tm()},h=t.criteriaMode===Kn.all,x=ie=>ge=>{clearTimeout(u),u=setTimeout(ie,ge)},p=async ie=>{if(!t.disabled&&(d.isValid||m.isValid||ie)){const ge=t.resolver?an((await T()).errors):await k(a,!0);ge!==r.isValid&&g.state.next({isValid:ge})}},y=(ie,ge)=>{!t.disabled&&(d.isValidating||d.validatingFields||m.isValidating||m.validatingFields)&&((ie||Array.from(l.mount)).forEach(ye=>{ye&&(ge?jr(r.validatingFields,ye,ge):Jr(r.validatingFields,ye))}),g.state.next({validatingFields:r.validatingFields,isValidating:!an(r.validatingFields)}))},_=(ie,ge=[],ye,qe,De=!0,Re=!0)=>{if(qe&&ye&&!t.disabled){if(o.action=!0,Re&&Array.isArray(At(a,ie))){const Je=ye(At(a,ie),qe.argA,qe.argB);De&&jr(a,ie,Je)}if(Re&&Array.isArray(At(r.errors,ie))){const Je=ye(At(r.errors,ie),qe.argA,qe.argB);De&&jr(r.errors,ie,Je),ob(r.errors,ie)}if((d.touchedFields||m.touchedFields)&&Re&&Array.isArray(At(r.touchedFields,ie))){const Je=ye(At(r.touchedFields,ie),qe.argA,qe.argB);De&&jr(r.touchedFields,ie,Je)}(d.dirtyFields||m.dirtyFields)&&(r.dirtyFields=qo(n,s)),g.state.next({name:ie,isDirty:A(ie,ge),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else jr(s,ie,ge)},S=(ie,ge)=>{jr(r.errors,ie,ge),g.state.next({errors:r.errors})},E=ie=>{r.errors=ie,g.state.next({errors:r.errors,isValid:!1})},C=(ie,ge,ye,qe)=>{const De=At(a,ie);if(De){const Re=At(s,ie,qr(ye)?At(n,ie):ye);qr(Re)||qe&&qe.defaultChecked||ge?jr(s,ie,ge?Re:Fm(De._f)):W(ie,Re),o.mount&&p()}},F=(ie,ge,ye,qe,De)=>{let Re=!1,Je=!1;const mt={name:ie};if(!t.disabled){if(!ye||qe){(d.isDirty||m.isDirty)&&(Je=r.isDirty,r.isDirty=mt.isDirty=A(),Re=Je!==mt.isDirty);const wt=si(At(n,ie),ge);Je=!!At(r.dirtyFields,ie),wt?Jr(r.dirtyFields,ie):jr(r.dirtyFields,ie,!0),mt.dirtyFields=r.dirtyFields,Re=Re||(d.dirtyFields||m.dirtyFields)&&Je!==!wt}if(ye){const wt=At(r.touchedFields,ie);wt||(jr(r.touchedFields,ie,ye),mt.touchedFields=r.touchedFields,Re=Re||(d.touchedFields||m.touchedFields)&&wt!==ye)}Re&&De&&g.state.next(mt)}return Re?mt:{}},B=(ie,ge,ye,qe)=>{const De=At(r.errors,ie),Re=(d.isValid||m.isValid)&&ms(ge)&&r.isValid!==ge;if(t.delayError&&ye?(c=x(()=>S(ie,ye)),c(t.delayError)):(clearTimeout(u),c=null,ye?jr(r.errors,ie,ye):Jr(r.errors,ie)),(ye?!si(De,ye):De)||!an(qe)||Re){const Je={...qe,...Re&&ms(ge)?{isValid:ge}:{},errors:r.errors,name:ie};r={...r,...Je},g.state.next(Je)}},T=async ie=>{y(ie,!0);const ge=await t.resolver(s,t.context,tb(ie||l.mount,a,t.criteriaMode,t.shouldUseNativeValidation));return y(ie),ge},P=async ie=>{const{errors:ge}=await T(ie);if(ie)for(const ye of ie){const qe=At(ge,ye);qe?jr(r.errors,ye,qe):Jr(r.errors,ye)}else r.errors=ge;return ge},k=async(ie,ge,ye={valid:!0})=>{for(const qe in ie){const De=ie[qe];if(De){const{_f:Re,...Je}=De;if(Re){const mt=l.array.has(Re.name),wt=De._f&&rb(De._f);wt&&d.validatingFields&&y([Re.name],!0);const bt=await Mm(De,l.disabled,s,h,t.shouldUseNativeValidation&&!ge,mt);if(wt&&d.validatingFields&&y([Re.name]),bt[Re.name]&&(ye.valid=!1,ge))break;!ge&&(At(bt,Re.name)?mt?lb(r.errors,bt,Re.name):jr(r.errors,Re.name,bt[Re.name]):Jr(r.errors,Re.name))}!an(Je)&&await k(Je,ge,ye)}}return ye.valid},I=()=>{for(const ie of l.unMount){const ge=At(a,ie);ge&&(ge._f.refs?ge._f.refs.every(ye=>!Id(ye)):!Id(ge._f.ref))&&ue(ie)}l.unMount=new Set},A=(ie,ge)=>!t.disabled&&(ie&&ge&&jr(s,ie,ge),!si(ne(),n)),b=(ie,ge,ye)=>Xw(ie,l,{...o.mount?s:qr(ge)?n:_n(ie)?{[ie]:ge}:ge},ye,ge),R=ie=>Vf(At(o.mount?s:n,ie,t.shouldUnregister?At(n,ie,[]):[])),W=(ie,ge,ye={})=>{const qe=At(a,ie);let De=ge;if(qe){const Re=qe._f;Re&&(!Re.disabled&&jr(s,ie,U1(ge,Re)),De=Qu(Re.ref)&&nn(ge)?"":ge,R1(Re.ref)?[...Re.ref.options].forEach(Je=>Je.selected=De.includes(Je.value)):Re.refs?Ec(Re.ref)?Re.refs.forEach(Je=>{(!Je.defaultChecked||!Je.disabled)&&(Array.isArray(De)?Je.checked=!!De.find(mt=>mt===Je.value):Je.checked=De===Je.value||!!De)}):Re.refs.forEach(Je=>Je.checked=Je.value===De):Yf(Re.ref)?Re.ref.value="":(Re.ref.value=De,Re.ref.type||g.state.next({name:ie,values:ca(s)})))}(ye.shouldDirty||ye.shouldTouch)&&F(ie,De,ye.shouldTouch,ye.shouldDirty,!0),ye.shouldValidate&&Q(ie)},Y=(ie,ge,ye)=>{for(const qe in ge){if(!ge.hasOwnProperty(qe))return;const De=ge[qe],Re=ie+"."+qe,Je=At(a,Re);(l.array.has(ie)||Qr(De)||Je&&!Je._f)&&!Ui(De)?Y(Re,De,ye):W(Re,De,ye)}},q=(ie,ge,ye={})=>{const qe=At(a,ie),De=l.array.has(ie),Re=ca(ge);jr(s,ie,Re),De?(g.array.next({name:ie,values:ca(s)}),(d.isDirty||d.dirtyFields||m.isDirty||m.dirtyFields)&&ye.shouldDirty&&g.state.next({name:ie,dirtyFields:qo(n,s),isDirty:A(ie,Re)})):qe&&!qe._f&&!nn(Re)?Y(ie,Re,ye):W(ie,Re,ye),Om(ie,l)&&g.state.next({...r,name:ie}),g.state.next({name:o.mount?ie:void 0,values:ca(s)})},U=async ie=>{o.mount=!0;const ge=ie.target;let ye=ge.name,qe=!0;const De=At(a,ye),Re=wt=>{qe=Number.isNaN(wt)||Ui(wt)&&isNaN(wt.getTime())||si(wt,At(s,ye,wt))},Je=km(t.mode),mt=km(t.reValidateMode);if(De){let wt,bt;const kt=ge.type?Fm(De._f):Ww(ie),ot=ie.type===Em.BLUR||ie.type===Em.FOCUS_OUT,Ar=!ab(De._f)&&!t.resolver&&!At(r.errors,ye)&&!De._f.deps||ib(ot,At(r.touchedFields,ye),r.isSubmitted,mt,Je),Ut=Om(ye,l,ot);jr(s,ye,kt),ot?(!ge||!ge.readOnly)&&(De._f.onBlur&&De._f.onBlur(ie),c&&c(0)):De._f.onChange&&De._f.onChange(ie);const Rr=F(ye,kt,ot),zt=!an(Rr)||Ut;if(!ot&&g.state.next({name:ye,type:ie.type,values:ca(s)}),Ar)return(d.isValid||m.isValid)&&(t.mode==="onBlur"?ot&&p():ot||p()),zt&&g.state.next({name:ye,...Ut?{}:Rr});if(!ot&&Ut&&g.state.next({...r}),t.resolver){const{errors:Yt}=await T([ye]);if(Re(kt),qe){const Vr=Im(r.errors,a,ye),Ot=Im(Yt,a,Vr.name||ye);wt=Ot.error,ye=Ot.name,bt=an(Yt)}}else y([ye],!0),wt=(await Mm(De,l.disabled,s,h,t.shouldUseNativeValidation))[ye],y([ye]),Re(kt),qe&&(wt?bt=!1:(d.isValid||m.isValid)&&(bt=await k(a,!0)));qe&&(De._f.deps&&(!Array.isArray(De._f.deps)||De._f.deps.length>0)&&Q(De._f.deps),B(ye,bt,wt,Rr))}},H=(ie,ge)=>{if(At(r.errors,ge)&&ie.focus)return ie.focus(),1},Q=async(ie,ge={})=>{let ye,qe;const De=ec(ie);if(t.resolver){const Re=await P(qr(ie)?ie:De);ye=an(Re),qe=ie?!De.some(Je=>At(Re,Je)):ye}else ie?(qe=(await Promise.all(De.map(async Re=>{const Je=At(a,Re);return await k(Je&&Je._f?{[Re]:Je}:Je)}))).every(Boolean),!(!qe&&!r.isValid)&&p()):qe=ye=await k(a);return g.state.next({...!_n(ie)||(d.isValid||m.isValid)&&ye!==r.isValid?{}:{name:ie},...t.resolver||!ie?{isValid:ye}:{},errors:r.errors}),ge.shouldFocus&&!qe&&tc(a,H,ie?De:l.mount),qe},ne=(ie,ge)=>{let ye={...o.mount?s:n};return ge&&(ye=I1(ge.dirtyFields?r.dirtyFields:r.touchedFields,ye)),qr(ie)?ye:_n(ie)?At(ye,ie):ie.map(qe=>At(ye,qe))},ee=(ie,ge)=>({invalid:!!At((ge||r).errors,ie),isDirty:!!At((ge||r).dirtyFields,ie),error:At((ge||r).errors,ie),isValidating:!!At(r.validatingFields,ie),isTouched:!!At((ge||r).touchedFields,ie)}),N=ie=>{ie&&ec(ie).forEach(ge=>Jr(r.errors,ge)),g.state.next({errors:ie?r.errors:{}})},L=(ie,ge,ye)=>{const qe=(At(a,ie,{_f:{}})._f||{}).ref,De=At(r.errors,ie)||{},{ref:Re,message:Je,type:mt,...wt}=De;jr(r.errors,ie,{...wt,...ge,ref:qe}),g.state.next({name:ie,errors:r.errors,isValid:!1}),ye&&ye.shouldFocus&&qe&&qe.focus&&qe.focus()},D=(ie,ge)=>Jn(ie)?g.state.subscribe({next:ye=>"values"in ye&&ie(b(void 0,ge),ye)}):b(ie,ge,!0),M=ie=>g.state.subscribe({next:ge=>{sb(ie.name,ge.name,ie.exact)&&nb(ge,ie.formState||d,Xe,ie.reRenderRoot)&&ie.callback({values:{...s},...r,...ge,defaultValues:n})}}).unsubscribe,z=ie=>(o.mount=!0,m={...m,...ie.formState},M({...ie,formState:m})),ue=(ie,ge={})=>{for(const ye of ie?ec(ie):l.mount)l.mount.delete(ye),l.array.delete(ye),ge.keepValue||(Jr(a,ye),Jr(s,ye)),!ge.keepError&&Jr(r.errors,ye),!ge.keepDirty&&Jr(r.dirtyFields,ye),!ge.keepTouched&&Jr(r.touchedFields,ye),!ge.keepIsValidating&&Jr(r.validatingFields,ye),!t.shouldUnregister&&!ge.keepDefaultValue&&Jr(n,ye);g.state.next({values:ca(s)}),g.state.next({...r,...ge.keepDirty?{isDirty:A()}:{}}),!ge.keepIsValid&&p()},pe=({disabled:ie,name:ge})=>{(ms(ie)&&o.mount||ie||l.disabled.has(ge))&&(ie?l.disabled.add(ge):l.disabled.delete(ge))},me=(ie,ge={})=>{let ye=At(a,ie);const qe=ms(ge.disabled)||ms(t.disabled);return jr(a,ie,{...ye||{},_f:{...ye&&ye._f?ye._f:{ref:{name:ie}},name:ie,mount:!0,...ge}}),l.mount.add(ie),ye?pe({disabled:ms(ge.disabled)?ge.disabled:t.disabled,name:ie}):C(ie,!0,ge.value),{...qe?{disabled:ge.disabled||t.disabled}:{},...t.progressive?{required:!!ge.required,min:$l(ge.min),max:$l(ge.max),minLength:$l(ge.minLength),maxLength:$l(ge.maxLength),pattern:$l(ge.pattern)}:{},name:ie,onChange:U,onBlur:U,ref:De=>{if(De){me(ie,ge),ye=At(a,ie);const Re=qr(De.value)&&De.querySelectorAll&&De.querySelectorAll("input,select,textarea")[0]||De,Je=Jw(Re),mt=ye._f.refs||[];if(Je?mt.find(wt=>wt===Re):Re===ye._f.ref)return;jr(a,ie,{_f:{...ye._f,...Je?{refs:[...mt.filter(Id),Re,...Array.isArray(At(n,ie))?[{}]:[]],ref:{type:Re.type,name:ie}}:{ref:Re}}}),C(ie,!1,void 0,Re)}else ye=At(a,ie,{}),ye._f&&(ye._f.mount=!1),(t.shouldUnregister||ge.shouldUnregister)&&!($w(l.array,ie)&&o.action)&&l.unMount.add(ie)}}},Ne=()=>t.shouldFocusError&&tc(a,H,l.mount),Oe=ie=>{ms(ie)&&(g.state.next({disabled:ie}),tc(a,(ge,ye)=>{const qe=At(a,ye);qe&&(ge.disabled=qe._f.disabled||ie,Array.isArray(qe._f.refs)&&qe._f.refs.forEach(De=>{De.disabled=qe._f.disabled||ie}))},0,!1))},Ie=(ie,ge)=>async ye=>{let qe;ye&&(ye.preventDefault&&ye.preventDefault(),ye.persist&&ye.persist());let De=ca(s);if(g.state.next({isSubmitting:!0}),t.resolver){const{errors:Re,values:Je}=await T();r.errors=Re,De=ca(Je)}else await k(a);if(l.disabled.size)for(const Re of l.disabled)Jr(De,Re);if(Jr(r.errors,"root"),an(r.errors)){g.state.next({errors:{}});try{await ie(De,ye)}catch(Re){qe=Re}}else ge&&await ge({...r.errors},ye),Ne(),setTimeout(Ne);if(g.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:an(r.errors)&&!qe,submitCount:r.submitCount+1,errors:r.errors}),qe)throw qe},Ze=(ie,ge={})=>{At(a,ie)&&(qr(ge.defaultValue)?q(ie,ca(At(n,ie))):(q(ie,ge.defaultValue),jr(n,ie,ca(ge.defaultValue))),ge.keepTouched||Jr(r.touchedFields,ie),ge.keepDirty||(Jr(r.dirtyFields,ie),r.isDirty=ge.defaultValue?A(ie,ca(At(n,ie))):A()),ge.keepError||(Jr(r.errors,ie),d.isValid&&p()),g.state.next({...r}))},st=(ie,ge={})=>{const ye=ie?ca(ie):n,qe=ca(ye),De=an(ie),Re=De?n:qe;if(ge.keepDefaultValues||(n=ye),!ge.keepValues){if(ge.keepDirtyValues){const Je=new Set([...l.mount,...Object.keys(qo(n,s))]);for(const mt of Array.from(Je))At(r.dirtyFields,mt)?jr(Re,mt,At(s,mt)):q(mt,At(Re,mt))}else{if(zf&&qr(ie))for(const Je of l.mount){const mt=At(a,Je);if(mt&&mt._f){const wt=Array.isArray(mt._f.refs)?mt._f.refs[0]:mt._f.ref;if(Qu(wt)){const bt=wt.closest("form");if(bt){bt.reset();break}}}}if(ge.keepFieldsRef)for(const Je of l.mount)q(Je,At(Re,Je));else a={}}s=t.shouldUnregister?ge.keepDefaultValues?ca(n):{}:ca(Re),g.array.next({values:{...Re}}),g.state.next({values:{...Re}})}l={mount:ge.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!ge.keepIsValid||!!ge.keepDirtyValues,o.watch=!!t.shouldUnregister,g.state.next({submitCount:ge.keepSubmitCount?r.submitCount:0,isDirty:De?!1:ge.keepDirty?r.isDirty:!!(ge.keepDefaultValues&&!si(ie,n)),isSubmitted:ge.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:De?{}:ge.keepDirtyValues?ge.keepDefaultValues&&s?qo(n,s):r.dirtyFields:ge.keepDefaultValues&&ie?qo(n,ie):ge.keepDirty?r.dirtyFields:{},touchedFields:ge.keepTouched?r.touchedFields:{},errors:ge.keepErrors?r.errors:{},isSubmitSuccessful:ge.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},Fe=(ie,ge)=>st(Jn(ie)?ie(s):ie,ge),le=(ie,ge={})=>{const ye=At(a,ie),qe=ye&&ye._f;if(qe){const De=qe.refs?qe.refs[0]:qe.ref;De.focus&&(De.focus(),ge.shouldSelect&&Jn(De.select)&&De.select())}},Xe=ie=>{r={...r,...ie}},$e={control:{register:me,unregister:ue,getFieldState:ee,handleSubmit:Ie,setError:L,_subscribe:M,_runSchema:T,_focusError:Ne,_getWatch:b,_getDirty:A,_setValid:p,_setFieldArray:_,_setDisabledField:pe,_setErrors:E,_getFieldArray:R,_reset:st,_resetDefaultValues:()=>Jn(t.defaultValues)&&t.defaultValues().then(ie=>{Fe(ie,t.resetOptions),g.state.next({isLoading:!1})}),_removeUnmounted:I,_disableForm:Oe,_subjects:g,_proxyFormState:d,get _fields(){return a},get _formValues(){return s},get _state(){return o},set _state(ie){o=ie},get _defaultValues(){return n},get _names(){return l},set _names(ie){l=ie},get _formState(){return r},get _options(){return t},set _options(ie){t={...t,...ie}}},subscribe:z,trigger:Q,register:me,handleSubmit:Ie,watch:D,setValue:q,getValues:ne,reset:Fe,resetField:Ze,clearErrors:N,unregister:ue,setError:L,setFocus:le,getFieldState:ee};return{...$e,formControl:$e}}function Xa(e={}){const t=$a.useRef(void 0),r=$a.useRef(void 0),[a,n]=$a.useState({isDirty:!1,isValidating:!1,isLoading:Jn(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Jn(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:a},e.defaultValues&&!Jn(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:o,...l}=ub(e);t.current={...l,formState:a}}const s=t.current.control;return s._options=e,Yw(()=>{const o=s._subscribe({formState:s._proxyFormState,callback:()=>n({...s._formState}),reRenderRoot:!0});return n(l=>({...l,isReady:!0})),s._formState.isReady=!0,o},[s]),$a.useEffect(()=>s._disableForm(e.disabled),[s,e.disabled]),$a.useEffect(()=>{e.mode&&(s._options.mode=e.mode),e.reValidateMode&&(s._options.reValidateMode=e.reValidateMode)},[s,e.mode,e.reValidateMode]),$a.useEffect(()=>{e.errors&&(s._setErrors(e.errors),s._focusError())},[s,e.errors]),$a.useEffect(()=>{e.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,e.shouldUnregister]),$a.useEffect(()=>{if(s._proxyFormState.isDirty){const o=s._getDirty();o!==a.isDirty&&s._subjects.state.next({isDirty:o})}},[s,a.isDirty]),$a.useEffect(()=>{e.values&&!si(e.values,r.current)?(s._reset(e.values,{keepFieldsRef:!0,...s._options.resetOptions}),r.current=e.values,n(o=>({...o}))):s._resetDefaultValues()},[s,e.values]),$a.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=Gw(a,s),t.current}const db=()=>{const[e,t]=se.useState("checking"),[r,a]=se.useState(null),[n,s]=se.useState(!1),o=async()=>{var d,m,g,h;s(!0),a(null);try{const x=await Xn.get("/system/health");x.status===200&&x.data?t("connected"):(t("error"),a("Unexpected response from server"))}catch(x){t("error"),x.code==="ERR_NETWORK"||x.message.includes("Network Error")?a("Cannot connect to Laravel API. Please ensure it's running on http://localhost:8000"):((d=x.response)==null?void 0:d.status)===404?a("Health endpoint not found. Please check Laravel API routes."):((m=x.response)==null?void 0:m.status)===500?a("Laravel server error. Check Laravel logs for details."):a(((h=(g=x.response)==null?void 0:g.data)==null?void 0:h.message)||x.message||"Unknown error occurred")}finally{s(!1)}};se.useEffect(()=>{o()},[]);const l=()=>{switch(e){case"connected":return i.jsx(y0,{className:"w-5 h-5 text-green-600"});case"error":return i.jsx(Q2,{className:"w-5 h-5 text-red-600"});default:return i.jsx(Qo,{className:"w-5 h-5 text-yellow-600"})}},c=()=>{switch(e){case"connected":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";default:return"bg-yellow-50 border-yellow-200"}},u=()=>{switch(e){case"connected":return"Backend Connected";case"error":return"Backend Connection Failed";default:return"Checking Backend..."}};return i.jsxs("div",{className:`p-4 rounded-lg border ${c()}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[l(),i.jsx("span",{className:"ml-2 font-medium text-gray-900",children:u()})]}),i.jsx("button",{onClick:o,disabled:n,className:"btn-secondary text-xs px-2 py-1",children:n?i.jsx(sn,{className:"w-3 h-3 animate-spin"}):i.jsx(sn,{className:"w-3 h-3"})})]}),r&&i.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[i.jsx("strong",{children:"Error:"})," ",r]}),e==="error"&&i.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:[i.jsx("strong",{children:"Quick Fix:"}),i.jsxs("ol",{className:"list-decimal list-inside mt-1 space-y-1",children:[i.jsxs("li",{children:["Ensure Laravel API is running: ",i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"php artisan serve"})]}),i.jsx("li",{children:"Check CORS configuration in Laravel"}),i.jsx("li",{children:"Verify API routes are properly defined"})]})]}),e==="connected"&&i.jsx("div",{className:"mt-2 text-sm text-green-700",children:" Backend is running and accessible. You can now use all features."})]})},e0="/assets/adminType-c4923907.png",W1="/assets/Data-Savvy-6-4d4495b2.jpg",fb=()=>{const{login:e,isAuthenticated:t,isLoading:r}=ha(),[a,n]=se.useState(!1),[s,o]=se.useState(!1),[l,c]=se.useState(""),{register:u,handleSubmit:d,formState:{errors:m}}=Xa();if(t)return i.jsx(v0,{to:"/dashboard",replace:!0});if(r)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-secondary-50",children:i.jsx(Er,{size:"lg"})});const g=async h=>{o(!0),c("");try{const x=await e(h);x.success||(c(x.message||"Login failed. Please try again."),o(!1))}catch(x){console.error("Login error:",x),c("An error occurred. Please try again."),o(!1)}};return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("div",{className:"hidden  lg:flex lg:w-1/2 bg-gradient-to-br from-primary-100 to-primary-800 relative overflow-hidden",children:[i.jsx("div",{className:" absolute min-h-screen flex  justify-center ",children:i.jsx("img",{className:"min-h-screen  m-auto items-center w-full object-cover",src:W1,alt:"IMS Background"})}),i.jsx("div",{className:"absolute  inset-0 bg-black bg-opacity-60"}),i.jsx("div",{className:"relative z-10 flex flex-col justify-center px-12 text-white",children:i.jsxs("div",{className:"mb-8",children:[i.jsx("div",{className:"w-64 m-auto bg-white bg-opacity-100 position-relative rounded-full items-center justify-center mb-6",children:i.jsx("img",{src:e0,alt:"Logo IMS"})}),i.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Inventory Management System"})]})})]}),i.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-8 bg-white",children:i.jsxs("div",{className:"max-w-md w-full space-y-6 sm:space-y-8",children:[i.jsxs("div",{className:"lg:hidden text-center",children:[i.jsx("div",{className:"mx-auto h-16 w-16  rounded-full flex items-center justify-center mb-4",children:i.jsx("img",{src:e0,alt:"logo"})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),i.jsx("p",{className:"text-gray-600",children:"Sign in to your account"})]}),i.jsxs("div",{className:"hidden lg:block",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Welcome Back"}),i.jsx("p",{className:"mt-2 text-gray-600",children:"Please sign in to your account"})]}),l&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center",children:[i.jsx(Qo,{className:"w-5 h-5 text-red-500 mr-3 flex-shrink-0"}),i.jsx("span",{className:"text-red-700 text-sm",children:l})]}),i.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:d(g),children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Zp,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...u("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"input pl-10",placeholder:"Enter your email"})]}),m.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.email.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx($u,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...u("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:a?"text":"password",className:"input pl-10 pr-10",placeholder:"Enter your password"}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!a),children:a?i.jsx(nf,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):i.jsx(cn,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),m.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.password.message})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),i.jsx("div",{className:"text-sm",children:i.jsx("a",{href:"#",className:"font-medium text-primary-600 hover:text-primary-500"})})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:s,className:"btn-primary w-full justify-center",children:s?i.jsxs(i.Fragment,{children:[i.jsx(Er,{size:"sm"}),i.jsx("span",{className:"ml-2",children:"Signing in..."})]}):"Sign in"})}),i.jsx("div",{className:"text-center",children:i.jsxs("span",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",i.jsx(hc,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"Sign up"})]})})]}),i.jsx("div",{className:"mt-6 sm:mt-8",children:i.jsx(db,{})})]})})]})},hb={login:e=>ut.post("/auth/login",e),register:e=>ut.post("/auth/register",e),logout:()=>ut.post("/auth/logout"),getProfile:()=>ut.get("/auth/profile"),updateProfile:(e,t)=>ut.put(`/auth/profile/${e}`,t),changePassword:e=>ut.post("/auth/change-password",e),uploadProfileImage:(e,t)=>ut.post(`/auth/profile/${e}/upload-image`,t,{headers:{"Content-Type":"multipart/form-data"}})},mb=()=>{const{isAuthenticated:e,isLoading:t}=ha(),[r,a]=se.useState(!1),[n,s]=se.useState(!1),[o,l]=se.useState(!1),[c,u]=se.useState(""),[d,m]=se.useState(!1),{register:g,handleSubmit:h,formState:{errors:x},watch:p}=Xa(),y=p("password");if(e)return i.jsx(v0,{to:"/dashboard",replace:!0});if(t)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-secondary-50",children:i.jsx(Er,{size:"lg"})});const _=async S=>{var E,C;l(!0),u("");try{(await hb.register(S)).data.success&&(m(!0),Ye.success("Account created successfully! Please login to continue."))}catch(F){const B=((C=(E=F.response)==null?void 0:E.data)==null?void 0:C.message)||"Registration failed. Please try again.";u(B),Ye.error(B)}finally{l(!1)}};return d?i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-secondary-50 p-4",children:i.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(y0,{className:"w-8 h-8 text-green-600"})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Account Created!"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Your account has been created successfully. You can now sign in with your credentials."}),i.jsx(hc,{to:"/login",className:"btn-primary w-full justify-center",children:"Go to Login"})]})}):i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("div",{className:"hidden  lg:flex lg:w-1/2 bg-gradient-to-br from-primary-100 to-primary-800 relative overflow-hidden",children:[i.jsx("div",{className:" absolute min-h-screen flex  justify-center ",children:i.jsx("img",{className:"min-h-screen fixed  m-auto items-center w-full object-cover",src:W1,alt:"IMS Background"})}),i.jsx("div",{className:"absolute  inset-0 bg-black bg-opacity-60"}),i.jsx("div",{className:"relative z-10 flex flex-col justify-center px-12 text-white",children:i.jsxs("div",{className:"mb-8",children:[i.jsx("div",{className:"w-64 m-auto fixed top-36 ml-40 bg-white bg-opacity-100 position-relative rounded-full items-center justify-center t-20",children:i.jsx("img",{src:e0,alt:"Logo IMS"})}),i.jsxs("p",{className:"text-xl fixed text-primary-100 leading-relaxed",children:["Create your account and start managing your inventory with ",i.jsx("br",{})," our powerful tools. Get access to comprehensive features designed ",i.jsx("br",{})," for modern businesses."]})]})})]}),i.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-8 bg-white",children:i.jsxs("div",{className:"max-w-md w-full space-y-6 sm:space-y-8",children:[i.jsxs("div",{className:"lg:hidden text-center",children:[i.jsx("div",{className:"mx-auto h-16 w-16 bg-primary-600 rounded-full flex items-center justify-center mb-4",children:i.jsx("img",{src:e0,alt:"logo"})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),i.jsx("p",{className:"text-gray-600",children:"Join us today"})]}),i.jsxs("div",{className:"hidden lg:block",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Create Account"}),i.jsx("p",{className:"mt-2 text-gray-600",children:"Please fill in your information"})]}),c&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center",children:[i.jsx(Qo,{className:"w-5 h-5 text-red-500 mr-3 flex-shrink-0"}),i.jsx("span",{className:"text-red-700 text-sm",children:c})]}),i.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:h(_),children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(fi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...g("name",{required:"Full name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",className:"input pl-10",placeholder:"Enter your full name"})]}),x.name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.name.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Zp,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...g("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"input pl-10",placeholder:"Enter your email"})]}),x.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.email.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx($u,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...g("password",{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"},pattern:{value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,message:"Password must contain at least one uppercase letter, one lowercase letter, and one number"}}),type:r?"text":"password",className:"input pl-10 pr-10",placeholder:"Create a strong password"}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>a(!r),children:r?i.jsx(nf,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):i.jsx(cn,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),x.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.password.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx($u,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...g("password_confirmation",{required:"Please confirm your password",validate:S=>S===y||"Passwords do not match"}),type:n?"text":"password",className:"input pl-10 pr-10",placeholder:"Confirm your password"}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!n),children:n?i.jsx(nf,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):i.jsx(cn,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),x.password_confirmation&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.password_confirmation.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Address (Optional)"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 pt-3 pointer-events-none",children:i.jsx(Z2,{className:"h-5 w-5 text-gray-400"})}),i.jsx("textarea",{rows:3,className:"input pl-10 resize-none",placeholder:"Enter your address"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number (Optional)"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(ev,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"tel",className:"input pl-10",placeholder:"Enter your phone number"})]}),x.phone&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:x.phone.message})]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"terms",name:"terms",type:"checkbox",...g("terms",{required:"You must accept the terms and conditions"}),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),i.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-700",children:["I agree to the"," ",i.jsx("a",{href:"#",className:"text-primary-600 hover:text-primary-500",children:"Terms and Conditions"})," ","and"," ",i.jsx("a",{href:"#",className:"text-primary-600 hover:text-primary-500",children:"Privacy Policy"})]})]}),x.terms&&i.jsx("p",{className:"text-sm text-red-600",children:x.terms.message}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:o,className:"btn-primary w-full justify-center",children:o?i.jsxs(i.Fragment,{children:[i.jsx(Er,{size:"sm"}),i.jsx("span",{className:"ml-2",children:"Creating account..."})]}):"Create Account"})}),i.jsx("div",{className:"text-center",children:i.jsxs("span",{className:"text-sm text-gray-600",children:["Already have an account?"," ",i.jsx(hc,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"Sign in"})]})})]})]})})]})},Rd=()=>Promise.resolve({data:[{id:1,pro_name:"Laptop Dell XPS 13",pro_description:"High-performance ultrabook with Intel Core i7",category_id:1,brand_id:1,upis:1200,sup:1500,qty:25,reorder_point:10,reorder_quantity:20,batch_number:"BATCH001",expiration_date:"2025-12-31",status:"active",image_url:null,category:{id:1,name:"Laptops"},brand:{id:1,name:"Dell"},created_at:"2024-01-01T00:00:00Z"},{id:2,pro_name:"iPhone 15 Pro",pro_description:"Latest iPhone with A17 Pro chip",category_id:2,brand_id:2,upis:999,sup:1199,qty:15,reorder_point:5,reorder_quantity:10,batch_number:"BATCH002",expiration_date:null,status:"active",image_url:null,category:{id:2,name:"Smartphones"},brand:{id:2,name:"Apple"},created_at:"2024-01-02T00:00:00Z"},{id:3,pro_name:"Samsung Galaxy S24",pro_description:"Premium Android smartphone",category_id:2,brand_id:3,upis:899,sup:1099,qty:8,reorder_point:10,reorder_quantity:15,batch_number:"BATCH003",expiration_date:null,status:"active",image_url:null,category:{id:2,name:"Smartphones"},brand:{id:3,name:"Samsung"},created_at:"2024-01-03T00:00:00Z"},{id:4,pro_name:"MacBook Air M3",pro_description:"Apple laptop with M3 chip",category_id:1,brand_id:2,upis:1099,sup:1299,qty:12,reorder_point:8,reorder_quantity:12,batch_number:"BATCH004",expiration_date:null,status:"active",image_url:null,created_at:"2024-01-04T00:00:00Z"},{id:5,pro_name:"Wireless Mouse",pro_description:"Ergonomic wireless mouse",category_id:3,brand_id:4,upis:25,sup:35,qty:15,reorder_point:20,reorder_quantity:30,batch_number:"BATCH005",expiration_date:null,status:"active",image_url:null,created_at:"2024-01-05T00:00:00Z"},{id:6,pro_name:"USB-C Cable",pro_description:"High-speed USB-C charging cable",category_id:3,brand_id:4,upis:10,sup:15,qty:3,reorder_point:15,reorder_quantity:25,batch_number:"BATCH006",expiration_date:null,status:"active",image_url:null,created_at:"2024-01-06T00:00:00Z"}]}),ti=()=>{const e=localStorage.getItem("token");return e&&e.startsWith("demo-token-")},Qi={getAll:e=>ti()?Rd():ut.get("/products",e),getById:e=>ti()?Rd().then(t=>({data:t.data.find(a=>a.id===parseInt(e))})):ut.get(`/products/${e}`),create:e=>ti()?Promise.resolve({data:{id:Date.now(),...e,created_at:new Date().toISOString()}}):e instanceof FormData?el("/products",e).then(t=>t.data):ut.post("/products",e),update:(e,t)=>ti()?Promise.resolve({data:{id:parseInt(e),...t,updated_at:new Date().toISOString()}}):t instanceof FormData?(t.append("_method","PUT"),el(`/products/${e}`,t).then(r=>r.data)):ut.put(`/products/${e}`,t),delete:e=>ti()?Promise.resolve({data:{message:"Product deleted successfully"}}):ut.delete(`/products/${e}`),deactivate:e=>ti()?Promise.resolve({data:{message:"Product deactivated successfully"}}):ut.post(`/products/${e}/deactivate`),activate:e=>ti()?Promise.resolve({data:{message:"Product activated successfully"}}):ut.post(`/products/${e}/activate`),getLowStock:e=>ti()?Rd().then(t=>({data:t.data.filter(a=>a.qty<=a.reorder_point)})):ut.get("/products/low-stock",e),getExpired:e=>ut.get("/products/expired",e),getNearExpiration:e=>ut.get("/products/near-expiration",e)},pb=Object.freeze(Object.defineProperty({__proto__:null,productService:Qi},Symbol.toStringTag,{value:"Module"})),Tc=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!0),[s,o]=se.useState(null),l=se.useRef(!1);se.useEffect(()=>{const d=ui("/products");d&&(r(d),n(!1))},[]);const c=JSON.stringify(e),u=se.useCallback(async()=>{if(l.current){console.log("useProducts: Already fetching, skipping...");return}try{l.current=!0,ui("/products")||n(!0);const m=await Qi.getAll(JSON.parse(c));r(m),o(null)}catch(d){o(d)}finally{n(!1),l.current=!1}},[c]);return se.useEffect(()=>{l.current||ui("/products")&&!t||u()},[c,u]),{data:t,isLoading:a,error:s,refetch:u}},xb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await Qi.create(n);return Ye.success("Product created successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to create product"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},H1=e=>{const[t,r]=se.useState(!1),a=async({id:n,data:s})=>{var o,l;try{r(!0);const c=await Qi.update(n,s);return Ye.success("Product updated successfully"),e&&e(),c}catch(c){throw Ye.error(((l=(o=c.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to update product"),c}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},gb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await Qi.delete(n);return Ye.success("Product deleted successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to delete product"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},vb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await Qi.deactivate(n);return Ye.success("Product deactivated successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to deactivate product"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},yb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await Qi.activate(n);return Ye.success("Product activated successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to activate product"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},xi={getAll:()=>ut.get("/orders",{_t:Date.now()}),getById:e=>ut.get(`/orders/${e}`,{_t:Date.now()}),create:e=>ut.post("/orders",e),update:(e,t)=>ut.put(`/orders/${e}`,t),delete:e=>ut.delete(`/orders/${e}`),forceDelete:e=>ut.delete(`/orders/${e}/force`)},wb=Object.freeze(Object.defineProperty({__proto__:null,orderService:xi},Symbol.toStringTag,{value:"Module"}));class bb{constructor(){this.cache={imports:[],orders:[],listeners:new Map}}subscribe(t,r){return this.cache.listeners.has(t)||this.cache.listeners.set(t,new Set),this.cache.listeners.get(t).add(r),()=>{const a=this.cache.listeners.get(t);a&&a.delete(r)}}notify(t){const r=this.cache.listeners.get(t);r&&r.forEach(a=>{try{a(this.cache[t])}catch(n){console.error("Cache listener error:",n)}})}get(t){return this.cache[t]||[]}set(t,r){Array.isArray(r)&&(this.cache[t]=r,this.notify(t))}add(t,r){Array.isArray(this.cache[t])||(this.cache[t]=[]),this.cache[t].some(n=>n.id===r.id)||(this.cache[t]=[r,...this.cache[t]],this.notify(t))}update(t,r,a){if(!Array.isArray(this.cache[t]))return;const n=this.cache[t].findIndex(s=>s.id===r);n!==-1&&(this.cache[t][n]={...this.cache[t][n],...a},this.notify(t))}remove(t,r){Array.isArray(this.cache[t])&&(this.cache[t]=this.cache[t].filter(a=>a.id!==r),this.notify(t))}clear(t){t?(this.cache[t]=[],this.notify(t)):(this.cache.imports=[],this.cache.orders=[],this.notify("imports"),this.notify("orders"))}}const Oa=new bb,Kf=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!0),[s,o]=se.useState(null);return se.useEffect(()=>{const c=ui("/orders");c&&(r(c),n(!1))},[]),se.useEffect(()=>Oa.subscribe("orders",u=>{r(d=>{var x,p;if(!d)return d;const m=((x=d==null?void 0:d.data)==null?void 0:x.data)||(d==null?void 0:d.data)||d||[],g=new Set(m.map(y=>y.id)),h=u.filter(y=>!g.has(y.id));if(h.length>0){const y=[...h,...m];return(p=d==null?void 0:d.data)!=null&&p.data?{...d,data:{...d.data,data:y}}:d!=null&&d.data?{...d,data:y}:y}return d})}),[]),se.useEffect(()=>{if(ui("/orders"))return;(async()=>{var u;try{n(!0);const d=await xi.getAll(e);r(d);const m=((u=d==null?void 0:d.data)==null?void 0:u.data)||(d==null?void 0:d.data)||d||[];Oa.set("orders",m),o(null)}catch(d){o(d),console.error("Orders fetch failed:",d)}finally{n(!1)}})()},[JSON.stringify(e)]),{data:t,isLoading:a,error:s,refetch:()=>{(async()=>{var u;try{n(!0);const d=await xi.getAll(e);r(d);const m=((u=d==null?void 0:d.data)==null?void 0:u.data)||(d==null?void 0:d.data)||d||[];Oa.set("orders",m),o(null)}catch(d){o(d),console.error("Orders refetch failed:",d)}finally{n(!1)}})()}}},$1=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async s=>{var o,l,c,u,d,m;try{t(!0),a(null);const g={id:`temp-${Date.now()}`,ord_date:s.ord_date,staff_id:s.staff_id,cus_id:s.cus_id,cus_name:s.cus_name,total:s.total||0,order_details:((o=s.items)==null?void 0:o.map(p=>({pro_code:p.product_id,pro_name:"",qty:p.qty,price:p.price,amount:p.qty*p.price})))||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};Oa.add("orders",g);const h=await xi.create(s),x=((l=h==null?void 0:h.data)==null?void 0:l.data)||(h==null?void 0:h.data)||h;return x&&x.id&&(Oa.remove("orders",g.id),Oa.add("orders",x)),Ye.success("Order created successfully"),h}catch(g){a(g),console.error("Order creation failed:",g),Oa.get("orders").filter(p=>{var y;return(y=p.id)==null?void 0:y.toString().startsWith("temp-")}).forEach(p=>Oa.remove("orders",p.id));const x=((u=(c=g.response)==null?void 0:c.data)==null?void 0:u.message)||((m=(d=g.response)==null?void 0:d.data)==null?void 0:m.error)||"Failed to create order";throw Ye.error(x),g}finally{t(!1)}},isLoading:e,error:r}},z1=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async({id:s,data:o})=>{var l,c,u,d;try{t(!0),a(null);const m=await xi.update(s,o);return Ye.success("Order updated successfully"),m}catch(m){a(m),console.error("Order update failed:",m);const g=((c=(l=m.response)==null?void 0:l.data)==null?void 0:c.message)||((d=(u=m.response)==null?void 0:u.data)==null?void 0:d.error)||"Failed to update order";throw Ye.error(g),m}finally{t(!1)}},isLoading:e,error:r}},Nb=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async s=>{var o,l,c,u;try{t(!0),a(null);const d=await xi.delete(s);return Ye.success("Order deleted successfully"),d}catch(d){a(d),console.error("Order deletion failed:",d);const m=((l=(o=d.response)==null?void 0:o.data)==null?void 0:l.message)||((u=(c=d.response)==null?void 0:c.data)==null?void 0:u.error)||"Failed to delete order";throw Ye.error(m),d}finally{t(!1)}},isLoading:e,error:r}},tl={getAll:()=>ut.get("/payments"),getById:e=>ut.get(`/payments/${e}`),create:e=>ut.post("/payments",e),update:(e,t)=>ut.put(`/payments/${e}`,t),delete:e=>ut.delete(`/payments/${e}`),getPending:()=>ut.get("/payments/pending"),getSummary:()=>ut.get("/payments/summary"),getOrderStatus:e=>ut.get(`/payments/order/${e}/status`)},_b=Object.freeze(Object.defineProperty({__proto__:null,paymentService:tl},Symbol.toStringTag,{value:"Module"})),Jf=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!0),[s,o]=se.useState(null);return se.useEffect(()=>{(async()=>{try{n(!0);const u=await tl.getAll(e);r(u),o(null)}catch(u){o(u),console.error("Payments fetch failed:",u)}finally{n(!1)}})()},[JSON.stringify(e)]),{data:t,isLoading:a,error:s,refetch:()=>{(async()=>{try{n(!0);const u=await tl.getAll(e);r(u),o(null)}catch(u){o(u),console.error("Payments refetch failed:",u)}finally{n(!1)}})()}}},V1=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async s=>{var o,l,c,u,d,m,g,h,x;try{t(!0),a(null);const p=await tl.create(s),y=((o=p==null?void 0:p.data)==null?void 0:o.message)||(p==null?void 0:p.message)||"";return y&&y.toLowerCase().includes("order is already fully paid")?Ye.success("Payment created successfully"):Ye.success("Payment created successfully"),p}catch(p){a(p),console.error("Payment creation failed:",p);const y=((c=(l=p.response)==null?void 0:l.data)==null?void 0:c.message)||((d=(u=p.response)==null?void 0:u.data)==null?void 0:d.error)||"Failed to create payment";if(y&&y.toLowerCase().includes("order is already fully paid")){Ye.success("Payment created successfully");const _=((g=(m=p.response)==null?void 0:m.data)==null?void 0:g.data)||((x=(h=p.response)==null?void 0:h.data)==null?void 0:x.payment)||null;return _?{data:_,success:!0}:{data:s,success:!0}}else throw Ye.error(y),p}finally{t(!1)}},isLoading:e,error:r}},G1=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async({id:s,data:o})=>{var l,c,u,d;try{t(!0),a(null);const m=await tl.update(s,o);return Ye.success("Payment updated successfully"),m}catch(m){a(m),console.error("Payment update failed:",m);const g=((c=(l=m.response)==null?void 0:l.data)==null?void 0:c.message)||((d=(u=m.response)==null?void 0:u.data)==null?void 0:d.error)||"Failed to update payment";throw Ye.error(g),m}finally{t(!1)}},isLoading:e,error:r}},Sb=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async s=>{var o,l,c,u;try{t(!0),a(null);const d=await tl.delete(s);return Ye.success("Payment deleted successfully"),d}catch(d){a(d),console.error("Payment deletion failed:",d);const m=((l=(o=d.response)==null?void 0:o.data)==null?void 0:l.message)||((u=(c=d.response)==null?void 0:c.data)==null?void 0:u.error)||"Failed to delete payment";throw Ye.error(m),d}finally{t(!1)}},isLoading:e,error:r}},Au=()=>i.jsx("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md"}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),i.jsx("div",{className:"h-8 bg-gray-200 rounded w-20 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]})]})}),zl=()=>i.jsxs("tr",{className:"animate-pulse",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-16"})})]}),Ab=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 animate-pulse"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-48 animate-pulse"})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("div",{className:"h-10 bg-gray-200 rounded w-24 animate-pulse"}),i.jsx("div",{className:"h-10 bg-gray-200 rounded w-20 animate-pulse"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(Au,{}),i.jsx(Au,{}),i.jsx(Au,{}),i.jsx(Au,{})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4 animate-pulse"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>i.jsxs("div",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg animate-pulse",children:[i.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded mb-2"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})]},e))})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 animate-pulse"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 animate-pulse"})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"})}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"})})]})}),i.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[i.jsx(zl,{}),i.jsx(zl,{}),i.jsx(zl,{}),i.jsx(zl,{}),i.jsx(zl,{})]})]})})]})]}),jb=()=>{const{user:e,updateUser:t}=ha(),r=[{value:"admin",label:" Admin",description:"Full system access"},{value:"manager",label:" Manager",description:"Management level access"},{value:"sales_staff",label:" Sales Staff",description:"Sales focused permissions"},{value:"inventory_staff",label:" Inventory Staff",description:"Inventory focused permissions"},{value:"user",label:" User",description:"Read-only access"}],a=s=>{const o=r.find(l=>l.value===s);t({type:s}),Ye.success(`Switched to ${o.label}`)},n=localStorage.getItem("token");return!n||!n.startsWith("demo-token-")?null:i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[i.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Demo Mode - Role Switcher"}),i.jsxs("p",{className:"text-xs text-yellow-700 mb-3",children:["Current role: ",i.jsx("strong",{children:e==null?void 0:e.type})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2",children:r.map(s=>i.jsx("button",{onClick:()=>a(s.value),className:`p-2 text-xs rounded border transition-colors ${(e==null?void 0:e.type)===s.value?"bg-yellow-200 border-yellow-400 text-yellow-900":"bg-white border-yellow-300 text-yellow-700 hover:bg-yellow-100"}`,title:s.description,children:s.label},s.value))})]})},Eb=()=>{var q,U,H,Q,ne,ee,N,L,D,M;const{user:e}=ha(),t=Of(),r=()=>{console.log("Navigating to Products page..."),t("/products")},a=()=>{console.log("Navigating to Orders page..."),t("/orders")},n=()=>{console.log("Navigating to Analytics page..."),t("/analytics")},s=()=>{console.log("Scrolling to Low Stock section...");const z=document.querySelector('[data-section="low-stock"]');z&&(z.scrollIntoView({behavior:"smooth"}),z.classList.add("ring-2","ring-yellow-400","ring-opacity-75"),setTimeout(()=>{z.classList.remove("ring-2","ring-yellow-400","ring-opacity-75")},3e3))},{data:o,isLoading:l,refetch:c}=Tc(),{data:u,isLoading:d,refetch:m}=Kf(),{data:g,isLoading:h,refetch:x}=Jf(),p=z=>{var ue;return z&&(((ue=z.data)==null?void 0:ue.data)||z.data||z)||[]},y=se.useMemo(()=>p(o),[o]),_=se.useMemo(()=>p(u),[u]),S=se.useMemo(()=>p(g),[g]),E=se.useMemo(()=>{const z=new Map;return _.forEach(ue=>{const pe=ue.id||ue.ord_id;pe&&!z.has(pe)&&z.set(pe,ue)}),Array.from(z.values())},[_]),C=se.useMemo(()=>{const z=y.filter(pe=>{const me=parseInt(pe.qty||0),Ne=parseInt(pe.reorder_point||10);return me<=Ne}),ue=[...E].sort((pe,me)=>{const Ne=new Date(pe.created_at||pe.ord_date);return new Date(me.created_at||me.ord_date)-Ne}).slice(0,10);return{products:y,orders:E,lowStock:z,recentOrders:ue,payments:S}},[y,E,S]),F=l&&d&&h&&!((q=C==null?void 0:C.products)!=null&&q.length),B=()=>{c(),m(),x()},T=(C==null?void 0:C.orders)||[],P=T.length,k=se.useMemo(()=>T.reduce((z,ue)=>z+parseFloat(ue.total||0),0),[T]),I=new Date().getMonth(),A=new Date().getFullYear(),b=se.useMemo(()=>T.filter(z=>{const ue=new Date(z.ord_date||z.created_at);return ue.getMonth()===I&&ue.getFullYear()===A}),[T,I,A]),R=se.useMemo(()=>((C==null?void 0:C.payments)||[]).filter(ue=>{const pe=new Date(ue.pay_date||ue.created_at);return pe.getMonth()===I&&pe.getFullYear()===A}).reduce((ue,pe)=>ue+parseFloat(pe.deposit||pe.amount||0),0),[C==null?void 0:C.payments,I,A]),W=[{name:"Total Products",value:((U=C==null?void 0:C.products)==null?void 0:U.length)||0,icon:Lr,color:"bg-blue-500",subtext:`${Array.isArray(C==null?void 0:C.products)?C.products.filter(z=>z.status==="active").length:0} active`,changeType:"neutral"},{name:"Total Orders",value:P,icon:In,color:"bg-green-500",subtext:`${b.length} this month`,changeType:"positive"},{name:"Total Revenue",value:br(k),icon:zu,color:"bg-purple-500",subtext:`${br(R)} this month`,changeType:"positive"},{name:"Low Stock Items",value:((H=C==null?void 0:C.lowStock)==null?void 0:H.length)||0,icon:Mu,color:"bg-red-500",subtext:"Need attention",changeType:"warning"}];return F&&!((Q=C==null?void 0:C.products)!=null&&Q.length)&&!((ne=C==null?void 0:C.orders)!=null&&ne.length)?i.jsx(Ab,{}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),i.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",(e==null?void 0:e.name)||(e==null?void 0:e.full_name)||((ee=e==null?void 0:e.profile)==null?void 0:ee.full_name)||(e==null?void 0:e.username)||(e==null?void 0:e.email)||"User"]}),(l||d||h)&&((N=C==null?void 0:C.products)==null?void 0:N.length)>0&&i.jsx("p",{className:"text-xs text-blue-600 mt-1",children:" Updating data..."})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(jb,{}),i.jsx("button",{onClick:B,className:"btn-secondary",disabled:F,children:"Refresh"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:W.map((z,ue)=>{const pe=z.icon;return i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:`${z.color} rounded-md p-3`,children:i.jsx(pe,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:z.name}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:z.value}),i.jsx("p",{className:"text-sm text-gray-500",children:z.subtext})]})]})},ue)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("button",{onClick:r,className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx(Lr,{className:"h-8 w-8 text-blue-600 mb-2"}),i.jsx("span",{className:"text-sm font-medium",children:"Add Product"})]}),i.jsxs("button",{onClick:a,className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx(In,{className:"h-8 w-8 text-green-600 mb-2"}),i.jsx("span",{className:"text-sm font-medium",children:"New Order"})]}),i.jsxs("button",{onClick:s,className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx(Mu,{className:"h-8 w-8 text-red-600 mb-2"}),i.jsx("span",{className:"text-sm font-medium",children:"Check Low Stock"})]}),i.jsxs("button",{onClick:n,className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[i.jsx(Hu,{className:"h-8 w-8 text-purple-600 mb-2"}),i.jsx("span",{className:"text-sm font-medium",children:"View Reports"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Orders"}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Showing ",((L=C==null?void 0:C.recentOrders)==null?void 0:L.length)||0," of ",P]})]}),((D=C==null?void 0:C.recentOrders)==null?void 0:D.length)>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.recentOrders.map(z=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",z.id||z.ord_id]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Pr(z.ord_date||z.created_at)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:br(z.total||0)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:z.status||"Completed"})})]},z.id||z.ord_id))})]})}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent orders found"})]}),((M=C==null?void 0:C.lowStock)==null?void 0:M.length)>0&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6","data-section":"low-stock",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[i.jsx(Mu,{className:"h-5 w-5 text-red-500 mr-2"}),"Low Stock Alert"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.lowStock.slice(0,6).map(z=>i.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:z.prod_name||z.name}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Current Stock: ",z.qty||0]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Reorder Point: ",z.reorder_point||10]})]},z.id||z.prod_id))}),C.lowStock.length>6&&i.jsxs("p",{className:"text-sm text-gray-500 mt-4",children:["And ",C.lowStock.length-6," more items need attention"]})]})]})},Wo={getAll:async()=>{try{return await ut.get("/test-categories")}catch{try{return await ut.get("/categories")}catch{return console.warn("CategoryService: Using fallback mock data"),[{id:1,name:"Test Category 1",description:"Test description 1",status:"active",image:null,image_url:null,created_at:"2025-11-05T12:00:00Z"},{id:2,name:"Test Category 2",description:"Test description 2",status:"active",image:null,image_url:null,created_at:"2025-11-05T12:00:00Z"}]}}},getById:e=>ut.get(`/categories/${e}`),create:async e=>{try{return(await(await Ga(()=>Promise.resolve().then(()=>gm),void 0)).default.post("/categories",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("CategoryService: Create failed:",t),t}},update:async(e,t)=>{try{return t instanceof FormData?(t.append("_method","PUT"),(await(await Ga(()=>Promise.resolve().then(()=>gm),void 0)).default.post(`/categories/${e}`,t,{headers:{"Content-Type":"multipart/form-data"}})).data):ut.put(`/categories/${e}`,t)}catch(r){throw console.error("CategoryService: Update failed:",r),r}},delete:(e,t=!1)=>{const r=t?`/categories/${e}?force=true`:`/categories/${e}`;return ut.delete(r)}},Y1=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await Wo.getAll();t(l),s(null)}catch(l){console.error("useCategories: Error fetching categories:",l),s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},Tb=()=>Promise.resolve({data:[{id:1,name:"Dell",code:"DELL",description:"Dell Technologies",status:"active",created_at:"2024-01-01T00:00:00Z"},{id:2,name:"Apple",code:"APPL",description:"Apple Inc.",status:"active",created_at:"2024-01-02T00:00:00Z"},{id:3,name:"Samsung",code:"SAMS",description:"Samsung Electronics",status:"active",created_at:"2024-01-03T00:00:00Z"},{id:4,name:"Logitech",code:"LOGI",description:"Logitech International",status:"active",created_at:"2024-01-04T00:00:00Z"}]}),Cb=()=>{const e=localStorage.getItem("token");return e&&e.startsWith("demo-token-")},C0={getAll:()=>Cb()?Tb():ut.get("/brands"),getById:e=>ut.get(`/brands/${e}`),create:e=>ut.post("/brands",e),update:(e,t)=>ut.put(`/brands/${e}`,t),delete:e=>ut.delete(`/brands/${e}`)},X1=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await C0.getAll();t(l),s(null)}catch(l){s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},Pb=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await C0.create(a);return Ye.success("Brand created successfully"),o}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to create brand"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},Lb=()=>{const[e,t]=se.useState(!1),r=async({id:a,data:n})=>{var s,o;try{t(!0);const l=await C0.update(a,n);return Ye.success("Brand updated successfully"),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to update brand"),l}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},Fb=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await C0.delete(a);return Ye.success("Brand deleted successfully"),o}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to delete brand"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},kb=e=>{if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(t){const[,o,l,c]=t;return`${c}-${l}-${o}`}const r=new Date(e);if(Number.isNaN(r.getTime()))return"";const a=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");return`${a}-${n}-${s}`},Db=({product:e,mode:t,onClose:r,onSuccess:a})=>{const n=t==="view",s=t==="edit",[o,l]=se.useState(null),{data:c}=Y1(),{data:u}=X1(),d=xb(),m=H1(),g=(c==null?void 0:c.data)||c||[],h=(u==null?void 0:u.data)||u||[],{register:x,handleSubmit:p,formState:{errors:y},reset:_}=Xa({defaultValues:{pro_name:"",pro_description:"",category_id:"",brand_id:"",upis:"",sup:"",qty:"",reorder_point:10,reorder_quantity:50,batch_number:"",expiration_date:"",status:"active",image:null,...e}});se.useEffect(()=>{e&&(_({pro_name:e.pro_name||"",pro_description:e.pro_description||"",category_id:e.category_id||"",brand_id:e.brand_id||"",upis:e.upis||"",sup:e.sup||"",qty:e.qty||"",reorder_point:e.reorder_point||10,reorder_quantity:e.reorder_quantity||50,batch_number:e.batch_number||"",expiration_date:kb(e.expiration_date||""),status:e.status||"active",image:null}),l(null))},[e,_]);const S=F=>{const B=F.target.files[0];if(B){const T=new FileReader;T.onloadend=()=>{l(T.result)},T.readAsDataURL(B)}else l(null)},E=async F=>{var B;try{const T=F.image&&F.image[0];let P;if(T){const A=new FormData;A.append("pro_name",F.pro_name||""),A.append("pro_description",F.pro_description||""),A.append("category_id",parseInt(F.category_id)||""),A.append("brand_id",F.brand_id||""),A.append("upis",parseFloat(F.upis)||0),A.append("sup",parseFloat(F.sup)||0),A.append("qty",parseInt(F.qty)||0),A.append("reorder_point",parseInt(F.reorder_point)||10),A.append("reorder_quantity",parseInt(F.reorder_quantity)||50),A.append("batch_number",F.batch_number||""),A.append("expiration_date",F.expiration_date||""),A.append("status",F.status||"active"),A.append("image",F.image[0]),P=A}else P={pro_name:F.pro_name||"",pro_description:F.pro_description||"",category_id:parseInt(F.category_id)||null,brand_id:F.brand_id||null,upis:parseFloat(F.upis)||0,sup:parseFloat(F.sup)||0,qty:parseInt(F.qty)||0,reorder_point:parseInt(F.reorder_point)||10,reorder_quantity:parseInt(F.reorder_quantity)||50,batch_number:F.batch_number||"",expiration_date:F.expiration_date||null,status:F.status||"active"};let k;s?k=await m.mutateAsync({id:e.id,data:P}):k=await d.mutateAsync(P);const I=k&&(((B=k.data)==null?void 0:B.data)||k.data||k)||null;typeof a=="function"&&await a({type:s?"update":"create",product:I}),r()}catch(T){console.error("Submit failed:",T)}},C=d.isLoading||m.isLoading;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3  sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 sticky top-0 bg-white",children:[i.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t==="create"?"Add New Product":t==="edit"?"Edit Product":"Product Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-1",children:i.jsx(zr,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),i.jsxs("form",{onSubmit:p(E),className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),i.jsx("input",{...x("pro_name",{required:"Product name is required"}),type:"text",className:"input text-sm sm:text-base",disabled:n,placeholder:"Enter product name"}),y.pro_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.pro_name.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),i.jsxs("select",{...x("category_id",{required:"Category is required"}),className:"input text-sm sm:text-base",disabled:n,children:[i.jsx("option",{value:"",children:"Select Category"}),Array.isArray(g)&&g.map(F=>i.jsx("option",{value:F.id,children:F.name},F.id))]}),y.category_id&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.category_id.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Brand"}),i.jsxs("select",{...x("brand_id"),className:"input text-sm sm:text-base",disabled:n,children:[i.jsx("option",{value:"",children:"Select Brand (Optional)"}),Array.isArray(h)&&h.map(F=>i.jsx("option",{value:F.id,children:F.name},F.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit Price *"}),i.jsx("input",{...x("upis",{required:"Unit price is required",min:{value:0,message:"Price must be positive"}}),type:"number",step:"0.01",className:"input text-sm sm:text-base",disabled:n,placeholder:"0.00"}),y.upis&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.upis.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sale Price"}),i.jsx("input",{...x("sup",{min:{value:0,message:"Price must be positive"}}),type:"number",step:"0.01",className:"input text-sm sm:text-base",disabled:n,placeholder:"0.00"}),y.sup&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.sup.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity *"}),i.jsx("input",{...x("qty",{required:"Quantity is required",min:{value:0,message:"Quantity must be positive"}}),type:"number",className:"input text-sm sm:text-base",disabled:n,placeholder:"0"}),y.qty&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.qty.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reorder Point"}),i.jsx("input",{...x("reorder_point",{min:{value:0,message:"Reorder point must be positive"}}),type:"number",className:"input text-sm sm:text-base",disabled:n,placeholder:"10"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reorder Quantity *"}),i.jsx("input",{...x("reorder_quantity",{required:"Reorder quantity is required",min:{value:1,message:"Reorder quantity must be at least 1"}}),type:"number",className:"input text-sm sm:text-base",disabled:n,placeholder:"50"}),y.reorder_quantity&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.reorder_quantity.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Batch Number"}),i.jsx("input",{...x("batch_number"),type:"text",className:"input text-sm sm:text-base",disabled:n,placeholder:"Enter batch number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiration Date"}),i.jsx("input",{...x("expiration_date"),type:"date",className:"input text-sm sm:text-base",disabled:n})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),i.jsxs("select",{...x("status"),className:"input text-sm sm:text-base",disabled:n,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Image"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsx("div",{className:"flex-shrink-0",children:o?i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-lg overflow-hidden border-2 border-primary-500",children:i.jsx("img",{src:o,alt:"Preview",className:"w-full h-full object-cover"})}),i.jsx("p",{className:"text-xs text-gray-600 mt-1 text-center",children:"New Image"})]}):(s||t==="view")&&(e!=null&&e.image)?i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-lg overflow-hidden border border-gray-300",children:i.jsx("img",{src:pi(e.image,Is.base_image_url),alt:"Product",className:"w-full h-full object-cover"})}),i.jsx("p",{className:"text-xs text-gray-600 mt-1 text-center",children:"Current Image"})]}):i.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-lg flex items-center justify-center border border-dashed border-gray-300",children:i.jsx(Bo,{className:"w-12 h-12 text-gray-400"})})}),!n&&i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 hover:border-primary-400 transition-colors",children:i.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[i.jsx(Mf,{className:"w-8 h-8 text-gray-400 mb-2"}),i.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer",children:[i.jsx("span",{className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Click to upload"}),i.jsx("span",{className:"text-sm text-gray-500",children:" or drag and drop"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF up to 10MB"}),i.jsx("input",{id:"image-upload",...x("image",{onChange:S}),type:"file",accept:"image/*",className:"hidden"})]})}),i.jsx("p",{className:"mt-2 text-xs text-gray-500",children:s?"Upload new image to replace current one (optional)":"Upload product image (optional)"})]})]})]}),i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),i.jsx("textarea",{...x("pro_description"),rows:3,className:"input text-sm sm:text-base resize-none",disabled:n,placeholder:"Enter product description"})]})]}),!n&&i.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-4 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto order-2 sm:order-1",disabled:C,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-primary w-full sm:w-auto order-1 sm:order-2",disabled:C,children:s?"Update Product":"Create Product"})]}),n&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto",children:"Close"})})]})]})})},xf=({items:e,title:t,type:r="product"})=>{const[a,n]=se.useState(null),[s,o]=se.useState("grid"),l=h=>{var x,p;return r==="product"?h.image_url||(h.image?`http://localhost:8000/storage/${h.image}`:null):r==="staff"?((x=h.profile)==null?void 0:x.image_url)||((p=h.profile)!=null&&p.image?`http://localhost:8000/storage/${h.profile.image}`:null):null},c=h=>r==="product"?h.pro_name:r==="staff"?h.name:"Unknown",u=h=>{var x;return r==="product"?{category:((x=h.category)==null?void 0:x.name)||"No Category",price:`$${h.upis||0}`,stock:`${h.qty||0} units`,status:h.status||"unknown"}:r==="staff"?{position:h.position||"Staff",department:h.department||"General",email:h.email||"No Email",status:h.status||"active"}:{}},d=(e==null?void 0:e.filter(h=>l(h)))||[],m=(h,x)=>{const p=document.createElement("a");p.href=h,p.download=`${x.replace(/\s+/g,"_")}_image.jpg`,document.body.appendChild(p),p.click(),document.body.removeChild(p)},g=async(h,x)=>{if(navigator.share)try{await navigator.share({title:`${x} Image`,url:h})}catch(p){console.log("Error sharing:",p)}else navigator.clipboard.writeText(h),alert("Image URL copied to clipboard!")};return i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 sm:p-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:[" ",t," Gallery"]}),i.jsxs("p",{className:"text-gray-600",children:[d.length," ",r,"s with photos"]})]}),i.jsxs("div",{className:"flex items-center space-x-2 mt-4 sm:mt-0",children:[i.jsx("button",{onClick:()=>o("grid"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${s==="grid"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Grid View"}),i.jsx("button",{onClick:()=>o("list"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${s==="list"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"})]})]}),d.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(cn,{className:"w-12 h-12 text-gray-400"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Photos Available"}),i.jsxs("p",{className:"text-gray-500",children:["No ",r,"s have photos uploaded yet. Add some photos to see them here!"]})]}):i.jsxs(i.Fragment,{children:[s==="grid"&&i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:d.map(h=>{const x=l(h),p=c(h),y=u(h);return i.jsxs("div",{className:"group relative bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>n({item:h,imageUrl:x,itemName:p,details:y}),children:[i.jsx("div",{className:"aspect-square bg-gray-200",children:i.jsx("img",{src:x,alt:p,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"})}),i.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 flex items-center justify-center",children:i.jsx(tv,{className:"w-6 h-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"font-medium text-gray-900 text-sm truncate",children:p}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:r==="product"?y.category:y.position})]})]},h.id)})}),s==="list"&&i.jsx("div",{className:"space-y-4",children:d.map(h=>{const x=l(h),p=c(h),y=u(h);return i.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>n({item:h,imageUrl:x,itemName:p,details:y}),children:[i.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:i.jsx("img",{src:x,alt:p,className:"w-full h-full object-cover",loading:"lazy"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-medium text-gray-900 truncate",children:p}),i.jsx("div",{className:"flex flex-wrap gap-4 mt-1 text-sm text-gray-500",children:Object.entries(y).map(([_,S])=>i.jsxs("span",{className:"capitalize",children:[_,": ",i.jsx("span",{className:"font-medium",children:S})]},_))})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:_=>{_.stopPropagation(),m(x,p)},className:"p-2 text-gray-400 hover:text-blue-600 transition-colors",title:"Download",children:i.jsx(Gi,{className:"w-4 h-4"})}),i.jsx("button",{onClick:_=>{_.stopPropagation(),g(x,p)},className:"p-2 text-gray-400 hover:text-green-600 transition-colors",title:"Share",children:i.jsx(Jh,{className:"w-4 h-4"})})]})]},h.id)})})]}),a&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"relative max-w-4xl max-h-full",children:[i.jsx("button",{onClick:()=>n(null),className:"absolute -top-12 right-0 text-white hover:text-gray-300 transition-colors",children:i.jsx(zr,{className:"w-8 h-8"})}),i.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",children:[i.jsx("img",{src:a.imageUrl,alt:a.itemName,className:"max-w-full max-h-[70vh] object-contain"}),i.jsxs("div",{className:"p-4 sm:p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:a.itemName}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:Object.entries(a.details).map(([h,x])=>i.jsxs("div",{children:[i.jsxs("span",{className:"text-gray-500 capitalize",children:[h,":"]}),i.jsx("p",{className:"font-medium text-gray-900",children:x})]},h))}),i.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-4 pt-4 border-t",children:[i.jsxs("button",{onClick:()=>m(a.imageUrl,a.itemName),className:"btn-secondary text-sm",children:[i.jsx(Gi,{className:"w-4 h-4 mr-2"}),"Download"]}),i.jsxs("button",{onClick:()=>g(a.imageUrl,a.itemName),className:"btn-primary text-sm",children:[i.jsx(Jh,{className:"w-4 h-4 mr-2"}),"Share"]})]})]})]})]})})]})},Ob=()=>{var q;const{hasPermission:e}=ha(),[t,r]=se.useState(""),[a,n]=se.useState(null),[s,o]=se.useState(!1),[l,c]=se.useState("create"),[u,d]=se.useState("table"),{data:m,isLoading:g,error:h,refetch:x}=Tc(),p=gb(x),y=H1(x),_=yb(x),S=vb(x),E=Array.isArray((q=m==null?void 0:m.data)==null?void 0:q.data)?m.data.data:Array.isArray(m==null?void 0:m.data)?m.data:Array.isArray(m)?m:null,[C,F]=se.useState([]);se.useEffect(()=>{if(Array.isArray(E)){const U=[...E].sort((H,Q)=>new Date(Q.created_at)-new Date(H.created_at));F(U)}},[E]);const B=Array.isArray(C),T=Array.isArray(C)?C.filter(U=>(U.pro_name||"").toLowerCase().includes(t.toLowerCase())||(U.description||"").toLowerCase().includes(t.toLowerCase())||(U.barcode||"").toLowerCase().includes(t.toLowerCase())):[],P=()=>{n(null),c("create"),o(!0)},k=U=>{n(U),c("edit"),o(!0)},I=U=>{n(U),c("view"),o(!0)},A=async U=>{var H,Q,ne,ee;if(window.confirm(`Are you sure you want to delete "${U.pro_name}"?`))try{F(N=>N.filter(L=>L.id!==U.id)),await p.mutate(U.id),x()}catch(N){if(console.error("Delete failed:",N),((H=N.response)==null?void 0:H.status)===422&&((ee=(ne=(Q=N.response)==null?void 0:Q.data)==null?void 0:ne.message)!=null&&ee.includes("transaction history"))&&window.confirm(`Cannot delete "${U.pro_name}" because it has transaction history.

Would you like to mark it as inactive instead?`))try{F(D=>D.map(M=>M.id===U.id?{...M,status:"inactive"}:M)),await y.mutate({id:U.id,data:{...U,status:"inactive"}}),x()}catch(D){console.error("Deactivate failed:",D),Ye.error("Failed to deactivate product"),x()}}},b=async U=>{const H=U.status==="active",Q=H?"deactivate":"activate";if(window.confirm(`Are you sure you want to ${Q} "${U.pro_name}"?`))try{H?await S.mutate(U.id):await _.mutate(U.id)}catch(ne){console.error(`${Q} failed:`,ne)}};if(g&&!m)return i.jsx(Er,{className:"h-64"});if(h)return i.jsxs("div",{className:"text-red-600 p-4 bg-red-50 rounded",children:["Error loading products: ",h.message,i.jsx("button",{onClick:x,className:"ml-4 px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]});const R=e(["create","create_product"]),W=e(["update","update_product"]),Y=e("delete");return i.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Products"}),i.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:t?`${T.length} of ${C.length} products`:`${T.length} total products`})]}),R&&i.jsxs("button",{onClick:P,className:"btn-primary w-full sm:w-auto",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),i.jsx("span",{className:"sm:inline",children:"Add Product"})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),i.jsx("input",{type:"text",placeholder:"Search products...",value:t,onChange:U=>r(U.target.value),className:"input pl-9 sm:pl-10 text-sm sm:text-base"})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("button",{className:"btn-secondary sm:w-auto",children:[i.jsx(rv,{className:"w-4 h-4 mr-2"}),i.jsx("span",{className:"sm:inline",children:"Filter"})]}),i.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>d("table"),className:`p-2 rounded-md transition-colors ${u==="table"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,title:"Table View",children:i.jsx(e1,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>d("gallery"),className:`p-2 rounded-md transition-colors ${u==="gallery"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,title:"Gallery View",children:i.jsx(t1,{className:"w-4 h-4"})})]})]})]})}),u==="table"&&i.jsx("div",{className:"block sm:hidden space-y-4",children:B&&(T==null?void 0:T.map(U=>{var H;return i.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[i.jsxs("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0 overflow-hidden border border-gray-200",children:[U.image_url||U.image?i.jsx("img",{src:U.image_url||pi(U.image,Is.base_image_url),alt:U.pro_name,className:"w-full h-full object-cover cursor-pointer",onClick:()=>I(U),onError:Q=>{console.log("Mobile image failed to load:",Q.target.src),Q.target.style.display="none";const ne=Q.target.parentNode.querySelector(".fallback-icon");ne&&(ne.style.display="flex",ne.classList.remove("hidden"))},onLoad:Q=>{console.log("Mobile image loaded successfully:",Q.target.src)}}):null,i.jsx(Lr,{className:`fallback-icon w-8 h-8 text-gray-400 ${U.image_url||U.image?"hidden":""}`})]}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("h3",{className:"font-medium text-gray-900 truncate",children:U.pro_name}),i.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:U.pro_description})]})]}),i.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>I(U),className:"text-gray-400 hover:text-gray-600 p-1",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),W&&i.jsx("button",{onClick:()=>k(U),className:"text-blue-400 hover:text-blue-600 p-1",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),W&&i.jsx("button",{onClick:()=>b(U),className:`p-1 ${U.status==="active"?"text-orange-400 hover:text-orange-600":"text-green-400 hover:text-green-600"}`,title:U.status==="active"?"Deactivate":"Activate",children:U.status==="active"?i.jsx(Qh,{className:"w-4 h-4"}):i.jsx(Zh,{className:"w-4 h-4"})}),Y&&i.jsx("button",{onClick:()=>A(U),className:"text-red-400 hover:text-red-600 p-1",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Category:"}),i.jsx("p",{className:"font-medium",children:((H=U.category)==null?void 0:H.name)||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Price:"}),i.jsx("p",{className:"font-medium",children:br(U.sup)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Stock:"}),i.jsx("p",{className:`font-medium ${U.qty<=(U.reorder_point||10)?"text-red-600":"text-gray-900"}`,children:U.qty})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${_m(U.status)}`,children:U.status})]})]})]},U.id)}))}),u==="table"&&i.jsxs("div",{className:"hidden sm:block bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table ",children:[i.jsx("thead",{className:"table-header bg-blue-400 text-white",children:i.jsxs("tr",{className:"text-white",children:[i.jsx("th",{className:"table-head text-white ",children:"Image"}),i.jsx("th",{className:"table-head text-white",children:"Name"}),i.jsx("th",{className:"table-head text-white",children:"Description"}),i.jsx("th",{className:"table-head text-white",children:"Category"}),i.jsx("th",{className:"table-head text-white",children:"Price"}),i.jsx("th",{className:"table-head text-white",children:"Stock"}),i.jsx("th",{className:"table-head text-white",children:"Status"}),i.jsx("th",{className:"table-head text-white",children:"Created"}),i.jsx("th",{className:"table-head text-white",children:"Actions"})]})}),i.jsx("tbody",{children:B&&(T==null?void 0:T.map(U=>{var H;return i.jsxs("tr",{className:"table-row",children:[i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden border border-gray-200",children:[U.image_url||U.image?i.jsx("img",{src:U.image_url||pi(U.image,Is.base_image_url),alt:U.pro_name,className:"w-full h-full object-cover cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>I(U),onError:Q=>{console.log("Desktop image failed to load:",Q.target.src),Q.target.style.display="none";const ne=Q.target.parentNode.querySelector(".fallback-icon");ne&&(ne.style.display="flex",ne.classList.remove("hidden"))},onLoad:Q=>{console.log("Desktop image loaded successfully:",Q.target.src)}}):null,i.jsx(Lr,{className:`fallback-icon w-8 h-8 text-gray-400 ${U.image_url||U.image?"hidden":""}`})]})}),i.jsx("td",{className:"table-cell",children:i.jsx("div",{children:i.jsx("div",{className:"font-medium text-gray-900",children:U.pro_name})})}),i.jsx("td",{children:i.jsx("div",{className:"text-sm text-gray-500 line-clamp-2 w-32 ",children:U.pro_description})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-sm text-gray-900",children:((H=U.category)==null?void 0:H.name)||"N/A"})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"font-medium text-gray-900",children:br(U.sup)})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:`font-medium ${U.qty<=(U.reorder_point||10)?"text-red-600":"text-gray-900"}`,children:U.qty})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_m(U.status)}`,children:U.status})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-sm text-gray-500",children:Pr(U.created_at)})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>I(U),className:"text-gray-400 hover:text-gray-600",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),W&&i.jsx("button",{onClick:()=>k(U),className:"text-blue-400 hover:text-blue-600",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),W&&i.jsx("button",{onClick:()=>b(U),className:`${U.status==="active"?"text-orange-400 hover:text-orange-600":"text-green-400 hover:text-green-600"}`,title:U.status==="active"?"Deactivate":"Activate",children:U.status==="active"?i.jsx(Qh,{className:"w-4 h-4"}):i.jsx(Zh,{className:"w-4 h-4"})}),Y&&i.jsx("button",{onClick:()=>A(U),className:"text-red-400 hover:text-red-600",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},U.id)}))})]})}),B&&(C==null?void 0:C.length)===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Lr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No products found"}),i.jsx("p",{className:"text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first product"})]})]}),u==="gallery"&&i.jsx(xf,{items:T,title:"Products",type:"product"}),s&&i.jsx(Db,{product:a,mode:l,onClose:()=>o(!1),onSuccess:({type:U,product:H})=>{o(!1),H&&F(Q=>U==="create"?[H,...Q]:U==="update"?Q.map(ne=>ne.id===H.id?{...ne,...H}:ne):Q),x()}})]})},Ib=()=>{const{hasPermission:e}=ha(),[t,r]=se.useState(""),[a,n]=se.useState("grid"),[s,o]=se.useState(null),[l,c]=se.useState(!1),[u,d]=se.useState("create"),[m,g]=se.useState([]),[h,x]=se.useState(!0),[p,y]=se.useState(null),[_,S]=se.useState({}),E=e(["create","create_category"]),C=e(["update","update_category"]),F=e(["delete","delete_category"]),[B,T]=se.useState({name:"",description:"",status:"active",image:null,imagePreview:null});se.useEffect(()=>{P()},[]);const P=async()=>{var ee;try{x(!0);const N=await Wo.getAll();console.log("CategoriesPage: Raw response:",N);let L=[];Array.isArray(N)?L=N:(ee=N.data)!=null&&ee.success?L=N.data.data||[]:N.data?L=Array.isArray(N.data)?N.data:[]:N.success&&(L=N.data||[]),console.log("CategoriesPage: Processed categories:",L),g(L),y(null)}catch(N){console.error("Error fetching categories:",N),y("Failed to load categories")}finally{x(!1)}},k=ee=>ee.image_url&&(ee.image_url.startsWith("http")||ee.image_url.startsWith("https"))?ee.image_url:ee.image?ee.image.startsWith("http")?ee.image:`http://localhost:8000/storage/${ee.image}`:null,I=ee=>ee?new Date(ee).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",A=()=>{o(null),T({name:"",description:"",status:"active",image:null,imagePreview:null}),S({}),d("create"),c(!0)},b=ee=>{o(ee),T({name:ee.cat_name||ee.name,description:ee.cat_desc||ee.description,status:ee.status,image:null,imagePreview:k(ee)}),S({}),d("edit"),c(!0)},R=async ee=>{var N,L,D;if(window.confirm(` "${ee.cat_name||ee.name}" ?`))try{const M=await Wo.delete(ee.id);g(z=>z.filter(ue=>ue.id!==ee.id)),Ye.success("  Category !",{duration:3e3,position:"top-right"})}catch(M){if(console.error("Error deleting category:",M),((N=M.response)==null?void 0:N.status)===422&&((D=(L=M.response)==null?void 0:L.data)!=null&&D.can_force_delete)){const z=M.response.data.product_count;if(window.confirm(`"${ee.name}"  ${z} 

:
 OK:  category  products  ()
 Cancel: 

 : !`))try{await Wo.delete(ee.id,!0),g(pe=>pe.filter(me=>me.id!==ee.id)),Ye.success(" Category  products !",{duration:4e3,position:"top-right"})}catch(pe){console.error("Force delete failed:",pe),Ye.error("  ")}}else Ye.error("  category  ")}},W=ee=>{const N=ee.target.files[0];if(N){const L=new FileReader;L.onloadend=()=>{T(D=>({...D,image:N,imagePreview:L.result}))},L.readAsDataURL(N)}},Y=async()=>{var ee,N;if(S({}),!B.name.trim()){S(L=>({...L,name:"Category name is required"}));return}try{const L=new FormData;L.append("name",B.name),L.append("description",B.description||""),L.append("status",B.status),B.image&&B.image instanceof File?(L.append("image",B.image),console.log("Adding new image file to FormData:",B.image.name)):console.log("No new image file selected, skipping image field");let D;u==="create"?(D=await Wo.create(L),D.success&&D.data&&(g(M=>[D.data,...M]),Ye.success("  Category !",{duration:3e3,position:"top-right"}))):(D=await Wo.update(s.id,L),D.success&&D.data&&(g(M=>M.map(z=>z.id===s.id?D.data:z)),Ye.success("  Category !",{duration:3e3,position:"top-right"}))),c(!1)}catch(L){if(console.error("Error saving category:",L),((ee=L.response)==null?void 0:ee.status)===422){console.error("Validation errors:",L.response.data);const D=L.response.data.errors||{};S(D);const M=L.response.data.message||"",z=Object.keys(D).length>0?`

:
`+Object.entries(D).map(([ue,pe])=>`${ue==="name"?"":ue==="description"?"":ue==="image"?"":ue}: ${Array.isArray(pe)?pe.join(", "):pe}`).join(`
`):"";Ye.error(` ${M}${z}`,{duration:5e3,position:"top-right"})}else console.error("Non-validation error:",((N=L.response)==null?void 0:N.data)||L.message),Ye.error("  category  ")}};console.log("CategoriesPage: Current categories state:",m),console.log("CategoriesPage: Categories length:",m.length);const q=m.filter(ee=>(ee.name||ee.cat_name||"").toLowerCase().includes(t.toLowerCase())||(ee.description||ee.cat_desc||"").toLowerCase().includes(t.toLowerCase()));console.log("CategoriesPage: Filtered categories:",q);const U=q.length,H=q.filter(ee=>ee.status==="active").length,Q=q.filter(ee=>ee.status==="inactive").length,ne=q.filter(ee=>k(ee)).length;return h?i.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Loading categories..."})]})}):i.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Categories"}),i.jsx("p",{className:"text-gray-600",children:"Manage your product categories"})]}),E&&i.jsxs("button",{onClick:A,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[i.jsx(An,{className:"w-4 h-4"})," Category"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 text-sm",children:"Total Categories"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:U})]}),i.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:i.jsx(Bo,{className:"w-6 h-6 text-blue-600"})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 text-sm",children:"Active"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:H})]}),i.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:i.jsx("span",{className:"text-lg text-green-600",children:""})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 text-sm",children:"Inactive"}),i.jsx("p",{className:"text-2xl font-bold text-red-600",children:Q})]}),i.jsx("div",{className:"bg-red-100 p-3 rounded-lg",children:i.jsx("span",{className:"text-lg text-red-600",children:""})})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 text-sm",children:"With Images"}),i.jsx("p",{className:"text-2xl font-bold text-purple-600",children:ne})]}),i.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:i.jsx(Bo,{className:"w-6 h-6 text-purple-600"})})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search categories...",value:t,onChange:ee=>r(ee.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>n("grid"),className:`p-2 rounded ${a==="grid"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600"}`,children:i.jsx(t1,{className:"w-5 h-5"})}),i.jsx("button",{onClick:()=>n("list"),className:`p-2 rounded ${a==="list"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600"}`,children:i.jsx(e1,{className:"w-5 h-5"})})]})]})}),p&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:p}),a==="grid"&&i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:q.map(ee=>i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition-shadow",children:[i.jsx("div",{className:"h-48 bg-gray-100 flex items-center justify-center overflow-hidden border-b border-gray-200",children:k(ee)?i.jsx("img",{src:k(ee),alt:ee.cat_name||ee.name,className:"w-full h-full object-cover",onError:N=>{N.target.style.display="none",N.target.nextSibling.style.display="flex"}}):i.jsx(Bo,{className:"w-12 h-12 text-gray-400"})}),i.jsxs("div",{className:"p-4",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2 truncate",children:ee.cat_name||ee.name}),i.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:ee.cat_desc||ee.description}),i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ee.status}),i.jsx("span",{className:"text-xs text-gray-500",children:I(ee.created_at)})]}),i.jsxs("div",{className:"flex gap-2",children:[C&&i.jsxs("button",{onClick:()=>b(ee),className:"flex-1 text-blue-600 hover:text-blue-800 font-medium text-sm py-2 border border-blue-200 rounded hover:bg-blue-50 transition-colors flex items-center justify-center gap-1",children:[i.jsx(Rn,{className:"w-4 h-4"}),"Edit"]}),F&&i.jsxs("button",{onClick:()=>R(ee),className:"flex-1 text-red-600 hover:text-red-800 font-medium text-sm py-2 border border-red-200 rounded hover:bg-red-50 transition-colors flex items-center justify-center gap-1",children:[i.jsx(un,{className:"w-4 h-4"}),"Delete"]})]})]})]},ee.id))}),a==="list"&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(ee=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center overflow-hidden border border-gray-200",children:k(ee)?i.jsx("img",{src:k(ee),alt:ee.cat_name||ee.name,className:"w-full h-full object-cover",onError:N=>{N.target.style.display="none",N.target.nextSibling.style.display="flex"}}):i.jsx(Bo,{className:"w-6 h-6 text-gray-400"})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"font-medium text-gray-900",children:ee.cat_name||ee.name})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:"text-gray-600 truncate max-w-xs block",children:ee.cat_desc||ee.description})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ee.status})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"text-sm text-gray-500",children:I(ee.created_at)})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[C&&i.jsx("button",{onClick:()=>b(ee),className:"text-blue-600 hover:text-blue-800",title:"Edit",children:i.jsx(Rn,{className:"w-5 h-5"})}),F&&i.jsx("button",{onClick:()=>R(ee),className:"text-red-600 hover:text-red-800",title:"Delete",children:i.jsx(un,{className:"w-5 h-5"})})]})})]},ee.id))})]})})}),q.length===0&&!h&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[i.jsx(Bo,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No categories found"}),i.jsx("p",{className:"text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first category"}),i.jsxs("div",{className:"mt-4 text-xs text-gray-400",children:["Debug: Categories array length: ",m.length,", Loading: ",h.toString(),", Error: ",p||"none"]})]}),l&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:u==="create"?"Add New Category":"Edit Category"}),i.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name *"}),i.jsx("input",{type:"text",value:B.name,onChange:ee=>T(N=>({...N,name:ee.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${_.name?"border-red-500":"border-gray-300"}`}),_.name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),i.jsx("textarea",{value:B.description,onChange:ee=>T(N=>({...N,description:ee.target.value})),rows:"3",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${_.description?"border-red-500":"border-gray-300"}`}),_.description&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.description})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),i.jsxs("select",{value:B.status,onChange:ee=>T(N=>({...N,status:ee.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${_.status?"border-red-500":"border-gray-300"}`,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]}),_.status&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.status})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image"}),i.jsxs("div",{className:"mt-2",children:[B.imagePreview&&i.jsx("div",{className:"mb-4",children:i.jsx("img",{src:B.imagePreview,alt:"Preview",className:"w-full h-48 object-cover rounded-lg border border-gray-300"})}),i.jsxs("label",{className:"flex items-center justify-center w-full px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[i.jsx(Mf,{className:"w-5 h-5 mr-2 text-gray-600"}),i.jsx("span",{className:"text-sm text-gray-600",children:B.imagePreview?"Change Image":"Upload Image"}),i.jsx("input",{type:"file",accept:"image/*",onChange:W,className:"hidden"})]}),_.image&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.image})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Y,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:u==="create"?"Create":"Update"})]})]})]})})]})})},Rb=({brand:e,mode:t,onClose:r,onSuccess:a})=>{const n=t==="edit",s=Pb(),o=Lb(),{register:l,handleSubmit:c,formState:{errors:u},reset:d}=Xa({defaultValues:{name:"",code:"",description:"",status:"active",...e}});se.useEffect(()=>{e&&d(e)},[e,d]);const m=async h=>{var x;try{let p;if(n?p=await o.mutateAsync({id:e.id,data:h}):p=await s.mutateAsync(h),typeof a=="function"){const y=p&&(((x=p.data)==null?void 0:x.data)||p.data||p)||null;await a({type:n?"update":"create",brand:y})}r()}catch(p){console.error("Submit failed:",p)}},g=s.isLoading||o.isLoading;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Brand":"Add New Brand"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:c(m),className:"p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand Name *"}),i.jsx("input",{...l("name",{required:"Brand name is required"}),type:"text",className:"input",placeholder:"Enter brand name"}),u.name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.name.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand Code *"}),i.jsx("input",{...l("code",{required:"Brand code is required"}),type:"text",className:"input",placeholder:"Enter brand code (e.g., APPLE, SAMSUNG)"}),u.code&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.code.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),i.jsxs("select",{...l("status",{required:"Status is required"}),className:"input",children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]}),u.status&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.status.message})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:r,className:"btn-secondary",disabled:g,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:g,children:g?i.jsx(Er,{size:"sm"}):n?"Update Brand":"Create Brand"})]})]})]})})},Mb=()=>{const{hasPermission:e}=ha(),[t,r]=se.useState(null),[a,n]=se.useState(!1),[s,o]=se.useState("create"),{data:l,isLoading:c,error:u,refetch:d}=X1(),m=Fb(),g=(l==null?void 0:l.data)||l||[],[h,x]=se.useState([]);se.useEffect(()=>{Array.isArray(g)&&x(g)},[g]);const p=Array.isArray(h),y=()=>{r(null),o("create"),n(!0)},_=B=>{r(B),o("edit"),n(!0)},S=async B=>{if(window.confirm(`Are you sure you want to delete "${B.name}"?`))try{x(T=>T.filter(P=>P.id!==B.id)),await m.mutateAsync(B.id),d()}catch(T){console.error("Delete failed:",T),d()}};if(c&&!l)return i.jsx(Er,{className:"h-64"});if(u)return i.jsx("div",{className:"text-red-600",children:"Error loading brands"});const E=e(["create"]),C=e(["update"]),F=e(["delete"]);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Brands"}),i.jsx("p",{className:"text-gray-600",children:"Manage product brands"})]}),E&&i.jsxs("button",{onClick:y,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"Add Brand"]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table",children:[i.jsx("thead",{className:"table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"table-head",children:"Name"}),i.jsx("th",{className:"table-head",children:"Code"}),i.jsx("th",{className:"table-head",children:"Created"}),i.jsx("th",{className:"table-head",children:"Actions"})]})}),i.jsx("tbody",{children:p&&(h==null?void 0:h.map(B=>i.jsxs("tr",{className:"table-row",children:[i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Kp,{className:"w-5 h-5 text-gray-400 mr-3"}),i.jsx("span",{className:"font-medium text-gray-900",children:B.name})]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:B.code||"N/A"})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-sm text-gray-500",children:Pr(B.created_at)})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[C&&i.jsx("button",{onClick:()=>_(B),className:"text-blue-400 hover:text-blue-600",children:i.jsx(Rn,{className:"w-4 h-4"})}),F&&i.jsx("button",{onClick:()=>S(B),className:"text-red-400 hover:text-red-600",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},B.id)))})]})})}),a&&i.jsx(Rb,{brand:t,mode:s,onClose:()=>n(!1),onSuccess:({type:B,brand:T})=>{T&&x(P=>B==="create"?[T,...P]:B==="update"?P.map(k=>k.id===T.id?{...k,...T}:k):P),d()}})]})},P0={getAll:()=>ut.get("/suppliers"),getById:e=>ut.get(`/suppliers/${e}`),create:e=>ut.post("/suppliers",e),update:(e,t)=>ut.put(`/suppliers/${e}`,t),delete:e=>ut.delete(`/suppliers/${e}`)},L0=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await P0.getAll();t(l),s(null)}catch(l){s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},Bb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await P0.create(n);return Ye.success("Supplier created successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to create supplier"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},Ub=e=>{const[t,r]=se.useState(!1),a=async({id:n,data:s})=>{var o,l;try{r(!0);const c=await P0.update(n,s);return Ye.success("Supplier updated successfully"),e&&e(),c}catch(c){throw Ye.error(((l=(o=c.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to update supplier"),c}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},qb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await P0.delete(n);return Ye.success("Supplier deleted successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to delete supplier"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},Wb=({supplier:e,mode:t,onClose:r,onSuccess:a})=>{const n=t==="edit",s=Bb(),o=Ub(),{register:l,handleSubmit:c,formState:{errors:u},reset:d}=Xa({defaultValues:e||{}});se.useEffect(()=>{e&&d(e)},[e,d]);const m=async h=>{var x;try{let p;n?p=await o.mutateAsync({id:e.id,data:h}):p=await s.mutateAsync(h);const y=p&&(((x=p.data)==null?void 0:x.data)||p.data||p)||null;typeof a=="function"&&a({type:n?"update":"create",supplier:y}),r()}catch(p){console.error("Submit failed:",p)}},g=s.isLoading||o.isLoading;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Edit Supplier":"Add New Supplier"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:c(m),className:"p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),i.jsx("input",{...l("supplier",{required:"Supplier name is required"}),type:"text",className:"input"}),u.supplier&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.supplier.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact *"}),i.jsx("input",{...l("sup_con",{required:"Contact is required"}),type:"text",className:"input"}),u.sup_con&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.sup_con.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address *"}),i.jsx("textarea",{...l("sup_add",{required:"Address is required"}),rows:3,className:"input"}),u.sup_add&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.sup_add.message})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:r,className:"btn-secondary",disabled:g,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:g,children:g?i.jsx(Er,{size:"sm"}):n?"Update Supplier":"Create Supplier"})]})]})]})})},Hb=()=>{var P;const{hasPermission:e}=ha(),[t,r]=se.useState(""),[a,n]=se.useState(null),[s,o]=se.useState(!1),[l,c]=se.useState("create"),[u,d]=se.useState([]),{data:m,isLoading:g,error:h,refetch:x}=L0(),p=qb(),y=((P=m==null?void 0:m.data)==null?void 0:P.data)||(m==null?void 0:m.data)||m||[];se.useEffect(()=>{Array.isArray(y)&&y.length>0&&d(y)},[m]);const _=()=>{n(null),c("create"),o(!0)},S=k=>{n(k),c("edit"),o(!0)},E=async k=>{if(window.confirm(`Are you sure you want to delete "${k.supplier}"?`))try{d(I=>I.filter(A=>A.id!==k.id)),await p.mutateAsync(k.id),x()}catch(I){console.error("Delete failed:",I),x()}};if(g&&!m)return i.jsx(Er,{className:"h-64"});if(h)return i.jsx("div",{className:"text-red-600",children:"Error loading suppliers"});const C=e(["create"]),F=e(["update"]),B=e(["delete"]),T=Array.isArray(u)?u.filter(k=>(k.supplier||"").toLowerCase().includes(t.toLowerCase())||(k.contact_person||"").toLowerCase().includes(t.toLowerCase())):[];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Suppliers"}),i.jsx("p",{className:"text-gray-600",children:"Manage your suppliers"})]}),C&&i.jsxs("button",{onClick:_,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"Add Supplier"]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsx("div",{className:"relative",children:i.jsx("input",{type:"text",placeholder:"Search suppliers...",value:t,onChange:k=>r(k.target.value),className:"input pl-10"})})}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table",children:[i.jsx("thead",{className:"table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"table-head",children:"Supplier"}),i.jsx("th",{className:"table-head",children:"Contact"}),i.jsx("th",{className:"table-head",children:"Address"}),i.jsx("th",{className:"table-head",children:"Created"}),i.jsx("th",{className:"table-head",children:"Actions"})]})}),i.jsx("tbody",{children:T.map(k=>i.jsxs("tr",{className:"table-row",children:[i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(mc,{className:"w-5 h-5 text-gray-400 mr-3"}),i.jsx("span",{className:"font-medium text-gray-900",children:k.supplier})]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:k.sup_con})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:k.sup_add})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-sm text-gray-500",children:Pr(k.created_at)})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[F&&i.jsx("button",{onClick:()=>S(k),className:"text-blue-400 hover:text-blue-600",children:i.jsx(Rn,{className:"w-4 h-4"})}),B&&i.jsx("button",{onClick:()=>E(k),className:"text-red-400 hover:text-red-600",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},k.id))})]})}),T.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(mc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No suppliers found"}),i.jsx("p",{className:"text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first supplier"})]})]}),s&&i.jsx(Wb,{supplier:a,mode:l,onClose:()=>o(!1),onSuccess:({type:k,supplier:I})=>{I&&d(A=>k==="create"?[I,...A]:k==="update"?A.map(b=>b.id===I.id?{...b,...I}:b):A),x()}})]})},F0={getAll:()=>ut.get("/customers"),getById:e=>ut.get(`/customers/${e}`),create:e=>ut.post("/customers",e),update:(e,t)=>ut.put(`/customers/${e}`,t),delete:e=>ut.delete(`/customers/${e}`)},K1=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await F0.getAll();t(l),s(null)}catch(l){s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},$b=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await F0.create(n);return Ye.success("Customer created successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to create customer"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},zb=e=>{const[t,r]=se.useState(!1),a=async({id:n,data:s})=>{var o,l;try{r(!0);const c=await F0.update(n,s);return Ye.success("Customer updated successfully"),e&&e(),c}catch(c){throw Ye.error(((l=(o=c.response)==null?void 0:o.data)==null?void 0:l.message)||"Failed to update customer"),c}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},Vb=e=>{const[t,r]=se.useState(!1),a=async n=>{var s,o;try{r(!0);const l=await F0.delete(n);return Ye.success("Customer deleted successfully"),e&&e(),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to delete customer"),l}finally{r(!1)}};return{mutate:a,mutateAsync:a,isLoading:t}},Gb=({customer:e,mode:t,onClose:r,onSuccess:a})=>{const n=t==="view",s=t==="edit",o=$b(),l=zb(),{register:c,handleSubmit:u,formState:{errors:d},reset:m}=Xa({defaultValues:{cus_name:"",cus_contact:"",...e}});se.useEffect(()=>{e&&m({cus_name:e.cus_name||"",cus_contact:e.cus_contact||""})},[e,m]);const g=async x=>{var p;try{let y;s?y=await l.mutateAsync({id:e.id,data:x}):y=await o.mutateAsync(x);const _=y&&(((p=y.data)==null?void 0:p.data)||y.data||y)||null;typeof a=="function"&&a({type:s?"update":"create",customer:_}),r()}catch(y){console.error("Submit failed:",y)}},h=o.isLoading||l.isLoading;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 sticky top-0 bg-white",children:[i.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t==="create"?"Add New Customer":t==="edit"?"Edit Customer":"Customer Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-1",children:i.jsx(zr,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),i.jsxs("form",{onSubmit:u(g),className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer Name *"}),i.jsx("input",{...c("cus_name",{required:"Customer name is required"}),type:"text",className:"input text-sm sm:text-base",disabled:n,placeholder:"Enter customer name"}),d.cus_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.cus_name.message})]}),i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Number"}),i.jsx("input",{...c("cus_contact",{maxLength:{value:10,message:"Contact number must be 10 digits or less"}}),type:"tel",className:"input text-sm sm:text-base",disabled:n,placeholder:"Enter contact number (max 10 digits)",maxLength:10}),d.cus_contact&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.cus_contact.message})]})]}),!n&&i.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-4 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto order-2 sm:order-1",disabled:h,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-primary w-full sm:w-auto order-1 sm:order-2",disabled:h,children:h?i.jsx(Er,{size:"sm"}):s?"Update Customer":"Create Customer"})]}),n&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto",children:"Close"})})]})]})})},Yb=()=>{const{hasPermission:e}=ha(),[t,r]=se.useState(""),[a,n]=se.useState(null),[s,o]=se.useState(!1),[l,c]=se.useState("create"),{data:u,isLoading:d,error:m,refetch:g}=K1(),h=Vb(),[x,p]=se.useState([]);se.useEffect(()=>{var k;const P=((k=u==null?void 0:u.data)==null?void 0:k.data)||(u==null?void 0:u.data)||u||[];Array.isArray(P)&&P.length>=0&&p(P)},[u]);const y=()=>{n(null),c("create"),o(!0)},_=P=>{n(P),c("view"),o(!0)},S=P=>{n(P),c("edit"),o(!0)},E=async P=>{if(window.confirm(`Are you sure you want to delete "${P.cus_name}"?`))try{p(k=>k.filter(I=>I.id!==P.id)),await h.mutateAsync(P.id),g()}catch(k){console.error("Delete failed:",k),g()}};if(d&&!u)return i.jsx(Er,{className:"h-64"});if(m)return i.jsx("div",{className:"text-red-600",children:"Error loading customers"});const C=e(["create"]),F=e(["update"]),B=e(["delete"]),T=Array.isArray(x)?x.filter(P=>{var k,I;return((k=P.cus_name)==null?void 0:k.toLowerCase().includes(t.toLowerCase()))||((I=P.cus_contact)==null?void 0:I.toLowerCase().includes(t.toLowerCase()))}):[];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customers"}),i.jsx("p",{className:"text-gray-600",children:"Manage your customers"})]}),C&&i.jsxs("button",{onClick:y,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search customers by name or contact...",value:t,onChange:P=>r(P.target.value),className:"input pl-10"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table",children:[i.jsx("thead",{className:"table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"table-head",children:"Customer"}),i.jsx("th",{className:"table-head",children:"Contact"}),i.jsx("th",{className:"table-head",children:"Created"}),i.jsx("th",{className:"table-head",children:"Actions"})]})}),i.jsx("tbody",{children:T.map(P=>i.jsxs("tr",{className:"table-row",children:[i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(hi,{className:"w-5 h-5 text-gray-400 mr-3"}),i.jsx("span",{className:"font-medium text-gray-900",children:P.cus_name})]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:P.cus_contact||"N/A"})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-sm text-gray-500",children:Pr(P.created_at)})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>_(P),className:"text-gray-400 hover:text-gray-600",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),F&&i.jsx("button",{onClick:()=>S(P),className:"text-blue-400 hover:text-blue-600",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),B&&i.jsx("button",{onClick:()=>E(P),className:"text-red-400 hover:text-red-600",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},P.id))})]})}),T.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(hi,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customers found"}),i.jsx("p",{className:"text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first customer"})]})]}),s&&i.jsx(Gb,{customer:a,mode:l,onClose:()=>o(!1),onSuccess:({type:P,customer:k})=>{k&&p(I=>P==="create"?[k,...I]:P==="update"?I.map(A=>A.id===k.id?{...A,...k}:A):I),g()}})]})},Bm=()=>Promise.resolve({data:[{id:1,name:"Dara Sok",email:"dara.sok@company.com",phone:"+855123456789",position:"Sales Manager",department:"Sales",salary:800,status:"active",hire_date:"2024-01-01",created_at:"2024-01-01T00:00:00Z"},{id:2,name:"Sarah Wilson",email:"sarah.wilson@company.com",phone:"+855123456790",position:"Inventory Specialist",department:"Warehouse",salary:600,status:"active",hire_date:"2024-01-15",created_at:"2024-01-15T00:00:00Z"},{id:3,name:"Mike Chen",email:"mike.chen@company.com",phone:"+855123456791",position:"Customer Service",department:"Support",salary:500,status:"active",hire_date:"2024-02-01",created_at:"2024-02-01T00:00:00Z"}]}),Vl=()=>{const e=localStorage.getItem("token");return e&&e.startsWith("demo-token-")},k0={getAll:()=>Vl()?Bm():ut.get("/staffs"),getById:e=>Vl()?Bm().then(t=>({data:t.data.find(a=>a.id===parseInt(e))})):ut.get(`/staffs/${e}`),create:e=>Vl()?Promise.resolve({data:{id:Date.now(),...e,created_at:new Date().toISOString()}}):e instanceof FormData?el("/staffs",e).then(t=>t.data):ut.post("/staffs",e),update:(e,t)=>Vl()?Promise.resolve({data:{id:parseInt(e),...t,updated_at:new Date().toISOString()}}):t instanceof FormData?(t.append("_method","PUT"),el(`/staffs/${e}`,t).then(r=>r.data)):ut.put(`/staffs/${e}`,t),delete:e=>Vl()?Promise.resolve({data:{message:"Staff deleted successfully"}}):ut.delete(`/staffs/${e}`)},Cc=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await k0.getAll();t(l),s(null)}catch(l){s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},Xb=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await k0.create(a);return Ye.success("Staff created successfully"),o}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to create staff"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},Kb=()=>{const[e,t]=se.useState(!1),r=async({id:a,data:n})=>{var s,o;try{t(!0);const l=await k0.update(a,n);return Ye.success("Staff updated successfully"),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to update staff"),l}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},Jb=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await k0.delete(a);return Ye.success("Staff deleted successfully"),o}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to delete staff"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},Um=e=>{if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(t){const[,o,l,c]=t;return`${c}-${l}-${o}`}const r=new Date(e);if(Number.isNaN(r.getTime()))return"";const a=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");return`${a}-${n}-${s}`},Qb=({staff:e,mode:t,onClose:r,onSuccess:a})=>{const n=t==="view",s=t==="edit",o=Xb(),l=Kb(),{register:c,handleSubmit:u,formState:{errors:d},reset:m}=Xa({defaultValues:{full_name:"",gen:"M",dob:Um(""),position:"",salary:"",stopwork:!1,status:"active",photo:null,...e}});se.useEffect(()=>{e&&m({full_name:e.full_name||"",gen:e.gen||"M",dob:Um(e.dob||""),position:e.position||"",salary:e.salary||"",stopwork:e.stopwork||!1,status:e.status||"active",photo:null})},[e,m]);const g=async x=>{var p,y,_;try{if(console.log("Form data received:",x),!((p=x.full_name)!=null&&p.trim()))throw new Error("Full name is required");if(!x.dob)throw new Error("Date of birth is required");if(!((y=x.position)!=null&&y.trim()))throw new Error("Position is required");if(!x.salary||parseFloat(x.salary)<0)throw new Error("Valid salary is required");const S=x.photo&&x.photo[0];console.log("Has file:",S);let E;if(S){const B=x.photo[0];if(!B.type.startsWith("image/"))throw new Error("Selected file is not an image");const T=new FormData;T.append("full_name",x.full_name||""),T.append("gen",x.gen||"M"),T.append("dob",x.dob||""),T.append("position",x.position||""),T.append("salary",x.salary?parseFloat(x.salary).toString():"0"),x.stopwork&&T.append("stopwork","1"),T.append("status",x.status||"active"),T.append("photo",B),E=T,console.log("Submitting FormData with file")}else E={full_name:x.full_name||"",gen:x.gen||"M",dob:x.dob||"",position:x.position||"",salary:x.salary?parseFloat(x.salary):0,stopwork:!!x.stopwork,status:x.status||"active"},console.log("Submitting JSON data:",E);let C;s?C=await l.mutateAsync({id:e.id,data:E}):C=await o.mutateAsync(E);const F=C&&(((_=C.data)==null?void 0:_.data)||C.data||C)||null;typeof a=="function"&&await a({type:s?"update":"create",staff:F}),r()}catch(S){console.error("Submit failed:",S),alert("Error: "+S.message)}},h=o.isLoading||l.isLoading;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 sticky top-0 bg-white",children:[i.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t==="create"?"Add New Staff":t==="edit"?"Edit Staff":"Staff Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-1",children:i.jsx(zr,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),i.jsxs("form",{onSubmit:u(g),className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),i.jsx("input",{...c("full_name",{required:"Full name is required"}),type:"text",className:"input text-sm sm:text-base",disabled:n,placeholder:"Enter full name"}),d.full_name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.full_name.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender *"}),i.jsxs("select",{...c("gen",{required:"Gender is required"}),className:"input text-sm sm:text-base",disabled:n,children:[i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"})]}),d.gen&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.gen.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth *"}),i.jsx("input",{...c("dob",{required:"Date of birth is required"}),type:"date",className:"input text-sm sm:text-base",disabled:n}),d.dob&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.dob.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position *"}),i.jsx("input",{...c("position",{required:"Position is required"}),type:"text",className:"input text-sm sm:text-base",disabled:n,placeholder:"Enter position"}),d.position&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.position.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary *"}),i.jsx("input",{...c("salary",{required:"Salary is required",min:{value:0,message:"Salary must be positive"}}),type:"number",step:"0.01",className:"input text-sm sm:text-base",disabled:n,placeholder:"0.00"}),d.salary&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.salary.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),i.jsxs("select",{...c("status"),className:"input text-sm sm:text-base",disabled:n,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{...c("stopwork"),type:"checkbox",className:"h-4 w-4 text-blue-600 rounded",disabled:n}),i.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:"Stop/Work"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photo"}),(s||t==="view")&&(e==null?void 0:e.photo)&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Current Photo:"}),i.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-lg overflow-hidden border border-gray-300",children:i.jsx("img",{src:e.photo_url||pi(e.photo,Is.base_image_url),alt:"Staff",className:"w-full h-full object-cover"})})]}),i.jsx("input",{...c("photo"),type:"file",accept:"image/jpeg,image/png,image/jpg,image/gif,image/webp,image/avif",className:"input text-sm sm:text-base",disabled:n}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Supported formats: JPEG, PNG, JPG, GIF, WEBP, AVIF (max 10MB)"})]})]}),!n&&i.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-4 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto order-2 sm:order-1",disabled:h,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-primary w-full sm:w-auto order-1 sm:order-2",disabled:h,children:h?i.jsx(Er,{size:"sm"}):s?"Update Staff":"Create Staff"})]}),n&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto",children:"Close"})})]})]})})},Zb=()=>{var k;const{hasPermission:e}=ha(),[t,r]=se.useState(""),[a,n]=se.useState(null),[s,o]=se.useState(!1),[l,c]=se.useState("create"),[u,d]=se.useState([]),{data:m,isLoading:g,error:h,refetch:x}=Cc(),p=Jb(),y=((k=m==null?void 0:m.data)==null?void 0:k.data)||(m==null?void 0:m.data)||m||[];se.useEffect(()=>{Array.isArray(y)&&y.length>0&&d(y)},[m]);const _=e(["create"]),S=e(["update"]),E=e(["delete"]),C=()=>{n(null),c("create"),o(!0)},F=I=>{n(I),c("edit"),o(!0)},B=I=>{n(I),c("view"),o(!0)},T=async I=>{if(window.confirm(`Are you sure you want to delete "${I.full_name}"?`))try{d(A=>A.filter(b=>b.id!==I.id)),await p.mutateAsync(I.id),x()}catch(A){console.error("Delete failed:",A),x()}};if(g&&!m)return i.jsx(Er,{className:"h-64"});if(h)return i.jsx("div",{className:"text-red-600",children:"Error loading staff"});const P=Array.isArray(u)?u.filter(I=>(I.full_name||"").toLowerCase().includes(t.toLowerCase())||(I.position||"").toLowerCase().includes(t.toLowerCase())):[];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Staff"}),i.jsx("p",{className:"text-gray-600",children:"Manage your staff members"})]}),_&&i.jsxs("button",{onClick:C,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"Add Staff"]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search staff...",value:t,onChange:I=>r(I.target.value),className:"input pl-10"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table",children:[i.jsx("thead",{className:"table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"table-head",children:"Photo"}),i.jsx("th",{className:"table-head",children:"Staff"}),i.jsx("th",{className:"table-head",children:"Position"}),i.jsx("th",{className:"table-head",children:"Gender"}),i.jsx("th",{className:"table-head",children:"Salary"}),i.jsx("th",{className:"table-head",children:"Status"}),i.jsx("th",{className:"table-head",children:"Actions"})]})}),i.jsx("tbody",{children:P.map(I=>i.jsxs("tr",{className:"table-row",children:[i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden border border-gray-200",children:[I.photo_url||I.photo?i.jsx("img",{src:I.photo_url||pi(I.photo,Is.base_image_url),alt:I.full_name,className:"w-full h-full object-cover cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>B(I),onError:A=>{console.log("Staff image failed to load:",A.target.src),A.target.style.display="none";const b=A.target.parentNode.querySelector(".fallback-icon");b&&(b.style.display="flex",b.classList.remove("hidden"))},onLoad:A=>{console.log("Staff image loaded successfully:",A.target.src)}}):null,i.jsx(af,{className:`fallback-icon w-8 h-8 text-gray-400 ${I.photo_url||I.photo?"hidden":""}`})]})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:I.full_name}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Date of Birth : ",Pr(I.dob,"dd/MM/yyyy")]})]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-900",children:I.position})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-900",children:I.gen==="M"?"Male":"Female"})}),i.jsx("td",{className:"table-cell",children:i.jsxs("span",{className:"font-medium text-gray-900",children:["$",I.salary]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:I.status})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>B(I),className:"text-gray-400 hover:text-gray-600",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),S&&i.jsx("button",{onClick:()=>F(I),className:"text-blue-400 hover:text-blue-600",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),E&&i.jsx("button",{onClick:()=>T(I),className:"text-red-400 hover:text-red-600",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},I.id))})]})}),P.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(af,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No staff found"}),i.jsx("p",{className:"text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first staff member"})]})]}),s&&i.jsx(Qb,{staff:a,mode:l,onClose:()=>o(!1),onSuccess:({type:I,staff:A})=>{A&&d(b=>I==="create"?[A,...b]:I==="update"?b.map(R=>R.id===A.id?{...R,...A}:R):b),x()}})]})},pc={getAll:()=>ut.get("/imports",{_t:Date.now()}),getById:e=>ut.get(`/imports/${e}`,{_t:Date.now()}),create:e=>ut.post("/imports",e),update:(e,t)=>ut.put(`/imports/${e}`,t),delete:e=>ut.delete(`/imports/${e}`)},e4=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!0),[s,o]=se.useState(null);return se.useEffect(()=>Oa.subscribe("imports",u=>{r(d=>{var x,p;if(!d)return d;const m=((x=d==null?void 0:d.data)==null?void 0:x.data)||(d==null?void 0:d.data)||d||[],g=new Set(m.map(y=>y.id)),h=u.filter(y=>!g.has(y.id));if(h.length>0){const y=[...h,...m];return(p=d==null?void 0:d.data)!=null&&p.data?{...d,data:{...d.data,data:y}}:d!=null&&d.data?{...d,data:y}:y}return d})}),[]),se.useEffect(()=>{(async()=>{var u;try{n(!0);const d=await pc.getAll(e);r(d);const m=((u=d==null?void 0:d.data)==null?void 0:u.data)||(d==null?void 0:d.data)||d||[];Oa.set("imports",m),o(null)}catch(d){o(d),console.error("Imports fetch failed:",d)}finally{n(!1)}})()},[JSON.stringify(e)]),{data:t,isLoading:a,error:s,refetch:()=>{(async()=>{var u;try{n(!0);const d=await pc.getAll(e);r(d);const m=((u=d==null?void 0:d.data)==null?void 0:u.data)||(d==null?void 0:d.data)||d||[];Oa.set("imports",m),o(null)}catch(d){o(d),console.error("Imports refetch failed:",d)}finally{n(!1)}})()}}},t4=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async s=>{var o,l,c,u,d,m;try{t(!0),a(null);const g={id:`temp-${Date.now()}`,imp_date:s.imp_date,staff_id:s.staff_id,sup_id:s.sup_id,supplier:s.supplier,total:s.total,import_details:((o=s.items)==null?void 0:o.map(p=>({pro_code:p.product_id,pro_name:"",qty:p.qty,price:p.price,amount:p.amount||p.qty*p.price})))||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};Oa.add("imports",g);const h=await pc.create(s),x=((l=h==null?void 0:h.data)==null?void 0:l.data)||(h==null?void 0:h.data)||h;return x&&x.id&&(Oa.remove("imports",g.id),Oa.add("imports",x)),Ye.success("Import created successfully"),h}catch(g){a(g),console.error("Import creation failed:",g),Oa.get("imports").filter(p=>{var y;return(y=p.id)==null?void 0:y.toString().startsWith("temp-")}).forEach(p=>Oa.remove("imports",p.id));const x=((u=(c=g.response)==null?void 0:c.data)==null?void 0:u.message)||((m=(d=g.response)==null?void 0:d.data)==null?void 0:m.error)||"Failed to create import";throw Ye.error(x),g}finally{t(!1)}},isLoading:e,error:r}},r4=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async({id:s,data:o})=>{var l,c,u,d;try{t(!0),a(null);const m=await pc.update(s,o);return Ye.success("Import updated successfully"),m}catch(m){a(m),console.error("Import update failed:",m);const g=((c=(l=m.response)==null?void 0:l.data)==null?void 0:c.message)||((d=(u=m.response)==null?void 0:u.data)==null?void 0:d.error)||"Failed to update import";throw Ye.error(g),m}finally{t(!1)}},isLoading:e,error:r}},a4=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(null);return{mutateAsync:async s=>{var o,l,c,u;try{t(!0),a(null);const d=await pc.delete(s);return Ye.success("Import deleted successfully"),d}catch(d){a(d),console.error("Import deletion failed:",d);const m=((l=(o=d.response)==null?void 0:o.data)==null?void 0:l.message)||((u=(c=d.response)==null?void 0:c.data)==null?void 0:u.error)||"Failed to delete import";throw Ye.error(m),d}finally{t(!1)}},isLoading:e,error:r}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var t0={};t0.version="0.18.5";var J1=1252,n4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Q1=function(e){n4.indexOf(e)!=-1&&(J1=e)};function s4(){Q1(1252)}var xc=function(e){Q1(e)};function i4(){xc(1200),s4()}function o4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ju=function(t){return String.fromCharCode(t)},qm=function(t){return String.fromCharCode(t)},Ri,oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gc(e){for(var t="",r=0,a=0,n=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,a=e.charCodeAt(u++),o=(r&3)<<4|a>>4,n=e.charCodeAt(u++),l=(a&15)<<2|n>>6,c=n&63,isNaN(a)?l=c=64:isNaN(n)&&(c=64),t+=oi.charAt(s)+oi.charAt(o)+oi.charAt(l)+oi.charAt(c);return t}function Rs(e){var t="",r=0,a=0,n=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=oi.indexOf(e.charAt(u++)),o=oi.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=oi.indexOf(e.charAt(u++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=oi.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var rr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Bs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Xi(e){return rr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wm(e){return rr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qn=function(t){return rr?Bs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function D0(e){if(typeof ArrayBuffer>"u")return Qn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Pc(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function l4(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var ba=rr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Bs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function c4(e){for(var t=[],r=0,a=e.length+250,n=Xi(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Xi(65535),a=65530)}return t.push(n.slice(0,r)),ba(t)}var rc=/\u0000/g,Eu=/[\u0001-\u0006]/g;function Yo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Zn(e,t){var r=""+e;return r.length>=t?r:Or("0",t-r.length)+r}function Qf(e,t){var r=""+e;return r.length>=t?r:Or(" ",t-r.length)+r}function r0(e,t){var r=""+e;return r.length>=t?r:r+Or(" ",t-r.length)}function u4(e,t){var r=""+Math.round(e);return r.length>=t?r:Or("0",t-r.length)+r}function d4(e,t){var r=""+e;return r.length>=t?r:Or("0",t-r.length)+r}var Hm=Math.pow(2,32);function ko(e,t){if(e>Hm||e<-Hm)return u4(e,t);var r=Math.round(e);return d4(r,t)}function a0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var $m=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Md=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function f4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ir={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},h4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function n0(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,o=1,l=0,c=1,u=0,d=0,m=Math.floor(n);u<t&&(m=Math.floor(n),l=m*o+s,d=m*u+c,!(n-m<5e-8));)n=1/(n-m),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,a*l,d];var g=Math.floor(a*l/d);return[g,a*l-g*d,d]}function Tu(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,o=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),a<60&&(s=(s+6)%7),r&&(s=w4(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=s,l}var Z1=new Date(1899,11,31,0,0,0),m4=Z1.getTime(),p4=new Date(1900,2,1,0,0,0);function ex(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=p4&&(r+=24*60*60*1e3),(r-(m4+(e.getTimezoneOffset()-Z1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Zf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function x4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function g4(e){var t=e<0?12:11,r=Zf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function v4(e){var t=Zf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function y4(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=g4(e):t===10?r=e.toFixed(10).substr(0,12):r=v4(e),Zf(x4(r.toUpperCase()))}function gf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):y4(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gi(14,ex(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function w4(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function b4(e,t,r,a){var n="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Md[r.m-1][1];case 5:return Md[r.m-1][0];default:return Md[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return $m[r.q][0];default:return $m[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Zn(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(n=Zn(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Zn(c,u):"";return d}function li(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var tx=/%/g;function N4(e,t,r){var a=t.replace(tx,""),n=t.length-a.length;return ks(e,a,r*Math.pow(10,2*n))+Or("%",n)}function _4(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ks(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function rx(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+rx(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+s)%n)+"."+d.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ax=/# (\?+)( ?)\/( ?)(\d+)/;function S4(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),o=n-s*a,l=a;return r+(s===0?"":""+s)+" "+(o===0?Or(" ",e[1].length+1+e[4].length):Qf(o,e[1].length)+e[2]+"/"+e[3]+Zn(l,e[4].length))}function A4(e,t,r){return r+(t===0?"":""+t)+Or(" ",e[1].length+2+e[4].length)}var nx=/^#*0*\.([0#]+)/,sx=/\).*[0#]/,ix=/\(###\) ###\\?-####/;function za(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Vm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Gm(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function j4(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function E4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Dn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sx)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dn("n",a,r):"("+Dn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _4(e,t,r);if(t.indexOf("%")!==-1)return N4(e,t,r);if(t.indexOf("E")!==-1)return rx(t,r);if(t.charCodeAt(0)===36)return"$"+Dn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ko(c,t.length);if(t.match(/^[#?]+$/))return n=ko(r,0),n==="0"&&(n=""),n.length>t.length?n:za(t.substr(0,t.length-n.length))+n;if(s=t.match(ax))return S4(s,c,u);if(t.match(/^#+0+$/))return u+ko(c,t.length-t.indexOf("0"));if(s=t.match(nx))return n=Vm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+za(s[1])).replace(/\.$/,"."+za(s[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Or("0",za(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Vm(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+li(ko(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dn(e,t,-r):li(""+(Math.floor(r)+j4(r,s[1].length)))+"."+Zn(Gm(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Dn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Yo(Dn(e,t.replace(/[\\-]/g,""),r)),o=0,Yo(Yo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<n.length?n.charAt(o++):x==="0"?"0":""}));if(t.match(ix))return n=Dn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=n0(c,Math.pow(10,o)-1,!1),n=""+u,d=ks("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],d=r0(l[2],o),d.length<s[4].length&&(d=za(s[4].substr(s[4].length-d.length))+d),n+=d,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=n0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Qf(l[1],o)+s[2]+"/"+s[3]+r0(l[2],o):Or(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=ko(r,0),t.length<=n.length?n:za(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,g=t.length-n.length-m;return za(t.substr(0,m)+n+t.substr(t.length-g))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Gm(r,s[1].length),r<0?"-"+Dn(e,t,-r):li(E4(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Zn(0,3-x.length):"")+x})+"."+Zn(o,s[1].length);switch(t){case"###,##0.00":return Dn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=li(ko(c,0));return h!=="0"?u+h:"";case"###,###.00":return Dn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function T4(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ks(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function C4(e,t,r){var a=t.replace(tx,""),n=t.length-a.length;return ks(e,a,r*Math.pow(10,2*n))+Or("%",n)}function ox(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ox(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(n+s)%n)+"."+d.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ds(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sx)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ds("n",a,r):"("+ds("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return T4(e,t,r);if(t.indexOf("%")!==-1)return C4(e,t,r);if(t.indexOf("E")!==-1)return ox(t,r);if(t.charCodeAt(0)===36)return"$"+ds(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Zn(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:za(t.substr(0,t.length-n.length))+n;if(s=t.match(ax))return A4(s,c,u);if(t.match(/^#+0+$/))return u+Zn(c,t.length-t.indexOf("0"));if(s=t.match(nx))return n=(""+r).replace(/^([^\.]+)$/,"$1."+za(s[1])).replace(/\.$/,"."+za(s[1])),n=n.replace(/\.(\d*)$/,function(x,p){return"."+p+Or("0",za(s[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+li(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ds(e,t,-r):li(""+r)+"."+Or("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ds(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Yo(ds(e,t.replace(/[\\-]/g,""),r)),o=0,Yo(Yo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<n.length?n.charAt(o++):x==="0"?"0":""}));if(t.match(ix))return n=ds(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=n0(c,Math.pow(10,o)-1,!1),n=""+u,d=ks("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],d=r0(l[2],o),d.length<s[4].length&&(d=za(s[4].substr(s[4].length-d.length))+d),n+=d,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=n0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Qf(l[1],o)+s[2]+"/"+s[3]+r0(l[2],o):Or(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:za(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var m=t.indexOf(".")-o,g=t.length-n.length-m;return za(t.substr(0,m)+n+t.substr(t.length-g))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ds(e,t,-r):li(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Zn(0,3-x.length):"")+x})+"."+Zn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=li(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return ds(e,t.slice(0,t.lastIndexOf(".")),r)+za(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ks(e,t,r){return(r|0)===r?ds(e,t,r):Dn(e,t,r)}function P4(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var lx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cx(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":a0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(lx))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function L4(e,t,r,a){for(var n=[],s="",o=0,l="",c="t",u,d,m,g="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!a0(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(m=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(m);n[n.length]={t:"t",v:s},++o;break;case"\\":var h=e.charAt(++o),x=h==="("||h===")"?h:"t";n[n.length]={t:x,v:h},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Tu(t,r,e.charAt(o+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Tu(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),n[n.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Tu(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,g="h"):(p.t="t",++o),u==null&&p.t==="T")return"";n[n.length]=p,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(lx)){if(u==null&&(u=Tu(t,r),u==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",cx(e)||(n[n.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;n[n.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;n[n.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var y=0,_=0,S;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=g,c="h",y<1&&(y=1);break;case"s":(S=n[o].v.match(/\.0+$/))&&(_=Math.max(_,S[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&n[o].v.match(/[Hh]/)&&(y=1),y<2&&n[o].v.match(/[Mm]/)&&(y=2),y<3&&n[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",C;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=b4(n[o].t.charCodeAt(0),n[o].v,u,_),n[o].t="t";break;case"n":case"?":for(C=o+1;n[C]!=null&&((l=n[C].t)==="?"||l==="D"||(l===" "||l==="t")&&n[C+1]!=null&&(n[C+1].t==="?"||n[C+1].t==="t"&&n[C+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[C].v==="/"||n[C].v===" "&&n[C+1]!=null&&n[C+1].t=="?"));)n[o].v+=n[C].v,n[C]={v:"",t:";"},++C;E+=n[o].v,o=C-1;break;case"G":n[o].t="t",n[o].v=gf(t,r);break}var F="",B,T;if(E.length>0){E.charCodeAt(0)==40?(B=t<0&&E.charCodeAt(0)===45?-t:t,T=ks("n",E,B)):(B=t<0&&a>1?-t:t,T=ks("n",E,B),B<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),C=T.length-1;var P=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){P=o;break}var k=n.length;if(P===n.length&&T.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(C>=n[o].v.length-1?(C-=n[o].v.length,n[o].v=T.substr(C+1,n[o].v.length)):C<0?n[o].v="":(n[o].v=T.substr(0,C+1),C=-1),n[o].t="t",k=o);C>=0&&k<n.length&&(n[k].v=T.substr(0,C+1)+n[k].v)}else if(P!==n.length&&T.indexOf("E")===-1){for(C=T.indexOf(".")-1,o=P;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===P?n[o].v.indexOf(".")-1:n[o].v.length-1,F=n[o].v.substr(d+1);d>=0;--d)C>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(F=T.charAt(C--)+F);n[o].v=F,n[o].t="t",k=o}for(C>=0&&k<n.length&&(n[k].v=T.substr(0,C+1)+n[k].v),C=T.indexOf(".")+1,o=P;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==P)){for(d=n[o].v.indexOf(".")>-1&&o===P?n[o].v.indexOf(".")+1:0,F=n[o].v.substr(0,d);d<n[o].v.length;++d)C<T.length&&(F+=T.charAt(C++));n[o].v=F,n[o].t="t",k=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(B=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=ks(n[o].t,n[o].v,B),n[o].t="t");var I="";for(o=0;o!==n.length;++o)n[o]!=null&&(I+=n[o].v);return I}var Ym=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Xm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function F4(e,t){var r=P4(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Ym),l=r[1].match(Ym);return Xm(t,o)?[a,r[0]]:Xm(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,s]}function gi(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ir)[e],a==null&&(a=r.table&&r.table[zm[e]]||Ir[zm[e]]),a==null&&(a=h4[e]||"General");break}if(a0(a,0))return gf(t,r);t instanceof Date&&(t=ex(t,r.date1904));var n=F4(a,t);if(a0(n[1]))return gf(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return L4(n[1],t,r,n[0])}function ux(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ir[r]==null){t<0&&(t=r);continue}if(Ir[r]==e){t=r;break}}t<0&&(t=391)}return Ir[t]=e,t}function O0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ux(e[t],t)}function I0(){Ir=f4()}var dx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k4(e){var t=typeof e=="number"?Ir[e]:e;return t=t.replace(dx,"(\\d+)"),new RegExp("^"+t+"$")}function D4(e,t,r){var a=-1,n=-1,s=-1,o=-1,l=-1,c=-1;(t.match(dx)||[]).forEach(function(m,g){var h=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":a=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:n=h;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:a==-1&&n==-1&&s==-1?d:u+"T"+d}var O4=function(){var e={};e.version="1.2.0";function t(){for(var T=0,P=new Array(256),k=0;k!=256;++k)T=k,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,P[k]=T;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function a(T){var P=0,k=0,I=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)A[I]=T[I];for(I=0;I!=256;++I)for(k=T[I],P=256+I;P<4096;P+=256)k=A[P]=k>>>8^T[k&255];var b=[];for(I=1;I!=16;++I)b[I-1]=typeof Int32Array<"u"?A.subarray(I*256,I*256+256):A.slice(I*256,I*256+256);return b}var n=a(r),s=n[0],o=n[1],l=n[2],c=n[3],u=n[4],d=n[5],m=n[6],g=n[7],h=n[8],x=n[9],p=n[10],y=n[11],_=n[12],S=n[13],E=n[14];function C(T,P){for(var k=P^-1,I=0,A=T.length;I<A;)k=k>>>8^r[(k^T.charCodeAt(I++))&255];return~k}function F(T,P){for(var k=P^-1,I=T.length-15,A=0;A<I;)k=E[T[A++]^k&255]^S[T[A++]^k>>8&255]^_[T[A++]^k>>16&255]^y[T[A++]^k>>>24]^p[T[A++]]^x[T[A++]]^h[T[A++]]^g[T[A++]]^m[T[A++]]^d[T[A++]]^u[T[A++]]^c[T[A++]]^l[T[A++]]^o[T[A++]]^s[T[A++]]^r[T[A++]];for(I+=15;A<I;)k=k>>>8^r[(k^T[A++])&255];return~k}function B(T,P){for(var k=P^-1,I=0,A=T.length,b=0,R=0;I<A;)b=T.charCodeAt(I++),b<128?k=k>>>8^r[(k^b)&255]:b<2048?(k=k>>>8^r[(k^(192|b>>6&31))&255],k=k>>>8^r[(k^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,R=T.charCodeAt(I++)&1023,k=k>>>8^r[(k^(240|b>>8&7))&255],k=k>>>8^r[(k^(128|b>>2&63))&255],k=k>>>8^r[(k^(128|R>>6&15|(b&3)<<4))&255],k=k>>>8^r[(k^(128|R&63))&255]):(k=k>>>8^r[(k^(224|b>>12&15))&255],k=k>>>8^r[(k^(128|b>>6&63))&255],k=k>>>8^r[(k^(128|b&63))&255]);return~k}return e.table=r,e.bstr=C,e.buf=F,e.str=B,e}(),mr=function(){var t={};t.version="1.2.1";function r(K,fe){for(var ae=K.split("/"),re=fe.split("/"),ce=0,de=0,Ae=Math.min(ae.length,re.length);ce<Ae;++ce){if(de=ae[ce].length-re[ce].length)return de;if(ae[ce]!=re[ce])return ae[ce]<re[ce]?-1:1}return ae.length-re.length}function a(K){if(K.charAt(K.length-1)=="/")return K.slice(0,-1).indexOf("/")===-1?K:a(K.slice(0,-1));var fe=K.lastIndexOf("/");return fe===-1?K:K.slice(0,fe+1)}function n(K){if(K.charAt(K.length-1)=="/")return n(K.slice(0,-1));var fe=K.lastIndexOf("/");return fe===-1?K:K.slice(fe+1)}function s(K,fe){typeof fe=="string"&&(fe=new Date(fe));var ae=fe.getHours();ae=ae<<6|fe.getMinutes(),ae=ae<<5|fe.getSeconds()>>>1,K.write_shift(2,ae);var re=fe.getFullYear()-1980;re=re<<4|fe.getMonth()+1,re=re<<5|fe.getDate(),K.write_shift(2,re)}function o(K){var fe=K.read_shift(2)&65535,ae=K.read_shift(2)&65535,re=new Date,ce=ae&31;ae>>>=5;var de=ae&15;ae>>>=4,re.setMilliseconds(0),re.setFullYear(ae+1980),re.setMonth(de-1),re.setDate(ce);var Ae=fe&31;fe>>>=5;var Me=fe&63;return fe>>>=6,re.setHours(fe),re.setMinutes(Me),re.setSeconds(Ae<<1),re}function l(K){wn(K,0);for(var fe={},ae=0;K.l<=K.length-4;){var re=K.read_shift(2),ce=K.read_shift(2),de=K.l+ce,Ae={};switch(re){case 21589:ae=K.read_shift(1),ae&1&&(Ae.mtime=K.read_shift(4)),ce>5&&(ae&2&&(Ae.atime=K.read_shift(4)),ae&4&&(Ae.ctime=K.read_shift(4))),Ae.mtime&&(Ae.mt=new Date(Ae.mtime*1e3));break}K.l=de,fe[re]=Ae}return fe}var c;function u(){return c||(c={})}function d(K,fe){if(K[0]==80&&K[1]==75)return nr(K,fe);if((K[0]|32)==109&&(K[1]|32)==105)return ja(K,fe);if(K.length<512)throw new Error("CFB file size "+K.length+" < 512");var ae=3,re=512,ce=0,de=0,Ae=0,Me=0,Ee=0,Te=[],Le=K.slice(0,512);wn(Le,0);var tt=m(Le);switch(ae=tt[0],ae){case 3:re=512;break;case 4:re=4096;break;case 0:if(tt[1]==0)return nr(K,fe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}re!==512&&(Le=K.slice(0,re),wn(Le,28));var it=K.slice(0,re);g(Le,ae);var pt=Le.read_shift(4,"i");if(ae===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);Le.l+=4,Ae=Le.read_shift(4,"i"),Le.l+=4,Le.chk("00100000","Mini Stream Cutoff Size: "),Me=Le.read_shift(4,"i"),ce=Le.read_shift(4,"i"),Ee=Le.read_shift(4,"i"),de=Le.read_shift(4,"i");for(var at=-1,ht=0;ht<109&&(at=Le.read_shift(4,"i"),!(at<0));++ht)Te[ht]=at;var Lt=h(K,re);y(Ee,de,Lt,re,Te);var Jt=S(Lt,Ae,Te,re);Jt[Ae].name="!Directory",ce>0&&Me!==R&&(Jt[Me].name="!MiniFAT"),Jt[Te[0]].name="!FAT",Jt.fat_addrs=Te,Jt.ssz=re;var er={},Tr=[],Ja=[],he=[];E(Ae,Jt,Lt,Tr,ce,er,Ja,Me),x(Ja,he,Tr),Tr.shift();var ke={FileIndex:Ja,FullPaths:he};return fe&&fe.raw&&(ke.raw={header:it,sectors:Lt}),ke}function m(K){if(K[K.l]==80&&K[K.l+1]==75)return[0,0];K.chk(W,"Header Signature: "),K.l+=16;var fe=K.read_shift(2,"u");return[K.read_shift(2,"u"),fe]}function g(K,fe){var ae=9;switch(K.l+=2,ae=K.read_shift(2)){case 9:if(fe!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(fe!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}K.chk("0600","Mini Sector Shift: "),K.chk("000000000000","Reserved: ")}function h(K,fe){for(var ae=Math.ceil(K.length/fe)-1,re=[],ce=1;ce<ae;++ce)re[ce-1]=K.slice(ce*fe,(ce+1)*fe);return re[ae-1]=K.slice(ae*fe),re}function x(K,fe,ae){for(var re=0,ce=0,de=0,Ae=0,Me=0,Ee=ae.length,Te=[],Le=[];re<Ee;++re)Te[re]=Le[re]=re,fe[re]=ae[re];for(;Me<Le.length;++Me)re=Le[Me],ce=K[re].L,de=K[re].R,Ae=K[re].C,Te[re]===re&&(ce!==-1&&Te[ce]!==ce&&(Te[re]=Te[ce]),de!==-1&&Te[de]!==de&&(Te[re]=Te[de])),Ae!==-1&&(Te[Ae]=re),ce!==-1&&re!=Te[re]&&(Te[ce]=Te[re],Le.lastIndexOf(ce)<Me&&Le.push(ce)),de!==-1&&re!=Te[re]&&(Te[de]=Te[re],Le.lastIndexOf(de)<Me&&Le.push(de));for(re=1;re<Ee;++re)Te[re]===re&&(de!==-1&&Te[de]!==de?Te[re]=Te[de]:ce!==-1&&Te[ce]!==ce&&(Te[re]=Te[ce]));for(re=1;re<Ee;++re)if(K[re].type!==0){if(Me=re,Me!=Te[Me])do Me=Te[Me],fe[re]=fe[Me]+"/"+fe[re];while(Me!==0&&Te[Me]!==-1&&Me!=Te[Me]);Te[re]=-1}for(fe[0]+="/",re=1;re<Ee;++re)K[re].type!==2&&(fe[re]+="/")}function p(K,fe,ae){for(var re=K.start,ce=K.size,de=[],Ae=re;ae&&ce>0&&Ae>=0;)de.push(fe.slice(Ae*b,Ae*b+b)),ce-=b,Ae=Mi(ae,Ae*4);return de.length===0?He(0):ba(de).slice(0,K.size)}function y(K,fe,ae,re,ce){var de=R;if(K===R){if(fe!==0)throw new Error("DIFAT chain shorter than expected")}else if(K!==-1){var Ae=ae[K],Me=(re>>>2)-1;if(!Ae)return;for(var Ee=0;Ee<Me&&(de=Mi(Ae,Ee*4))!==R;++Ee)ce.push(de);y(Mi(Ae,re-4),fe-1,ae,re,ce)}}function _(K,fe,ae,re,ce){var de=[],Ae=[];ce||(ce=[]);var Me=re-1,Ee=0,Te=0;for(Ee=fe;Ee>=0;){ce[Ee]=!0,de[de.length]=Ee,Ae.push(K[Ee]);var Le=ae[Math.floor(Ee*4/re)];if(Te=Ee*4&Me,re<4+Te)throw new Error("FAT boundary crossed: "+Ee+" 4 "+re);if(!K[Le])break;Ee=Mi(K[Le],Te)}return{nodes:de,data:ap([Ae])}}function S(K,fe,ae,re){var ce=K.length,de=[],Ae=[],Me=[],Ee=[],Te=re-1,Le=0,tt=0,it=0,pt=0;for(Le=0;Le<ce;++Le)if(Me=[],it=Le+fe,it>=ce&&(it-=ce),!Ae[it]){Ee=[];var at=[];for(tt=it;tt>=0;){at[tt]=!0,Ae[tt]=!0,Me[Me.length]=tt,Ee.push(K[tt]);var ht=ae[Math.floor(tt*4/re)];if(pt=tt*4&Te,re<4+pt)throw new Error("FAT boundary crossed: "+tt+" 4 "+re);if(!K[ht]||(tt=Mi(K[ht],pt),at[tt]))break}de[it]={nodes:Me,data:ap([Ee])}}return de}function E(K,fe,ae,re,ce,de,Ae,Me){for(var Ee=0,Te=re.length?2:0,Le=fe[K].data,tt=0,it=0,pt;tt<Le.length;tt+=128){var at=Le.slice(tt,tt+128);wn(at,64),it=at.read_shift(2),pt=nh(at,0,it-Te),re.push(pt);var ht={name:pt,type:at.read_shift(1),color:at.read_shift(1),L:at.read_shift(4,"i"),R:at.read_shift(4,"i"),C:at.read_shift(4,"i"),clsid:at.read_shift(16),state:at.read_shift(4,"i"),start:0,size:0},Lt=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Lt!==0&&(ht.ct=C(at,at.l-8));var Jt=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Jt!==0&&(ht.mt=C(at,at.l-8)),ht.start=at.read_shift(4,"i"),ht.size=at.read_shift(4,"i"),ht.size<0&&ht.start<0&&(ht.size=ht.type=0,ht.start=R,ht.name=""),ht.type===5?(Ee=ht.start,ce>0&&Ee!==R&&(fe[Ee].name="!StreamData")):ht.size>=4096?(ht.storage="fat",fe[ht.start]===void 0&&(fe[ht.start]=_(ae,ht.start,fe.fat_addrs,fe.ssz)),fe[ht.start].name=ht.name,ht.content=fe[ht.start].data.slice(0,ht.size)):(ht.storage="minifat",ht.size<0?ht.size=0:Ee!==R&&ht.start!==R&&fe[Ee]&&(ht.content=p(ht,fe[Ee].data,(fe[Me]||{}).data))),ht.content&&wn(ht.content,0),de[pt]=ht,Ae.push(ht)}}function C(K,fe){return new Date((Nn(K,fe+4)/1e7*Math.pow(2,32)+Nn(K,fe)/1e7-11644473600)*1e3)}function F(K,fe){return u(),d(c.readFileSync(K),fe)}function B(K,fe){var ae=fe&&fe.type;switch(ae||rr&&Buffer.isBuffer(K)&&(ae="buffer"),ae||"base64"){case"file":return F(K,fe);case"base64":return d(Qn(Rs(K)),fe);case"binary":return d(Qn(K),fe)}return d(K,fe)}function T(K,fe){var ae=fe||{},re=ae.root||"Root Entry";if(K.FullPaths||(K.FullPaths=[]),K.FileIndex||(K.FileIndex=[]),K.FullPaths.length!==K.FileIndex.length)throw new Error("inconsistent CFB structure");K.FullPaths.length===0&&(K.FullPaths[0]=re+"/",K.FileIndex[0]={name:re,type:5}),ae.CLSID&&(K.FileIndex[0].clsid=ae.CLSID),P(K)}function P(K){var fe="Sh33tJ5";if(!mr.find(K,"/"+fe)){var ae=He(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,K.FileIndex.push({name:fe,type:2,content:ae,size:4,L:69,R:69,C:69}),K.FullPaths.push(K.FullPaths[0]+fe),k(K)}}function k(K,fe){T(K);for(var ae=!1,re=!1,ce=K.FullPaths.length-1;ce>=0;--ce){var de=K.FileIndex[ce];switch(de.type){case 0:re?ae=!0:(K.FileIndex.pop(),K.FullPaths.pop());break;case 1:case 2:case 5:re=!0,isNaN(de.R*de.L*de.C)&&(ae=!0),de.R>-1&&de.L>-1&&de.R==de.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!fe)){var Ae=new Date(1987,1,19),Me=0,Ee=Object.create?Object.create(null):{},Te=[];for(ce=0;ce<K.FullPaths.length;++ce)Ee[K.FullPaths[ce]]=!0,K.FileIndex[ce].type!==0&&Te.push([K.FullPaths[ce],K.FileIndex[ce]]);for(ce=0;ce<Te.length;++ce){var Le=a(Te[ce][0]);re=Ee[Le],re||(Te.push([Le,{name:n(Le).replace("/",""),type:1,clsid:q,ct:Ae,mt:Ae,content:null}]),Ee[Le]=!0)}for(Te.sort(function(pt,at){return r(pt[0],at[0])}),K.FullPaths=[],K.FileIndex=[],ce=0;ce<Te.length;++ce)K.FullPaths[ce]=Te[ce][0],K.FileIndex[ce]=Te[ce][1];for(ce=0;ce<Te.length;++ce){var tt=K.FileIndex[ce],it=K.FullPaths[ce];if(tt.name=n(it).replace("/",""),tt.L=tt.R=tt.C=-(tt.color=1),tt.size=tt.content?tt.content.length:0,tt.start=0,tt.clsid=tt.clsid||q,ce===0)tt.C=Te.length>1?1:-1,tt.size=0,tt.type=5;else if(it.slice(-1)=="/"){for(Me=ce+1;Me<Te.length&&a(K.FullPaths[Me])!=it;++Me);for(tt.C=Me>=Te.length?-1:Me,Me=ce+1;Me<Te.length&&a(K.FullPaths[Me])!=a(it);++Me);tt.R=Me>=Te.length?-1:Me,tt.type=1}else a(K.FullPaths[ce+1]||"")==a(it)&&(tt.R=ce+1),tt.type=2}}}function I(K,fe){var ae=fe||{};if(ae.fileType=="mad")return _t(K,ae);switch(k(K),ae.fileType){case"zip":return sr(K,ae)}var re=function(pt){for(var at=0,ht=0,Lt=0;Lt<pt.FileIndex.length;++Lt){var Jt=pt.FileIndex[Lt];if(Jt.content){var er=Jt.content.length;er>0&&(er<4096?at+=er+63>>6:ht+=er+511>>9)}}for(var Tr=pt.FullPaths.length+3>>2,Ja=at+7>>3,he=at+127>>7,ke=Ja+ht+Tr+he,nt=ke+127>>7,St=nt<=109?0:Math.ceil((nt-109)/127);ke+nt+St+127>>7>nt;)St=++nt<=109?0:Math.ceil((nt-109)/127);var Ke=[1,St,nt,he,Tr,ht,at,0];return pt.FileIndex[0].size=at<<6,Ke[7]=(pt.FileIndex[0].start=Ke[0]+Ke[1]+Ke[2]+Ke[3]+Ke[4]+Ke[5])+(Ke[6]+7>>3),Ke}(K),ce=He(re[7]<<9),de=0,Ae=0;{for(de=0;de<8;++de)ce.write_shift(1,Y[de]);for(de=0;de<8;++de)ce.write_shift(2,0);for(ce.write_shift(2,62),ce.write_shift(2,3),ce.write_shift(2,65534),ce.write_shift(2,9),ce.write_shift(2,6),de=0;de<3;++de)ce.write_shift(2,0);for(ce.write_shift(4,0),ce.write_shift(4,re[2]),ce.write_shift(4,re[0]+re[1]+re[2]+re[3]-1),ce.write_shift(4,0),ce.write_shift(4,4096),ce.write_shift(4,re[3]?re[0]+re[1]+re[2]-1:R),ce.write_shift(4,re[3]),ce.write_shift(-4,re[1]?re[0]-1:R),ce.write_shift(4,re[1]),de=0;de<109;++de)ce.write_shift(-4,de<re[2]?re[1]+de:-1)}if(re[1])for(Ae=0;Ae<re[1];++Ae){for(;de<236+Ae*127;++de)ce.write_shift(-4,de<re[2]?re[1]+de:-1);ce.write_shift(-4,Ae===re[1]-1?R:Ae+1)}var Me=function(pt){for(Ae+=pt;de<Ae-1;++de)ce.write_shift(-4,de+1);pt&&(++de,ce.write_shift(-4,R))};for(Ae=de=0,Ae+=re[1];de<Ae;++de)ce.write_shift(-4,U.DIFSECT);for(Ae+=re[2];de<Ae;++de)ce.write_shift(-4,U.FATSECT);Me(re[3]),Me(re[4]);for(var Ee=0,Te=0,Le=K.FileIndex[0];Ee<K.FileIndex.length;++Ee)Le=K.FileIndex[Ee],Le.content&&(Te=Le.content.length,!(Te<4096)&&(Le.start=Ae,Me(Te+511>>9)));for(Me(re[6]+7>>3);ce.l&511;)ce.write_shift(-4,U.ENDOFCHAIN);for(Ae=de=0,Ee=0;Ee<K.FileIndex.length;++Ee)Le=K.FileIndex[Ee],Le.content&&(Te=Le.content.length,!(!Te||Te>=4096)&&(Le.start=Ae,Me(Te+63>>6)));for(;ce.l&511;)ce.write_shift(-4,U.ENDOFCHAIN);for(de=0;de<re[4]<<2;++de){var tt=K.FullPaths[de];if(!tt||tt.length===0){for(Ee=0;Ee<17;++Ee)ce.write_shift(4,0);for(Ee=0;Ee<3;++Ee)ce.write_shift(4,-1);for(Ee=0;Ee<12;++Ee)ce.write_shift(4,0);continue}Le=K.FileIndex[de],de===0&&(Le.start=Le.size?Le.start-1:R);var it=de===0&&ae.root||Le.name;if(Te=2*(it.length+1),ce.write_shift(64,it,"utf16le"),ce.write_shift(2,Te),ce.write_shift(1,Le.type),ce.write_shift(1,Le.color),ce.write_shift(-4,Le.L),ce.write_shift(-4,Le.R),ce.write_shift(-4,Le.C),Le.clsid)ce.write_shift(16,Le.clsid,"hex");else for(Ee=0;Ee<4;++Ee)ce.write_shift(4,0);ce.write_shift(4,Le.state||0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,Le.start),ce.write_shift(4,Le.size),ce.write_shift(4,0)}for(de=1;de<K.FileIndex.length;++de)if(Le=K.FileIndex[de],Le.size>=4096)if(ce.l=Le.start+1<<9,rr&&Buffer.isBuffer(Le.content))Le.content.copy(ce,ce.l,0,Le.size),ce.l+=Le.size+511&-512;else{for(Ee=0;Ee<Le.size;++Ee)ce.write_shift(1,Le.content[Ee]);for(;Ee&511;++Ee)ce.write_shift(1,0)}for(de=1;de<K.FileIndex.length;++de)if(Le=K.FileIndex[de],Le.size>0&&Le.size<4096)if(rr&&Buffer.isBuffer(Le.content))Le.content.copy(ce,ce.l,0,Le.size),ce.l+=Le.size+63&-64;else{for(Ee=0;Ee<Le.size;++Ee)ce.write_shift(1,Le.content[Ee]);for(;Ee&63;++Ee)ce.write_shift(1,0)}if(rr)ce.l=ce.length;else for(;ce.l<ce.length;)ce.write_shift(1,0);return ce}function A(K,fe){var ae=K.FullPaths.map(function(Ee){return Ee.toUpperCase()}),re=ae.map(function(Ee){var Te=Ee.split("/");return Te[Te.length-(Ee.slice(-1)=="/"?2:1)]}),ce=!1;fe.charCodeAt(0)===47?(ce=!0,fe=ae[0].slice(0,-1)+fe):ce=fe.indexOf("/")!==-1;var de=fe.toUpperCase(),Ae=ce===!0?ae.indexOf(de):re.indexOf(de);if(Ae!==-1)return K.FileIndex[Ae];var Me=!de.match(Eu);for(de=de.replace(rc,""),Me&&(de=de.replace(Eu,"!")),Ae=0;Ae<ae.length;++Ae)if((Me?ae[Ae].replace(Eu,"!"):ae[Ae]).replace(rc,"")==de||(Me?re[Ae].replace(Eu,"!"):re[Ae]).replace(rc,"")==de)return K.FileIndex[Ae];return null}var b=64,R=-2,W="d0cf11e0a1b11ae1",Y=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",U={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(K,fe,ae){u();var re=I(K,ae);c.writeFileSync(fe,re)}function Q(K){for(var fe=new Array(K.length),ae=0;ae<K.length;++ae)fe[ae]=String.fromCharCode(K[ae]);return fe.join("")}function ne(K,fe){var ae=I(K,fe);switch(fe&&fe.type||"buffer"){case"file":return u(),c.writeFileSync(fe.filename,ae),ae;case"binary":return typeof ae=="string"?ae:Q(ae);case"base64":return gc(typeof ae=="string"?ae:Q(ae));case"buffer":if(rr)return Buffer.isBuffer(ae)?ae:Bs(ae);case"array":return typeof ae=="string"?Qn(ae):ae}return ae}var ee;function N(K){try{var fe=K.InflateRaw,ae=new fe;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)ee=K;else throw new Error("zlib does not expose bytesRead")}catch(re){console.error("cannot use native zlib: "+(re.message||re))}}function L(K,fe){if(!ee)return Ot(K,fe);var ae=ee.InflateRaw,re=new ae,ce=re._processChunk(K.slice(K.l),re._finishFlushFlag);return K.l+=re.bytesRead,ce}function D(K){return ee?ee.deflateRawSync(K):kt(K)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(K){var fe=(K<<1|K<<11)&139536|(K<<5|K<<15)&558144;return(fe>>16|fe>>8|fe)&255}for(var me=typeof Uint8Array<"u",Ne=me?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)Ne[Oe]=pe(Oe);function Ie(K,fe){var ae=Ne[K&255];return fe<=8?ae>>>8-fe:(ae=ae<<8|Ne[K>>8&255],fe<=16?ae>>>16-fe:(ae=ae<<8|Ne[K>>16&255],ae>>>24-fe))}function Ze(K,fe){var ae=fe&7,re=fe>>>3;return(K[re]|(ae<=6?0:K[re+1]<<8))>>>ae&3}function st(K,fe){var ae=fe&7,re=fe>>>3;return(K[re]|(ae<=5?0:K[re+1]<<8))>>>ae&7}function Fe(K,fe){var ae=fe&7,re=fe>>>3;return(K[re]|(ae<=4?0:K[re+1]<<8))>>>ae&15}function le(K,fe){var ae=fe&7,re=fe>>>3;return(K[re]|(ae<=3?0:K[re+1]<<8))>>>ae&31}function Xe(K,fe){var ae=fe&7,re=fe>>>3;return(K[re]|(ae<=1?0:K[re+1]<<8))>>>ae&127}function xt(K,fe,ae){var re=fe&7,ce=fe>>>3,de=(1<<ae)-1,Ae=K[ce]>>>re;return ae<8-re||(Ae|=K[ce+1]<<8-re,ae<16-re)||(Ae|=K[ce+2]<<16-re,ae<24-re)||(Ae|=K[ce+3]<<24-re),Ae&de}function $e(K,fe,ae){var re=fe&7,ce=fe>>>3;return re<=5?K[ce]|=(ae&7)<<re:(K[ce]|=ae<<re&255,K[ce+1]=(ae&7)>>8-re),fe+3}function ie(K,fe,ae){var re=fe&7,ce=fe>>>3;return ae=(ae&1)<<re,K[ce]|=ae,fe+1}function ge(K,fe,ae){var re=fe&7,ce=fe>>>3;return ae<<=re,K[ce]|=ae&255,ae>>>=8,K[ce+1]=ae,fe+8}function ye(K,fe,ae){var re=fe&7,ce=fe>>>3;return ae<<=re,K[ce]|=ae&255,ae>>>=8,K[ce+1]=ae&255,K[ce+2]=ae>>>8,fe+16}function qe(K,fe){var ae=K.length,re=2*ae>fe?2*ae:fe+5,ce=0;if(ae>=fe)return K;if(rr){var de=Wm(re);if(K.copy)K.copy(de);else for(;ce<K.length;++ce)de[ce]=K[ce];return de}else if(me){var Ae=new Uint8Array(re);if(Ae.set)Ae.set(K);else for(;ce<ae;++ce)Ae[ce]=K[ce];return Ae}return K.length=re,K}function De(K){for(var fe=new Array(K),ae=0;ae<K;++ae)fe[ae]=0;return fe}function Re(K,fe,ae){var re=1,ce=0,de=0,Ae=0,Me=0,Ee=K.length,Te=me?new Uint16Array(32):De(32);for(de=0;de<32;++de)Te[de]=0;for(de=Ee;de<ae;++de)K[de]=0;Ee=K.length;var Le=me?new Uint16Array(Ee):De(Ee);for(de=0;de<Ee;++de)Te[ce=K[de]]++,re<ce&&(re=ce),Le[de]=0;for(Te[0]=0,de=1;de<=re;++de)Te[de+16]=Me=Me+Te[de-1]<<1;for(de=0;de<Ee;++de)Me=K[de],Me!=0&&(Le[de]=Te[Me+16]++);var tt=0;for(de=0;de<Ee;++de)if(tt=K[de],tt!=0)for(Me=Ie(Le[de],re)>>re-tt,Ae=(1<<re+4-tt)-1;Ae>=0;--Ae)fe[Me|Ae<<tt]=tt&15|de<<4;return re}var Je=me?new Uint16Array(512):De(512),mt=me?new Uint16Array(32):De(32);if(!me){for(var wt=0;wt<512;++wt)Je[wt]=0;for(wt=0;wt<32;++wt)mt[wt]=0}(function(){for(var K=[],fe=0;fe<32;fe++)K.push(5);Re(K,mt,32);var ae=[];for(fe=0;fe<=143;fe++)ae.push(8);for(;fe<=255;fe++)ae.push(9);for(;fe<=279;fe++)ae.push(7);for(;fe<=287;fe++)ae.push(8);Re(ae,Je,288)})();var bt=function(){for(var fe=me?new Uint8Array(32768):[],ae=0,re=0;ae<ue.length-1;++ae)for(;re<ue[ae+1];++re)fe[re]=ae;for(;re<32768;++re)fe[re]=29;var ce=me?new Uint8Array(259):[];for(ae=0,re=0;ae<z.length-1;++ae)for(;re<z[ae+1];++re)ce[re]=ae;function de(Me,Ee){for(var Te=0;Te<Me.length;){var Le=Math.min(65535,Me.length-Te),tt=Te+Le==Me.length;for(Ee.write_shift(1,+tt),Ee.write_shift(2,Le),Ee.write_shift(2,~Le&65535);Le-- >0;)Ee[Ee.l++]=Me[Te++]}return Ee.l}function Ae(Me,Ee){for(var Te=0,Le=0,tt=me?new Uint16Array(32768):[];Le<Me.length;){var it=Math.min(65535,Me.length-Le);if(it<10){for(Te=$e(Ee,Te,+(Le+it==Me.length)),Te&7&&(Te+=8-(Te&7)),Ee.l=Te/8|0,Ee.write_shift(2,it),Ee.write_shift(2,~it&65535);it-- >0;)Ee[Ee.l++]=Me[Le++];Te=Ee.l*8;continue}Te=$e(Ee,Te,+(Le+it==Me.length)+2);for(var pt=0;it-- >0;){var at=Me[Le];pt=(pt<<5^at)&32767;var ht=-1,Lt=0;if((ht=tt[pt])&&(ht|=Le&-32768,ht>Le&&(ht-=32768),ht<Le))for(;Me[ht+Lt]==Me[Le+Lt]&&Lt<250;)++Lt;if(Lt>2){at=ce[Lt],at<=22?Te=ge(Ee,Te,Ne[at+1]>>1)-1:(ge(Ee,Te,3),Te+=5,ge(Ee,Te,Ne[at-23]>>5),Te+=3);var Jt=at<8?0:at-4>>2;Jt>0&&(ye(Ee,Te,Lt-z[at]),Te+=Jt),at=fe[Le-ht],Te=ge(Ee,Te,Ne[at]>>3),Te-=3;var er=at<4?0:at-2>>1;er>0&&(ye(Ee,Te,Le-ht-ue[at]),Te+=er);for(var Tr=0;Tr<Lt;++Tr)tt[pt]=Le&32767,pt=(pt<<5^Me[Le])&32767,++Le;it-=Lt-1}else at<=143?at=at+48:Te=ie(Ee,Te,1),Te=ge(Ee,Te,Ne[at]),tt[pt]=Le&32767,++Le}Te=ge(Ee,Te,0)-1}return Ee.l=(Te+7)/8|0,Ee.l}return function(Ee,Te){return Ee.length<8?de(Ee,Te):Ae(Ee,Te)}}();function kt(K){var fe=He(50+Math.floor(K.length*1.1)),ae=bt(K,fe);return fe.slice(0,ae)}var ot=me?new Uint16Array(32768):De(32768),Ar=me?new Uint16Array(32768):De(32768),Ut=me?new Uint16Array(128):De(128),Rr=1,zt=1;function Yt(K,fe){var ae=le(K,fe)+257;fe+=5;var re=le(K,fe)+1;fe+=5;var ce=Fe(K,fe)+4;fe+=4;for(var de=0,Ae=me?new Uint8Array(19):De(19),Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ee=1,Te=me?new Uint8Array(8):De(8),Le=me?new Uint8Array(8):De(8),tt=Ae.length,it=0;it<ce;++it)Ae[M[it]]=de=st(K,fe),Ee<de&&(Ee=de),Te[de]++,fe+=3;var pt=0;for(Te[0]=0,it=1;it<=Ee;++it)Le[it]=pt=pt+Te[it-1]<<1;for(it=0;it<tt;++it)(pt=Ae[it])!=0&&(Me[it]=Le[pt]++);var at=0;for(it=0;it<tt;++it)if(at=Ae[it],at!=0){pt=Ne[Me[it]]>>8-at;for(var ht=(1<<7-at)-1;ht>=0;--ht)Ut[pt|ht<<at]=at&7|it<<3}var Lt=[];for(Ee=1;Lt.length<ae+re;)switch(pt=Ut[Xe(K,fe)],fe+=pt&7,pt>>>=3){case 16:for(de=3+Ze(K,fe),fe+=2,pt=Lt[Lt.length-1];de-- >0;)Lt.push(pt);break;case 17:for(de=3+st(K,fe),fe+=3;de-- >0;)Lt.push(0);break;case 18:for(de=11+Xe(K,fe),fe+=7;de-- >0;)Lt.push(0);break;default:Lt.push(pt),Ee<pt&&(Ee=pt);break}var Jt=Lt.slice(0,ae),er=Lt.slice(ae);for(it=ae;it<286;++it)Jt[it]=0;for(it=re;it<30;++it)er[it]=0;return Rr=Re(Jt,ot,286),zt=Re(er,Ar,30),fe}function Vr(K,fe){if(K[0]==3&&!(K[1]&3))return[Xi(fe),2];for(var ae=0,re=0,ce=Wm(fe||1<<18),de=0,Ae=ce.length>>>0,Me=0,Ee=0;!(re&1);){if(re=st(K,ae),ae+=3,re>>>1)re>>1==1?(Me=9,Ee=5):(ae=Yt(K,ae),Me=Rr,Ee=zt);else{ae&7&&(ae+=8-(ae&7));var Te=K[ae>>>3]|K[(ae>>>3)+1]<<8;if(ae+=32,Te>0)for(!fe&&Ae<de+Te&&(ce=qe(ce,de+Te),Ae=ce.length);Te-- >0;)ce[de++]=K[ae>>>3],ae+=8;continue}for(;;){!fe&&Ae<de+32767&&(ce=qe(ce,de+32767),Ae=ce.length);var Le=xt(K,ae,Me),tt=re>>>1==1?Je[Le]:ot[Le];if(ae+=tt&15,tt>>>=4,!(tt>>>8&255))ce[de++]=tt;else{if(tt==256)break;tt-=257;var it=tt<8?0:tt-4>>2;it>5&&(it=0);var pt=de+z[tt];it>0&&(pt+=xt(K,ae,it),ae+=it),Le=xt(K,ae,Ee),tt=re>>>1==1?mt[Le]:Ar[Le],ae+=tt&15,tt>>>=4;var at=tt<4?0:tt-2>>1,ht=ue[tt];for(at>0&&(ht+=xt(K,ae,at),ae+=at),!fe&&Ae<pt&&(ce=qe(ce,pt+100),Ae=ce.length);de<pt;)ce[de]=ce[de-ht],++de}}}return fe?[ce,ae+7>>>3]:[ce.slice(0,de),ae+7>>>3]}function Ot(K,fe){var ae=K.slice(K.l||0),re=Vr(ae,fe);return K.l+=re[1],re[0]}function Ka(K,fe){if(K)typeof console<"u"&&console.error(fe);else throw new Error(fe)}function nr(K,fe){var ae=K;wn(ae,0);var re=[],ce=[],de={FileIndex:re,FullPaths:ce};T(de,{root:fe.root});for(var Ae=ae.length-4;(ae[Ae]!=80||ae[Ae+1]!=75||ae[Ae+2]!=5||ae[Ae+3]!=6)&&Ae>=0;)--Ae;ae.l=Ae+4,ae.l+=4;var Me=ae.read_shift(2);ae.l+=6;var Ee=ae.read_shift(4);for(ae.l=Ee,Ae=0;Ae<Me;++Ae){ae.l+=20;var Te=ae.read_shift(4),Le=ae.read_shift(4),tt=ae.read_shift(2),it=ae.read_shift(2),pt=ae.read_shift(2);ae.l+=8;var at=ae.read_shift(4),ht=l(ae.slice(ae.l+tt,ae.l+tt+it));ae.l+=tt+it+pt;var Lt=ae.l;ae.l=at+4,ma(ae,Te,Le,de,ht),ae.l=Lt}return de}function ma(K,fe,ae,re,ce){K.l+=2;var de=K.read_shift(2),Ae=K.read_shift(2),Me=o(K);if(de&8257)throw new Error("Unsupported ZIP encryption");for(var Ee=K.read_shift(4),Te=K.read_shift(4),Le=K.read_shift(4),tt=K.read_shift(2),it=K.read_shift(2),pt="",at=0;at<tt;++at)pt+=String.fromCharCode(K[K.l++]);if(it){var ht=l(K.slice(K.l,K.l+it));(ht[21589]||{}).mt&&(Me=ht[21589].mt),((ce||{})[21589]||{}).mt&&(Me=ce[21589].mt)}K.l+=it;var Lt=K.slice(K.l,K.l+Te);switch(Ae){case 8:Lt=L(K,Le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ae)}var Jt=!1;de&8&&(Ee=K.read_shift(4),Ee==134695760&&(Ee=K.read_shift(4),Jt=!0),Te=K.read_shift(4),Le=K.read_shift(4)),Te!=fe&&Ka(Jt,"Bad compressed size: "+fe+" != "+Te),Le!=ae&&Ka(Jt,"Bad uncompressed size: "+ae+" != "+Le),pa(re,pt,Lt,{unsafe:!0,mt:Me})}function sr(K,fe){var ae=fe||{},re=[],ce=[],de=He(1),Ae=ae.compression?8:0,Me=0,Ee=0,Te=0,Le=0,tt=0,it=K.FullPaths[0],pt=it,at=K.FileIndex[0],ht=[],Lt=0;for(Ee=1;Ee<K.FullPaths.length;++Ee)if(pt=K.FullPaths[Ee].slice(it.length),at=K.FileIndex[Ee],!(!at.size||!at.content||pt=="Sh33tJ5")){var Jt=Le,er=He(pt.length);for(Te=0;Te<pt.length;++Te)er.write_shift(1,pt.charCodeAt(Te)&127);er=er.slice(0,er.l),ht[tt]=O4.buf(at.content,0);var Tr=at.content;Ae==8&&(Tr=D(Tr)),de=He(30),de.write_shift(4,67324752),de.write_shift(2,20),de.write_shift(2,Me),de.write_shift(2,Ae),at.mt?s(de,at.mt):de.write_shift(4,0),de.write_shift(-4,ht[tt]),de.write_shift(4,Tr.length),de.write_shift(4,at.content.length),de.write_shift(2,er.length),de.write_shift(2,0),Le+=de.length,re.push(de),Le+=er.length,re.push(er),Le+=Tr.length,re.push(Tr),de=He(46),de.write_shift(4,33639248),de.write_shift(2,0),de.write_shift(2,20),de.write_shift(2,Me),de.write_shift(2,Ae),de.write_shift(4,0),de.write_shift(-4,ht[tt]),de.write_shift(4,Tr.length),de.write_shift(4,at.content.length),de.write_shift(2,er.length),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(4,0),de.write_shift(4,Jt),Lt+=de.l,ce.push(de),Lt+=er.length,ce.push(er),++tt}return de=He(22),de.write_shift(4,101010256),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,tt),de.write_shift(2,tt),de.write_shift(4,Lt),de.write_shift(4,Le),de.write_shift(2,0),ba([ba(re),ba(ce),de])}var Vt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pt(K,fe){if(K.ctype)return K.ctype;var ae=K.name||"",re=ae.match(/\.([^\.]+)$/);return re&&Vt[re[1]]||fe&&(re=(ae=fe).match(/[\.\\]([^\.\\])+$/),re&&Vt[re[1]])?Vt[re[1]]:"application/octet-stream"}function $t(K){for(var fe=gc(K),ae=[],re=0;re<fe.length;re+=76)ae.push(fe.slice(re,re+76));return ae.join(`\r
`)+`\r
`}function Aa(K){var fe=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Le=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Le.length==1?"0"+Le:Le)});fe=fe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),fe.charAt(0)==`
`&&(fe="=0D"+fe.slice(1)),fe=fe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],re=fe.split(`\r
`),ce=0;ce<re.length;++ce){var de=re[ce];if(de.length==0){ae.push("");continue}for(var Ae=0;Ae<de.length;){var Me=76,Ee=de.slice(Ae,Ae+Me);Ee.charAt(Me-1)=="="?Me--:Ee.charAt(Me-2)=="="?Me-=2:Ee.charAt(Me-3)=="="&&(Me-=3),Ee=de.slice(Ae,Ae+Me),Ae+=Me,Ae<de.length&&(Ee+="="),ae.push(Ee)}}return ae.join(`\r
`)}function Mr(K){for(var fe=[],ae=0;ae<K.length;++ae){for(var re=K[ae];ae<=K.length&&re.charAt(re.length-1)=="=";)re=re.slice(0,re.length-1)+K[++ae];fe.push(re)}for(var ce=0;ce<fe.length;++ce)fe[ce]=fe[ce].replace(/[=][0-9A-Fa-f]{2}/g,function(de){return String.fromCharCode(parseInt(de.slice(1),16))});return Qn(fe.join(`\r
`))}function Ua(K,fe,ae){for(var re="",ce="",de="",Ae,Me=0;Me<10;++Me){var Ee=fe[Me];if(!Ee||Ee.match(/^\s*$/))break;var Te=Ee.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":re=Te[2].trim();break;case"content-type":de=Te[2].trim();break;case"content-transfer-encoding":ce=Te[2].trim();break}}switch(++Me,ce.toLowerCase()){case"base64":Ae=Qn(Rs(fe.slice(Me).join("")));break;case"quoted-printable":Ae=Mr(fe.slice(Me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ce)}var Le=pa(K,re.slice(ae.length),Ae,{unsafe:!0});de&&(Le.ctype=de)}function ja(K,fe){if(Q(K.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=fe&&fe.root||"",re=(rr&&Buffer.isBuffer(K)?K.toString("binary"):Q(K)).split(`\r
`),ce=0,de="";for(ce=0;ce<re.length;++ce)if(de=re[ce],!!/^Content-Location:/i.test(de)&&(de=de.slice(de.indexOf("file")),ae||(ae=de.slice(0,de.lastIndexOf("/")+1)),de.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),de.slice(0,ae.length)!=ae););var Ae=(re[1]||"").match(/boundary="(.*?)"/);if(!Ae)throw new Error("MAD cannot find boundary");var Me="--"+(Ae[1]||""),Ee=[],Te=[],Le={FileIndex:Ee,FullPaths:Te};T(Le);var tt,it=0;for(ce=0;ce<re.length;++ce){var pt=re[ce];pt!==Me&&pt!==Me+"--"||(it++&&Ua(Le,re.slice(tt,ce),ae),tt=ce)}return Le}function _t(K,fe){var ae=fe||{},re=ae.boundary||"SheetJS";re="------="+re;for(var ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+re.slice(2)+'"',"","",""],de=K.FullPaths[0],Ae=de,Me=K.FileIndex[0],Ee=1;Ee<K.FullPaths.length;++Ee)if(Ae=K.FullPaths[Ee].slice(de.length),Me=K.FileIndex[Ee],!(!Me.size||!Me.content||Ae=="Sh33tJ5")){Ae=Ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Lt){return"_x"+Lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Lt){return"_u"+Lt.charCodeAt(0).toString(16)+"_"});for(var Te=Me.content,Le=rr&&Buffer.isBuffer(Te)?Te.toString("binary"):Q(Te),tt=0,it=Math.min(1024,Le.length),pt=0,at=0;at<=it;++at)(pt=Le.charCodeAt(at))>=32&&pt<128&&++tt;var ht=tt>=it*4/5;ce.push(re),ce.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+Ae),ce.push("Content-Transfer-Encoding: "+(ht?"quoted-printable":"base64")),ce.push("Content-Type: "+Pt(Me,Ae)),ce.push(""),ce.push(ht?Aa(Le):$t(Le))}return ce.push(re+`--\r
`),ce.join(`\r
`)}function Ea(K){var fe={};return T(fe,K),fe}function pa(K,fe,ae,re){var ce=re&&re.unsafe;ce||T(K);var de=!ce&&mr.find(K,fe);if(!de){var Ae=K.FullPaths[0];fe.slice(0,Ae.length)==Ae?Ae=fe:(Ae.slice(-1)!="/"&&(Ae+="/"),Ae=(Ae+fe).replace("//","/")),de={name:n(fe),type:2},K.FileIndex.push(de),K.FullPaths.push(Ae),ce||mr.utils.cfb_gc(K)}return de.content=ae,de.size=ae?ae.length:0,re&&(re.CLSID&&(de.clsid=re.CLSID),re.mt&&(de.mt=re.mt),re.ct&&(de.ct=re.ct)),de}function gr(K,fe){T(K);var ae=mr.find(K,fe);if(ae){for(var re=0;re<K.FileIndex.length;++re)if(K.FileIndex[re]==ae)return K.FileIndex.splice(re,1),K.FullPaths.splice(re,1),!0}return!1}function Kt(K,fe,ae){T(K);var re=mr.find(K,fe);if(re){for(var ce=0;ce<K.FileIndex.length;++ce)if(K.FileIndex[ce]==re)return K.FileIndex[ce].name=n(ae),K.FullPaths[ce]=ae,!0}return!1}function Nr(K){k(K,!0)}return t.find=A,t.read=B,t.parse=d,t.write=ne,t.writeFile=H,t.utils={cfb_new:Ea,cfb_add:pa,cfb_del:gr,cfb_mov:Kt,cfb_gc:Nr,ReadShift:nc,CheckField:Cx,prep_blob:wn,bconcat:ba,use_zlib:N,_deflateRaw:kt,_inflateRaw:Ot,consts:U},t}();function I4(e){return typeof e=="string"?D0(e):Array.isArray(e)?l4(e):e}function Lc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=D0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Fs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([I4(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Pc(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Sa(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Km(e,t){for(var r=[],a=Sa(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function eh(e){for(var t=[],r=Sa(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function R0(e){for(var t=[],r=Sa(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function R4(e){for(var t=[],r=Sa(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var s0=new Date(1899,11,30,0,0,0);function dn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=s0.getTime()+(e.getTimezoneOffset()-s0.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var fx=new Date,M4=s0.getTime()+(fx.getTimezoneOffset()-s0.getTimezoneOffset())*6e4,Jm=fx.getTimezoneOffset();function hx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+M4),t.getTimezoneOffset()!==Jm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Jm)*6e4),t}var Qm=new Date("2017-02-19T19:06:09.000Z"),mx=isNaN(Qm.getFullYear())?new Date("2/19/17"):Qm,B4=mx.getFullYear()==2017;function Ya(e,t){var r=new Date(e);if(B4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(mx.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function M0(e,t){if(rr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Fs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fs(o4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Fs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function fn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=fn(e[r]));return t}function Or(e,t){for(var r="";r.length<t;)r+=e;return r}function Ds(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var U4=["january","february","march","april","may","june","july","august","september","october","november","december"];function vc(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&U4.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ht(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return rr?a=Bs(r):a=c4(r),mr.utils.cfb_add(e,t,a)}mr.utils.cfb_add(e,t,r)}else e.file(t,r)}function th(){return mr.utils.cfb_new()}var ta=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,q4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rh=eh(q4),ah=/[&<>'"]/g,W4=/[\u0000-\u0008\u000b-\u001f]/g;function dr(e){var t=e+"";return t.replace(ah,function(r){return rh[r]}).replace(W4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Zm(e){return dr(e).replace(/ /g,"_x0020_")}var px=/[\u0000-\u001f]/g;function H4(e){var t=e+"";return t.replace(ah,function(r){return rh[r]}).replace(/\n/g,"<br/>").replace(px,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $4(e){var t=e+"";return t.replace(ah,function(r){return rh[r]}).replace(px,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function z4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function V4(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bd(e){for(var t="",r=0,a=0,n=0,s=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(n&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function ep(e){var t=Xi(2*e.length),r,a,n=1,s=0,o=0,l;for(a=0;a<e.length;a+=n)n=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function tp(e){return Bs(e,"binary").toString("utf8")}var Cu="foo bar baz",ac=rr&&(tp(Cu)==Bd(Cu)&&tp||ep(Cu)==Bd(Cu)&&ep)||Bd,Fs=rr?function(e){return Bs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},G4=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),xx=/(^\s|\s$|\n)/;function Na(e,t){return"<"+e+(t.match(xx)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function yc(e){return Sa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function lt(e,t,r){return"<"+e+(r!=null?yc(r):"")+(t!=null?(t.match(xx)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function vf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Y4(e,t){switch(typeof e){case"string":var r=lt("vt:lpwstr",dr(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return lt((e|0)==e?"vt:i4":"vt:r8",dr(String(e)));case"boolean":return lt("vt:bool",e?"true":"false")}if(e instanceof Date)return lt("vt:filetime",vf(e));throw new Error("Unable to serialize "+e)}var ua={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X4(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function K4(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,o=a?-t:t;isFinite(o)?o==0?n=s=0:(n=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var rp=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},ap=rr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Bs(t)})):rp(e)}:rp,np=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Ql(e,n)));return a.join("").replace(rc,"")},nh=rr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(rc,""):np(e,t,r)}:np,sp=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},gx=rr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sp(e,t,r)}:sp,ip=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Ho(e,n)));return a.join("")},Fc=rr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):ip(t,r,a)}:ip,vx=function(e,t){var r=Nn(e,t);return r>0?Fc(e,t+4,t+4+r-1):""},yx=vx,wx=function(e,t){var r=Nn(e,t);return r>0?Fc(e,t+4,t+4+r-1):""},bx=wx,Nx=function(e,t){var r=2*Nn(e,t);return r>0?Fc(e,t+4,t+4+r-1):""},_x=Nx,Sx=function(t,r){var a=Nn(t,r);return a>0?nh(t,r+4,r+4+a):""},Ax=Sx,jx=function(e,t){var r=Nn(e,t);return r>0?Fc(e,t+4,t+4+r):""},Ex=jx,Tx=function(e,t){return X4(e,t)},i0=Tx,sh=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rr&&(yx=function(t,r){if(!Buffer.isBuffer(t))return vx(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},bx=function(t,r){if(!Buffer.isBuffer(t))return wx(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},_x=function(t,r){if(!Buffer.isBuffer(t))return Nx(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Ax=function(t,r){if(!Buffer.isBuffer(t))return Sx(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Ex=function(t,r){if(!Buffer.isBuffer(t))return jx(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},i0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Tx(t,r)},sh=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ho=function(e,t){return e[t]},Ql=function(e,t){return e[t+1]*256+e[t]},J4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Nn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Mi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Q4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function nc(e,t){var r="",a,n,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,rr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ql(this,u)),u+=2;e*=2;break;case"utf8":r=Fc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=nh(this,this.l,this.l+e);break;case"wstr":return nc.call(this,e,"dbcs");case"lpstr-ansi":r=yx(this,this.l),e=4+Nn(this,this.l);break;case"lpstr-cp":r=bx(this,this.l),e=4+Nn(this,this.l);break;case"lpwstr":r=_x(this,this.l),e=4+2*Nn(this,this.l);break;case"lpp4":e=4+Nn(this,this.l),r=Ax(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Nn(this,this.l),r=Ex(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ho(this,this.l+e++))!==0;)s.push(ju(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Ql(this,this.l+e))!==0;)s.push(ju(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ho(this,u),this.l=u+1,l=nc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ju(Ql(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ho(this,u),this.l=u+1,l=nc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ju(Ho(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return a=Ho(this,this.l),this.l++,a;case 2:return a=(t==="i"?J4:Ql)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Mi:Q4)(this,this.l),this.l+=4,a):(n=Nn(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=i0(this,this.l):n=i0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=gx(this,this.l,e);break}}return this.l+=e,r}var Z4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},eN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},tN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function rN(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)tN(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Z4(this,t,this.l);break;case 8:if(a=8,r==="f"){K4(this,t,this.l);break}case 16:break;case-4:a=4,eN(this,t,this.l);break}return this.l+=a,this}function Cx(e,t){var r=gx(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wn(e,t){e.l=t,e.read_shift=nc,e.chk=Cx,e.write_shift=rN}function vs(e,t){e.l+=t}function He(e){var t=Xi(e);return wn(t,0),t}function ln(){var e=[],t=rr?256:2048,r=function(u){var d=He(u);return wn(d,0),d},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(u){return a&&u<a.length-a.l?a:(n(),a=r(Math.max(u+1,t)))},o=function(){return n(),ba(e)},l=function(u){n(),a=u,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Qe(e,t,r,a){var n=+t,s;if(!isNaN(n)){a||(a=XA[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var o=e.next(s);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&sh(r)&&e.push(r)}}function sc(e,t,r){var a=fn(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function op(e,t,r){var a=fn(e);return a.s=sc(a.s,t.s,r),a.e=sc(a.e,t.s,r),a}function ic(e,t){if(e.cRel&&e.c<0)for(e=fn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=fn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=fr(e);return!e.cRel&&e.cRel!=null&&(r=sN(r)),!e.rRel&&e.rRel!=null&&(r=aN(r)),r}function Ud(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ra(e.s.c)+":"+(e.e.cRel?"":"$")+Ra(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+_a(e.s.r)+":"+(e.e.rRel?"":"$")+_a(e.e.r):ic(e.s,t.biff)+":"+ic(e.e,t.biff)}function ih(e){return parseInt(nN(e),10)-1}function _a(e){return""+(e+1)}function aN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nN(e){return e.replace(/\$(\d+)$/,"$1")}function oh(e){for(var t=iN(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Ra(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function sN(e){return e.replace(/^([A-Z])/,"$$$1")}function iN(e){return e.replace(/^\$([A-Z])/,"$1")}function oN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function da(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function fr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function jn(e){var t=e.indexOf(":");return t==-1?{s:da(e),e:da(e)}:{s:da(e.slice(0,t)),e:da(e.slice(t+1))}}function Zr(e,t){return typeof t>"u"||typeof t=="number"?Zr(e.s,e.e):(typeof e!="string"&&(e=fr(e)),typeof t!="string"&&(t=fr(t)),e==t?e:e+":"+t)}function Sr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function lp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gi(e.z,r?dn(t):t)}catch{}try{return e.w=gi((e.XF||{}).numFmtId||(r?14:0),r?dn(t):t)}catch{return""+t}}function Ms(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?kc[e.v]||e.v:t==null?lp(e,e.v):lp(e,t))}function Zi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Px(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),o=0,l=0;if(s&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?da(a.origin):a.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Sr(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var h={v:t[m][g]},x=o+m,p=l+g;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))h=t[m][g];else if(Array.isArray(h.v)&&(h.f=t[m][g][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Ir[14],a.cellDates?(h.t="d",h.w=gi(h.z,dn(h.v))):(h.t="n",h.v=dn(h.v),h.w=gi(h.z,h.v))):h.t="s";if(n)s[x]||(s[x]=[]),s[x][p]&&s[x][p].z&&(h.z=s[x][p].z),s[x][p]=h;else{var y=fr({c:p,r:x});s[y]&&s[y].z&&(h.z=s[y].z),s[y]=h}}}return u.s.c<1e7&&(s["!ref"]=Zr(u)),s}function il(e,t){return Px(null,e,t)}function lN(e){return e.read_shift(4,"i")}function rs(e,t){return t||(t=He(4)),t.write_shift(4,e),t}function Ma(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function fa(e,t){var r=!1;return t==null&&(r=!0,t=He(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function uN(e,t){return t||(t=He(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function lh(e,t){var r=e.l,a=e.read_shift(1),n=Ma(e),s=[],o={t:n,h:n};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(cN(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function dN(e,t){var r=!1;return t==null&&(r=!0,t=He(15+4*e.t.length)),t.write_shift(1,0),fa(e.t,t),r?t.slice(0,t.l):t}var fN=lh;function hN(e,t){var r=!1;return t==null&&(r=!0,t=He(23+4*e.t.length)),t.write_shift(1,1),fa(e.t,t),t.write_shift(4,1),uN({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Mn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function eo(e,t){return t==null&&(t=He(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function to(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ro(e,t){return t==null&&(t=He(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var mN=Ma,Lx=fa;function ch(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function o0(e,t){var r=!1;return t==null&&(r=!0,t=He(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var pN=Ma,yf=ch,uh=o0;function Fx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?i0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Mi(t,0)>>2;return r?n/100:n}function kx(e,t){t==null&&(t=He(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Dx(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function xN(e,t){return t||(t=He(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ao=Dx,ol=xN;function ll(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ki(e,t){return(t||He(8)).write_shift(8,e,"f")}function gN(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var u=jN[n];u&&(t.rgb=yp(u));break;case 2:t.rgb=yp([o,l,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function l0(e,t){if(t||(t=He(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function vN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function yN(e,t){t||(t=He(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Ox=2,yn=3,Pu=11,c0=19,Lu=64,wN=65,bN=71,NN=4108,_N=4126,wa=80,cp={1:{n:"CodePage",t:Ox},2:{n:"Category",t:wa},3:{n:"PresentationFormat",t:wa},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:Pu},12:{n:"HeadingPairs",t:NN},13:{n:"TitlesOfParts",t:_N},14:{n:"Manager",t:wa},15:{n:"Company",t:wa},16:{n:"LinksUpToDate",t:Pu},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:Pu},22:{n:"HyperlinksChanged",t:Pu},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:wN},26:{n:"ContentType",t:wa},27:{n:"ContentStatus",t:wa},28:{n:"Language",t:wa},29:{n:"Version",t:wa},255:{},2147483648:{n:"Locale",t:c0},2147483651:{n:"Behavior",t:c0},1919054434:{}},up={1:{n:"CodePage",t:Ox},2:{n:"Title",t:wa},3:{n:"Subject",t:wa},4:{n:"Author",t:wa},5:{n:"Keywords",t:wa},6:{n:"Comments",t:wa},7:{n:"Template",t:wa},8:{n:"LastAuthor",t:wa},9:{n:"RevNumber",t:wa},10:{n:"EditTime",t:Lu},11:{n:"LastPrinted",t:Lu},12:{n:"CreatedDate",t:Lu},13:{n:"ModifiedDate",t:Lu},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:bN},18:{n:"Application",t:wa},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:c0},2147483651:{n:"Behavior",t:c0},1919054434:{}};function SN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var AN=SN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),jN=fn(AN),kc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},EN={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ix(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Rx(e,t){var r=R4(EN),a=[],n;a[a.length]=ta,a[a.length]=lt("Types",null,{xmlns:ua.CT,"xmlns:xsd":ua.xsd,"xmlns:xsi":ua.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return lt("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=lt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Fu[c][t.bookType]||Fu[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){a[a.length]=lt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Fu[c][t.bookType]||Fu[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){a[a.length]=lt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Xo(e){var t=[ta,lt("Relationships",null,{xmlns:ua.RELS})];return Sa(e["!id"]).forEach(function(r){t[t.length]=lt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ur(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,s?n.TargetMode=s:[Zt.HLINK,Zt.XPATH,Zt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function TN(e){var t=[ta];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function dp(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function CN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function PN(e){var t=[ta];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(dp(e[r][0],e[r][1])),t.push(CN("",e[r][0]));return t.push(dp("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Bx(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+t0.version+"</meta:generator></office:meta></office:document-meta>"}var Wi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function qd(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=dr(t),a[a.length]=r?lt(e,t,r):Na(e,t))}function Ux(e,t){var r=t||{},a=[ta,lt("cp:coreProperties",null,{"xmlns:cp":ua.CORE_PROPS,"xmlns:dc":ua.dc,"xmlns:dcterms":ua.dcterms,"xmlns:dcmitype":ua.dcmitype,"xmlns:xsi":ua.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&qd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:vf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&qd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:vf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=Wi.length;++s){var o=Wi[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&qd(o[0],l,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Ko=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],qx=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Wx(e){var t=[],r=lt;return e||(e={}),e.Application="SheetJS",t[t.length]=ta,t[t.length]=lt("Properties",null,{xmlns:ua.EXT_PROPS,"xmlns:vt":ua.vt}),Ko.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=dr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+dr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Hx(e){var t=[ta,lt("Properties",null,{xmlns:ua.CUST_PROPS,"xmlns:vt":ua.vt})];if(!e)return t.join("");var r=1;return Sa(e).forEach(function(n){++r,t[t.length]=lt("property",Y4(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function LN(e,t){var r=[];return Sa(fp).map(function(a){for(var n=0;n<Wi.length;++n)if(Wi[n][1]==a)return Wi[n];for(n=0;n<Ko.length;++n)if(Ko[n][1]==a)return Ko[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Na(fp[a[1]]||a[1],n))}}),lt("DocumentProperties",r.join(""),{xmlns:bn.o})}function FN(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Sa(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Wi.length;++o)if(s==Wi[o][1])return;for(o=0;o<Ko.length;++o)if(s==Ko[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(lt(Zm(s),l,{"dt:dt":c}))}}),t&&Sa(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(lt(Zm(s),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+bn.o+'">'+n.join("")+"</"+a+">"}function kN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var o=He(8);return o.write_shift(4,a),o.write_shift(4,n),o}function hp(e,t){var r=He(4),a=He(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=He(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=kN(t);break;case 31:case 80:for(a=He(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ba([r,a])}var $x=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function DN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function mp(e,t,r){var a=He(8),n=[],s=[],o=8,l=0,c=He(8),u=He(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),n.push(u),o+=8+c.length,!t){u=He(8),u.write_shift(4,0),n.unshift(u);var d=[He(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(c=He(4+4+2*(m.length+1)+(m.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,m.length+1),c.write_shift(0,m,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ba(d),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!($x.indexOf(e[l][0])>-1||qx.indexOf(e[l][0])>-1)&&e[l][1]!=null){var g=e[l][1],h=0;if(t){h=+t[e[l][0]];var x=r[h];if(x.p=="version"&&typeof g=="string"){var p=g.split(".");g=(+p[0]<<16)+(+p[1]||0)}c=hp(x.t,g)}else{var y=DN(g);y==-1&&(y=31,g=String(g)),c=hp(y,g)}s.push(c),u=He(8),u.write_shift(4,t?h:2+l),n.push(u),o+=8+c.length}var _=8*(s.length+1);for(l=0;l<s.length;++l)n[l].write_shift(4,_),_+=s[l].length;return a.write_shift(4,o),a.write_shift(4,s.length),ba([a].concat(n).concat(s))}function pp(e,t,r,a,n,s){var o=He(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,mr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=mp(e,r,a);if(l.push(c),n){var u=mp(n,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return ba(l)}function ON(e,t){t||(t=He(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function IN(e,t){return e.read_shift(t)===1}function Va(e,t){return t||(t=He(2)),t.write_shift(2,+!!e),t}function zx(e){return e.read_shift(2,"u")}function On(e,t){return t||(t=He(2)),t.write_shift(2,e),t}function Vx(e,t,r){return r||(r=He(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Gx(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function RN(e){var t=e.t||"",r=He(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var a=He(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return ba(n)}function MN(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function BN(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):MN(e,a,r)}function UN(e,t,r){if(r.biff>5)return BN(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Yx(e,t,r){return r||(r=He(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function xp(e,t){t||(t=He(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function qN(e){var t=He(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)a=a.slice(1),xp(a,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&xp(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ji(e,t,r,a){return a||(a=He(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function WN(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,s,o]}function HN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function Xx(e,t){return t||(t=He(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function dh(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=He(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $N(e,t){var r=!t||t.biff==8,a=He(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function zN(e,t){var r=!t||t.biff>=8?2:1,a=He(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function VN(e,t){var r=He(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=RN(e[n]);var s=ba([r].concat(a));return s.parts=[r.length].concat(a.map(function(o){return o.length})),s}function GN(){var e=He(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function YN(e){var t=He(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function XN(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,s=He(n);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function KN(e,t,r,a){var n=He(10);return Ji(e,t,a,n),n.write_shift(4,r),n}function JN(e,t,r,a,n){var s=!n||n.biff==8,o=He(6+2+ +s+(1+s)*r.length);return Ji(e,t,a,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function QN(e,t,r,a){var n=r&&r.biff==5;a||(a=He(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}function ZN(e,t){var r=t.biff==8||!t.biff?4:2,a=He(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function gp(e,t,r,a){var n=r&&r.biff==5;a||(a=He(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function e3(e){var t=He(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function t3(e,t,r,a,n,s){var o=He(8);return Ji(e,t,a,o),Vx(r,s,o),o}function r3(e,t,r,a){var n=He(14);return Ji(e,t,a,n),Ki(r,n),n}function a3(e,t,r){if(r.biff<8)return n3(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(WN(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function n3(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Gx(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function s3(e){var t=He(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Xx(e[r],t);return t}function i3(e){var t=He(24),r=da(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return ba([t,qN(e[1])])}function o3(e){var t=e[1].Tooltip,r=He(10+2*(t.length+1));r.write_shift(2,2048);var a=da(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function l3(e){return e||(e=He(4)),e.write_shift(2,1),e.write_shift(2,1),e}function c3(e,t,r){if(!r.cellStyles)return vs(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var u={s:n,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function u3(e,t){var r=He(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function d3(e){for(var t=He(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function f3(e,t,r){var a=He(15);return Oc(a,e,t),a.write_shift(8,r,"f"),a}function h3(e,t,r){var a=He(9);return Oc(a,e,t),a.write_shift(2,r),a}var m3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=eh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Xi(1);switch(c.type){case"base64":d=Qn(Rs(l));break;case"binary":d=Qn(l);break;case"buffer":case"array":d=l;break}wn(d,0);var m=d.read_shift(1),g=!!(m&136),h=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:h=!0,g=!0;break;case 49:h=!0,g=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var p=0,y=521;m==2&&(p=d.read_shift(2)),d.l+=3,m!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),m!=2&&(y=d.read_shift(2));var _=d.read_shift(2),S=c.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(S=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var E=[],C={},F=Math.min(d.length,m==2?521:y-10-(h?264:0)),B=x?32:11;d.l<F&&d[d.l]!=13;)switch(C={},C.name=Ri.utils.decode(S,d.slice(d.l,d.l+B)).replace(/[\u0000\r\n].*$/g,""),d.l+=B,C.type=String.fromCharCode(d.read_shift(1)),m!=2&&!x&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),m==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&E.push(C),m!=2&&(d.l+=x?13:14),C.type){case"B":(!h||C.len!=8)&&c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var T=0,P=0;for(u[0]=[],P=0;P!=E.length;++P)u[0][P]=E[P].name;for(;p-- >0;){if(d[d.l]===42){d.l+=_;continue}for(++d.l,u[++T]=[],P=0,P=0;P!=E.length;++P){var k=d.slice(d.l,d.l+E[P].len);d.l+=E[P].len,wn(k,0);var I=Ri.utils.decode(S,k);switch(E[P].type){case"C":I.trim().length&&(u[T][P]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[T][P]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[T][P]=I;break;case"F":u[T][P]=parseFloat(I.trim());break;case"+":case"I":u[T][P]=x?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[T][P]=!0;break;case"N":case"F":u[T][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));u[T][P]="##MEMO##"+(x?parseInt(I.trim(),10):k.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[T][P]=+I||0);break;case"@":u[T][P]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[T][P]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[T][P]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][P]=-k.read_shift(-8,"f");break;case"B":if(h&&E[P].len==8){u[T][P]=k.read_shift(8,"f");break}case"G":case"P":k.l+=E[P].len;break;case"0":if(E[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[P].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=E,u}function a(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=il(r(l,u),u);return d["!cols"]=u.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete u.DBF,d}function n(l,c){try{return Zi(a(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&xc(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ln(),m=m0(l,{header:1,raw:!0,cellDates:!0}),g=m[0],h=m.slice(1),x=l["!cols"]||[],p=0,y=0,_=0,S=1;for(p=0;p<g.length;++p){if(((x[p]||{}).DBF||{}).name){g[p]=x[p].DBF.name,++_;continue}if(g[p]!=null){if(++_,typeof g[p]=="number"&&(g[p]=g[p].toString(10)),typeof g[p]!="string")throw new Error("DBF Invalid column name "+g[p]+" |"+typeof g[p]+"|");if(g.indexOf(g[p])!==p){for(y=0;y<1024;++y)if(g.indexOf(g[p]+"_"+y)==-1){g[p]+="_"+y;break}}}}var E=Sr(l["!ref"]),C=[],F=[],B=[];for(p=0;p<=E.e.c-E.s.c;++p){var T="",P="",k=0,I=[];for(y=0;y<h.length;++y)h[y][p]!=null&&I.push(h[y][p]);if(I.length==0||g[p]==null){C[p]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=I[y]instanceof Date?"D":"C";break;default:P="C"}k=Math.max(k,String(I[y]).length),T=T&&T!=P?"C":P}k>250&&(k=250),P=((x[p]||{}).DBF||{}).type,P=="C"&&x[p].DBF.len>k&&(k=x[p].DBF.len),T=="B"&&P=="N"&&(T="N",B[p]=x[p].DBF.dec,k=x[p].DBF.len),F[p]=T=="C"||P=="N"?k:s[T]||0,S+=F[p],C[p]=T}var A=d.next(32);for(A.write_shift(4,318902576),A.write_shift(4,h.length),A.write_shift(2,296+32*_),A.write_shift(2,S),p=0;p<4;++p)A.write_shift(4,0);for(A.write_shift(4,0|(+t[J1]||3)<<8),p=0,y=0;p<g.length;++p)if(g[p]!=null){var b=d.next(32),R=(g[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,R,"sbcs"),b.write_shift(1,C[p]=="?"?"C":C[p],"sbcs"),b.write_shift(4,y),b.write_shift(1,F[p]||s[C[p]]||0),b.write_shift(1,B[p]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),y+=F[p]||s[C[p]]||0}var W=d.next(264);for(W.write_shift(4,13),p=0;p<65;++p)W.write_shift(4,0);for(p=0;p<h.length;++p){var Y=d.next(S);for(Y.write_shift(1,0),y=0;y<g.length;++y)if(g[y]!=null)switch(C[y]){case"L":Y.write_shift(1,h[p][y]==null?63:h[p][y]?84:70);break;case"B":Y.write_shift(8,h[p][y]||0,"f");break;case"N":var q="0";for(typeof h[p][y]=="number"&&(q=h[p][y].toFixed(B[y]||0)),_=0;_<F[y]-q.length;++_)Y.write_shift(1,32);Y.write_shift(1,q,"sbcs");break;case"D":h[p][y]?(Y.write_shift(4,("0000"+h[p][y].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(h[p][y].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+h[p][y].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var U=String(h[p][y]!=null?h[p][y]:"").slice(0,F[y]);for(Y.write_shift(1,U,"sbcs"),_=0;_<F[y]-U.length;++_)Y.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),p3=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Sa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,h){var x=e[h];return typeof x=="number"?qm(x):x},a=function(g,h,x){var p=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?g:qm(p)};e["|"]=254;function n(g,h){switch(h.type){case"base64":return s(Rs(g),h);case"binary":return s(g,h);case"buffer":return s(rr&&Buffer.isBuffer(g)?g.toString("binary"):Pc(g),h);case"array":return s(M0(g),h)}throw new Error("Unrecognized type "+h.type)}function s(g,h){var x=g.split(/[\n\r]+/),p=-1,y=-1,_=0,S=0,E=[],C=[],F=null,B={},T=[],P=[],k=[],I=0,A;for(+h.codepage>=0&&xc(+h.codepage);_!==x.length;++_){I=0;var b=x[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),R=b.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),W=R[0],Y;if(b.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&C.push(b.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,U=!1,H=!1,Q=!1,ne=-1,ee=-1;for(S=1;S<R.length;++S)switch(R[S].charAt(0)){case"A":break;case"X":y=parseInt(R[S].slice(1))-1,U=!0;break;case"Y":for(p=parseInt(R[S].slice(1))-1,U||(y=0),A=E.length;A<=p;++A)E[A]=[];break;case"K":Y=R[S].slice(1),Y.charAt(0)==='"'?Y=Y.slice(1,Y.length-1):Y==="TRUE"?Y=!0:Y==="FALSE"?Y=!1:isNaN(Ds(Y))?isNaN(vc(Y).getDate())||(Y=Ya(Y)):(Y=Ds(Y),F!==null&&cx(F)&&(Y=hx(Y))),q=!0;break;case"E":Q=!0;var N=h_(R[S].slice(1),{r:p,c:y});E[p][y]=[E[p][y],N];break;case"S":H=!0,E[p][y]=[E[p][y],"S5S"];break;case"G":break;case"R":ne=parseInt(R[S].slice(1))-1;break;case"C":ee=parseInt(R[S].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}if(q&&(E[p][y]&&E[p][y].length==2?E[p][y][0]=Y:E[p][y]=Y,F=null),H){if(Q)throw new Error("SYLK shared formula cannot have own formula");var L=ne>-1&&E[ne][ee];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");E[p][y][1]=m_(L[1],{r:p-ne,c:y-ee})}break;case"F":var D=0;for(S=1;S<R.length;++S)switch(R[S].charAt(0)){case"X":y=parseInt(R[S].slice(1))-1,++D;break;case"Y":for(p=parseInt(R[S].slice(1))-1,A=E.length;A<=p;++A)E[A]=[];break;case"M":I=parseInt(R[S].slice(1))/20;break;case"F":break;case"G":break;case"P":F=C[parseInt(R[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=R[S].slice(1).split(" "),A=parseInt(k[0],10);A<=parseInt(k[1],10);++A)I=parseInt(k[2],10),P[A-1]=I===0?{hidden:!0}:{wch:I},fh(P[A-1]);break;case"C":y=parseInt(R[S].slice(1))-1,P[y]||(P[y]={});break;case"R":p=parseInt(R[S].slice(1))-1,T[p]||(T[p]={}),I>0?(T[p].hpt=I,T[p].hpx=eg(I)):I===0&&(T[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}D<1&&(F=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+b)}}return T.length>0&&(B["!rows"]=T),P.length>0&&(B["!cols"]=P),h&&h.sheetRows&&(E=E.slice(0,h.sheetRows)),[E,B]}function o(g,h){var x=n(g,h),p=x[0],y=x[1],_=il(p,h);return Sa(y).forEach(function(S){_[S]=y[S]}),_}function l(g,h){return Zi(o(g,h),h)}function c(g,h,x,p){var y="C;Y"+(x+1)+";X"+(p+1)+";K";switch(g.t){case"n":y+=g.v||0,g.f&&!g.F&&(y+=";E"+mh(g.f,{r:x,c:p}));break;case"b":y+=g.v?"TRUE":"FALSE";break;case"e":y+=g.w||g.v;break;case"d":y+='"'+(g.w||g.v)+'"';break;case"s":y+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(g,h){h.forEach(function(x,p){var y="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=u0(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=d0(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&g.push(y)})}function d(g,h){h.forEach(function(x,p){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*f0(x.hpx)+";"),y.length>2&&g.push(y+"R"+(p+1))})}function m(g,h){var x=["ID;PWXL;N;E"],p=[],y=Sr(g["!ref"]),_,S=Array.isArray(g),E=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),g["!cols"]&&u(x,g["!cols"]),g["!rows"]&&d(x,g["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var C=y.s.r;C<=y.e.r;++C)for(var F=y.s.c;F<=y.e.c;++F){var B=fr({r:C,c:F});_=S?(g[C]||[])[F]:g[B],!(!_||_.v==null&&(!_.f||_.F))&&p.push(c(_,g,C,F))}return x.join(E)+E+p.join(E)+E+"E"+E}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),x3=function(){function e(s,o){switch(o.type){case"base64":return t(Rs(s),o);case"binary":return t(s,o);case"buffer":return t(rr&&Buffer.isBuffer(s)?s.toString("binary"):Pc(s),o);case"array":return t(M0(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,m=[];d!==l.length;++d){if(l[d].trim()==="BOT"){m[++c]=[],u=0;continue}if(!(c<0)){var g=l[d].trim().split(","),h=g[0],x=g[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){m[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?m[c][u]=!0:p==="FALSE"?m[c][u]=!1:isNaN(Ds(x))?isNaN(vc(x).getDate())?m[c][u]=x:m[c][u]=Ya(x):m[c][u]=Ds(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),m[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(s,o){return il(e(s,o),o)}function a(s,o){return Zi(r(s,o),o)}var n=function(){var s=function(c,u,d,m,g){c.push(u),c.push(d+","+m),c.push('"'+g.replace(/"/g,'""')+'"')},o=function(c,u,d,m){c.push(u+","+d),c.push(u==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(c){var u=[],d=Sr(c["!ref"]),m,g=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=fr({r:h,c:x});if(m=g?(c[h]||[])[x]:c[p],!m){o(u,1,0,"");continue}switch(m.t){case"n":var y=m.w;!y&&m.v!=null&&(y=m.v),y==null?m.f&&!m.F?o(u,1,0,"="+m.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=gi(m.z||Ir[14],dn(Ya(m.v)))),o(u,0,m.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var _=`\r
`,S=u.join(_);return S}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),Kx=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var h=m.split(`
`),x=-1,p=-1,y=0,_=[];y!==h.length;++y){var S=h[y].trim().split(":");if(S[0]==="cell"){var E=da(S[1]);if(_.length<=E.r)for(x=_.length;x<=E.r;++x)_[x]||(_[x]=[]);switch(x=E.r,p=E.c,S[2]){case"t":_[x][p]=e(S[3]);break;case"v":_[x][p]=+S[3];break;case"vtf":var C=S[S.length-1];case"vtc":switch(S[3]){case"nl":_[x][p]=!!+S[4];break;default:_[x][p]=+S[4];break}S[2]=="vtf"&&(_[x][p]=[_[x][p],C])}}}return g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),_}function a(m,g){return il(r(m,g),g)}function n(m,g){return Zi(a(m,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(m){if(!m||!m["!ref"])return"";for(var g=[],h=[],x,p="",y=jn(m["!ref"]),_=Array.isArray(m),S=y.s.r;S<=y.e.r;++S)for(var E=y.s.c;E<=y.e.c;++E)if(p=fr({r:S,c:E}),x=_?(m[S]||[])[E]:m[p],!(!x||x.v==null||x.t==="z")){switch(h=["cell",p,"t"],x.t){case"s":case"str":h.push(t(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=t(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var C=dn(Ya(x.v));h[2]="vtc",h[3]="nd",h[4]=""+C,h[5]=x.w||gi(x.z||Ir[14],C);break;case"e":continue}g.push(h.join(":"))}return g.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(m){return[s,o,l,o,u(m),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}}(),g3=function(){function e(d,m,g,h,x){x.raw?m[g][h]=d:d===""||(d==="TRUE"?m[g][h]=!0:d==="FALSE"?m[g][h]=!1:isNaN(Ds(d))?isNaN(vc(d).getDate())?m[g][h]=d:m[g][h]=Ya(d):m[g][h]=Ds(d))}function t(d,m){var g=m||{},h=[];if(!d||d.length===0)return h;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var y=10,_=0,S=0;S<=p;++S)_=x[S].indexOf(" "),_==-1?_=x[S].length:_++,y=Math.max(y,_);for(S=0;S<=p;++S){h[S]=[];var E=0;for(e(x[S].slice(0,y).trim(),h,S,E,g),E=1;E<=(x[S].length-y)/10+1;++E)e(x[S].slice(y+(E-1)*10,y+E*10).trim(),h,S,E,g)}return g.sheetRows&&(h=h.slice(0,g.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var m={},g=!1,h=0,x=0;h<d.length;++h)(x=d.charCodeAt(h))==34?g=!g:!g&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&x.push([m[h],h]);if(!x.length){m=a;for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&x.push([m[h],h])}return x.sort(function(p,y){return p[0]-y[0]||a[p[1]]-a[y[1]]}),r[x.pop()[1]]||44}function s(d,m){var g=m||{},h="",x=g.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=n(d.slice(0,1024)):g&&g.FS?h=g.FS:h=n(d.slice(0,1024));var y=0,_=0,S=0,E=0,C=0,F=h.charCodeAt(0),B=!1,T=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var k=g.dateNF!=null?k4(g.dateNF):null;function I(){var A=d.slice(E,C),b={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)b.t="z";else if(g.raw)b.t="s",b.v=A;else if(A.trim().length===0)b.t="s",b.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(b.t="s",b.v=A.slice(2,-1).replace(/""/g,'"')):p_(A)?(b.t="n",b.f=A.slice(1)):(b.t="s",b.v=A);else if(A=="TRUE")b.t="b",b.v=!0;else if(A=="FALSE")b.t="b",b.v=!1;else if(!isNaN(S=Ds(A)))b.t="n",g.cellText!==!1&&(b.w=A),b.v=S;else if(!isNaN(vc(A).getDate())||k&&A.match(k)){b.z=g.dateNF||Ir[14];var R=0;k&&A.match(k)&&(A=D4(A,g.dateNF,A.match(k)||[]),R=1),g.cellDates?(b.t="d",b.v=Ya(A,R)):(b.t="n",b.v=dn(Ya(A,R))),g.cellText!==!1&&(b.w=gi(b.z,b.v instanceof Date?dn(b.v):b.v)),g.cellNF||delete b.z}else b.t="s",b.v=A;if(b.t=="z"||(g.dense?(x[y]||(x[y]=[]),x[y][_]=b):x[fr({c:_,r:y})]=b),E=C+1,P=d.charCodeAt(E),p.e.c<_&&(p.e.c=_),p.e.r<y&&(p.e.r=y),T==F)++_;else if(_=0,++y,g.sheetRows&&g.sheetRows<=y)return!0}e:for(;C<d.length;++C)switch(T=d.charCodeAt(C)){case 34:P===34&&(B=!B);break;case F:case 10:case 13:if(!B&&I())break e;break}return C-E>0&&I(),x["!ref"]=Zr(p),x}function o(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,m):il(t(d,m),m)}function l(d,m){var g="",h=m.type=="string"?[0,0,0,0]:Cj(d,m);switch(m.type){case"base64":g=Rs(d);break;case"binary":g=d;break;case"buffer":m.codepage==65001?g=d.toString("utf8"):m.codepage&&typeof Ri<"u"?g=Ri.utils.decode(m.codepage,d):g=rr&&Buffer.isBuffer(d)?d.toString("binary"):Pc(d);break;case"array":g=M0(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+m.type)}return h[0]==239&&h[1]==187&&h[2]==191?g=ac(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=ac(g):m.type=="binary"&&typeof Ri<"u"&&m.codepage&&(g=Ri.utils.decode(m.codepage,Ri.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?Kx.to_sheet(m.type=="string"?g:ac(g),m):o(g,m)}function c(d,m){return Zi(l(d,m),m)}function u(d){for(var m=[],g=Sr(d["!ref"]),h,x=Array.isArray(d),p=g.s.r;p<=g.e.r;++p){for(var y=[],_=g.s.c;_<=g.e.c;++_){var S=fr({r:p,c:_});if(h=x?(d[p]||[])[_]:d[S],!h||h.v==null){y.push("          ");continue}for(var E=(h.w||(Ms(h),h.w)||"").slice(0,10);E.length<10;)E+=" ";y.push(E+(_===0?" ":""))}m.push(y.join(""))}return m.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),vp=function(){function e(N,L,D){if(N){wn(N,N.l||0);for(var M=D.Enum||ne;N.l<N.length;){var z=N.read_shift(2),ue=M[z]||M[65535],pe=N.read_shift(2),me=N.l+pe,Ne=ue.f&&ue.f(N,pe,D);if(N.l=me,L(Ne,ue,z))return}}}function t(N,L){switch(L.type){case"base64":return r(Qn(Rs(N)),L);case"binary":return r(Qn(N),L);case"buffer":case"array":return r(N,L)}throw"Unsupported type "+L.type}function r(N,L){if(!N)return N;var D=L||{},M=D.dense?[]:{},z="Sheet1",ue="",pe=0,me={},Ne=[],Oe=[],Ie={s:{r:0,c:0},e:{r:0,c:0}},Ze=D.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)D.Enum=ne,e(N,function(Xe,xt,$e){switch($e){case 0:D.vers=Xe,Xe>=4096&&(D.qpro=!0);break;case 6:Ie=Xe;break;case 204:Xe&&(ue=Xe);break;case 222:ue=Xe;break;case 15:case 51:D.qpro||(Xe[1].v=Xe[1].v.slice(1));case 13:case 14:case 16:$e==14&&(Xe[2]&112)==112&&(Xe[2]&15)>1&&(Xe[2]&15)<15&&(Xe[1].z=D.dateNF||Ir[14],D.cellDates&&(Xe[1].t="d",Xe[1].v=hx(Xe[1].v))),D.qpro&&Xe[3]>pe&&(M["!ref"]=Zr(Ie),me[z]=M,Ne.push(z),M=D.dense?[]:{},Ie={s:{r:0,c:0},e:{r:0,c:0}},pe=Xe[3],z=ue||"Sheet"+(pe+1),ue="");var ie=D.dense?(M[Xe[0].r]||[])[Xe[0].c]:M[fr(Xe[0])];if(ie){ie.t=Xe[1].t,ie.v=Xe[1].v,Xe[1].z!=null&&(ie.z=Xe[1].z),Xe[1].f!=null&&(ie.f=Xe[1].f);break}D.dense?(M[Xe[0].r]||(M[Xe[0].r]=[]),M[Xe[0].r][Xe[0].c]=Xe[1]):M[fr(Xe[0])]=Xe[1];break}},D);else if(N[2]==26||N[2]==14)D.Enum=ee,N[2]==14&&(D.qpro=!0,N.l=0),e(N,function(Xe,xt,$e){switch($e){case 204:z=Xe;break;case 22:Xe[1].v=Xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Xe[3]>pe&&(M["!ref"]=Zr(Ie),me[z]=M,Ne.push(z),M=D.dense?[]:{},Ie={s:{r:0,c:0},e:{r:0,c:0}},pe=Xe[3],z="Sheet"+(pe+1)),Ze>0&&Xe[0].r>=Ze)break;D.dense?(M[Xe[0].r]||(M[Xe[0].r]=[]),M[Xe[0].r][Xe[0].c]=Xe[1]):M[fr(Xe[0])]=Xe[1],Ie.e.c<Xe[0].c&&(Ie.e.c=Xe[0].c),Ie.e.r<Xe[0].r&&(Ie.e.r=Xe[0].r);break;case 27:Xe[14e3]&&(Oe[Xe[14e3][0]]=Xe[14e3][1]);break;case 1537:Oe[Xe[0]]=Xe[1],Xe[0]==pe&&(z=Xe[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(M["!ref"]=Zr(Ie),me[ue||z]=M,Ne.push(ue||z),!Oe.length)return{SheetNames:Ne,Sheets:me};for(var st={},Fe=[],le=0;le<Oe.length;++le)me[Ne[le]]?(Fe.push(Oe[le]||Ne[le]),st[Oe[le]]=me[Oe[le]]||me[Ne[le]]):(Fe.push(Oe[le]),st[Oe[le]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:st}}function a(N,L){var D=L||{};if(+D.codepage>=0&&xc(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var M=ln(),z=Sr(N["!ref"]),ue=Array.isArray(N),pe=[];ct(M,0,s(1030)),ct(M,6,c(z));for(var me=Math.min(z.e.r,8191),Ne=z.s.r;Ne<=me;++Ne)for(var Oe=_a(Ne),Ie=z.s.c;Ie<=z.e.c;++Ie){Ne===z.s.r&&(pe[Ie]=Ra(Ie));var Ze=pe[Ie]+Oe,st=ue?(N[Ne]||[])[Ie]:N[Ze];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?ct(M,13,h(Ne,Ie,st.v)):ct(M,14,p(Ne,Ie,st.v));else{var Fe=Ms(st);ct(M,15,m(Ne,Ie,Fe.slice(0,239)))}}return ct(M,1),M.end()}function n(N,L){var D=L||{};if(+D.codepage>=0&&xc(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var M=ln();ct(M,0,o(N));for(var z=0,ue=0;z<N.SheetNames.length;++z)(N.Sheets[N.SheetNames[z]]||{})["!ref"]&&ct(M,27,Q(N.SheetNames[z],ue++));var pe=0;for(z=0;z<N.SheetNames.length;++z){var me=N.Sheets[N.SheetNames[z]];if(!(!me||!me["!ref"])){for(var Ne=Sr(me["!ref"]),Oe=Array.isArray(me),Ie=[],Ze=Math.min(Ne.e.r,8191),st=Ne.s.r;st<=Ze;++st)for(var Fe=_a(st),le=Ne.s.c;le<=Ne.e.c;++le){st===Ne.s.r&&(Ie[le]=Ra(le));var Xe=Ie[le]+Fe,xt=Oe?(me[st]||[])[le]:me[Xe];if(!(!xt||xt.t=="z"))if(xt.t=="n")ct(M,23,I(st,le,pe,xt.v));else{var $e=Ms(xt);ct(M,22,T(st,le,pe,$e.slice(0,239)))}}++pe}}return ct(M,1),M.end()}function s(N){var L=He(2);return L.write_shift(2,N),L}function o(N){var L=He(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var D=0,M=0,z=0,ue=0;ue<N.SheetNames.length;++ue){var pe=N.SheetNames[ue],me=N.Sheets[pe];if(!(!me||!me["!ref"])){++z;var Ne=jn(me["!ref"]);D<Ne.e.r&&(D=Ne.e.r),M<Ne.e.c&&(M=Ne.e.c)}}return D>8191&&(D=8191),L.write_shift(2,D),L.write_shift(1,z),L.write_shift(1,M),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(N,L,D){var M={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&D.qpro?(M.s.c=N.read_shift(1),N.l++,M.s.r=N.read_shift(2),M.e.c=N.read_shift(1),N.l++,M.e.r=N.read_shift(2),M):(M.s.c=N.read_shift(2),M.s.r=N.read_shift(2),L==12&&D.qpro&&(N.l+=2),M.e.c=N.read_shift(2),M.e.r=N.read_shift(2),L==12&&D.qpro&&(N.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function c(N){var L=He(8);return L.write_shift(2,N.s.c),L.write_shift(2,N.s.r),L.write_shift(2,N.e.c),L.write_shift(2,N.e.r),L}function u(N,L,D){var M=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(M[0].c=N.read_shift(1),M[3]=N.read_shift(1),M[0].r=N.read_shift(2),N.l+=2):(M[2]=N.read_shift(1),M[0].c=N.read_shift(2),M[0].r=N.read_shift(2)),M}function d(N,L,D){var M=N.l+L,z=u(N,L,D);if(z[1].t="s",D.vers==20768){N.l++;var ue=N.read_shift(1);return z[1].v=N.read_shift(ue,"utf8"),z}return D.qpro&&N.l++,z[1].v=N.read_shift(M-N.l,"cstr"),z}function m(N,L,D){var M=He(7+D.length);M.write_shift(1,255),M.write_shift(2,L),M.write_shift(2,N),M.write_shift(1,39);for(var z=0;z<M.length;++z){var ue=D.charCodeAt(z);M.write_shift(1,ue>=128?95:ue)}return M.write_shift(1,0),M}function g(N,L,D){var M=u(N,L,D);return M[1].v=N.read_shift(2,"i"),M}function h(N,L,D){var M=He(7);return M.write_shift(1,255),M.write_shift(2,L),M.write_shift(2,N),M.write_shift(2,D,"i"),M}function x(N,L,D){var M=u(N,L,D);return M[1].v=N.read_shift(8,"f"),M}function p(N,L,D){var M=He(13);return M.write_shift(1,255),M.write_shift(2,L),M.write_shift(2,N),M.write_shift(8,D,"f"),M}function y(N,L,D){var M=N.l+L,z=u(N,L,D);if(z[1].v=N.read_shift(8,"f"),D.qpro)N.l=M;else{var ue=N.read_shift(2);C(N.slice(N.l,N.l+ue),z),N.l+=ue}return z}function _(N,L,D){var M=L&32768;return L&=-32769,L=(M?N:0)+(L>=8192?L-16384:L),(M?"":"$")+(D?Ra(L):_a(L))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(N,L){wn(N,0);for(var D=[],M=0,z="",ue="",pe="",me="";N.l<N.length;){var Ne=N[N.l++];switch(Ne){case 0:D.push(N.read_shift(8,"f"));break;case 1:ue=_(L[0].c,N.read_shift(2),!0),z=_(L[0].r,N.read_shift(2),!1),D.push(ue+z);break;case 2:{var Oe=_(L[0].c,N.read_shift(2),!0),Ie=_(L[0].r,N.read_shift(2),!1);ue=_(L[0].c,N.read_shift(2),!0),z=_(L[0].r,N.read_shift(2),!1),D.push(Oe+Ie+":"+ue+z)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(N.read_shift(2));break;case 6:{for(var Ze="";Ne=N[N.l++];)Ze+=String.fromCharCode(Ne);D.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:me=D.pop(),pe=D.pop(),D.push(["AND","OR"][Ne-20]+"("+pe+","+me+")");break;default:if(Ne<32&&E[Ne])me=D.pop(),pe=D.pop(),D.push(pe+E[Ne]+me);else if(S[Ne]){if(M=S[Ne][1],M==69&&(M=N[N.l++]),M>D.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+D.join("|")+"|");return}var st=D.slice(-M);D.length-=M,D.push(S[Ne][0]+"("+st.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}D.length==1?L[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function F(N){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=N.read_shift(2),L[3]=N[N.l++],L[0].c=N[N.l++],L}function B(N,L){var D=F(N);return D[1].t="s",D[1].v=N.read_shift(L-4,"cstr"),D}function T(N,L,D,M){var z=He(6+M.length);z.write_shift(2,N),z.write_shift(1,D),z.write_shift(1,L),z.write_shift(1,39);for(var ue=0;ue<M.length;++ue){var pe=M.charCodeAt(ue);z.write_shift(1,pe>=128?95:pe)}return z.write_shift(1,0),z}function P(N,L){var D=F(N);D[1].v=N.read_shift(2);var M=D[1].v>>1;if(D[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return D[1].v=M,D}function k(N,L){var D=F(N),M=N.read_shift(4),z=N.read_shift(4),ue=N.read_shift(2);if(ue==65535)return M===0&&z===3221225472?(D[1].t="e",D[1].v=15):M===0&&z===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var pe=ue&32768;return ue=(ue&32767)-16446,D[1].v=(1-pe*2)*(z*Math.pow(2,ue+32)+M*Math.pow(2,ue)),D}function I(N,L,D,M){var z=He(14);if(z.write_shift(2,N),z.write_shift(1,D),z.write_shift(1,L),M==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var ue=0,pe=0,me=0,Ne=0;return M<0&&(ue=1,M=-M),pe=Math.log2(M)|0,M/=Math.pow(2,pe-31),Ne=M>>>0,Ne&2147483648||(M/=2,++pe,Ne=M>>>0),M-=Ne,Ne|=2147483648,Ne>>>=0,M*=Math.pow(2,32),me=M>>>0,z.write_shift(4,me),z.write_shift(4,Ne),pe+=16383+(ue?32768:0),z.write_shift(2,pe),z}function A(N,L){var D=k(N);return N.l+=L-14,D}function b(N,L){var D=F(N),M=N.read_shift(4);return D[1].v=M>>6,D}function R(N,L){var D=F(N),M=N.read_shift(8,"f");return D[1].v=M,D}function W(N,L){var D=R(N);return N.l+=L-10,D}function Y(N,L){return N[N.l+L-1]==0?N.read_shift(L,"cstr"):""}function q(N,L){var D=N[N.l++];D>L-1&&(D=L-1);for(var M="";M.length<D;)M+=String.fromCharCode(N[N.l++]);return M}function U(N,L,D){if(!(!D.qpro||L<21)){var M=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var z=N.read_shift(L-21,"cstr");return[M,z]}}function H(N,L){for(var D={},M=N.l+L;N.l<M;){var z=N.read_shift(2);if(z==14e3){for(D[z]=[0,""],D[z][0]=N.read_shift(2);N[N.l];)D[z][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return D}function Q(N,L){var D=He(5+N.length);D.write_shift(2,14e3),D.write_shift(2,L);for(var M=0;M<N.length;++M){var z=N.charCodeAt(M);D[D.l++]=z>127?95:z}return D[D.l++]=0,D}var ne={0:{n:"BOF",f:zx},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:U},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}(),v3=/^\s|\s$|[\t\n\r]/;function Jx(e,t){if(!t.bookSST)return"";var r=[ta];r[r.length]=lt("sst",null,{xmlns:sl[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(v3)&&(s+=' xml:space="preserve"'),s+=">"+dr(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function y3(e){return[e.read_shift(4),e.read_shift(4)]}function w3(e,t){return t||(t=He(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var b3=dN;function N3(e){var t=ln();Qe(t,159,w3(e));for(var r=0;r<e.length;++r)Qe(t,19,b3(e[r]));return Qe(t,160),t.end()}function _3(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Qx(e){var t=0,r,a=_3(e),n=a.length+1,s,o,l,c,u;for(r=Xi(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var S3=function(){function e(n,s){switch(s.type){case"base64":return t(Rs(n),s);case"binary":return t(n,s);case"buffer":return t(rr&&Buffer.isBuffer(n)?n.toString("binary"):Pc(n),s);case"array":return t(M0(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var o=s||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,m){Array.isArray(l)&&(l[m]=[]);for(var g=/\\\w+\b/g,h=0,x,p=-1;x=g.exec(d);){switch(x[0]){case"\\cell":var y=d.slice(h,g.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++p,y.length){var _={v:y,t:"s"};Array.isArray(l)?l[m][p]=_:l[fr({r:m,c:p})]=_}break}h=g.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Zr(u),l}function r(n,s){return Zi(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],o=Sr(n["!ref"]),l,c=Array.isArray(n),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var m=fr({r:u,c:d});l=c?(n[u]||[])[d]:n[m],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Ms(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function yp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var A3=6,Os=A3;function u0(e){return Math.floor((e+Math.round(128/Os)/256)*Os)}function d0(e){return Math.floor((e-5)/Os*100+.5)/100}function wf(e){return Math.round((e*Os+5)/Os*256)/256}function fh(e){e.width?(e.wpx=u0(e.width),e.wch=d0(e.wpx),e.MDW=Os):e.wpx?(e.wch=d0(e.wpx),e.width=wf(e.wch),e.MDW=Os):typeof e.wch=="number"&&(e.width=wf(e.wch),e.wpx=u0(e.width),e.MDW=Os),e.customWidth&&delete e.customWidth}var j3=96,Zx=j3;function f0(e){return e*96/Zx}function eg(e){return e*Zx/96}function E3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=lt("numFmt",null,{numFmtId:a,formatCode:dr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=lt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function T3(e){var t=[];return t[t.length]=lt("cellXfs",null),e.forEach(function(r){t[t.length]=lt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=lt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function tg(e,t){var r=[ta,lt("styleSheet",null,{xmlns:sl[0],"xmlns:vt":ua.vt})],a;return e.SSF&&(a=E3(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=T3(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function C3(e,t){var r=e.read_shift(2),a=Ma(e);return[r,a]}function P3(e,t,r){r||(r=He(6+4*t.length)),r.write_shift(2,e),fa(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function L3(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=vN(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=gN(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ma(e),a}function F3(e,t){t||(t=He(25+4*32)),t.write_shift(2,e.sz*20),yN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),l0(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),fa(e.name,t),t.length>t.l?t.slice(0,t.l):t}var k3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Wd,D3=vs;function wp(e,t){t||(t=He(4*3+8*7+16*1)),Wd||(Wd=eh(k3));var r=Wd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(l0({auto:1},t),l0({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function O3(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function rg(e,t,r){r||(r=He(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Gl(e,t){return t||(t=He(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var I3=vs;function R3(e,t){return t||(t=He(51)),t.write_shift(1,0),Gl(null,t),Gl(null,t),Gl(null,t),Gl(null,t),Gl(null,t),t.length>t.l?t.slice(0,t.l):t}function M3(e,t){return t||(t=He(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),o0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function B3(e,t,r){var a=He(2052);return a.write_shift(4,e),o0(t,a),o0(r,a),a.length>a.l?a.slice(0,a.l):a}function U3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(Qe(e,615,rs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Qe(e,44,P3(n,t[n]))}),Qe(e,616))}}function q3(e){var t=1;Qe(e,611,rs(t)),Qe(e,43,F3({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Qe(e,612)}function W3(e){var t=2;Qe(e,603,rs(t)),Qe(e,45,wp({patternType:"none"})),Qe(e,45,wp({patternType:"gray125"})),Qe(e,604)}function H3(e){var t=1;Qe(e,613,rs(t)),Qe(e,46,R3()),Qe(e,614)}function $3(e){var t=1;Qe(e,626,rs(t)),Qe(e,47,rg({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Qe(e,627)}function z3(e,t){Qe(e,617,rs(t.length)),t.forEach(function(r){Qe(e,47,rg(r,0))}),Qe(e,618)}function V3(e){var t=1;Qe(e,619,rs(t)),Qe(e,48,M3({xfId:0,builtinId:0,name:"Normal"})),Qe(e,620)}function G3(e){var t=0;Qe(e,505,rs(t)),Qe(e,506)}function Y3(e){var t=0;Qe(e,508,B3(t,"TableStyleMedium9","PivotStyleMedium4")),Qe(e,509)}function X3(e,t){var r=ln();return Qe(r,278),U3(r,e.SSF),q3(r),W3(r),H3(r),$3(r),z3(r,t.cellXfs),V3(r),G3(r),Y3(r),Qe(r,279),r.end()}function ag(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ta];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function K3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ma(e)}}function J3(e){var t=He(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),fa(e.name,t),t.slice(0,t.l)}function Q3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Z3(e){var t=He(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function e_(e,t){var r=He(8+2*t.length);return r.write_shift(4,e),fa(t,r),r.slice(0,r.l)}function t_(e){return e.l+=4,e.read_shift(4)!=0}function r_(e,t){var r=He(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function a_(){var e=ln();return Qe(e,332),Qe(e,334,rs(1)),Qe(e,335,J3({name:"XLDAPR",version:12e4,flags:3496657072})),Qe(e,336),Qe(e,339,e_(1,"XLDAPR")),Qe(e,52),Qe(e,35,rs(514)),Qe(e,4096,rs(0)),Qe(e,4097,On(1)),Qe(e,36),Qe(e,53),Qe(e,340),Qe(e,337,r_(1,!0)),Qe(e,51,Z3([[1,0]])),Qe(e,338),Qe(e,333),e.end()}function ng(){var e=[ta];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function n_(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=fr(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var Vo=1024;function sg(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[lt("xml",null,{"xmlns:v":bn.v,"xmlns:o":bn.o,"xmlns:x":bn.x,"xmlns:mv":bn.mv}).replace(/\/>/,">"),lt("o:shapelayout",lt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),lt("v:shapetype",[lt("v:stroke",null,{joinstyle:"miter"}),lt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Vo<e*1e3;)Vo+=1e3;return t.forEach(function(s){var o=da(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?lt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=lt("v:fill",c,l),d={on:"t",obscured:"t"};++Vo,n=n.concat(["<v:shape"+yc({id:"_x0000_s"+Vo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,lt("v:shadow",null,d),lt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Na("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Na("x:AutoFill","False"),Na("x:Row",String(o.r)),Na("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function ig(e){var t=[ta,lt("comments",null,{xmlns:sl[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var s=dr(n.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(dr(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Na("t",dr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(Na("t",dr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function s_(e,t,r){var a=[ta,lt("ThreadedComments",null,{xmlns:ua.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var s="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(lt("threadedComment",Na("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function i_(e){var t=[ta,lt("personList",null,{xmlns:ua.TCMNT,"xmlns:x":sl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(lt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function o_(e){var t={};t.iauthor=e.read_shift(4);var r=ao(e);return t.rfx=r.s,t.ref=fr(r.s),e.l+=16,t}function l_(e,t){return t==null&&(t=He(36)),t.write_shift(4,e[1].iauthor),ol(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var c_=Ma;function u_(e){return fa(e.slice(0,54))}function d_(e){var t=ln(),r=[];return Qe(t,628),Qe(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Qe(t,632,u_(n.a)))})}),Qe(t,631),Qe(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:da(a[0]),e:da(a[0])};Qe(t,635,l_([s,n])),n.t&&n.t.length>0&&Qe(t,637,hN(n)),Qe(t,636),delete n.iauthor})}),Qe(t,634),Qe(t,629),t.end()}function f_(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&mr.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var og=["xlsb","xlsm","xlam","biff8","xla"],h_=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,n+(l?"":"$")+Ra(d)+(c?"":"$")+_a(u)}return function(n,s){return t=s,n.replace(e,r)}}(),hh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mh=function(){return function(t,r){return t.replace(hh,function(a,n,s,o,l,c){var u=oh(o)-(s?0:r.c),d=ih(c)-(l?0:r.r),m=d==0?"":l?d+1:"["+d+"]",g=u==0?"":s?u+1:"["+u+"]";return n+"R"+m+"C"+g})}}();function m_(e,t){return e.replace(hh,function(r,a,n,s,o,l){return a+(n=="$"?n+s:Ra(oh(s)+t.c))+(o=="$"?o+l:_a(ih(l)+t.r))})}function p_(e){return e.length!=1}function Kr(e){e.l+=1}function vi(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function lg(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return cg(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),o=vi(e,2),l=vi(e,2);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function cg(e){var t=vi(e,2),r=vi(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function x_(e,t,r){if(r.biff<8)return cg(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=vi(e,2),o=vi(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function ug(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return g_(e);var a=e.read_shift(r&&r.biff==12?4:2),n=vi(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function g_(e){var t=vi(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function v_(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function y_(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return w_(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:o,rRel:l}}function w_(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function b_(e,t,r){var a=(e[e.l++]&96)>>5,n=lg(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function N_(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=lg(e,s,r);return[a,n,o]}function __(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function S_(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function A_(e,t,r){var a=(e[e.l++]&96)>>5,n=x_(e,t-1,r);return[a,n]}function j_(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function bp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function E_(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function T_(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function C_(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function P_(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function L_(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function dg(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function F_(e){return e.read_shift(2),dg(e)}function k_(e){return e.read_shift(2),dg(e)}function D_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=ug(e,0,r);return[a,n]}function O_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=y_(e,0,r);return[a,n]}function I_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=ug(e,0,r);return[a,n,s]}function R_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[RS[n],mg[n],a]}function M_(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:B_(e);return[n,(s[0]===0?mg:IS)[s[1]]]}function B_(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function U_(e,t,r){e.l+=r&&r.biff==2?3:4}function q_(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function W_(e){return e.l++,kc[e.read_shift(1)]}function H_(e){return e.l++,e.read_shift(2)}function $_(e){return e.l++,e.read_shift(1)!==0}function z_(e){return e.l++,ll(e)}function V_(e,t,r){return e.l++,Gx(e,t-1,r)}function G_(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=IN(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=kc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ll(e);break;case 2:r[1]=UN(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Y_(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?ao:HN)(e));return n}function X_(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,o=[];s!=a&&(o[s]=[]);++s)for(var l=0;l!=n;++l)o[s][l]=G_(e,r.biff);return o}function K_(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function J_(e,t,r){if(r.biff==5)return Q_(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function Q_(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function Z_(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function eS(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function tS(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function rS(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var aS=vs,nS=vs,sS=vs;function Dc(e,t,r){return e.l+=2,[v_(e)]}function ph(e){return e.l+=6,[]}var iS=Dc,oS=ph,lS=ph,cS=Dc;function fg(e){return e.l+=2,[zx(e),e.read_shift(2)&1]}var uS=Dc,dS=fg,fS=ph,hS=Dc,mS=Dc,pS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xS(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),o=pS[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:s}}function gS(e){return e.l+=2,[e.read_shift(4)]}function vS(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function yS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function bS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function NS(e){return e.l+=4,[0,0]}var Np={1:{n:"PtgExp",f:q_},2:{n:"PtgTbl",f:sS},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:V_},26:{n:"PtgSheet",f:vS},27:{n:"PtgEndSheet",f:yS},28:{n:"PtgErr",f:W_},29:{n:"PtgBool",f:$_},30:{n:"PtgInt",f:H_},31:{n:"PtgNum",f:z_},32:{n:"PtgArray",f:j_},33:{n:"PtgFunc",f:R_},34:{n:"PtgFuncVar",f:M_},35:{n:"PtgName",f:K_},36:{n:"PtgRef",f:D_},37:{n:"PtgArea",f:b_},38:{n:"PtgMemArea",f:Z_},39:{n:"PtgMemErr",f:aS},40:{n:"PtgMemNoMem",f:nS},41:{n:"PtgMemFunc",f:eS},42:{n:"PtgRefErr",f:tS},43:{n:"PtgAreaErr",f:__},44:{n:"PtgRefN",f:O_},45:{n:"PtgAreaN",f:A_},46:{n:"PtgMemAreaN",f:wS},47:{n:"PtgMemNoMemN",f:bS},57:{n:"PtgNameX",f:J_},58:{n:"PtgRef3d",f:I_},59:{n:"PtgArea3d",f:N_},60:{n:"PtgRefErr3d",f:rS},61:{n:"PtgAreaErr3d",f:S_},255:{}},_S={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},SS={1:{n:"PtgElfLel",f:fg},2:{n:"PtgElfRw",f:hS},3:{n:"PtgElfCol",f:iS},6:{n:"PtgElfRwV",f:mS},7:{n:"PtgElfColV",f:cS},10:{n:"PtgElfRadical",f:uS},11:{n:"PtgElfRadicalS",f:fS},13:{n:"PtgElfColS",f:oS},15:{n:"PtgElfColSV",f:lS},16:{n:"PtgElfRadicalLel",f:dS},25:{n:"PtgList",f:xS},29:{n:"PtgSxName",f:gS},255:{}},AS={0:{n:"PtgAttrNoop",f:NS},1:{n:"PtgAttrSemi",f:L_},2:{n:"PtgAttrIf",f:C_},4:{n:"PtgAttrChoose",f:E_},8:{n:"PtgAttrGoto",f:T_},16:{n:"PtgAttrSum",f:U_},32:{n:"PtgAttrBaxcel",f:bp},33:{n:"PtgAttrBaxcel",f:bp},64:{n:"PtgAttrSpace",f:F_},65:{n:"PtgAttrSpaceSemi",f:k_},128:{n:"PtgAttrIfError",f:P_},255:{}};function jS(e,t,r,a){if(a.biff<8)return vs(e,t);for(var n=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=X_(e,0,a),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Y_(e,r[o][1],a),s.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&s.push(vs(e,t)),s}function ES(e,t,r){for(var a=e.l+t,n,s,o=[];a!=e.l;)t=a-e.l,s=e[e.l],n=Np[s]||Np[_S[s]],(s===24||s===25)&&(n=(s===24?SS:AS)[e[e.l+1]]),!n||!n.f?vs(e,t):o.push([n.n,n.f(e,t,r)]);return o}function TS(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var o=a[s];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var CS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PS(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function hg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function _p(e,t,r){var a=hg(e,t,r);return a=="#REF"?a:PS(a,r)}function rl(e,t,r,a,n){var s=n&&n.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,u,d,m=0,g=0,h,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,y="",_=0,S=e[0].length;_<S;++_){var E=e[0][_];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:y=Or(" ",e[0][p][1][1]);break;case 1:y=Or("\r",e[0][p][1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+y,p=-1}l.push(u+CS[E[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=sc(E[1][1],o,n),l.push(ic(d,s));break;case"PtgRefN":d=r?sc(E[1][1],r,n):E[1][1],l.push(ic(d,s));break;case"PtgRef3d":m=E[1][1],d=sc(E[1][2],o,n),x=_p(a,m,n),l.push(x+"!"+ic(d,s));break;case"PtgFunc":case"PtgFuncVar":var C=E[1][0],F=E[1][1];C||(C=0),C&=127;var B=C==0?[]:l.slice(-C);l.length-=C,F==="User"&&(F=B.shift()),l.push(F+"("+B.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":h=op(E[1][1],r?{s:r}:o,n),l.push(Ud(h,n));break;case"PtgArea":h=op(E[1][1],o,n),l.push(Ud(h,n));break;case"PtgArea3d":m=E[1][1],h=E[1][2],x=_p(a,m,n),l.push(x+"!"+Ud(h,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var T=(a.names||[])[g-1]||(a[0]||[])[g],P=T?T.Name:"SH33TJSNAME"+String(g);P&&P.slice(0,6)=="_xlfn."&&!n.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var k=E[1][1];g=E[1][2];var I;if(n.biff<=5)k<0&&(k=-k),a[k]&&(I=a[k][g]);else{var A="";if(((a[k]||[])[0]||[])[0]==14849||(((a[k]||[])[0]||[])[0]==1025?a[k][g]&&a[k][g].itab>0&&(A=a.SheetNames[a[k][g].itab-1]+"!"):A=a.SheetNames[g-1]+"!"),a[k]&&a[k][g])A+=a[k][g].Name;else if(a[0]&&a[0][g])A+=a[0][g].Name;else{var b=(hg(a,k,n)||"").split(";;");b[g-1]?A=b[g-1]:A+="SH33TJSERRX"}l.push(A);break}I||(I={Name:"SH33TJSERRY"}),l.push(I.Name);break;case"PtgParen":var R="(",W=")";if(p>=0){switch(y="",e[0][p][1][0]){case 2:R=Or(" ",e[0][p][1][1])+R;break;case 3:R=Or("\r",e[0][p][1][1])+R;break;case 4:W=Or(" ",e[0][p][1][1])+W;break;case 5:W=Or("\r",e[0][p][1][1])+W;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(R+l.pop()+W);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:E[1][1],r:E[1][0]};var Y={c:r.c,r:r.r};if(a.sharedf[fr(d)]){var q=a.sharedf[fr(d)];l.push(rl(q,o,Y,a,n))}else{var U=!1;for(c=0;c!=a.arrayf.length;++c)if(u=a.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(rl(u[1],o,Y,a,n)),U=!0;break}U||l.push(E[1])}break;case"PtgArray":l.push("{"+TS(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&H.indexOf(e[0][_][0])==-1){E=e[0][p];var Q=!0;switch(E[1][0]){case 4:Q=!1;case 0:y=Or(" ",E[1][1]);break;case 5:Q=!1;case 1:y=Or("\r",E[1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((Q?y:"")+l.pop()+(Q?"":y)),p=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function LS(e){if(e==null){var t=He(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ki(e);return Ki(0)}function FS(e,t,r,a,n){var s=Ji(t,r,n),o=LS(e.v),l=He(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=He(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var m=ba([s,o,l,u]);return m}function B0(e,t,r){var a=e.read_shift(4),n=ES(e,a,r),s=e.read_shift(4),o=s>0?jS(e,s,n,r):null;return[n,o]}var kS=B0,U0=B0,DS=B0,OS=B0,IS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},RS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function MS(e){var t="of:="+e.replace(hh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function BS(e){return e.replace(/\./,"!")}var oc=typeof Map<"u";function xh(e,t,r){var a=0,n=e.length;if(r){if(oc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=oc?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(oc?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function q0(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Os=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=d0(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=wf(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function pg(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ni(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,s=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){ux(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function US(e,t,r){if(e&&e["!ref"]){var a=Sr(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qS(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zr(e[r])+'"/>';return t+"</mergeCells>"}function WS(e,t,r,a,n){var s=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Fs(dr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+lt("outlinePr",null,u)}!s&&!l||(n[n.length]=lt("sheetPr",l,o))}var HS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$S=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function zS(e){var t={sheet:1};return HS.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),$S.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Qx(e.password).toString(16).toUpperCase()),lt("sheetProtection",null,t)}function VS(e){return pg(e),lt("pageMargins",null,e)}function GS(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=lt("col",null,q0(n,a)));return r[r.length]="</cols>",r.join("")}function YS(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Zr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=jn(n);o.s.r==o.e.r&&(o.e.r=jn(t["!ref"]).e.r,n=Zr(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),lt("autoFilter",null,{ref:n})}function XS(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),lt("sheetViews",lt("sheetView",null,n),{})}function KS(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=kc[e.v];break;case"d":a&&a.cellDates?n=Ya(e.v,-1).toISOString():(e=fn(e),e.t="n",n=""+(e.v=dn(Ya(e.v)))),typeof e.z>"u"&&(e.z=Ir[14]);break;default:n=e.v;break}var l=Na("v",dr(n)),c={r:t},u=Ni(a.cellXfs,e,a);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=Na("v",""+xh(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=lt("f",dr(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),lt("c",l,c)}function JS(e,t,r,a){var n=[],s=[],o=Sr(e["!ref"]),l="",c,u="",d=[],m=0,g=0,h=e["!rows"],x=Array.isArray(e),p={r:u},y,_=-1;for(g=o.s.c;g<=o.e.c;++g)d[g]=Ra(g);for(m=o.s.r;m<=o.e.r;++m){for(s=[],u=_a(m),g=o.s.c;g<=o.e.c;++g){c=d[g]+u;var S=x?(e[m]||[])[g]:e[c];S!==void 0&&(l=KS(S,c,e,t))!=null&&s.push(l)}(s.length>0||h&&h[m])&&(p={r:u},h&&h[m]&&(y=h[m],y.hidden&&(p.hidden=1),_=-1,y.hpx?_=f0(y.hpx):y.hpt&&(_=y.hpt),_>-1&&(p.ht=_,p.customHeight=1),y.level&&(p.outlineLevel=y.level)),n[n.length]=lt("row",s.join(""),p))}if(h)for(;m<h.length;++m)h&&h[m]&&(p={r:m+1},y=h[m],y.hidden&&(p.hidden=1),_=-1,y.hpx?_=f0(y.hpx):y.hpt&&(_=y.hpt),_>-1&&(p.ht=_,p.customHeight=1),y.level&&(p.outlineLevel=y.level),n[n.length]=lt("row","",p));return n.join("")}function xg(e,t,r,a){var n=[ta,lt("worksheet",null,{xmlns:sl[0],"xmlns:r":ua.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Sr(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Zr(d)}a||(a={}),c["!comments"]=[];var m=[];WS(c,r,e,t,n),n[n.length]=lt("dimension",null,{ref:u}),n[n.length]=XS(c,t,e,r),t.sheetFormat&&(n[n.length]=lt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=GS(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=JS(c,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=zS(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=YS(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=qS(c["!merges"]));var g=-1,h,x=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=ur(a,-1,dr(p[1].Target).replace(/#.*$/,""),Zt.HLINK),h["r:id"]="rId"+x),(g=p[1].Target.indexOf("#"))>-1&&(h.location=dr(p[1].Target.slice(g+1))),p[1].Tooltip&&(h.tooltip=dr(p[1].Tooltip)),n[n.length]=lt("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=VS(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Na("ignoredErrors",lt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),m.length>0&&(x=ur(a,-1,"../drawings/drawing"+(e+1)+".xml",Zt.DRAW),n[n.length]=lt("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=m),c["!comments"].length>0&&(x=ur(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Zt.VML),n[n.length]=lt("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function QS(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function ZS(e,t,r){var a=He(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=f0(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var m=-1,g=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[fr(u)];x&&(m<0&&(m=h),g=h)}m<0||(++l,a.write_shift(4,m),a.write_shift(4,g))}var p=a.l;return a.l=c,a.write_shift(4,l),a.l=p,a.length>a.l?a.slice(0,a.l):a}function e6(e,t,r,a){var n=ZS(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Qe(e,0,n)}var t6=ao,r6=ol;function a6(){}function n6(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=mN(e),r}function s6(e,t,r){r==null&&(r=He(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return l0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Lx(e,r),r.slice(0,r.l)}function i6(e){var t=Mn(e);return[t]}function o6(e,t,r){return r==null&&(r=He(8)),eo(t,r)}function l6(e){var t=to(e);return[t]}function c6(e,t,r){return r==null&&(r=He(4)),ro(t,r)}function u6(e){var t=Mn(e),r=e.read_shift(1);return[t,r,"b"]}function d6(e,t,r){return r==null&&(r=He(9)),eo(t,r),r.write_shift(1,e.v?1:0),r}function f6(e){var t=to(e),r=e.read_shift(1);return[t,r,"b"]}function h6(e,t,r){return r==null&&(r=He(5)),ro(t,r),r.write_shift(1,e.v?1:0),r}function m6(e){var t=Mn(e),r=e.read_shift(1);return[t,r,"e"]}function p6(e,t,r){return r==null&&(r=He(9)),eo(t,r),r.write_shift(1,e.v),r}function x6(e){var t=to(e),r=e.read_shift(1);return[t,r,"e"]}function g6(e,t,r){return r==null&&(r=He(8)),ro(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function v6(e){var t=Mn(e),r=e.read_shift(4);return[t,r,"s"]}function y6(e,t,r){return r==null&&(r=He(12)),eo(t,r),r.write_shift(4,t.v),r}function w6(e){var t=to(e),r=e.read_shift(4);return[t,r,"s"]}function b6(e,t,r){return r==null&&(r=He(8)),ro(t,r),r.write_shift(4,t.v),r}function N6(e){var t=Mn(e),r=ll(e);return[t,r,"n"]}function _6(e,t,r){return r==null&&(r=He(16)),eo(t,r),Ki(e.v,r),r}function S6(e){var t=to(e),r=ll(e);return[t,r,"n"]}function A6(e,t,r){return r==null&&(r=He(12)),ro(t,r),Ki(e.v,r),r}function j6(e){var t=Mn(e),r=Fx(e);return[t,r,"n"]}function E6(e,t,r){return r==null&&(r=He(12)),eo(t,r),kx(e.v,r),r}function T6(e){var t=to(e),r=Fx(e);return[t,r,"n"]}function C6(e,t,r){return r==null&&(r=He(8)),ro(t,r),kx(e.v,r),r}function P6(e){var t=Mn(e),r=lh(e);return[t,r,"is"]}function L6(e){var t=Mn(e),r=Ma(e);return[t,r,"str"]}function F6(e,t,r){return r==null&&(r=He(12+4*e.v.length)),eo(t,r),fa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function k6(e){var t=to(e),r=Ma(e);return[t,r,"str"]}function D6(e,t,r){return r==null&&(r=He(8+4*e.v.length)),ro(t,r),fa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function O6(e,t,r){var a=e.l+t,n=Mn(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"b"];if(r.cellFormula){e.l+=2;var l=U0(e,a-e.l,r);o[3]=rl(l,null,n,r.supbooks,r)}else e.l=a;return o}function I6(e,t,r){var a=e.l+t,n=Mn(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"e"];if(r.cellFormula){e.l+=2;var l=U0(e,a-e.l,r);o[3]=rl(l,null,n,r.supbooks,r)}else e.l=a;return o}function R6(e,t,r){var a=e.l+t,n=Mn(e);n.r=r["!row"];var s=ll(e),o=[n,s,"n"];if(r.cellFormula){e.l+=2;var l=U0(e,a-e.l,r);o[3]=rl(l,null,n,r.supbooks,r)}else e.l=a;return o}function M6(e,t,r){var a=e.l+t,n=Mn(e);n.r=r["!row"];var s=Ma(e),o=[n,s,"str"];if(r.cellFormula){e.l+=2;var l=U0(e,a-e.l,r);o[3]=rl(l,null,n,r.supbooks,r)}else e.l=a;return o}var B6=ao,U6=ol;function q6(e,t){return t==null&&(t=He(4)),t.write_shift(4,e),t}function W6(e,t){var r=e.l+t,a=ao(e),n=ch(e),s=Ma(e),o=Ma(e),l=Ma(e);e.l=r;var c={rfx:a,relId:n,loc:s,display:l};return o&&(c.Tooltip=o),c}function H6(e,t){var r=He(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ol({s:da(e[0]),e:da(e[0])},r),uh("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return fa(n||"",r),fa(e[1].Tooltip||"",r),fa("",r),r.slice(0,r.l)}function $6(){}function z6(e,t,r){var a=e.l+t,n=Dx(e),s=e.read_shift(1),o=[n];if(o[2]=s,r.cellFormula){var l=kS(e,a-e.l,r);o[1]=l}else e.l=a;return o}function V6(e,t,r){var a=e.l+t,n=ao(e),s=[n];if(r.cellFormula){var o=OS(e,a-e.l,r);s[1]=o,e.l=a}else e.l=a;return s}function G6(e,t,r){r==null&&(r=He(18));var a=q0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var gg=["left","right","top","bottom","header","footer"];function Y6(e){var t={};return gg.forEach(function(r){t[r]=ll(e)}),t}function X6(e,t){return t==null&&(t=He(6*8)),pg(e),gg.forEach(function(r){Ki(e[r],t)}),t}function K6(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function J6(e,t,r){r==null&&(r=He(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Q6(e){var t=He(24);return t.write_shift(4,4),t.write_shift(4,1),ol(e,t),t}function Z6(e,t){return t==null&&(t=He(16*4+2)),t.write_shift(2,e.password?Qx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function eA(){}function tA(){}function rA(e,t,r,a,n,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=fn(t),t.z=t.z||Ir[14],t.v=dn(Ya(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=Ni(n.cellXfs,t,n),t.l&&s["!links"].push([fr(c),t.l]),t.c&&s["!comments"].push([fr(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=xh(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,o?Qe(e,18,b6(t,c)):Qe(e,7,y6(t,c))):(c.t="str",o?Qe(e,17,D6(t,c)):Qe(e,6,F6(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Qe(e,13,C6(t,c)):Qe(e,2,E6(t,c)):o?Qe(e,16,A6(t,c)):Qe(e,5,_6(t,c)),!0;case"b":return c.t="b",o?Qe(e,15,h6(t,c)):Qe(e,4,d6(t,c)),!0;case"e":return c.t="e",o?Qe(e,14,g6(t,c)):Qe(e,3,p6(t,c)),!0}return o?Qe(e,12,c6(t,c)):Qe(e,1,o6(t,c)),!0}function aA(e,t,r,a){var n=Sr(t["!ref"]||"A1"),s,o="",l=[];Qe(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){o=_a(d),e6(e,t,n,d);var m=!1;if(d<=n.e.r)for(var g=n.s.c;g<=n.e.c;++g){d===n.s.r&&(l[g]=Ra(g)),s=l[g]+o;var h=c?(t[d]||[])[g]:t[s];if(!h){m=!1;continue}m=rA(e,h,d,g,a,t,m)}}Qe(e,146)}function nA(e,t){!t||!t["!merges"]||(Qe(e,177,q6(t["!merges"].length)),t["!merges"].forEach(function(r){Qe(e,176,U6(r))}),Qe(e,178))}function sA(e,t){!t||!t["!cols"]||(Qe(e,390),t["!cols"].forEach(function(r,a){r&&Qe(e,60,G6(a,r))}),Qe(e,391))}function iA(e,t){!t||!t["!ref"]||(Qe(e,648),Qe(e,649,Q6(Sr(t["!ref"]))),Qe(e,650))}function oA(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=ur(r,-1,a[1].Target.replace(/#.*$/,""),Zt.HLINK);Qe(e,494,H6(a,n))}}),delete t["!links"]}function lA(e,t,r,a){if(t["!comments"].length>0){var n=ur(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Zt.VML);Qe(e,551,uh("rId"+n)),t["!legacy"]=n}}function cA(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:Zr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=jn(s);l.s.r==l.e.r&&(l.e.r=jn(t["!ref"]).e.r,s=Zr(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Qe(e,161,ol(Sr(s))),Qe(e,162)}}function uA(e,t,r){Qe(e,133),Qe(e,137,J6(t,r)),Qe(e,138),Qe(e,134)}function dA(e,t){t["!protect"]&&Qe(e,535,Z6(t["!protect"]))}function fA(e,t,r,a){var n=ln(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Sr(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Qe(n,129),(r.vbaraw||o["!outline"])&&Qe(n,147,s6(l,o["!outline"])),Qe(n,148,r6(c)),uA(n,o,r.Workbook),sA(n,o),aA(n,o,e,t),dA(n,o),cA(n,o,r,e),nA(n,o),oA(n,o,a),o["!margins"]&&Qe(n,476,X6(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&iA(n,o),lA(n,o,e,a),Qe(n,130),n.end()}function hA(e,t){e.l+=10;var r=Ma(e);return{name:r}}var mA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function pA(e){return!e.Workbook||!e.Workbook.WBProps?"false":V4(e.Workbook.WBProps.date1904)?"true":"false"}var xA="][*?/\\".split("");function vg(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return xA.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function gA(e,t,r){e.forEach(function(a,n){vg(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function vA(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];gA(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)US(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function yg(e){var t=[ta];t[t.length]=lt("workbook",null,{xmlns:sl[0],"xmlns:r":ua.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(mA.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=lt("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:dr(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=lt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=lt("definedName",dr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function yA(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=yf(e),r.name=Ma(e),r}function wA(e,t){return t||(t=He(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),uh(e.strRelID,t),fa(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function bA(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ma(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function NA(e,t){t||(t=He(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Lx(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function _A(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=pN(e),o=DS(e,0,r),l=ch(e);e.l=a;var c={Name:s,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function SA(e,t){Qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Qe(e,156,wA(n))}Qe(e,144)}function AA(e,t){t||(t=He(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return fa("SheetJS",t),fa(t0.version,t),fa(t0.version,t),fa("7262",t),t.length>t.l?t.slice(0,t.l):t}function jA(e,t){t||(t=He(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function EA(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(Qe(e,135),Qe(e,158,jA(n)),Qe(e,136))}}function TA(e,t){var r=ln();return Qe(r,131),Qe(r,128,AA()),Qe(r,153,NA(e.Workbook&&e.Workbook.WBProps||null)),EA(r,e),SA(r,e),Qe(r,132),r.end()}function CA(e,t,r){return(t.slice(-4)===".bin"?TA:yg)(e)}function PA(e,t,r,a,n){return(t.slice(-4)===".bin"?fA:xg)(e,r,a,n)}function LA(e,t,r){return(t.slice(-4)===".bin"?X3:tg)(e,r)}function FA(e,t,r){return(t.slice(-4)===".bin"?N3:Jx)(e,r)}function kA(e,t,r){return(t.slice(-4)===".bin"?d_:ig)(e)}function DA(e){return(e.slice(-4)===".bin"?a_:ng)()}function OA(e,t){var r=[];return e.Props&&r.push(LN(e.Props,t)),e.Custprops&&r.push(FN(e.Props,e.Custprops)),r.join("")}function IA(){return""}function RA(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var s=[];s.push(lt("NumberFormat",null,{"ss:Format":dr(Ir[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(lt("Style",s.join(""),o))}),lt("Styles",r.join(""))}function wg(e){return lt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+mh(e.Ref,{r:0,c:0})})}function MA(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(wg(n)))}return lt("Names",r.join(""))}function BA(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(wg(l)))}return s.join("")}function UA(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(lt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(lt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(lt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(lt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Na("ProtectContents","True")),e["!protect"].objects&&n.push(Na("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Na("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Na("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Na("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":lt("WorksheetOptions",n.join(""),{xmlns:bn.x})}function qA(e){return e.map(function(t){var r=z4(t.t||""),a=lt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return lt("Comment",a,{"ss:Author":t.a})}).join("")}function WA(e,t,r,a,n,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+dr(mh(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=da(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=dr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=dr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var m="",g="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":m="Number",g=String(e.v);break;case"b":m="Boolean",g=e.v?"1":"0";break;case"e":m="Error",g=kc[e.v];break;case"d":m="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ir[14]);break;case"s":m="String",g=$4(e.v||"");break}var h=Ni(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var x=e.v!=null?g:"",p=e.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=qA(e.c)),lt("Cell",p,l)}function HA(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=eg(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $A(e,t,r,a){if(!e["!ref"])return"";var n=Sr(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,_){fh(y);var S=!!y.width,E=q0(_,y),C={"ss:Index":_+1};S&&(C["ss:Width"]=u0(E.width)),y.hidden&&(C["ss:Hidden"]="1"),l.push(lt("Column",null,C))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[HA(u,(e["!rows"]||[])[u])],m=n.s.c;m<=n.e.c;++m){var g=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>m)&&!(s[o].s.r>u)&&!(s[o].e.c<m)&&!(s[o].e.r<u)){(s[o].s.c!=m||s[o].s.r!=u)&&(g=!0);break}if(!g){var h={r:u,c:m},x=fr(h),p=c?(e[u]||[])[m]:e[x];d.push(WA(p,x,e,t,r,a,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function zA(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],o=s?BA(s,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=s?$A(s,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(UA(s,t,e,r)),a.join("")}function VA(e,t){t||(t={}),e.SSF||(e.SSF=fn(Ir)),e.SSF&&(I0(),O0(e.SSF),t.revssf=R0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(OA(e,t)),r.push(IA()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(lt("Worksheet",zA(a,t,e),{"ss:Name":dr(e.SheetNames[a])}));return r[2]=RA(e,t),r[3]=MA(e),ta+lt("Workbook",r.join(""),{xmlns:bn.ss,"xmlns:o":bn.o,"xmlns:x":bn.x,"xmlns:ss":bn.ss,"xmlns:dt":bn.dt,"xmlns:html":bn.html})}var Hd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function GA(e,t){var r=[],a=[],n=[],s=0,o,l=Km(cp,"n"),c=Km(up,"n");if(e.Props)for(o=Sa(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?a:n).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Sa(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?a:n).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<n.length;++s)$x.indexOf(n[s][0])>-1||qx.indexOf(n[s][0])>-1||n[s][1]!=null&&u.push(n[s]);a.length&&mr.utils.cfb_add(t,"/SummaryInformation",pp(a,Hd.SI,c,up)),(r.length||u.length)&&mr.utils.cfb_add(t,"/DocumentSummaryInformation",pp(r,Hd.DSI,l,cp,u.length?u:null,Hd.UDI))}function YA(e,t){var r=t||{},a=mr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return mr.utils.cfb_add(a,n,bg(e,r)),r.biff==8&&(e.Props||e.Custprops)&&GA(e,a),r.biff==8&&e.vbaraw&&f_(a,mr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var XA={0:{f:QS},1:{f:i6},2:{f:j6},3:{f:m6},4:{f:u6},5:{f:N6},6:{f:L6},7:{f:v6},8:{f:M6},9:{f:R6},10:{f:O6},11:{f:I6},12:{f:l6},13:{f:T6},14:{f:x6},15:{f:f6},16:{f:S6},17:{f:k6},18:{f:w6},19:{f:lh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_A},40:{},42:{},43:{f:L3},44:{f:C3},45:{f:D3},46:{f:I3},47:{f:O3},48:{},49:{f:lN},50:{},51:{f:Q3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c3},62:{f:P6},63:{f:n_},64:{f:eA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:K6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n6},148:{f:t6,p:16},151:{f:$6},152:{},153:{f:bA},154:{},155:{},156:{f:yA},157:{},158:{},159:{T:1,f:y3},160:{T:-1},161:{T:1,f:ao},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:B6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:K3},336:{T:-1},337:{f:t_,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:a3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:z6},427:{f:V6},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Y6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:a6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:W6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:c_},633:{T:1},634:{T:-1},635:{T:1,f:o_},636:{T:-1},637:{f:fN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:tA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ct(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,s),s>0&&sh(r)&&e.push(r)}}function KA(e,t,r,a){var n=a||(r||[]).length||0;if(n<=8224)return ct(e,t,r,n);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Oc(e,t,r){return e||(e=He(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function JA(e,t,r,a){var n=He(9);return Oc(n,e,t),Vx(r,a||"b",n),n}function QA(e,t,r){var a=He(8+2*r.length);return Oc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function ZA(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?dn(Ya(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?ct(e,2,h3(r,a,n)):ct(e,3,f3(r,a,n));return;case"b":case"e":ct(e,5,JA(r,a,t.v,t.t));return;case"s":case"str":ct(e,4,QA(r,a,(t.v||"").slice(0,255)));return}ct(e,1,Oc(null,r,a))}function ej(e,t,r,a){var n=Array.isArray(t),s=Sr(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Zr(s)}for(var u=s.s.r;u<=s.e.r;++u){l=_a(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Ra(d)),o=c[d]+l;var m=n?(t[u]||[])[d]:t[o];m&&ZA(e,m,u,d)}}}function tj(e,t){for(var r=t||{},a=ln(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ct(a,r.biff==4?1033:r.biff==3?521:9,dh(e,16,r)),ej(a,e.Sheets[e.SheetNames[n]],n,r),ct(a,10),a.end()}function rj(e,t,r){ct(e,49,XN({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function aj(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&ct(e,1054,QN(n,t[n],r))})}function nj(e,t){var r=He(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ct(e,2151,r),r=He(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Xx(Sr(t["!ref"]||"A1"),r),r.write_shift(4,4),ct(e,2152,r)}function sj(e,t){for(var r=0;r<16;++r)ct(e,224,gp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){ct(e,224,gp(a,0,t))})}function ij(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];ct(e,440,i3(a)),a[1].Tooltip&&ct(e,2048,o3(a))}delete t["!links"]}function oj(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&ct(e,125,u3(q0(n,a),n))})}}function lj(e,t,r,a,n){var s=16+Ni(n.cellXfs,t,n);if(t.v==null&&!t.bf){ct(e,513,Ji(r,a,s));return}if(t.bf)ct(e,6,FS(t,r,a,n,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?dn(Ya(t.v)):t.v;ct(e,515,r3(r,a,o,s));break;case"b":case"e":ct(e,517,t3(r,a,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var l=xh(n.Strings,t.v,n.revStrings);ct(e,253,KN(r,a,l,s))}else ct(e,516,JN(r,a,(t.v||"").slice(0,255),s,n));break;default:ct(e,513,Ji(r,a,s))}}function cj(e,t,r){var a=ln(),n=r.SheetNames[e],s=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,m="",g=[],h=Sr(s["!ref"]||"A1"),x=u?65536:16384;if(h.e.c>255||h.e.r>=x){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,x-1)}ct(a,2057,dh(r,16,t)),ct(a,13,On(1)),ct(a,12,On(100)),ct(a,15,Va(!0)),ct(a,17,Va(!1)),ct(a,16,Ki(.001)),ct(a,95,Va(!0)),ct(a,42,Va(!1)),ct(a,43,Va(!1)),ct(a,130,On(1)),ct(a,128,e3([0,0])),ct(a,131,Va(!1)),ct(a,132,Va(!1)),u&&oj(a,s["!cols"]),ct(a,512,ZN(h,t)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){m=_a(p);for(var y=h.s.c;y<=h.e.c;++y){p===h.s.r&&(g[y]=Ra(y)),d=g[y]+m;var _=c?(s[p]||[])[y]:s[d];_&&(lj(a,_,p,y,t),u&&_.l&&s["!links"].push([d,_.l]))}}var S=l.CodeName||l.name||n;return u&&ct(a,574,YN((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&ct(a,229,s3(s["!merges"])),u&&ij(a,s),ct(a,442,Yx(S)),u&&nj(a,s),ct(a,10),a.end()}function uj(e,t,r){var a=ln(),n=(e||{}).Workbook||{},s=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(ct(a,2057,dh(e,5,r)),r.bookType=="xla"&&ct(a,135),ct(a,225,l?On(1200):null),ct(a,193,ON(2)),c&&ct(a,191),c&&ct(a,192),ct(a,226),ct(a,92,$N("SheetJS",r)),ct(a,66,On(l?1200:1252)),l&&ct(a,353,On(0)),l&&ct(a,448),ct(a,317,d3(e.SheetNames.length)),l&&e.vbaraw&&ct(a,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";ct(a,442,Yx(u))}ct(a,156,On(17)),ct(a,25,Va(!1)),ct(a,18,Va(!1)),ct(a,19,On(0)),l&&ct(a,431,Va(!1)),l&&ct(a,444,On(0)),ct(a,61,GN()),ct(a,64,Va(!1)),ct(a,141,On(0)),ct(a,34,Va(pA(e)=="true")),ct(a,14,Va(!0)),l&&ct(a,439,Va(!1)),ct(a,218,On(0)),rj(a,e,r),aj(a,e.SSF,r),sj(a,r),l&&ct(a,352,Va(!1));var d=a.end(),m=ln();l&&ct(m,140,l3()),l&&r.Strings&&KA(m,252,VN(r.Strings)),ct(m,10);var g=m.end(),h=ln(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var y=d.length+x+g.length;for(p=0;p<e.SheetNames.length;++p){var _=s[p]||{};ct(h,133,zN({pos:y,hs:_.Hidden||0,dt:0,name:e.SheetNames[p]},r)),y+=t[p].length}var S=h.end();if(x!=S.length)throw new Error("BS8 "+x+" != "+S.length);var E=[];return d.length&&E.push(d),S.length&&E.push(S),g.length&&E.push(g),ba(E)}function dj(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=fn(Ir)),e&&e.SSF&&(I0(),O0(e.SSF),r.revssf=R0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,gh(r),r.cellXfs=[],Ni(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=cj(n,r,e);return a.unshift(uj(e,a,r)),ba(a)}function bg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=jn(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return dj(e,t);case 4:case 3:case 2:return tj(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function fj(e,t,r,a){for(var n=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>o)&&!(n[u].e.r<r||n[u].e.c<o)){if(n[u].s.r<r||n[u].s.c<o){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var d=fr({r,c:o}),m=a.dense?(e[r]||[])[o]:e[d],g=m&&m.v!=null&&(m.h||H4(m.w||(Ms(m),m.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),a.editable?g='<span contenteditable="true">'+g+"</span>":m&&(h["data-t"]=m&&m.t||"z",m.v!=null&&(h["data-v"]=m.v),m.z!=null&&(h["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),h.id=(a.id||"sjs")+"-"+d,s.push(lt("td",g,h))}}var x="<tr>";return x+s.join("")+"</tr>"}var hj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mj="</body></html>";function pj(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ng(e,t){var r=t||{},a=r.header!=null?r.header:hj,n=r.footer!=null?r.footer:mj,s=[a],o=jn(e["!ref"]);r.dense=Array.isArray(e),s.push(pj(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(fj(e,o,l,r));return s.push("</table>"+n),s.join("")}function _g(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?da(a.origin):a.origin;n=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var d=jn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var m=[],g=0,h=e["!rows"]||(e["!rows"]=[]),x=0,p=0,y=0,_=0,S=0,E=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var C=l[x];if(Sp(C)){if(a.display)continue;h[p]={hidden:!0}}var F=C.children;for(y=_=0;y<F.length;++y){var B=F[y];if(!(a.display&&Sp(B))){var T=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):G4(B.innerHTML),P=B.getAttribute("data-z")||B.getAttribute("z");for(g=0;g<m.length;++g){var k=m[g];k.s.c==_+s&&k.s.r<p+n&&p+n<=k.e.r&&(_=k.e.c+1-s,g=-1)}E=+B.getAttribute("colspan")||1,((S=+B.getAttribute("rowspan")||1)>1||E>1)&&m.push({s:{r:p+n,c:_+s},e:{r:p+n+(S||1)-1,c:_+s+(E||1)-1}});var I={t:"s",v:T},A=B.getAttribute("data-t")||B.getAttribute("t")||"";T!=null&&(T.length==0?I.t=A||"z":a.raw||T.trim().length==0||A=="s"||(T==="TRUE"?I={t:"b",v:!0}:T==="FALSE"?I={t:"b",v:!1}:isNaN(Ds(T))?isNaN(vc(T).getDate())||(I={t:"d",v:Ya(T)},a.cellDates||(I={t:"n",v:dn(I.v)}),I.z=a.dateNF||Ir[14]):I={t:"n",v:Ds(T)})),I.z===void 0&&P!=null&&(I.z=P);var b="",R=B.getElementsByTagName("A");if(R&&R.length)for(var W=0;W<R.length&&!(R[W].hasAttribute("href")&&(b=R[W].getAttribute("href"),b.charAt(0)!="#"));++W);b&&b.charAt(0)!="#"&&(I.l={Target:b}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][_+s]=I):e[fr({c:_+s,r:p+n})]=I,u.e.c<_+s&&(u.e.c=_+s),_+=E}}++p}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),u.e.r=Math.max(u.e.r,p-1+n),e["!ref"]=Zr(u),p>=c&&(e["!fullref"]=Zr((u.e.r=l.length-x+p-1+n,u))),e}function Sg(e,t){var r=t||{},a=r.dense?[]:{};return _g(a,e,t)}function xj(e,t){return Zi(Sg(e,t),t)}function Sp(e){var t="",r=gj(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function gj(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var vj=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+yc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ta+t}}(),Ap=function(){var e=function(s){return dr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,o,l){var c=[];c.push('      <table:table table:name="'+dr(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,m=jn(s["!ref"]||"A1"),g=s["!merges"]||[],h=0,x=Array.isArray(s);if(s["!cols"])for(d=0;d<=m.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",y=s["!rows"]||[];for(u=0;u<m.s.r;++u)p=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=m.e.r;++u){for(p=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<m.s.c;++d)c.push(t);for(;d<=m.e.c;++d){var _=!1,S={},E="";for(h=0;h!=g.length;++h)if(!(g[h].s.c>d)&&!(g[h].s.r>u)&&!(g[h].e.c<d)&&!(g[h].e.r<u)){(g[h].s.c!=d||g[h].s.r!=u)&&(_=!0),S["table:number-columns-spanned"]=g[h].e.c-g[h].s.c+1,S["table:number-rows-spanned"]=g[h].e.r-g[h].s.r+1;break}if(_){c.push(r);continue}var C=fr({r:u,c:d}),F=x?(s[u]||[])[d]:s[C];if(F&&F.f&&(S["table:formula"]=dr(MS(F.f)),F.F&&F.F.slice(0,C.length)==C)){var B=jn(F.F);S["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,S["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!F){c.push(t);continue}switch(F.t){case"b":E=F.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=F.v?"true":"false";break;case"n":E=F.w||String(F.v||0),S["office:value-type"]="float",S["office:value"]=F.v||0;break;case"s":case"str":E=F.v==null?"":F.v,S["office:value-type"]="string";break;case"d":E=F.w||Ya(F.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Ya(F.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(t);continue}var T=e(E);if(F.l&&F.l.Target){var P=F.l.Target;P=P.charAt(0)=="#"?"#"+BS(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),T=lt("text:a",T,{"xlink:href":P.replace(/&/g,"&amp;")})}c.push("          "+lt("table:table-cell",lt("text:p",T,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var m=u["!cols"][d];if(m.width==null&&m.wpx==null&&m.wch==null)continue;fh(m),m.ods=l;var g=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var m=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ta],u=yc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=yc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Bx().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)c.push(a(o.Sheets[o.SheetNames[m]],o,m));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Ag(e,t){if(t.bookType=="fods")return Ap(e,t);var r=th(),a="",n=[],s=[];return a="mimetype",Ht(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ht(r,a,Ap(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Ht(r,a,vj(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Ht(r,a,ta+Bx()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Ht(r,a,PN(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ht(r,a,TN(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function h0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yj(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qn(Fs(e))}function wj(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function yi(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function bj(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=n&255;e[t+15]|=r>=0?0:128}function wc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function lr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Jo(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function na(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=wc(e,r),s=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=wc(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var u={data:l,type:s};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function ya(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(lr(a*8+n.type)),n.type==2&&t.push(lr(n.data.length)),t.push(n.data))})}),yi(t)}function $n(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=wc(e,a),s=na(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:Jo(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=na(l.data),u=Jo(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Jo(s[3][0].data)>>>0>0),r.push(o)}return r}function Do(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:lr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:lr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:lr(o.data.length)}],a[2].push({data:ya(o.meta),type:2})});var s=ya(a);t.push(lr(s.length)),t.push(s),n.forEach(function(o){return t.push(o)})}),yi(t)}function Nj(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=wc(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[yi(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=yi(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function zn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Nj(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return yi(t)}function Oo(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=lr(a),o=s.length;t.push(s),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return yi(t)}function $d(e,t){var r=new Uint8Array(32),a=h0(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,bj(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function zd(e,t){var r=new Uint8Array(32),a=h0(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function ri(e){var t=na(e);return wc(t[1][0].data)}function _j(e,t,r){var a,n,s,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Jo(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=h0(e[7][0].data),d=0,m=[],g=h0(e[4][0].data),h=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),g.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),g.setUint16(p*2,h,!0);var y,_;switch(typeof t[p]){case"string":y=$d({t:"s",v:t[p]},r),_=zd({t:"s",v:t[p]},r);break;case"number":y=$d({t:"n",v:t[p]},r),_=zd({t:"n",v:t[p]},r);break;case"boolean":y=$d({t:"b",v:t[p]},r),_=zd({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}m.push(y),d+=y.length,x.push(_),h+=_.length,++c}for(e[2][0].data=lr(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),g.setUint16(p*2,65535,!0);return e[6][0].data=yi(m),e[3][0].data=yi(x),c}function Sj(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=jn(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Zr(a)));var s=m0(r,{range:a,header:1}),o=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(D){typeof D=="string"&&o.push(D)})});var l={},c=[],u=mr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,D){return[L,u.FullPaths[D]]}).forEach(function(L){var D=L[0],M=L[1];if(D.type==2&&D.name.match(/\.iwa/)){var z=D.content,ue=zn(z),pe=$n(ue);pe.forEach(function(me){c.push(me.id),l[me.id]={deps:[],location:M,type:Jo(me.messages[0].meta[1][0].data)}})}}),c.sort(function(L,D){return L-D});var d=c.filter(function(L){return L>1}).map(function(L){return[L,lr(L)]});u.FileIndex.map(function(L,D){return[L,u.FullPaths[D]]}).forEach(function(L){var D=L[0];if(L[1],!!D.name.match(/\.iwa/)){var M=$n(zn(D.content));M.forEach(function(z){z.messages.forEach(function(ue){d.forEach(function(pe){z.messages.some(function(me){return Jo(me.meta[1][0].data)!=11006&&wj(me.data,pe[1])})&&l[pe[0]].deps.push(z.id)})})})}});for(var m=mr.find(u,l[1].location),g=$n(zn(m.content)),h,x=0;x<g.length;++x){var p=g[x];p.id==1&&(h=p)}var y=ri(na(h.messages[0].data)[1][0].data);for(m=mr.find(u,l[y].location),g=$n(zn(m.content)),x=0;x<g.length;++x)p=g[x],p.id==y&&(h=p);for(y=ri(na(h.messages[0].data)[2][0].data),m=mr.find(u,l[y].location),g=$n(zn(m.content)),x=0;x<g.length;++x)p=g[x],p.id==y&&(h=p);for(y=ri(na(h.messages[0].data)[2][0].data),m=mr.find(u,l[y].location),g=$n(zn(m.content)),x=0;x<g.length;++x)p=g[x],p.id==y&&(h=p);var _=na(h.messages[0].data);{_[6][0].data=lr(a.e.r+1),_[7][0].data=lr(a.e.c+1);var S=ri(_[46][0].data),E=mr.find(u,l[S].location),C=$n(zn(E.content));{for(var F=0;F<C.length&&C[F].id!=S;++F);if(C[F].id!=S)throw"Bad ColumnRowUIDMapArchive";var B=na(C[F].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var T=0;T<=a.e.c;++T){var P=[];P[1]=P[2]=[{type:0,data:lr(T+420690)}],B[1].push({type:2,data:ya(P)}),B[2].push({type:0,data:lr(T)}),B[3].push({type:0,data:lr(T)})}B[4]=[],B[5]=[],B[6]=[];for(var k=0;k<=a.e.r;++k)P=[],P[1]=P[2]=[{type:0,data:lr(k+726270)}],B[4].push({type:2,data:ya(P)}),B[5].push({type:0,data:lr(k)}),B[6].push({type:0,data:lr(k)});C[F].messages[0].data=ya(B)}E.content=Oo(Do(C)),E.size=E.content.length,delete _[46];var I=na(_[4][0].data);{I[7][0].data=lr(a.e.r+1);var A=na(I[1][0].data),b=ri(A[2][0].data);E=mr.find(u,l[b].location),C=$n(zn(E.content));{if(C[0].id!=b)throw"Bad HeaderStorageBucket";var R=na(C[0].messages[0].data);for(k=0;k<s.length;++k){var W=na(R[2][0].data);W[1][0].data=lr(k),W[4][0].data=lr(s[k].length),R[2][k]={type:R[2][0].type,data:ya(W)}}C[0].messages[0].data=ya(R)}E.content=Oo(Do(C)),E.size=E.content.length;var Y=ri(I[2][0].data);E=mr.find(u,l[Y].location),C=$n(zn(E.content));{if(C[0].id!=Y)throw"Bad HeaderStorageBucket";for(R=na(C[0].messages[0].data),T=0;T<=a.e.c;++T)W=na(R[2][0].data),W[1][0].data=lr(T),W[4][0].data=lr(a.e.r+1),R[2][T]={type:R[2][0].type,data:ya(W)};C[0].messages[0].data=ya(R)}E.content=Oo(Do(C)),E.size=E.content.length;var q=ri(I[4][0].data);(function(){for(var L=mr.find(u,l[q].location),D=$n(zn(L.content)),M,z=0;z<D.length;++z){var ue=D[z];ue.id==q&&(M=ue)}var pe=na(M.messages[0].data);{pe[3]=[];var me=[];o.forEach(function(Ie,Ze){me[1]=[{type:0,data:lr(Ze)}],me[2]=[{type:0,data:lr(1)}],me[3]=[{type:2,data:yj(Ie)}],pe[3].push({type:2,data:ya(me)})})}M.messages[0].data=ya(pe);var Ne=Do(D),Oe=Oo(Ne);L.content=Oe,L.size=L.content.length})();var U=na(I[3][0].data);{var H=U[1][0];delete U[2];var Q=na(H.data);{var ne=ri(Q[2][0].data);(function(){for(var L=mr.find(u,l[ne].location),D=$n(zn(L.content)),M,z=0;z<D.length;++z){var ue=D[z];ue.id==ne&&(M=ue)}var pe=na(M.messages[0].data);{delete pe[6],delete U[7];var me=new Uint8Array(pe[5][0].data);pe[5]=[];for(var Ne=0,Oe=0;Oe<=a.e.r;++Oe){var Ie=na(me);Ne+=_j(Ie,s[Oe],o),Ie[1][0].data=lr(Oe),pe[5].push({data:ya(Ie),type:2})}pe[1]=[{type:0,data:lr(a.e.c+1)}],pe[2]=[{type:0,data:lr(a.e.r+1)}],pe[3]=[{type:0,data:lr(Ne)}],pe[4]=[{type:0,data:lr(a.e.r+1)}]}M.messages[0].data=ya(pe);var Ze=Do(D),st=Oo(Ze);L.content=st,L.size=L.content.length})()}H.data=ya(Q)}I[3][0].data=ya(U)}_[4][0].data=ya(I)}h.messages[0].data=ya(_);var ee=Do(g),N=Oo(ee);return m.content=N,m.size=m.content.length,u}function Aj(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function gh(e){Aj([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function jj(e,t){return t.bookType=="ods"?Ag(e,t):t.bookType=="numbers"?Sj(e,t):t.bookType=="xlsb"?Ej(e,t):Tj(e,t)}function Ej(e,t){Vo=1024,e&&!e.SSF&&(e.SSF=fn(Ir)),e&&e.SSF&&(I0(),O0(e.SSF),t.revssf=R0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,oc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=og.indexOf(t.bookType)>-1,n=Ix();gh(t=t||{});var s=th(),o="",l=0;if(t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ht(s,o,Ux(e.Props,t)),n.coreprops.push(o),ur(t.rels,2,o,Zt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ht(s,o,Wx(e.Props)),n.extprops.push(o),ur(t.rels,3,o,Zt.EXT_PROPS),e.Custprops!==e.Props&&Sa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ht(s,o,Hx(e.Custprops)),n.custprops.push(o),ur(t.rels,4,o,Zt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},m=e.Sheets[e.SheetNames[l-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ht(s,o,PA(l-1,o,t,e,d)),n.sheets.push(o),ur(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Zt.WS[0])}if(m){var h=m["!comments"],x=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Ht(s,p,kA(h,p)),n.comments.push(p),ur(d,-1,"../comments"+l+"."+r,Zt.CMNT),x=!0),m["!legacy"]&&x&&Ht(s,"xl/drawings/vmlDrawing"+l+".vml",sg(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&Ht(s,Mx(o),Xo(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ht(s,o,FA(t.Strings,o,t)),n.strs.push(o),ur(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),o="xl/workbook."+r,Ht(s,o,CA(e,o)),n.workbooks.push(o),ur(t.rels,1,o,Zt.WB),o="xl/theme/theme1.xml",Ht(s,o,ag(e.Themes,t)),n.themes.push(o),ur(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),o="xl/styles."+r,Ht(s,o,LA(e,o,t)),n.styles.push(o),ur(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ht(s,o,e.vbaraw),n.vba.push(o),ur(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),o="xl/metadata."+r,Ht(s,o,DA(o)),n.metadata.push(o),ur(t.wbrels,-1,"metadata."+r,Zt.XLMETA),Ht(s,"[Content_Types].xml",Rx(n,t)),Ht(s,"_rels/.rels",Xo(t.rels)),Ht(s,"xl/_rels/workbook."+r+".rels",Xo(t.wbrels)),delete t.revssf,delete t.ssf,s}function Tj(e,t){Vo=1024,e&&!e.SSF&&(e.SSF=fn(Ir)),e&&e.SSF&&(I0(),O0(e.SSF),t.revssf=R0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,oc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=og.indexOf(t.bookType)>-1,n=Ix();gh(t=t||{});var s=th(),o="",l=0;if(t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ht(s,o,Ux(e.Props,t)),n.coreprops.push(o),ur(t.rels,2,o,Zt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ht(s,o,Wx(e.Props)),n.extprops.push(o),ur(t.rels,3,o,Zt.EXT_PROPS),e.Custprops!==e.Props&&Sa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ht(s,o,Hx(e.Custprops)),n.custprops.push(o),ur(t.rels,4,o,Zt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},g=e.Sheets[e.SheetNames[l-1]],h=(g||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ht(s,o,xg(l-1,t,e,m)),n.sheets.push(o),ur(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Zt.WS[0])}if(g){var x=g["!comments"],p=!1,y="";if(x&&x.length>0){var _=!1;x.forEach(function(S){S[1].forEach(function(E){E.T==!0&&(_=!0)})}),_&&(y="xl/threadedComments/threadedComment"+l+"."+r,Ht(s,y,s_(x,d,t)),n.threadedcomments.push(y),ur(m,-1,"../threadedComments/threadedComment"+l+"."+r,Zt.TCMNT)),y="xl/comments"+l+"."+r,Ht(s,y,ig(x)),n.comments.push(y),ur(m,-1,"../comments"+l+"."+r,Zt.CMNT),p=!0}g["!legacy"]&&p&&Ht(s,"xl/drawings/vmlDrawing"+l+".vml",sg(l,g["!comments"])),delete g["!comments"],delete g["!legacy"]}m["!id"].rId1&&Ht(s,Mx(o),Xo(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ht(s,o,Jx(t.Strings,t)),n.strs.push(o),ur(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),o="xl/workbook."+r,Ht(s,o,yg(e)),n.workbooks.push(o),ur(t.rels,1,o,Zt.WB),o="xl/theme/theme1.xml",Ht(s,o,ag(e.Themes,t)),n.themes.push(o),ur(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),o="xl/styles."+r,Ht(s,o,tg(e,t)),n.styles.push(o),ur(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ht(s,o,e.vbaraw),n.vba.push(o),ur(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),o="xl/metadata."+r,Ht(s,o,ng()),n.metadata.push(o),ur(t.wbrels,-1,"metadata."+r,Zt.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ht(s,o,i_(d)),n.people.push(o),ur(t.wbrels,-1,"persons/person.xml",Zt.PEOPLE)),Ht(s,"[Content_Types].xml",Rx(n,t)),Ht(s,"_rels/.rels",Xo(t.rels)),Ht(s,"xl/_rels/workbook."+r+".rels",Xo(t.wbrels)),delete t.revssf,delete t.ssf,s}function Cj(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Rs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function jg(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Lc(t.file,mr.write(e,{type:rr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return mr.write(e,t)}function Pj(e,t){var r=fn(t||{}),a=jj(e,r);return Lj(a,r)}function Lj(e,t){var r={},a=rr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?mr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(D0(n))}return t.password&&typeof encrypt_agile<"u"?jg(encrypt_agile(n,t.password),t):t.type==="file"?Lc(t.file,n):t.type=="string"?ac(n):n}function Fj(e,t){var r=t||{},a=YA(e,r);return jg(a,r)}function fs(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return gc(Fs(a));case"binary":return Fs(a);case"string":return e;case"file":return Lc(t.file,a,"utf8");case"buffer":return rr?Bs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):fs(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function kj(e,t){switch(t.type){case"base64":return gc(e);case"binary":return e;case"string":return e;case"file":return Lc(t.file,e,"binary");case"buffer":return rr?Bs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ku(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?gc(r):t.type=="string"?ac(r):r;case"file":return Lc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Eg(e,t){i4(),vA(e);var r=fn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Eg(e,r);return r.type="array",D0(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fs(VA(e,r),r);case"slk":case"sylk":return fs(p3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return fs(Ng(e.Sheets[e.SheetNames[n]],r),r);case"txt":return kj(Cg(e.Sheets[e.SheetNames[n]],r),r);case"csv":return fs(vh(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return fs(x3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return ku(m3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return fs(g3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return fs(S3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return fs(Kx.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return fs(Ag(e,r),r);case"wk1":return ku(vp.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return ku(vp.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ku(bg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Fj(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Pj(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Dj(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Tg(e,t,r){var a=r||{};return a.type="file",a.file=t,Dj(a),Eg(e,a)}function Oj(e,t,r,a,n,s,o,l){var c=_a(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,g=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var x=o?e[r][h]:e[a[h]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;s[h]!=null&&(g[s[h]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[h]!=null){if(p==null)if(x.t=="e"&&p===null)g[s[h]]=null;else if(u!==void 0)g[s[h]]=u;else if(d&&p===null)g[s[h]]=null;else continue;else g[s[h]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:Ms(x,p,l);p!=null&&(m=!1)}}return{row:g,isempty:m}}function m0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof d){case"string":c=Sr(d);break;case"number":c=Sr(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(n=0);var m=_a(c.s.r),g=[],h=[],x=0,p=0,y=Array.isArray(e),_=c.s.r,S=0,E={};y&&!e[_]&&(e[_]=[]);var C=u.skipHidden&&e["!cols"]||[],F=u.skipHidden&&e["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(C[S]||{}).hidden)switch(g[S]=Ra(S),r=y?e[_][S]:e[g[S]+m],a){case 1:s[S]=S-c.s.c;break;case 2:s[S]=g[S];break;case 3:s[S]=u.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ms(r,null,u),p=E[o]||0,!p)E[o]=1;else{do l=o+"_"+p++;while(E[l]);E[o]=p,E[l]=1}s[S]=l}for(_=c.s.r+n;_<=c.e.r;++_)if(!(F[_]||{}).hidden){var B=Oj(e,c,_,g,a,s,y,u);(B.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(h[x++]=B.row)}return h.length=x,h}var jp=/"/g;function Ij(e,t,r,a,n,s,o,l){for(var c=!0,u=[],d="",m=_a(r),g=t.s.c;g<=t.e.c;++g)if(a[g]){var h=l.dense?(e[r]||[])[g]:e[a[g]+m];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:Ms(h,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===n||p===s||p===34||l.forceQuotes){d='"'+d.replace(jp,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(jp,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function vh(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Sr(e["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",m=[];a.dense=Array.isArray(e);for(var g=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(g[x]||{}).hidden||(m[x]=Ra(x));for(var p=0,y=n.s.r;y<=n.e.r;++y)(h[y]||{}).hidden||(d=Ij(e,n,y,m,o,c,s,a),d!=null&&(a.strip&&(d=d.replace(u,"")),(d||a.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete a.dense,r.join("")}function Cg(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=vh(e,t);return r}function Rj(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Sr(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=Ra(l);for(var d=n.s.r;d<=n.e.r;++d)for(s=_a(d),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function Pg(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?da(a.origin):a.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(s["!ref"]){var m=Sr(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(o=m.e.r+1,d.e.r=o+t.length-1+n)}else o==-1&&(o=0,d.e.r=t.length-1+n);var g=a.header||[],h=0;t.forEach(function(p,y){Sa(p).forEach(function(_){(h=g.indexOf(_))==-1&&(g[h=g.length]=_);var S=p[_],E="z",C="",F=fr({c:l+h,r:o+y+n});u=bc(s,F),S&&typeof S=="object"&&!(S instanceof Date)?s[F]=S:(typeof S=="number"?E="n":typeof S=="boolean"?E="b":typeof S=="string"?E="s":S instanceof Date?(E="d",a.cellDates||(E="n",S=dn(S)),C=a.dateNF||Ir[14]):S===null&&a.nullError&&(E="e",S=0),u?(u.t=E,u.v=S,delete u.w,delete u.R,C&&(u.z=C)):s[F]=u={t:E,v:S},C&&(u.z=C))})}),d.e.c=Math.max(d.e.c,l+g.length-1);var x=_a(o);if(n)for(h=0;h<g.length;++h)s[Ra(h+l)+x]={t:"s",v:g[h]};return s["!ref"]=Zr(d),s}function Mj(e,t){return Pg(null,e,t)}function bc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=da(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?bc(e,fr(t)):bc(e,fr({r:t,c:r||0}))}function Bj(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Uj(){return{SheetNames:[],Sheets:{}}}function qj(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var o=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(vg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Wj(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Bj(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function Hj(e,t){return e.z=t,e}function Lg(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function $j(e,t,r){return Lg(e,"#"+t,r)}function zj(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Vj(e,t,r,a){for(var n=typeof t!="string"?t:Sr(t),s=typeof t=="string"?t:Zr(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=bc(e,o,l);c.t="n",c.F=s,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var ps={encode_col:Ra,encode_row:_a,encode_cell:fr,encode_range:Zr,decode_col:oh,decode_row:ih,split_cell:oN,decode_cell:da,decode_range:jn,format_cell:Ms,sheet_add_aoa:Px,sheet_add_json:Pg,sheet_add_dom:_g,aoa_to_sheet:il,json_to_sheet:Mj,table_to_sheet:Sg,table_to_book:xj,sheet_to_csv:vh,sheet_to_txt:Cg,sheet_to_json:m0,sheet_to_html:Ng,sheet_to_formulae:Rj,sheet_to_row_object_array:m0,sheet_get_cell:bc,book_new:Uj,book_append_sheet:qj,book_set_sheet_visibility:Wj,cell_set_number_format:Hj,cell_set_hyperlink:Lg,cell_set_internal_link:$j,cell_add_comment:zj,sheet_set_array_formula:Vj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ia=Uint8Array,Sn=Uint16Array,yh=Int32Array,W0=new Ia([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),H0=new Ia([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bf=new Ia([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fg=function(e,t){for(var r=new Sn(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new yh(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},kg=Fg(W0,2),Dg=kg.b,Nf=kg.r;Dg[28]=258,Nf[258]=28;var Og=Fg(H0,0),Gj=Og.b,Ep=Og.r,_f=new Sn(32768);for(var _r=0;_r<32768;++_r){var ai=(_r&43690)>>1|(_r&21845)<<1;ai=(ai&52428)>>2|(ai&13107)<<2,ai=(ai&61680)>>4|(ai&3855)<<4,_f[_r]=((ai&65280)>>8|(ai&255)<<8)>>1}var gs=function(e,t,r){for(var a=e.length,n=0,s=new Sn(t);n<a;++n)e[n]&&++s[e[n]-1];var o=new Sn(t);for(n=1;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;var l;if(r){l=new Sn(1<<t);var c=15-t;for(n=0;n<a;++n)if(e[n])for(var u=n<<4|e[n],d=t-e[n],m=o[e[n]-1]++<<d,g=m|(1<<d)-1;m<=g;++m)l[_f[m]>>c]=u}else for(l=new Sn(a),n=0;n<a;++n)e[n]&&(l[n]=_f[o[e[n]-1]++]>>15-e[n]);return l},wi=new Ia(288);for(var _r=0;_r<144;++_r)wi[_r]=8;for(var _r=144;_r<256;++_r)wi[_r]=9;for(var _r=256;_r<280;++_r)wi[_r]=7;for(var _r=280;_r<288;++_r)wi[_r]=8;var Nc=new Ia(32);for(var _r=0;_r<32;++_r)Nc[_r]=5;var Yj=gs(wi,9,0),Xj=gs(wi,9,1),Kj=gs(Nc,5,0),Jj=gs(Nc,5,1),Vd=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Vn=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&r},Gd=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},wh=function(e){return(e+7)/8|0},Ig=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new Ia(e.subarray(t,r))},Qj=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Yn=function(e,t,r){var a=new Error(t||Qj[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,Yn),!r)throw a;return a},Zj=function(e,t,r,a){var n=e.length,s=a?a.length:0;if(!n||t.f&&!t.l)return r||new Ia(0);var o=!r,l=o||t.i!=2,c=t.i;o&&(r=new Ia(n*3));var u=function(Oe){var Ie=r.length;if(Oe>Ie){var Ze=new Ia(Math.max(Ie*2,Oe));Ze.set(r),r=Ze}},d=t.f||0,m=t.p||0,g=t.b||0,h=t.l,x=t.d,p=t.m,y=t.n,_=n*8;do{if(!h){d=Vn(e,m,1);var S=Vn(e,m+1,3);if(m+=3,S)if(S==1)h=Xj,x=Jj,p=9,y=5;else if(S==2){var B=Vn(e,m,31)+257,T=Vn(e,m+10,15)+4,P=B+Vn(e,m+5,31)+1;m+=14;for(var k=new Ia(P),I=new Ia(19),A=0;A<T;++A)I[bf[A]]=Vn(e,m+A*3,7);m+=T*3;for(var b=Vd(I),R=(1<<b)-1,W=gs(I,b,1),A=0;A<P;){var Y=W[Vn(e,m,R)];m+=Y&15;var E=Y>>4;if(E<16)k[A++]=E;else{var q=0,U=0;for(E==16?(U=3+Vn(e,m,3),m+=2,q=k[A-1]):E==17?(U=3+Vn(e,m,7),m+=3):E==18&&(U=11+Vn(e,m,127),m+=7);U--;)k[A++]=q}}var H=k.subarray(0,B),Q=k.subarray(B);p=Vd(H),y=Vd(Q),h=gs(H,p,1),x=gs(Q,y,1)}else Yn(1);else{var E=wh(m)+4,C=e[E-4]|e[E-3]<<8,F=E+C;if(F>n){c&&Yn(0);break}l&&u(g+C),r.set(e.subarray(E,F),g),t.b=g+=C,t.p=m=F*8,t.f=d;continue}if(m>_){c&&Yn(0);break}}l&&u(g+131072);for(var ne=(1<<p)-1,ee=(1<<y)-1,N=m;;N=m){var q=h[Gd(e,m)&ne],L=q>>4;if(m+=q&15,m>_){c&&Yn(0);break}if(q||Yn(2),L<256)r[g++]=L;else if(L==256){N=m,h=null;break}else{var D=L-254;if(L>264){var A=L-257,M=W0[A];D=Vn(e,m,(1<<M)-1)+Dg[A],m+=M}var z=x[Gd(e,m)&ee],ue=z>>4;z||Yn(3),m+=z&15;var Q=Gj[ue];if(ue>3){var M=H0[ue];Q+=Gd(e,m)&(1<<M)-1,m+=M}if(m>_){c&&Yn(0);break}l&&u(g+131072);var pe=g+D;if(g<Q){var me=s-Q,Ne=Math.min(Q,pe);for(me+g<0&&Yn(3);g<Ne;++g)r[g]=a[me+g]}for(;g<pe;++g)r[g]=r[g-Q]}}t.l=h,t.p=N,t.b=g,t.f=d,h&&(d=1,t.m=p,t.d=x,t.n=y)}while(!d);return g!=r.length&&o?Ig(r,0,g):r.subarray(0,g)},Ls=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Yl=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Yd=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return{t:Mg,l:0};if(n==1){var o=new Ia(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(F,B){return F.f-B.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,m=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=n-1;)l=r[r[u].f<r[m].f?u++:m++],c=r[u!=d&&r[u].f<r[m].f?u++:m++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var g=s[0].s,a=1;a<n;++a)s[a].s>g&&(g=s[a].s);var h=new Sn(g+1),x=Sf(r[d-1],h,0);if(x>t){var a=0,p=0,y=x-t,_=1<<y;for(s.sort(function(B,T){return h[T.s]-h[B.s]||B.f-T.f});a<n;++a){var S=s[a].s;if(h[S]>t)p+=_-(1<<x-h[S]),h[S]=t;else break}for(p>>=y;p>0;){var E=s[a].s;h[E]<t?p-=1<<t-h[E]++-1:++a}for(;a>=0&&p;--a){var C=s[a].s;h[C]==t&&(--h[C],++p)}x=t}return{t:new Ia(h),l:x}},Sf=function(e,t,r){return e.s==-1?Math.max(Sf(e.l,t,r+1),Sf(e.r,t,r+1)):t[e.s]=r},Tp=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Sn(++t),a=0,n=e[0],s=1,o=function(c){r[a++]=c},l=1;l<=t;++l)if(e[l]==n&&l!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(n),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(n);s=1,n=e[l]}return{c:r.subarray(0,a),n:t}},Xl=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},Rg=function(e,t,r){var a=r.length,n=wh(t+2);e[n]=a&255,e[n+1]=a>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var s=0;s<a;++s)e[n+s+4]=r[s];return(n+4+a)*8},Cp=function(e,t,r,a,n,s,o,l,c,u,d){Ls(t,d++,r),++n[256];for(var m=Yd(n,15),g=m.t,h=m.l,x=Yd(s,15),p=x.t,y=x.l,_=Tp(g),S=_.c,E=_.n,C=Tp(p),F=C.c,B=C.n,T=new Sn(19),P=0;P<S.length;++P)++T[S[P]&31];for(var P=0;P<F.length;++P)++T[F[P]&31];for(var k=Yd(T,7),I=k.t,A=k.l,b=19;b>4&&!I[bf[b-1]];--b);var R=u+5<<3,W=Xl(n,wi)+Xl(s,Nc)+o,Y=Xl(n,g)+Xl(s,p)+o+14+3*b+Xl(T,I)+2*T[16]+3*T[17]+7*T[18];if(c>=0&&R<=W&&R<=Y)return Rg(t,d,e.subarray(c,c+u));var q,U,H,Q;if(Ls(t,d,1+(Y<W)),d+=2,Y<W){q=gs(g,h,0),U=g,H=gs(p,y,0),Q=p;var ne=gs(I,A,0);Ls(t,d,E-257),Ls(t,d+5,B-1),Ls(t,d+10,b-4),d+=14;for(var P=0;P<b;++P)Ls(t,d+3*P,I[bf[P]]);d+=3*b;for(var ee=[S,F],N=0;N<2;++N)for(var L=ee[N],P=0;P<L.length;++P){var D=L[P]&31;Ls(t,d,ne[D]),d+=I[D],D>15&&(Ls(t,d,L[P]>>5&127),d+=L[P]>>12)}}else q=Yj,U=wi,H=Kj,Q=Nc;for(var P=0;P<l;++P){var M=a[P];if(M>255){var D=M>>18&31;Yl(t,d,q[D+257]),d+=U[D+257],D>7&&(Ls(t,d,M>>23&31),d+=W0[D]);var z=M&31;Yl(t,d,H[z]),d+=Q[z],z>3&&(Yl(t,d,M>>5&8191),d+=H0[z])}else Yl(t,d,q[M]),d+=U[M]}return Yl(t,d,q[256]),d+U[256]},eE=new yh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Mg=new Ia(0),tE=function(e,t,r,a,n,s){var o=s.z||e.length,l=new Ia(a+o+5*(1+Math.ceil(o/7e3))+n),c=l.subarray(a,l.length-n),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var m=eE[t-1],g=m>>13,h=m&8191,x=(1<<r)-1,p=s.p||new Sn(32768),y=s.h||new Sn(x+1),_=Math.ceil(r/3),S=2*_,E=function(st){return(e[st]^e[st+1]<<_^e[st+2]<<S)&x},C=new yh(25e3),F=new Sn(288),B=new Sn(32),T=0,P=0,k=s.i||0,I=0,A=s.w||0,b=0;k+2<o;++k){var R=E(k),W=k&32767,Y=y[R];if(p[W]=Y,y[R]=W,A<=k){var q=o-k;if((T>7e3||I>24576)&&(q>423||!u)){d=Cp(e,c,0,C,F,B,P,I,b,k-b,d),I=T=P=0,b=k;for(var U=0;U<286;++U)F[U]=0;for(var U=0;U<30;++U)B[U]=0}var H=2,Q=0,ne=h,ee=W-Y&32767;if(q>2&&R==E(k-ee))for(var N=Math.min(g,q)-1,L=Math.min(32767,k),D=Math.min(258,q);ee<=L&&--ne&&W!=Y;){if(e[k+H]==e[k+H-ee]){for(var M=0;M<D&&e[k+M]==e[k+M-ee];++M);if(M>H){if(H=M,Q=ee,M>N)break;for(var z=Math.min(ee,M-2),ue=0,U=0;U<z;++U){var pe=k-ee+U&32767,me=p[pe],Ne=pe-me&32767;Ne>ue&&(ue=Ne,Y=pe)}}}W=Y,Y=p[W],ee+=W-Y&32767}if(Q){C[I++]=268435456|Nf[H]<<18|Ep[Q];var Oe=Nf[H]&31,Ie=Ep[Q]&31;P+=W0[Oe]+H0[Ie],++F[257+Oe],++B[Ie],A=k+H,++T}else C[I++]=e[k],++F[e[k]]}}for(k=Math.max(k,A);k<o;++k)C[I++]=e[k],++F[e[k]];d=Cp(e,c,u,C,F,B,P,I,b,k-b,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=p,s.i=k,s.w=A)}else{for(var k=s.w||0;k<o+u;k+=65535){var Ze=k+65535;Ze>=o&&(c[d/8|0]=u,Ze=o),d=Rg(c,d+1,e.subarray(k,Ze))}s.i=o}return Ig(l,0,a+wh(d)+n)},Bg=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}e=a,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},rE=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new Ia(s.length+e.length);o.set(s),o.set(e,s.length),e=o,n.w=s.length}return tE(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,n)},Ug=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},aE=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=Bg();n.p(t.dictionary),Ug(e,2,n.d())}},nE=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Yn(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Yn(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Af(e,t){t||(t={});var r=Bg();r.p(e);var a=rE(e,t,t.dictionary?6:2,4);return aE(a,t),Ug(a,a.length-4,r.d()),a}function sE(e,t){return Zj(e.subarray(nE(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var iE=typeof TextDecoder<"u"&&new TextDecoder,oE=0;try{iE.decode(Mg,{stream:!0}),oE=1}catch{}var Ft=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Xd(){Ft.console&&typeof Ft.console.log=="function"&&Ft.console.log.apply(Ft.console,arguments)}var xr={log:Xd,warn:function(e){Ft.console&&(typeof Ft.console.warn=="function"?Ft.console.warn.apply(Ft.console,arguments):Xd.call(null,arguments))},error:function(e){Ft.console&&(typeof Ft.console.error=="function"?Ft.console.error.apply(Ft.console,arguments):Xd(e))}};function Kd(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){Ii(a.response,t,r)},a.onerror=function(){xr.error("could not download file")},a.send()}function Pp(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Du(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var lc,jf,Ii=Ft.saveAs||((typeof window>"u"?"undefined":ar(window))!=="object"||window!==Ft?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Ft.URL||Ft.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin!==location.origin?Pp(n.href)?Kd(e,t,r):Du(n,n.target="_blank"):Du(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){Du(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Pp(e))Kd(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){Du(a)})}else navigator.msSaveOrOpenBlob(function(n,s){return s===void 0?s={autoBom:!1}:ar(s)!=="object"&&(xr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob([String.fromCharCode(65279),n],{type:n.type}):n}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return Kd(e,t,r);var n=e.type==="application/octet-stream",s=/constructor/i.test(Ft.HTMLElement)||Ft.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&s)&&(typeof FileReader>"u"?"undefined":ar(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=d:location=d,a=null},l.readAsDataURL(e)}else{var c=Ft.URL||Ft.webkitURL,u=c.createObjectURL(e);a?a.location=u:location.href=u,a=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function qg(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,o=n.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Jd(e,t){var r=e[0],a=e[1],n=e[2],s=e[3];r=Pa(r,a,n,s,t[0],7,-680876936),s=Pa(s,r,a,n,t[1],12,-389564586),n=Pa(n,s,r,a,t[2],17,606105819),a=Pa(a,n,s,r,t[3],22,-1044525330),r=Pa(r,a,n,s,t[4],7,-176418897),s=Pa(s,r,a,n,t[5],12,1200080426),n=Pa(n,s,r,a,t[6],17,-1473231341),a=Pa(a,n,s,r,t[7],22,-45705983),r=Pa(r,a,n,s,t[8],7,1770035416),s=Pa(s,r,a,n,t[9],12,-1958414417),n=Pa(n,s,r,a,t[10],17,-42063),a=Pa(a,n,s,r,t[11],22,-1990404162),r=Pa(r,a,n,s,t[12],7,1804603682),s=Pa(s,r,a,n,t[13],12,-40341101),n=Pa(n,s,r,a,t[14],17,-1502002290),r=La(r,a=Pa(a,n,s,r,t[15],22,1236535329),n,s,t[1],5,-165796510),s=La(s,r,a,n,t[6],9,-1069501632),n=La(n,s,r,a,t[11],14,643717713),a=La(a,n,s,r,t[0],20,-373897302),r=La(r,a,n,s,t[5],5,-701558691),s=La(s,r,a,n,t[10],9,38016083),n=La(n,s,r,a,t[15],14,-660478335),a=La(a,n,s,r,t[4],20,-405537848),r=La(r,a,n,s,t[9],5,568446438),s=La(s,r,a,n,t[14],9,-1019803690),n=La(n,s,r,a,t[3],14,-187363961),a=La(a,n,s,r,t[8],20,1163531501),r=La(r,a,n,s,t[13],5,-1444681467),s=La(s,r,a,n,t[2],9,-51403784),n=La(n,s,r,a,t[7],14,1735328473),r=Fa(r,a=La(a,n,s,r,t[12],20,-1926607734),n,s,t[5],4,-378558),s=Fa(s,r,a,n,t[8],11,-2022574463),n=Fa(n,s,r,a,t[11],16,1839030562),a=Fa(a,n,s,r,t[14],23,-35309556),r=Fa(r,a,n,s,t[1],4,-1530992060),s=Fa(s,r,a,n,t[4],11,1272893353),n=Fa(n,s,r,a,t[7],16,-155497632),a=Fa(a,n,s,r,t[10],23,-1094730640),r=Fa(r,a,n,s,t[13],4,681279174),s=Fa(s,r,a,n,t[0],11,-358537222),n=Fa(n,s,r,a,t[3],16,-722521979),a=Fa(a,n,s,r,t[6],23,76029189),r=Fa(r,a,n,s,t[9],4,-640364487),s=Fa(s,r,a,n,t[12],11,-421815835),n=Fa(n,s,r,a,t[15],16,530742520),r=ka(r,a=Fa(a,n,s,r,t[2],23,-995338651),n,s,t[0],6,-198630844),s=ka(s,r,a,n,t[7],10,1126891415),n=ka(n,s,r,a,t[14],15,-1416354905),a=ka(a,n,s,r,t[5],21,-57434055),r=ka(r,a,n,s,t[12],6,1700485571),s=ka(s,r,a,n,t[3],10,-1894986606),n=ka(n,s,r,a,t[10],15,-1051523),a=ka(a,n,s,r,t[1],21,-2054922799),r=ka(r,a,n,s,t[8],6,1873313359),s=ka(s,r,a,n,t[15],10,-30611744),n=ka(n,s,r,a,t[6],15,-1560198380),a=ka(a,n,s,r,t[13],21,1309151649),r=ka(r,a,n,s,t[4],6,-145523070),s=ka(s,r,a,n,t[11],10,-1120210379),n=ka(n,s,r,a,t[2],15,718787259),a=ka(a,n,s,r,t[9],21,-343485551),e[0]=ci(r,e[0]),e[1]=ci(a,e[1]),e[2]=ci(n,e[2]),e[3]=ci(s,e[3])}function $0(e,t,r,a,n,s){return t=ci(ci(t,e),ci(a,s)),ci(t<<n|t>>>32-n,r)}function Pa(e,t,r,a,n,s,o){return $0(t&r|~t&a,e,t,n,s,o)}function La(e,t,r,a,n,s,o){return $0(t&a|r&~a,e,t,n,s,o)}function Fa(e,t,r,a,n,s,o){return $0(t^r^a,e,t,n,s,o)}function ka(e,t,r,a,n,s,o){return $0(r^(t|~a),e,t,n,s,o)}function Wg(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Jd(a,lE(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Jd(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,Jd(a,n),a}function lE(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}lc=Ft.atob.bind(Ft),jf=Ft.btoa.bind(Ft);var Lp="0123456789abcdef".split("");function cE(e){for(var t="",r=0;r<4;r++)t+=Lp[e>>8*r+4&15]+Lp[e>>8*r&15];return t}function uE(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Ef(e){return Wg(e).map(uE).join("")}var dE=function(e){for(var t=0;t<e.length;t++)e[t]=cE(e[t]);return e.join("")}(Wg("hello"))!="5d41402abc4b2a76b9719d911017c592";function ci(e,t){if(dE){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Tf(e,t){var r,a,n,s;if(e!==r){for(var o=(n=e,s=1+(256/e.length>>0),new Array(s+1).join(n)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,a=l}else l=a;var m=t.length,g=0,h=0,x="";for(c=0;c<m;c++)h=(h+(d=l[g=(g+1)%256]))%256,l[g]=l[h],l[h]=d,o=l[(l[g]+l[h])%256],x+=String.fromCharCode(t.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Fp={print:4,modify:8,copy:16,"annot-forms":32};function $o(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(l){if(Fp.perm!==void 0)throw new Error("Invalid permission: "+l);n+=Fp[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^n)),this.encryptionKey=Ef(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Tf(this.encryptionKey,this.padding)}function zo(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?t+="#"+("0"+n.toString(16)).slice(-2):t+=e[a]}return t}function kp(e){if(ar(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,a)}catch(l){Ft.console&&xr.error("jsPDF PubSub Error",l.message,l)}o[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function _c(e){if(!(this instanceof _c))return new _c(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Hg(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function ii(e,t,r,a,n){if(!(this instanceof ii))return new ii(e,t,r,a,n);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Hg.call(this,a,n)}function qi(e,t,r,a,n){if(!(this instanceof qi))return new qi(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Hg.call(this,a,n)}function Tt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;ar(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,n=e.format||n,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var m=e.putOnlyUsedFonts||!1,g={},h={internal:{},__private__:{}};h.__private__.PubSub=kp;var x="1.3",p=h.__private__.getPdfVersion=function(){return x};h.__private__.setPdfVersion=function(w){x=w};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var _=h.__private__.getPageFormat=function(w){return y[w]};n=n||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},E=S.COMPAT;function C(){this.saveGraphicsState(),le(new _t(ot,0,0,-ot,0,Ws()*ot).toString()+" cm"),this.setFontSize(this.getFontSize()/ot),u="n",E=S.ADVANCED}function F(){this.restoreGraphicsState(),u="S",E=S.COMPAT}var B=h.__private__.combineFontStyleAndFontWeight=function(w,G){if(w=="bold"&&G=="normal"||w=="bold"&&G==400||w=="normal"&&G=="italic"||w=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(w=G==400||G==="normal"?w==="italic"?"italic":"normal":G!=700&&G!=="bold"||w!=="normal"?(G==700?"bold":G)+""+w:"bold"),w};h.advancedAPI=function(w){var G=E===S.COMPAT;return G&&C.call(this),typeof w!="function"||(w(this),G&&F.call(this)),this},h.compatAPI=function(w){var G=E===S.ADVANCED;return G&&F.call(this),typeof w!="function"||(w(this),G&&C.call(this)),this},h.isAdvancedAPI=function(){return E===S.ADVANCED};var T,P=function(w){if(E!==S.ADVANCED)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},k=h.roundToPrecision=h.__private__.roundToPrecision=function(w,G){var xe=t||G;if(isNaN(w)||isNaN(xe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(xe).replace(/0+$/,"")};T=h.hpf=h.__private__.hpf=typeof c=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return k(w,c)}:c==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return k(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return k(w,16)};var I=h.f2=h.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return k(w,2)},A=h.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return k(w,3)},b=h.scale=h.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return E===S.COMPAT?w*ot:E===S.ADVANCED?w:void 0},R=function(w){return E===S.COMPAT?Ws()-w:E===S.ADVANCED?w:void 0},W=function(w){return b(R(w))};h.__private__.setPrecision=h.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(t=parseInt(w,10))};var Y,q="00000000000000000000000000000000",U=h.__private__.getFileId=function(){return q},H=h.__private__.setFileId=function(w){return q=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ta=new $o(d.userPermissions,d.userPassword,d.ownerPassword,q)),q};h.setFileId=function(w){return H(w),this},h.getFileId=function(){return U()};var Q=h.__private__.convertDateToPDFDate=function(w){var G=w.getTimezoneOffset(),xe=G<0?"+":"-",ve=Math.floor(Math.abs(G/60)),je=Math.abs(G%60),We=[xe,D(ve),"'",D(je),"'"].join("");return["D:",w.getFullYear(),D(w.getMonth()+1),D(w.getDate()),D(w.getHours()),D(w.getMinutes()),D(w.getSeconds()),We].join("")},ne=h.__private__.convertPDFDateToDate=function(w){var G=parseInt(w.substr(2,4),10),xe=parseInt(w.substr(6,2),10)-1,ve=parseInt(w.substr(8,2),10),je=parseInt(w.substr(10,2),10),We=parseInt(w.substr(12,2),10),rt=parseInt(w.substr(14,2),10);return new Date(G,xe,ve,je,We,rt,0)},ee=h.__private__.setCreationDate=function(w){var G;if(w===void 0&&(w=new Date),w instanceof Date)G=Q(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=w}return Y=G},N=h.__private__.getCreationDate=function(w){var G=Y;return w==="jsDate"&&(G=ne(Y)),G};h.setCreationDate=function(w){return ee(w),this},h.getCreationDate=function(w){return N(w)};var L,D=h.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},M=h.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},z=0,ue=[],pe=[],me=0,Ne=[],Oe=[],Ie=!1,Ze=pe,st=function(){z=0,me=0,pe=[],ue=[],Ne=[],ae=Nr(),re=Nr()};h.__private__.setCustomOutputDestination=function(w){Ie=!0,Ze=w};var Fe=function(w){Ie||(Ze=w)};h.__private__.resetCustomOutputDestination=function(){Ie=!1,Ze=pe};var le=h.__private__.out=function(w){return w=w.toString(),me+=w.length+1,Ze.push(w),Ze},Xe=h.__private__.write=function(w){return le(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},xt=h.__private__.getArrayBuffer=function(w){for(var G=w.length,xe=new ArrayBuffer(G),ve=new Uint8Array(xe);G--;)ve[G]=w.charCodeAt(G);return xe},$e=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return $e};var ie=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(w){return ie=E===S.ADVANCED?w/ot:w,this};var ge,ye=h.__private__.getFontSize=h.getFontSize=function(){return E===S.COMPAT?ie:ie*ot},qe=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(w){return qe=w,this},h.__private__.getR2L=h.getR2L=function(){return qe};var De,Re=h.__private__.setZoomMode=function(w){var G=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))ge=w;else if(isNaN(w)){if(G.indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');ge=w}else ge=parseInt(w,10)};h.__private__.getZoomMode=function(){return ge};var Je,mt=h.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');De=w};h.__private__.getPageMode=function(){return De};var wt=h.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');Je=w};h.__private__.getLayoutMode=function(){return Je},h.__private__.setDisplayMode=h.setDisplayMode=function(w,G,xe){return Re(w),wt(G),mt(xe),this};var bt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(w){if(Object.keys(bt).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return bt[w]},h.__private__.getDocumentProperties=function(){return bt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(w){for(var G in bt)bt.hasOwnProperty(G)&&w[G]&&(bt[G]=w[G]);return this},h.__private__.setDocumentProperty=function(w,G){if(Object.keys(bt).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return bt[w]=G};var kt,ot,Ar,Ut,Rr,zt={},Yt={},Vr=[],Ot={},Ka={},nr={},ma={},sr=null,Vt=0,Pt=[],$t=new kp(h),Aa=e.hotfixes||[],Mr={},Ua={},ja=[],_t=function w(G,xe,ve,je,We,rt){if(!(this instanceof w))return new w(G,xe,ve,je,We,rt);isNaN(G)&&(G=1),isNaN(xe)&&(xe=0),isNaN(ve)&&(ve=0),isNaN(je)&&(je=1),isNaN(We)&&(We=0),isNaN(rt)&&(rt=0),this._matrix=[G,xe,ve,je,We,rt]};Object.defineProperty(_t.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(_t.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(_t.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(_t.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(_t.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(_t.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(_t.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(_t.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(_t.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(_t.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(_t.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(_t.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(_t.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(_t.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(_t.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(_t.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),_t.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(w)},_t.prototype.multiply=function(w){var G=w.sx*this.sx+w.shy*this.shx,xe=w.sx*this.shy+w.shy*this.sy,ve=w.shx*this.sx+w.sy*this.shx,je=w.shx*this.shy+w.sy*this.sy,We=w.tx*this.sx+w.ty*this.shx+this.tx,rt=w.tx*this.shy+w.ty*this.sy+this.ty;return new _t(G,xe,ve,je,We,rt)},_t.prototype.decompose=function(){var w=this.sx,G=this.shy,xe=this.shx,ve=this.sy,je=this.tx,We=this.ty,rt=Math.sqrt(w*w+G*G),vt=(w/=rt)*xe+(G/=rt)*ve;xe-=w*vt,ve-=G*vt;var jt=Math.sqrt(xe*xe+ve*ve);return vt/=jt,w*(ve/=jt)<G*(xe/=jt)&&(w=-w,G=-G,vt=-vt,rt=-rt),{scale:new _t(rt,0,0,jt,0,0),translate:new _t(1,0,0,1,je,We),rotate:new _t(w,G,-G,w,0,0),skew:new _t(1,0,vt,1,0,0)}},_t.prototype.toString=function(w){return this.join(" ")},_t.prototype.inversed=function(){var w=this.sx,G=this.shy,xe=this.shx,ve=this.sy,je=this.tx,We=this.ty,rt=1/(w*ve-G*xe),vt=ve*rt,jt=-G*rt,Bt=-xe*rt,Rt=w*rt;return new _t(vt,jt,Bt,Rt,-vt*je-Bt*We,-jt*je-Rt*We)},_t.prototype.applyToPoint=function(w){var G=w.x*this.sx+w.y*this.shx+this.tx,xe=w.x*this.shy+w.y*this.sy+this.ty;return new fo(G,xe)},_t.prototype.applyToRectangle=function(w){var G=this.applyToPoint(w),xe=this.applyToPoint(new fo(w.x+w.w,w.y+w.h));return new gl(G.x,G.y,xe.x-G.x,xe.y-G.y)},_t.prototype.clone=function(){var w=this.sx,G=this.shy,xe=this.shx,ve=this.sy,je=this.tx,We=this.ty;return new _t(w,G,xe,ve,je,We)},h.Matrix=_t;var Ea=h.matrixMult=function(w,G){return G.multiply(w)},pa=new _t(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=pa;var gr=function(w,G){if(!Ka[w]){var xe=(G instanceof ii?"Sh":"P")+(Object.keys(Ot).length+1).toString(10);G.id=xe,Ka[w]=xe,Ot[xe]=G,$t.publish("addPattern",G)}};h.ShadingPattern=ii,h.TilingPattern=qi,h.addShadingPattern=function(w,G){return P("addShadingPattern()"),gr(w,G),this},h.beginTilingPattern=function(w){P("beginTilingPattern()"),Yc(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},h.endTilingPattern=function(w,G){P("endTilingPattern()"),G.stream=Oe[L].join(`
`),gr(w,G),$t.publish("endTilingPattern",G),ja.pop().restore()};var Kt=h.__private__.newObject=function(){var w=Nr();return K(w,!0),w},Nr=h.__private__.newObjectDeferred=function(){return z++,ue[z]=function(){return me},z},K=function(w,G){return G=typeof G=="boolean"&&G,ue[w]=me,G&&le(w+" 0 obj"),w},fe=h.__private__.newAdditionalObject=function(){var w={objId:Nr(),content:""};return Ne.push(w),w},ae=Nr(),re=Nr(),ce=h.__private__.decodeColorString=function(w){var G=w.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length===5&&(G[4]==="k"||G[4]==="K")&&(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var xe=parseFloat(G[0]);G=[xe,xe,xe,"r"]}for(var ve="#",je=0;je<3;je++)ve+=("0"+Math.floor(255*parseFloat(G[je])).toString(16)).slice(-2);return ve},de=h.__private__.encodeColorString=function(w){var G;typeof w=="string"&&(w={ch1:w});var xe=w.ch1,ve=w.ch2,je=w.ch3,We=w.ch4,rt=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof xe=="string"&&xe.charAt(0)!=="#"){var vt=new qg(xe);if(vt.ok)xe=vt.toHex();else if(!/^\d*\.?\d*$/.test(xe))throw new Error('Invalid color "'+xe+'" passed to jsPDF.encodeColorString.')}if(typeof xe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(xe)&&(xe="#"+xe[1]+xe[1]+xe[2]+xe[2]+xe[3]+xe[3]),typeof xe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(xe)){var jt=parseInt(xe.substr(1),16);xe=jt>>16&255,ve=jt>>8&255,je=255&jt}if(ve===void 0||We===void 0&&xe===ve&&ve===je)if(typeof xe=="string")G=xe+" "+rt[0];else switch(w.precision){case 2:G=I(xe/255)+" "+rt[0];break;case 3:default:G=A(xe/255)+" "+rt[0]}else if(We===void 0||ar(We)==="object"){if(We&&!isNaN(We.a)&&We.a===0)return G=["1.","1.","1.",rt[1]].join(" ");if(typeof xe=="string")G=[xe,ve,je,rt[1]].join(" ");else switch(w.precision){case 2:G=[I(xe/255),I(ve/255),I(je/255),rt[1]].join(" ");break;default:case 3:G=[A(xe/255),A(ve/255),A(je/255),rt[1]].join(" ")}}else if(typeof xe=="string")G=[xe,ve,je,We,rt[2]].join(" ");else switch(w.precision){case 2:G=[I(xe),I(ve),I(je),I(We),rt[2]].join(" ");break;case 3:default:G=[A(xe),A(ve),A(je),A(We),rt[2]].join(" ")}return G},Ae=h.__private__.getFilters=function(){return o},Me=h.__private__.putStream=function(w){var G=(w=w||{}).data||"",xe=w.filters||Ae(),ve=w.alreadyAppliedFilters||[],je=w.addLength1||!1,We=G.length,rt=w.objectId,vt=function(Ca){return Ca};if(d!==null&&rt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(vt=Ta.encryptor(rt,0));var jt={};xe===!0&&(xe=["FlateEncode"]);var Bt=w.additionalKeyValues||[],Rt=(jt=Tt.API.processDataByFilters!==void 0?Tt.API.processDataByFilters(G,xe):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(ve)?ve.join(" "):ve.toString());if(jt.data.length!==0&&(Bt.push({key:"Length",value:jt.data.length}),je===!0&&Bt.push({key:"Length1",value:We})),Rt.length!=0)if(Rt.split("/").length-1==1)Bt.push({key:"Filter",value:Rt});else{Bt.push({key:"Filter",value:"["+Rt+"]"});for(var Xt=0;Xt<Bt.length;Xt+=1)if(Bt[Xt].key==="DecodeParms"){for(var Cr=[],Fr=0;Fr<jt.reverseChain.split("/").length-1;Fr+=1)Cr.push("null");Cr.push(Bt[Xt].value),Bt[Xt].value="["+Cr.join(" ")+"]"}}le("<<");for(var Gr=0;Gr<Bt.length;Gr++)le("/"+Bt[Gr].key+" "+Bt[Gr].value);le(">>"),jt.data.length!==0&&(le("stream"),le(vt(jt.data)),le("endstream"))},Ee=h.__private__.putPage=function(w){var G=w.number,xe=w.data,ve=w.objId,je=w.contentsObjId;K(ve,!0),le("<</Type /Page"),le("/Parent "+w.rootDictionaryObjId+" 0 R"),le("/Resources "+w.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(T(w.mediaBox.bottomLeftX))+" "+parseFloat(T(w.mediaBox.bottomLeftY))+" "+T(w.mediaBox.topRightX)+" "+T(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&le("/CropBox ["+T(w.cropBox.bottomLeftX)+" "+T(w.cropBox.bottomLeftY)+" "+T(w.cropBox.topRightX)+" "+T(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&le("/BleedBox ["+T(w.bleedBox.bottomLeftX)+" "+T(w.bleedBox.bottomLeftY)+" "+T(w.bleedBox.topRightX)+" "+T(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&le("/TrimBox ["+T(w.trimBox.bottomLeftX)+" "+T(w.trimBox.bottomLeftY)+" "+T(w.trimBox.topRightX)+" "+T(w.trimBox.topRightY)+"]"),w.artBox!==null&&le("/ArtBox ["+T(w.artBox.bottomLeftX)+" "+T(w.artBox.bottomLeftY)+" "+T(w.artBox.topRightX)+" "+T(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&le("/UserUnit "+w.userUnit),$t.publish("putPage",{objId:ve,pageContext:Pt[G],pageNumber:G,page:xe}),le("/Contents "+je+" 0 R"),le(">>"),le("endobj");var We=xe.join(`
`);return E===S.ADVANCED&&(We+=`
Q`),K(je,!0),Me({data:We,filters:Ae(),objectId:je}),le("endobj"),ve},Te=h.__private__.putPages=function(){var w,G,xe=[];for(w=1;w<=Vt;w++)Pt[w].objId=Nr(),Pt[w].contentsObjId=Nr();for(w=1;w<=Vt;w++)xe.push(Ee({number:w,data:Oe[w],objId:Pt[w].objId,contentsObjId:Pt[w].contentsObjId,mediaBox:Pt[w].mediaBox,cropBox:Pt[w].cropBox,bleedBox:Pt[w].bleedBox,trimBox:Pt[w].trimBox,artBox:Pt[w].artBox,userUnit:Pt[w].userUnit,rootDictionaryObjId:ae,resourceDictionaryObjId:re}));K(ae,!0),le("<</Type /Pages");var ve="/Kids [";for(G=0;G<Vt;G++)ve+=xe[G]+" 0 R ";le(ve+"]"),le("/Count "+Vt),le(">>"),le("endobj"),$t.publish("postPutPages")},Le=function(w){$t.publish("putFont",{font:w,out:le,newObject:Kt,putStream:Me}),w.isAlreadyPutted!==!0&&(w.objectNumber=Kt(),le("<<"),le("/Type /Font"),le("/BaseFont /"+zo(w.postScriptName)),le("/Subtype /Type1"),typeof w.encoding=="string"&&le("/Encoding /"+w.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},tt=function(){for(var w in zt)zt.hasOwnProperty(w)&&(m===!1||m===!0&&g.hasOwnProperty(w))&&Le(zt[w])},it=function(w){w.objectNumber=Kt();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[T(w.x),T(w.y),T(w.x+w.width),T(w.y+w.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var xe=w.pages[1].join(`
`);Me({data:xe,additionalKeyValues:G,objectId:w.objectNumber}),le("endobj")},pt=function(){for(var w in Mr)Mr.hasOwnProperty(w)&&it(Mr[w])},at=function(w,G){var xe,ve=[],je=1/(G-1);for(xe=0;xe<1;xe+=je)ve.push(xe);if(ve.push(1),w[0].offset!=0){var We={offset:0,color:w[0].color};w.unshift(We)}if(w[w.length-1].offset!=1){var rt={offset:1,color:w[w.length-1].color};w.push(rt)}for(var vt="",jt=0,Bt=0;Bt<ve.length;Bt++){for(xe=ve[Bt];xe>w[jt+1].offset;)jt++;var Rt=w[jt].offset,Xt=(xe-Rt)/(w[jt+1].offset-Rt),Cr=w[jt].color,Fr=w[jt+1].color;vt+=M(Math.round((1-Xt)*Cr[0]+Xt*Fr[0]).toString(16))+M(Math.round((1-Xt)*Cr[1]+Xt*Fr[1]).toString(16))+M(Math.round((1-Xt)*Cr[2]+Xt*Fr[2]).toString(16))}return vt.trim()},ht=function(w,G){G||(G=21);var xe=Kt(),ve=at(w.colors,G),je=[];je.push({key:"FunctionType",value:"0"}),je.push({key:"Domain",value:"[0.0 1.0]"}),je.push({key:"Size",value:"["+G+"]"}),je.push({key:"BitsPerSample",value:"8"}),je.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),je.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Me({data:ve,additionalKeyValues:je,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:xe}),le("endobj"),w.objectNumber=Kt(),le("<< /ShadingType "+w.type),le("/ColorSpace /DeviceRGB");var We="/Coords ["+T(parseFloat(w.coords[0]))+" "+T(parseFloat(w.coords[1]))+" ";w.type===2?We+=T(parseFloat(w.coords[2]))+" "+T(parseFloat(w.coords[3])):We+=T(parseFloat(w.coords[2]))+" "+T(parseFloat(w.coords[3]))+" "+T(parseFloat(w.coords[4]))+" "+T(parseFloat(w.coords[5])),le(We+="]"),w.matrix&&le("/Matrix ["+w.matrix.toString()+"]"),le("/Function "+xe+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},Lt=function(w,G){var xe=Nr(),ve=Kt();G.push({resourcesOid:xe,objectOid:ve}),w.objectNumber=ve;var je=[];je.push({key:"Type",value:"/Pattern"}),je.push({key:"PatternType",value:"1"}),je.push({key:"PaintType",value:"1"}),je.push({key:"TilingType",value:"1"}),je.push({key:"BBox",value:"["+w.boundingBox.map(T).join(" ")+"]"}),je.push({key:"XStep",value:T(w.xStep)}),je.push({key:"YStep",value:T(w.yStep)}),je.push({key:"Resources",value:xe+" 0 R"}),w.matrix&&je.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Me({data:w.stream,additionalKeyValues:je,objectId:w.objectNumber}),le("endobj")},Jt=function(w){var G;for(G in Ot)Ot.hasOwnProperty(G)&&(Ot[G]instanceof ii?ht(Ot[G]):Ot[G]instanceof qi&&Lt(Ot[G],w))},er=function(w){for(var G in w.objectNumber=Kt(),le("<<"),w)switch(G){case"opacity":le("/ca "+I(w[G]));break;case"stroke-opacity":le("/CA "+I(w[G]))}le(">>"),le("endobj")},Tr=function(){var w;for(w in nr)nr.hasOwnProperty(w)&&er(nr[w])},Ja=function(){for(var w in le("/XObject <<"),Mr)Mr.hasOwnProperty(w)&&Mr[w].objectNumber>=0&&le("/"+w+" "+Mr[w].objectNumber+" 0 R");$t.publish("putXobjectDict"),le(">>")},he=function(){Ta.oid=Kt(),le("<<"),le("/Filter /Standard"),le("/V "+Ta.v),le("/R "+Ta.r),le("/U <"+Ta.toHexString(Ta.U)+">"),le("/O <"+Ta.toHexString(Ta.O)+">"),le("/P "+Ta.P),le(">>"),le("endobj")},ke=function(){for(var w in le("/Font <<"),zt)zt.hasOwnProperty(w)&&(m===!1||m===!0&&g.hasOwnProperty(w))&&le("/"+w+" "+zt[w].objectNumber+" 0 R");le(">>")},nt=function(){if(Object.keys(Ot).length>0){for(var w in le("/Shading <<"),Ot)Ot.hasOwnProperty(w)&&Ot[w]instanceof ii&&Ot[w].objectNumber>=0&&le("/"+w+" "+Ot[w].objectNumber+" 0 R");$t.publish("putShadingPatternDict"),le(">>")}},St=function(w){if(Object.keys(Ot).length>0){for(var G in le("/Pattern <<"),Ot)Ot.hasOwnProperty(G)&&Ot[G]instanceof h.TilingPattern&&Ot[G].objectNumber>=0&&Ot[G].objectNumber<w&&le("/"+G+" "+Ot[G].objectNumber+" 0 R");$t.publish("putTilingPatternDict"),le(">>")}},Ke=function(){if(Object.keys(nr).length>0){var w;for(w in le("/ExtGState <<"),nr)nr.hasOwnProperty(w)&&nr[w].objectNumber>=0&&le("/"+w+" "+nr[w].objectNumber+" 0 R");$t.publish("putGStateDict"),le(">>")}},dt=function(w){K(w.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),ke(),nt(),St(w.objectOid),Ke(),Ja(),le(">>"),le("endobj")},Dt=function(){var w=[];tt(),Tr(),pt(),Jt(w),$t.publish("putResources"),w.forEach(dt),dt({resourcesOid:re,objectOid:Number.MAX_SAFE_INTEGER}),$t.publish("postPutResources")},vr=function(){$t.publish("putAdditionalObjects");for(var w=0;w<Ne.length;w++){var G=Ne[w];K(G.objId,!0),le(G.content),le("endobj")}$t.publish("postPutAdditionalObjects")},xa=function(w){Yt[w.fontName]=Yt[w.fontName]||{},Yt[w.fontName][w.fontStyle]=w.id},mn=function(w,G,xe,ve,je){var We={id:"F"+(Object.keys(zt).length+1).toString(10),postScriptName:w,fontName:G,fontStyle:xe,encoding:ve,isStandardFont:je||!1,metadata:{}};return $t.publish("addFont",{font:We,instance:this}),zt[We.id]=We,xa(We),We.id},V0=function(w){for(var G=0,xe=$e.length;G<xe;G++){var ve=mn.call(this,w[G][0],w[G][1],w[G][2],$e[G][3],!0);m===!1&&(g[ve]=!0);var je=w[G][0].split("-");xa({id:ve,fontName:je[0],fontStyle:je[1]||""})}$t.publish("addFonts",{fonts:zt,dictionary:Yt})},Bn=function(w){return w.foo=function(){try{return w.apply(this,arguments)}catch(ve){var G=ve.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var xe="Error in function "+G.split(`
`)[0].split("<")[0]+": "+ve.message;if(!Ft.console)throw new Error(xe);Ft.console.error(xe,ve),Ft.alert&&alert(xe)}},w.foo.bar=w,w.foo},so=function(w,G){var xe,ve,je,We,rt,vt,jt,Bt,Rt;if(je=(G=G||{}).sourceEncoding||"Unicode",rt=G.outputEncoding,(G.autoencode||rt)&&zt[kt].metadata&&zt[kt].metadata[je]&&zt[kt].metadata[je].encoding&&(We=zt[kt].metadata[je].encoding,!rt&&zt[kt].encoding&&(rt=zt[kt].encoding),!rt&&We.codePages&&(rt=We.codePages[0]),typeof rt=="string"&&(rt=We[rt]),rt)){for(jt=!1,vt=[],xe=0,ve=w.length;xe<ve;xe++)(Bt=rt[w.charCodeAt(xe)])?vt.push(String.fromCharCode(Bt)):vt.push(w[xe]),vt[xe].charCodeAt(0)>>8&&(jt=!0);w=vt.join("")}for(xe=w.length;jt===void 0&&xe!==0;)w.charCodeAt(xe-1)>>8&&(jt=!0),xe--;if(!jt)return w;for(vt=G.noBOM?[]:[254,255],xe=0,ve=w.length;xe<ve;xe++){if((Rt=(Bt=w.charCodeAt(xe))>>8)>>8)throw new Error("Character at position "+xe+" of string '"+w+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");vt.push(Rt),vt.push(Bt-(Rt<<8))}return String.fromCharCode.apply(void 0,vt)},Qa=h.__private__.pdfEscape=h.pdfEscape=function(w,G){return so(w,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cl=h.__private__.beginPage=function(w){Oe[++Vt]=[],Pt[Vt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},Rc(Vt),Fe(Oe[L])},Ic=function(w,G){var xe,ve,je;switch(r=G||r,typeof w=="string"&&(xe=_(w.toLowerCase()),Array.isArray(xe)&&(ve=xe[0],je=xe[1])),Array.isArray(w)&&(ve=w[0]*ot,je=w[1]*ot),isNaN(ve)&&(ve=n[0],je=n[1]),(ve>14400||je>14400)&&(xr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ve=Math.min(14400,ve),je=Math.min(14400,je)),n=[ve,je],r.substr(0,1)){case"l":je>ve&&(n=[je,ve]);break;case"p":ve>je&&(n=[je,ve])}cl(n),Hc(hl),le(Un),pl!==0&&le(pl+" J"),xl!==0&&le(xl+" j"),$t.publish("addPage",{pageNumber:Vt})},G0=function(w){w>0&&w<=Vt&&(Oe.splice(w,1),Pt.splice(w,1),Vt--,L>Vt&&(L=Vt),this.setPage(L))},Rc=function(w){w>0&&w<=Vt&&(L=w)},Y0=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Oe.length-1},Mc=function(w,G,xe){var ve,je=void 0;return xe=xe||{},w=w!==void 0?w:zt[kt].fontName,G=G!==void 0?G:zt[kt].fontStyle,ve=w.toLowerCase(),Yt[ve]!==void 0&&Yt[ve][G]!==void 0?je=Yt[ve][G]:Yt[w]!==void 0&&Yt[w][G]!==void 0?je=Yt[w][G]:xe.disableWarning===!1&&xr.warn("Unable to look up font label for font '"+w+"', '"+G+"'. Refer to getFontList() for available fonts."),je||xe.noFallback||(je=Yt.times[G])==null&&(je=Yt.times.normal),je},X0=h.__private__.putInfo=function(){var w=Kt(),G=function(ve){return ve};for(var xe in d!==null&&(G=Ta.encryptor(w,0)),le("<<"),le("/Producer ("+Qa(G("jsPDF "+Tt.version))+")"),bt)bt.hasOwnProperty(xe)&&bt[xe]&&le("/"+xe.substr(0,1).toUpperCase()+xe.substr(1)+" ("+Qa(G(bt[xe]))+")");le("/CreationDate ("+Qa(G(Y))+")"),le(">>"),le("endobj")},ul=h.__private__.putCatalog=function(w){var G=(w=w||{}).rootDictionaryObjId||ae;switch(Kt(),le("<<"),le("/Type /Catalog"),le("/Pages "+G+" 0 R"),ge||(ge="fullwidth"),ge){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var xe=""+ge;xe.substr(xe.length-1)==="%"&&(ge=parseInt(ge)/100),typeof ge=="number"&&le("/OpenAction [3 0 R /XYZ null null "+I(ge)+"]")}switch(Je||(Je="continuous"),Je){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}De&&le("/PageMode /"+De),$t.publish("putCatalog"),le(">>"),le("endobj")},K0=h.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(z+1)),le("/Root "+z+" 0 R"),le("/Info "+(z-1)+" 0 R"),d!==null&&le("/Encrypt "+Ta.oid+" 0 R"),le("/ID [ <"+q+"> <"+q+"> ]"),le(">>")},J0=h.__private__.putHeader=function(){le("%PDF-"+x),le("%")},Q0=h.__private__.putXRef=function(){var w="0000000000";le("xref"),le("0 "+(z+1)),le("0000000000 65535 f ");for(var G=1;G<=z;G++)typeof ue[G]=="function"?le((w+ue[G]()).slice(-10)+" 00000 n "):ue[G]!==void 0?le((w+ue[G]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},bs=h.__private__.buildDocument=function(){st(),Fe(pe),$t.publish("buildDocument"),J0(),Te(),vr(),Dt(),d!==null&&he(),X0(),ul();var w=me;return Q0(),K0(),le("startxref"),le(""+w),le("%%EOF"),Fe(Oe[L]),pe.join(`
`)},io=h.__private__.getBlob=function(w){return new Blob([xt(w)],{type:"application/pdf"})},oo=h.output=h.__private__.output=Bn(function(w,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",w){case void 0:return bs();case"save":h.save(G.filename);break;case"arraybuffer":return xt(bs());case"blob":return io(bs());case"bloburi":case"bloburl":if(Ft.URL!==void 0&&typeof Ft.URL.createObjectURL=="function")return Ft.URL&&Ft.URL.createObjectURL(io(bs()))||void 0;xr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var xe="",ve=bs();try{xe=jf(ve)}catch{xe=jf(unescape(encodeURIComponent(ve)))}return"data:application/pdf;filename="+G.filename+";base64,"+xe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ft)==="[object Window]"){var je="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",We=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(je=G.pdfObjectUrl,We="");var rt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+je+'"'+We+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",vt=Ft.open();return vt!==null&&vt.document.write(rt),vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ft)==="[object Window]"){var jt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',Bt=Ft.open();if(Bt!==null){Bt.document.write(jt);var Rt=this;Bt.document.documentElement.querySelector("#pdfViewer").onload=function(){Bt.document.title=G.filename,Bt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Rt.output("bloburl"))}}return Bt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ft)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',Cr=Ft.open();if(Cr!==null&&(Cr.document.write(Xt),Cr.document.title=G.filename),Cr||typeof safari>"u")return Cr;break;case"datauri":case"dataurl":return Ft.document.location.href=this.output("datauristring",G);default:return null}}),Bc=function(w){return Array.isArray(Aa)===!0&&Aa.indexOf(w)>-1};switch(a){case"pt":ot=1;break;case"mm":ot=72/25.4;break;case"cm":ot=72/2.54;break;case"in":ot=72;break;case"px":ot=Bc("px_scaling")==1?.75:96/72;break;case"pc":case"em":ot=12;break;case"ex":ot=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ot=a}var Ta=null;ee(),H();var Z0=function(w){return d!==null?Ta.encryptor(w,0):function(G){return G}},Uc=h.__private__.getPageInfo=h.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Pt[w].objId,pageNumber:w,pageContext:Pt[w]}},It=h.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in Pt)if(Pt[G].objId===w)break;return Uc(G)},ed=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Pt[L].objId,pageNumber:L,pageContext:Pt[L]}};h.addPage=function(){return Ic.apply(this,arguments),this},h.setPage=function(){return Rc.apply(this,arguments),Fe.call(this,Oe[L]),this},h.insertPage=function(w){return this.addPage(),this.movePage(L,w),this},h.movePage=function(w,G){var xe,ve;if(w>G){xe=Oe[w],ve=Pt[w];for(var je=w;je>G;je--)Oe[je]=Oe[je-1],Pt[je]=Pt[je-1];Oe[G]=xe,Pt[G]=ve,this.setPage(G)}else if(w<G){xe=Oe[w],ve=Pt[w];for(var We=w;We<G;We++)Oe[We]=Oe[We+1],Pt[We]=Pt[We+1];Oe[G]=xe,Pt[G]=ve,this.setPage(G)}return this},h.deletePage=function(){return G0.apply(this,arguments),this},h.__private__.text=h.text=function(w,G,xe,ve,je){var We,rt,vt,jt,Bt,Rt,Xt,Cr,Fr,Gr=(ve=ve||{}).scope||this;if(typeof w=="number"&&typeof G=="number"&&(typeof xe=="string"||Array.isArray(xe))){var Ca=xe;xe=G,G=w,w=Ca}if(arguments[3]instanceof _t?(P("The transform parameter of text() with a Matrix value"),Fr=je):(vt=arguments[4],jt=arguments[5],ar(Xt=arguments[3])==="object"&&Xt!==null||(typeof vt=="string"&&(jt=vt,vt=null),typeof Xt=="string"&&(jt=Xt,Xt=null),typeof Xt=="number"&&(vt=Xt,Xt=null),ve={flags:Xt,angle:vt,align:jt})),isNaN(G)||isNaN(xe)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return Gr;var ia="",qn=!1,pn=typeof ve.lineHeightFactor=="number"?ve.lineHeightFactor:Si,ls=Gr.internal.scaleFactor;function Xc(yr){return yr=yr.split("	").join(Array(ve.TabLen||9).join(" ")),Qa(yr,Xt)}function bl(yr){for(var wr,Ur=yr.concat(),ra=[],js=Ur.length;js--;)typeof(wr=Ur.shift())=="string"?ra.push(wr):Array.isArray(yr)&&(wr.length===1||wr[1]===void 0&&wr[2]===void 0)?ra.push(wr[0]):ra.push([wr[0],wr[1],wr[2]]);return ra}function Nl(yr,wr){var Ur;if(typeof yr=="string")Ur=wr(yr)[0];else if(Array.isArray(yr)){for(var ra,js,Pl=yr.concat(),_o=[],eu=Pl.length;eu--;)typeof(ra=Pl.shift())=="string"?_o.push(wr(ra)[0]):Array.isArray(ra)&&typeof ra[0]=="string"&&(js=wr(ra[0],ra[1],ra[2]),_o.push([js[0],js[1],js[2]]));Ur=_o}return Ur}var mo=!1,_l=!0;if(typeof w=="string")mo=!0;else if(Array.isArray(w)){var Sl=w.concat();rt=[];for(var po,ga=Sl.length;ga--;)(typeof(po=Sl.shift())!="string"||Array.isArray(po)&&typeof po[0]!="string")&&(_l=!1);mo=_l}if(mo===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var xo=ie/Gr.internal.scaleFactor,go=xo*(pn-1);switch(ve.baseline){case"bottom":xe-=go;break;case"top":xe+=xo-go;break;case"hanging":xe+=xo-2*go;break;case"middle":xe+=xo/2-go}if((Rt=ve.maxWidth||0)>0&&(typeof w=="string"?w=Gr.splitTextToSize(w,Rt):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(yr,wr){return yr.concat(Gr.splitTextToSize(wr,Rt))},[]))),We={text:w,x:G,y:xe,options:ve,mutex:{pdfEscape:Qa,activeFontKey:kt,fonts:zt,activeFontSize:ie}},$t.publish("preProcessText",We),w=We.text,vt=(ve=We.options).angle,!(Fr instanceof _t)&&vt&&typeof vt=="number"){vt*=Math.PI/180,ve.rotationDirection===0&&(vt=-vt),E===S.ADVANCED&&(vt=-vt);var vo=Math.cos(vt),Al=Math.sin(vt);Fr=new _t(vo,Al,-Al,vo,0,0)}else vt&&vt instanceof _t&&(Fr=vt);E!==S.ADVANCED||Fr||(Fr=pa),(Bt=ve.charSpace||uo)!==void 0&&(ia+=T(b(Bt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Cr=ve.horizontalScale)!==void 0&&(ia+=T(100*Cr)+` Tz
`),ve.lang;var Za=-1,ud=ve.renderingMode!==void 0?ve.renderingMode:ve.stroke,jl=Gr.internal.getCurrentPageInfo().pageContext;switch(ud){case 0:case!1:case"fill":Za=0;break;case 1:case!0:case"stroke":Za=1;break;case 2:case"fillThenStroke":Za=2;break;case 3:case"invisible":Za=3;break;case 4:case"fillAndAddForClipping":Za=4;break;case 5:case"strokeAndAddPathForClipping":Za=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Za=6;break;case 7:case"addToPathForClipping":Za=7}var Kc=jl.usedRenderingMode!==void 0?jl.usedRenderingMode:-1;Za!==-1?ia+=Za+` Tr
`:Kc!==-1&&(ia+=`0 Tr
`),Za!==-1&&(jl.usedRenderingMode=Za),jt=ve.align||"left";var En,yo=ie*pn,Jc=Gr.internal.pageSize.getWidth(),Qc=zt[kt];Bt=ve.charSpace||uo,Rt=ve.maxWidth||0,Xt=Object.assign({autoencode:!0,noBOM:!0},ve.flags);var Hs=[],Ei=function(yr){return Gr.getStringUnitWidth(yr,{font:Qc,charSpace:Bt,fontSize:ie,doKerning:!1})*ie/ls};if(Object.prototype.toString.call(w)==="[object Array]"){var en;rt=bl(w),jt!=="left"&&(En=rt.map(Ei));var qa,$s=0;if(jt==="right"){G-=En[0],w=[],ga=rt.length;for(var _s=0;_s<ga;_s++)_s===0?(qa=os(G),en=Ns(xe)):(qa=b($s-En[_s]),en=-yo),w.push([rt[_s],qa,en]),$s=En[_s]}else if(jt==="center"){G-=En[0]/2,w=[],ga=rt.length;for(var Ss=0;Ss<ga;Ss++)Ss===0?(qa=os(G),en=Ns(xe)):(qa=b(($s-En[Ss])/2),en=-yo),w.push([rt[Ss],qa,en]),$s=En[Ss]}else if(jt==="left"){w=[],ga=rt.length;for(var wo=0;wo<ga;wo++)w.push(rt[wo])}else if(jt==="justify"&&Qc.encoding==="Identity-H"){w=[],ga=rt.length,Rt=Rt!==0?Rt:Jc;for(var As=0,Br=0;Br<ga;Br++)if(en=Br===0?Ns(xe):-yo,qa=Br===0?os(G):As,Br<ga-1){var El=b((Rt-En[Br])/(rt[Br].split(" ").length-1)),Wa=rt[Br].split(" ");w.push([Wa[0]+" ",qa,en]),As=0;for(var Tn=1;Tn<Wa.length;Tn++){var bo=(Ei(Wa[Tn-1]+" "+Wa[Tn])-Ei(Wa[Tn]))*ls+El;Tn==Wa.length-1?w.push([Wa[Tn],bo,0]):w.push([Wa[Tn]+" ",bo,0]),As-=bo}}else w.push([rt[Br],qa,en]);w.push(["",As,0])}else{if(jt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],ga=rt.length,Rt=Rt!==0?Rt:Jc,Br=0;Br<ga;Br++)en=Br===0?Ns(xe):-yo,qa=Br===0?os(G):0,Br<ga-1?Hs.push(T(b((Rt-En[Br])/(rt[Br].split(" ").length-1)))):Hs.push(0),w.push([rt[Br],qa,en])}}var Zc=typeof ve.R2L=="boolean"?ve.R2L:qe;Zc===!0&&(w=Nl(w,function(yr,wr,Ur){return[yr.split("").reverse().join(""),wr,Ur]})),We={text:w,x:G,y:xe,options:ve,mutex:{pdfEscape:Qa,activeFontKey:kt,fonts:zt,activeFontSize:ie}},$t.publish("postProcessText",We),w=We.text,qn=We.mutex.isHex||!1;var Tl=zt[kt].encoding;Tl!=="WinAnsiEncoding"&&Tl!=="StandardEncoding"||(w=Nl(w,function(yr,wr,Ur){return[Xc(yr),wr,Ur]})),rt=bl(w),w=[];for(var Ti,Ci,zs,Pi=0,No=1,Li=Array.isArray(rt[0])?No:Pi,Vs="",Cl=function(yr,wr,Ur){var ra="";return Ur instanceof _t?(Ur=typeof ve.angle=="number"?Ea(Ur,new _t(1,0,0,1,yr,wr)):Ea(new _t(1,0,0,1,yr,wr),Ur),E===S.ADVANCED&&(Ur=Ea(new _t(1,0,0,-1,0,0),Ur)),ra=Ur.join(" ")+` Tm
`):ra=T(yr)+" "+T(wr)+` Td
`,ra},Cn=0;Cn<rt.length;Cn++){switch(Vs="",Li){case No:zs=(qn?"<":"(")+rt[Cn][0]+(qn?">":")"),Ti=parseFloat(rt[Cn][1]),Ci=parseFloat(rt[Cn][2]);break;case Pi:zs=(qn?"<":"(")+rt[Cn]+(qn?">":")"),Ti=os(G),Ci=Ns(xe)}Hs!==void 0&&Hs[Cn]!==void 0&&(Vs=Hs[Cn]+` Tw
`),Cn===0?w.push(Vs+Cl(Ti,Ci,Fr)+zs):Li===Pi?w.push(Vs+zs):Li===No&&w.push(Vs+Cl(Ti,Ci,Fr)+zs)}w=Li===Pi?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var Pn=`BT
/`;return Pn+=kt+" "+ie+` Tf
`,Pn+=T(ie*pn)+` TL
`,Pn+=Ai+`
`,Pn+=ia,Pn+=w,le(Pn+="ET"),g[kt]=!0,Gr};var td=h.__private__.clip=h.clip=function(w){return le(w==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return td("evenodd")},h.__private__.discardPath=h.discardPath=function(){return le("n"),this};var is=h.__private__.isValidStyle=function(w){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(G=!0),G};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(w){return is(w)&&(u=w),this};var qc=h.__private__.getStyle=h.getStyle=function(w){var G=u;switch(w){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=w}return G},Wc=h.close=function(){return le("h"),this};h.stroke=function(){return le("S"),this},h.fill=function(w){return lo("f",w),this},h.fillEvenOdd=function(w){return lo("f*",w),this},h.fillStroke=function(w){return lo("B",w),this},h.fillStrokeEvenOdd=function(w){return lo("B*",w),this};var lo=function(w,G){ar(G)==="object"?ad(G,w):le(w)},dl=function(w){w===null||E===S.ADVANCED&&w===void 0||(w=qc(w),le(w))};function rd(w,G,xe,ve,je){var We=new qi(G||this.boundingBox,xe||this.xStep,ve||this.yStep,this.gState,je||this.matrix);We.stream=this.stream;var rt=w+"$$"+this.cloneIndex+++"$$";return gr(rt,We),We}var ad=function(w,G){var xe=Ka[w.key],ve=Ot[xe];if(ve instanceof ii)le("q"),le(nd(G)),ve.gState&&h.setGState(ve.gState),le(w.matrix.toString()+" cm"),le("/"+xe+" sh"),le("Q");else if(ve instanceof qi){var je=new _t(1,0,0,-1,0,Ws());w.matrix&&(je=je.multiply(w.matrix||pa),xe=rd.call(ve,w.key,w.boundingBox,w.xStep,w.yStep,je).id),le("q"),le("/Pattern cs"),le("/"+xe+" scn"),ve.gState&&h.setGState(ve.gState),le(G),le("Q")}},nd=function(w){switch(w){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},fl=h.moveTo=function(w,G){return le(T(b(w))+" "+T(W(G))+" m"),this},_i=h.lineTo=function(w,G){return le(T(b(w))+" "+T(W(G))+" l"),this},Us=h.curveTo=function(w,G,xe,ve,je,We){return le([T(b(w)),T(W(G)),T(b(xe)),T(W(ve)),T(b(je)),T(W(We)),"c"].join(" ")),this};h.__private__.line=h.line=function(w,G,xe,ve,je){if(isNaN(w)||isNaN(G)||isNaN(xe)||isNaN(ve)||!is(je))throw new Error("Invalid arguments passed to jsPDF.line");return E===S.COMPAT?this.lines([[xe-w,ve-G]],w,G,[1,1],je||"S"):this.lines([[xe-w,ve-G]],w,G,[1,1]).stroke()},h.__private__.lines=h.lines=function(w,G,xe,ve,je,We){var rt,vt,jt,Bt,Rt,Xt,Cr,Fr,Gr,Ca,ia,qn;if(typeof w=="number"&&(qn=xe,xe=G,G=w,w=qn),ve=ve||[1,1],We=We||!1,isNaN(G)||isNaN(xe)||!Array.isArray(w)||!Array.isArray(ve)||!is(je)||typeof We!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(fl(G,xe),rt=ve[0],vt=ve[1],Bt=w.length,Ca=G,ia=xe,jt=0;jt<Bt;jt++)(Rt=w[jt]).length===2?(Ca=Rt[0]*rt+Ca,ia=Rt[1]*vt+ia,_i(Ca,ia)):(Xt=Rt[0]*rt+Ca,Cr=Rt[1]*vt+ia,Fr=Rt[2]*rt+Ca,Gr=Rt[3]*vt+ia,Ca=Rt[4]*rt+Ca,ia=Rt[5]*vt+ia,Us(Xt,Cr,Fr,Gr,Ca,ia));return We&&Wc(),dl(je),this},h.path=function(w){for(var G=0;G<w.length;G++){var xe=w[G],ve=xe.c;switch(xe.op){case"m":fl(ve[0],ve[1]);break;case"l":_i(ve[0],ve[1]);break;case"c":Us.apply(this,ve);break;case"h":Wc()}}return this},h.__private__.rect=h.rect=function(w,G,xe,ve,je){if(isNaN(w)||isNaN(G)||isNaN(xe)||isNaN(ve)||!is(je))throw new Error("Invalid arguments passed to jsPDF.rect");return E===S.COMPAT&&(ve=-ve),le([T(b(w)),T(W(G)),T(b(xe)),T(b(ve)),"re"].join(" ")),dl(je),this},h.__private__.triangle=h.triangle=function(w,G,xe,ve,je,We,rt){if(isNaN(w)||isNaN(G)||isNaN(xe)||isNaN(ve)||isNaN(je)||isNaN(We)||!is(rt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[xe-w,ve-G],[je-xe,We-ve],[w-je,G-We]],w,G,[1,1],rt,!0),this},h.__private__.roundedRect=h.roundedRect=function(w,G,xe,ve,je,We,rt){if(isNaN(w)||isNaN(G)||isNaN(xe)||isNaN(ve)||isNaN(je)||isNaN(We)||!is(rt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var vt=4/3*(Math.SQRT2-1);return je=Math.min(je,.5*xe),We=Math.min(We,.5*ve),this.lines([[xe-2*je,0],[je*vt,0,je,We-We*vt,je,We],[0,ve-2*We],[0,We*vt,-je*vt,We,-je,We],[2*je-xe,0],[-je*vt,0,-je,-We*vt,-je,-We],[0,2*We-ve],[0,-We*vt,je*vt,-We,je,-We]],w+je,G,[1,1],rt,!0),this},h.__private__.ellipse=h.ellipse=function(w,G,xe,ve,je){if(isNaN(w)||isNaN(G)||isNaN(xe)||isNaN(ve)||!is(je))throw new Error("Invalid arguments passed to jsPDF.ellipse");var We=4/3*(Math.SQRT2-1)*xe,rt=4/3*(Math.SQRT2-1)*ve;return fl(w+xe,G),Us(w+xe,G-rt,w+We,G-ve,w,G-ve),Us(w-We,G-ve,w-xe,G-rt,w-xe,G),Us(w-xe,G+rt,w-We,G+ve,w,G+ve),Us(w+We,G+ve,w+xe,G+rt,w+xe,G),dl(je),this},h.__private__.circle=h.circle=function(w,G,xe,ve){if(isNaN(w)||isNaN(G)||isNaN(xe)||!is(ve))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,G,xe,xe,ve)},h.setFont=function(w,G,xe){return xe&&(G=B(G,xe)),kt=Mc(w,G,{disableWarning:!1}),this};var sd=h.__private__.getFont=h.getFont=function(){return zt[Mc.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var w,G,xe={};for(w in Yt)if(Yt.hasOwnProperty(w))for(G in xe[w]=[],Yt[w])Yt[w].hasOwnProperty(G)&&xe[w].push(G);return xe},h.addFont=function(w,G,xe,ve,je){var We=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&We.indexOf(arguments[3])!==-1?je=arguments[3]:arguments[3]&&We.indexOf(arguments[3])==-1&&(xe=B(xe,ve)),je=je||"Identity-H",mn.call(this,w,G,xe,je)};var Si,hl=e.lineWidth||.200025,co=h.__private__.getLineWidth=h.getLineWidth=function(){return hl},Hc=h.__private__.setLineWidth=h.setLineWidth=function(w){return hl=w,le(T(b(w))+" w"),this};h.__private__.setLineDash=Tt.API.setLineDash=Tt.API.setLineDashPattern=function(w,G){if(w=w||[],G=G||0,isNaN(G)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(xe){return T(b(xe))}).join(" "),G=T(b(G)),le("["+w+"] "+G+" d"),this};var $c=h.__private__.getLineHeight=h.getLineHeight=function(){return ie*Si};h.__private__.getLineHeight=h.getLineHeight=function(){return ie*Si};var zc=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(Si=w),this},Vc=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Si};zc(e.lineHeight);var os=h.__private__.getHorizontalCoordinate=function(w){return b(w)},Ns=h.__private__.getVerticalCoordinate=function(w){return E===S.ADVANCED?w:Pt[L].mediaBox.topRightY-Pt[L].mediaBox.bottomLeftY-b(w)},id=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(w){return T(os(w))},qs=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(w){return T(Ns(w))},Un=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ce(Un)},h.__private__.setStrokeColor=h.setDrawColor=function(w,G,xe,ve){return Un=de({ch1:w,ch2:G,ch3:xe,ch4:ve,pdfColorType:"draw",precision:2}),le(Un),this};var ml=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ce(ml)},h.__private__.setFillColor=h.setFillColor=function(w,G,xe,ve){return ml=de({ch1:w,ch2:G,ch3:xe,ch4:ve,pdfColorType:"fill",precision:2}),le(ml),this};var Ai=e.textColor||"0 g",od=h.__private__.getTextColor=h.getTextColor=function(){return ce(Ai)};h.__private__.setTextColor=h.setTextColor=function(w,G,xe,ve){return Ai=de({ch1:w,ch2:G,ch3:xe,ch4:ve,pdfColorType:"text",precision:3}),this};var uo=e.charSpace,ld=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(uo||0)};h.__private__.setCharSpace=h.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return uo=w,this};var pl=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(w){var G=h.CapJoinStyles[w];if(G===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pl=G,le(G+" J"),this};var xl=0;h.__private__.setLineJoin=h.setLineJoin=function(w){var G=h.CapJoinStyles[w];if(G===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xl=G,le(G+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(T(b(w))+" M"),this},h.GState=_c,h.setGState=function(w){(w=typeof w=="string"?nr[ma[w]]:Gc(null,w)).equals(sr)||(le("/"+w.id+" gs"),sr=w)};var Gc=function(w,G){if(!w||!ma[w]){var xe=!1;for(var ve in nr)if(nr.hasOwnProperty(ve)&&nr[ve].equals(G)){xe=!0;break}if(xe)G=nr[ve];else{var je="GS"+(Object.keys(nr).length+1).toString(10);nr[je]=G,G.id=je}return w&&(ma[w]=G.id),$t.publish("addGState",G),G}};h.addGState=function(w,G){return Gc(w,G),this},h.saveGraphicsState=function(){return le("q"),Vr.push({key:kt,size:ie,color:Ai}),this},h.restoreGraphicsState=function(){le("Q");var w=Vr.pop();return kt=w.key,ie=w.size,Ai=w.color,sr=null,this},h.setCurrentTransformationMatrix=function(w){return le(w.toString()+" cm"),this},h.comment=function(w){return le("#"+w),this};var fo=function(w,G){var xe=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return xe},set:function(We){isNaN(We)||(xe=parseFloat(We))}});var ve=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ve},set:function(We){isNaN(We)||(ve=parseFloat(We))}});var je="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return je},set:function(We){je=We.toString()}}),this},gl=function(w,G,xe,ve){fo.call(this,w,G),this.type="rect";var je=xe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return je},set:function(rt){isNaN(rt)||(je=parseFloat(rt))}});var We=ve||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return We},set:function(rt){isNaN(rt)||(We=parseFloat(rt))}}),this},vl=function(){this.page=Vt,this.currentPage=L,this.pages=Oe.slice(0),this.pagesContext=Pt.slice(0),this.x=Ar,this.y=Ut,this.matrix=Rr,this.width=ji(L),this.height=Ws(L),this.outputDestination=Ze,this.id="",this.objectNumber=-1};vl.prototype.restore=function(){Vt=this.page,L=this.currentPage,Pt=this.pagesContext,Oe=this.pages,Ar=this.x,Ut=this.y,Rr=this.matrix,yl(L,this.width),wl(L,this.height),Ze=this.outputDestination};var Yc=function(w,G,xe,ve,je){ja.push(new vl),Vt=L=0,Oe=[],Ar=w,Ut=G,Rr=je,cl([xe,ve])},cd=function(w){if(Ua[w])ja.pop().restore();else{var G=new vl,xe="Xo"+(Object.keys(Mr).length+1).toString(10);G.id=xe,Ua[w]=xe,Mr[xe]=G,$t.publish("addFormObject",G),ja.pop().restore()}};for(var ho in h.beginFormObject=function(w,G,xe,ve,je){return Yc(w,G,xe,ve,je),this},h.endFormObject=function(w){return cd(w),this},h.doFormObject=function(w,G){var xe=Mr[Ua[w]];return le("q"),le(G.toString()+" cm"),le("/"+xe.id+" Do"),le("Q"),this},h.getFormObject=function(w){var G=Mr[Ua[w]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},h.save=function(w,G){return w=w||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(Ii(io(bs()),w),typeof Ii.unload=="function"&&Ft.setTimeout&&setTimeout(Ii.unload,911),this):new Promise(function(xe,ve){try{var je=Ii(io(bs()),w);typeof Ii.unload=="function"&&Ft.setTimeout&&setTimeout(Ii.unload,911),xe(je)}catch(We){ve(We.message)}})},Tt.API)Tt.API.hasOwnProperty(ho)&&(ho==="events"&&Tt.API.events.length?function(w,G){var xe,ve,je;for(je=G.length-1;je!==-1;je--)xe=G[je][0],ve=G[je][1],w.subscribe.apply(w,[xe].concat(typeof ve=="function"?[ve]:ve))}($t,Tt.API.events):h[ho]=Tt.API[ho]);var ji=h.getPageWidth=function(w){return(Pt[w=w||L].mediaBox.topRightX-Pt[w].mediaBox.bottomLeftX)/ot},yl=h.setPageWidth=function(w,G){Pt[w].mediaBox.topRightX=G*ot+Pt[w].mediaBox.bottomLeftX},Ws=h.getPageHeight=function(w){return(Pt[w=w||L].mediaBox.topRightY-Pt[w].mediaBox.bottomLeftY)/ot},wl=h.setPageHeight=function(w,G){Pt[w].mediaBox.topRightY=G*ot+Pt[w].mediaBox.bottomLeftY};return h.internal={pdfEscape:Qa,getStyle:qc,getFont:sd,getFontSize:ye,getCharSpace:ld,getTextColor:od,getLineHeight:$c,getLineHeightFactor:Vc,getLineWidth:co,write:Xe,getHorizontalCoordinate:os,getVerticalCoordinate:Ns,getCoordinateString:id,getVerticalCoordinateString:qs,collections:{},newObject:Kt,newAdditionalObject:fe,newObjectDeferred:Nr,newObjectDeferredBegin:K,getFilters:Ae,putStream:Me,events:$t,scaleFactor:ot,pageSize:{getWidth:function(){return ji(L)},setWidth:function(w){yl(L,w)},getHeight:function(){return Ws(L)},setHeight:function(w){wl(L,w)}},encryptionOptions:d,encryption:Ta,getEncryptor:Z0,output:oo,getNumberOfPages:Y0,pages:Oe,out:le,f2:I,f3:A,getPageInfo:Uc,getPageInfoByObjId:It,getCurrentPageInfo:ed,getPDFVersion:p,Point:fo,Rectangle:gl,Matrix:_t,hasHotfix:Bc},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return ji(L)},set:function(w){yl(L,w)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Ws(L)},set:function(w){wl(L,w)},enumerable:!0,configurable:!0}),V0.call(h,$e),kt="F1",Ic(n,r),$t.publish("initialized"),h}$o.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},$o.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},$o.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},$o.prototype.processOwnerPassword=function(e,t){return Tf(Ef(t).substr(0,5),e)},$o.prototype.encryptor=function(e,t){var r=Ef(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return Tf(r,a)}},_c.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||ar(e)!==ar(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},Tt.API={events:[]},Tt.version="2.5.2";var Dr=Tt.API,bh=1,no=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Io=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Mt=function(e){return e.toFixed(2)},ni=function(e){return e.toFixed(5)};Dr.__acroform__={};var hn=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Dp=function(e){return e*bh},hs=function(e){var t=new zg,r=Nt.internal.getHeight(e)||0,a=Nt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Mt(a)),Number(Mt(r))],t},fE=Dr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},hE=Dr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},mE=Dr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Wr=Dr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return mE(e,t-1)},Hr=Dr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return fE(e,t-1)},$r=Dr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return hE(e,t-1)},pE=Dr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(n)||0,c.lowerLeft_Y=a(s+l)||0,c.upperRight_X=r(n+o)||0,c.upperRight_Y=a(s)||0,[Number(Mt(c.lowerLeft_X)),Number(Mt(c.lowerLeft_Y)),Number(Mt(c.upperRight_X)),Number(Mt(c.upperRight_Y))]},xE=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=Cf(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+Mt(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=hs(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},Cf=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(A){return A.split(`
`)}):n.map(function(A){return[A]});var s=r,o=Nt.internal.getHeight(e)||0;o=o<0?-o:o;var l=Nt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(A,b,R){if(A+1<n.length){var W=b+" "+n[A+1][0];return Ou(W,e,R).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,m=Ou("3",e,s).height,g=e.multiline?o-s:(o-m)/2,h=g+=2,x=0,p=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Ou(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var _="",S=0,E=0;E<n.length;E++)if(n.hasOwnProperty(E)){var C=!1;if(n[E].length!==1&&y!==n[E].length-1){if((m+2)*(S+2)+2>o)continue e;_+=n[E][y],C=!0,p=E,E--}else{_=(_+=n[E][y]+" ").substr(_.length-1)==" "?_.substr(0,_.length-1):_;var F=parseInt(E),B=c(F,_,s),T=E>=n.length-1;if(B&&!T){_+=" ",y=0;continue}if(B||T){if(T)p=F;else if(e.multiline&&(m+2)*(S+2)+2>o)continue e}else{if(!e.multiline||(m+2)*(S+2)+2>o)continue e;p=F}}for(var P="",k=x;k<=p;k++){var I=n[k];if(e.multiline){if(k===p){P+=I[y]+" ",y=(y+1)%I.length;continue}if(k===x){P+=I[I.length-1]+" ";continue}}P+=I[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,d=Ou(P,e,s).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;case"left":default:u=2}t+=Mt(u)+" "+Mt(h)+` Td
`,t+="("+no(P)+`) Tj
`,t+=-Mt(u)+` 0 Td
`,h=-(s+2),d=0,x=C?p:p+1,S++,_=""}break}return a.text=t,a.fontSize=s,a},Ou=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},gE={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},vE=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},yE=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,n=e[r];t.internal.newObjectDeferredBegin(n.objId,!0),ar(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete e[a]}},wE=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ns.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(gE)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");bh=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Vg,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&vE(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var l=a[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=pE(l.Rect,n)),n.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Nt.createDefaultAppearanceStream(l),ar(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=xE(l);c.push({key:"AP",value:"<</N "+d+">>"}),n.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var m="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var h=l.appearanceStreamContent[g];if(m+="/"+g+" ",m+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var x=h[o];typeof x=="function"&&(x=x.call(n,l)),m+="/"+o+" "+x+" ",n.internal.acroformPlugin.xForms.indexOf(x)>=0||n.internal.acroformPlugin.xForms.push(x)}}else typeof(x=h)=="function"&&(x=x.call(n,l)),m+="/"+o+" "+x,n.internal.acroformPlugin.xForms.indexOf(x)>=0||n.internal.acroformPlugin.xForms.push(x);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:l.objId}),n.internal.out("endobj")}s&&yE(n.internal.acroformPlugin.xForms,n)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},$g=Dr.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var n="[",s=0;s<e.length;s++)switch(s!==0&&(n+=" "),ar(e[s])){case"boolean":case"number":case"object":n+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+no(a(e[s].toString()))+")"):n+=e[s].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Qd=function(e,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+no(a(e))+")"},xs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};xs.prototype.toString=function(){return this.objId+" 0 R"},xs.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},xs.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:$g(n,this.objId,this.scope)}):n instanceof xs?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&e.push({key:a,value:n}))}return e};var zg=function(){xs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};hn(zg,xs);var Vg=function(){xs.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+no(r(e))+")"}},set:function(r){e=r}})};hn(Vg,xs);var ns=function e(){xs.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute F supplied.');t=_}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Wr(t,3)},set:function(_){_?this.F=Hr(t,3):this.F=$r(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute Ff supplied.');r=_}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(_){a=_!==void 0?_:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(_){a[0]=_}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(_){a[1]=_}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(_){a[2]=_}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(_){a[3]=_}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(_){switch(_){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=_;break;default:throw new Error('Invalid value "'+_+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof p0)return;s="FieldObject"+e.FieldNum++}var _=function(S){return S};return this.scope&&(_=this.scope.internal.getEncryptor(this.objId)),"("+no(_(s))+")"},set:function(_){s=_.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(_){s=_}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(_){o=_}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(_){l=_}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(_){c=_}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/bh:u},set:function(_){u=_}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(_){d=_}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof p0||this instanceof di))return Qd(m,this.objId,this.scope)},set:function(_){_=_.toString(),m=_}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof sa?g:Qd(g,this.objId,this.scope)},set:function(_){_=_.toString(),g=this instanceof sa?_:_.substr(0,1)==="("?Io(_.substr(1,_.length-2)):Io(_)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof sa?Io(g.substr(1,g.length-1)):g},set:function(_){_=_.toString(),g=this instanceof sa?"/"+_:_}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(_){this.V=_}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof sa?h:Qd(h,this.objId,this.scope)},set:function(_){_=_.toString(),h=this instanceof sa?_:_.substr(0,1)==="("?Io(_.substr(1,_.length-2)):Io(_)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof sa?Io(h.substr(1,h.length-1)):h},set:function(_){_=_.toString(),h=this instanceof sa?"/"+_:_}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(_){_=!!_,p=_}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(_){x=_}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,1)},set:function(_){_?this.Ff=Hr(this.Ff,1):this.Ff=$r(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,2)},set:function(_){_?this.Ff=Hr(this.Ff,2):this.Ff=$r(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,3)},set:function(_){_?this.Ff=Hr(this.Ff,3):this.Ff=$r(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(_){if([0,1,2].indexOf(_)===-1)throw new Error('Invalid value "'+_+'" for attribute Q supplied.');y=_}}),Object.defineProperty(this,"textAlign",{get:function(){var _;switch(y){case 0:default:_="left";break;case 1:_="center";break;case 2:_="right"}return _},configurable:!0,enumerable:!0,set:function(_){switch(_){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};hn(ns,xs);var Hi=function(){ns.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return $g(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,18)},set:function(r){r?this.Ff=Hr(this.Ff,18):this.Ff=$r(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Hr(this.Ff,19):this.Ff=$r(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,20)},set:function(r){r?(this.Ff=Hr(this.Ff,20),t.sort()):this.Ff=$r(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,22)},set:function(r){r?this.Ff=Hr(this.Ff,22):this.Ff=$r(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,23)},set:function(r){r?this.Ff=Hr(this.Ff,23):this.Ff=$r(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,27)},set:function(r){r?this.Ff=Hr(this.Ff,27):this.Ff=$r(this.Ff,27)}}),this.hasAppearanceStream=!1};hn(Hi,ns);var $i=function(){Hi.call(this),this.fontName="helvetica",this.combo=!1};hn($i,Hi);var zi=function(){$i.call(this),this.combo=!0};hn(zi,$i);var cc=function(){zi.call(this),this.edit=!0};hn(cc,zi);var sa=function(){ns.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,15)},set:function(r){r?this.Ff=Hr(this.Ff,15):this.Ff=$r(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,16)},set:function(r){r?this.Ff=Hr(this.Ff,16):this.Ff=$r(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,17)},set:function(r){r?this.Ff=Hr(this.Ff,17):this.Ff=$r(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,26)},set:function(r){r?this.Ff=Hr(this.Ff,26):this.Ff=$r(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+no(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){ar(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};hn(sa,ns);var uc=function(){sa.call(this),this.pushButton=!0};hn(uc,sa);var Vi=function(){sa.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};hn(Vi,sa);var p0=function(){var e,t;ns.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),a)o.push("/"+s+" ("+no(n(a[s]))+")");return o.push(">>"),o.join(`
`)},set:function(n){ar(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Nt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};hn(p0,ns),Vi.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Vi.prototype.createOption=function(e){var t=new p0;return t.Parent=this,t.optionName=e,this.Kids.push(t),bE.call(this.scope,t),t};var dc=function(){sa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Nt.CheckBox.createAppearanceStream()};hn(dc,sa);var di=function(){ns.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,13)},set:function(t){t?this.Ff=Hr(this.Ff,13):this.Ff=$r(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,21)},set:function(t){t?this.Ff=Hr(this.Ff,21):this.Ff=$r(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,23)},set:function(t){t?this.Ff=Hr(this.Ff,23):this.Ff=$r(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,24)},set:function(t){t?this.Ff=Hr(this.Ff,24):this.Ff=$r(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,25)},set:function(t){t?this.Ff=Hr(this.Ff,25):this.Ff=$r(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,26)},set:function(t){t?this.Ff=Hr(this.Ff,26):this.Ff=$r(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};hn(di,ns);var fc=function(){di.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Wr(this.Ff,14)},set:function(e){e?this.Ff=Hr(this.Ff,14):this.Ff=$r(this.Ff,14)}}),this.password=!0};hn(fc,di);var Nt={CheckBox:{createAppearanceStream:function(){return{N:{On:Nt.CheckBox.YesNormal},D:{On:Nt.CheckBox.YesPushDown,Off:Nt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=hs(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=Cf(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Mt(Nt.internal.getWidth(e))+" "+Mt(Nt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Mt(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=hs(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],s=Nt.internal.getHeight(e),o=Nt.internal.getWidth(e),l=Cf(e,e.caption);return n.push("1 g"),n.push("0 0 "+Mt(o)+" "+Mt(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Mt(o-1)+" "+Mt(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Mt(l.fontSize)+" Tf "+a),n.push(l.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=hs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Mt(Nt.internal.getWidth(e))+" "+Mt(Nt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Nt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Nt.RadioButton.Circle.YesNormal,t.D[e]=Nt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=hs(e);t.scope=e.scope;var r=[],a=Nt.internal.getWidth(e)<=Nt.internal.getHeight(e)?Nt.internal.getWidth(e)/4:Nt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Nt.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ni(Nt.internal.getWidth(e)/2)+" "+ni(Nt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=hs(e);t.scope=e.scope;var r=[],a=Nt.internal.getWidth(e)<=Nt.internal.getHeight(e)?Nt.internal.getWidth(e)/4:Nt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*Nt.internal.Bezier_C).toFixed(5)),o=Number((a*Nt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ni(Nt.internal.getWidth(e)/2)+" "+ni(Nt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ni(Nt.internal.getWidth(e)/2)+" "+ni(Nt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=hs(e);t.scope=e.scope;var r=[],a=Nt.internal.getWidth(e)<=Nt.internal.getHeight(e)?Nt.internal.getWidth(e)/4:Nt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*Nt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ni(Nt.internal.getWidth(e)/2)+" "+ni(Nt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Nt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Nt.RadioButton.Cross.YesNormal,t.D[e]=Nt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=hs(e);t.scope=e.scope;var r=[],a=Nt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Mt(Nt.internal.getWidth(e)-2)+" "+Mt(Nt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Mt(a.x1.x)+" "+Mt(a.x1.y)+" m"),r.push(Mt(a.x2.x)+" "+Mt(a.x2.y)+" l"),r.push(Mt(a.x4.x)+" "+Mt(a.x4.y)+" m"),r.push(Mt(a.x3.x)+" "+Mt(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=hs(e);t.scope=e.scope;var r=Nt.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Mt(Nt.internal.getWidth(e))+" "+Mt(Nt.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Mt(Nt.internal.getWidth(e)-2)+" "+Mt(Nt.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Mt(r.x1.x)+" "+Mt(r.x1.y)+" m"),a.push(Mt(r.x2.x)+" "+Mt(r.x2.y)+" l"),a.push(Mt(r.x4.x)+" "+Mt(r.x4.y)+" m"),a.push(Mt(r.x3.x)+" "+Mt(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=hs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Mt(Nt.internal.getWidth(e))+" "+Mt(Nt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Nt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Nt.internal.getWidth(e),r=Nt.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Nt.internal.getWidth=function(e){var t=0;return ar(e)==="object"&&(t=Dp(e.Rect[2])),t},Nt.internal.getHeight=function(e){var t=0;return ar(e)==="object"&&(t=Dp(e.Rect[3])),t};var bE=Dr.addField=function(e){if(wE(this,e),!(e instanceof ns))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Dr.AcroFormChoiceField=Hi,Dr.AcroFormListBox=$i,Dr.AcroFormComboBox=zi,Dr.AcroFormEditBox=cc,Dr.AcroFormButton=sa,Dr.AcroFormPushButton=uc,Dr.AcroFormRadioButton=Vi,Dr.AcroFormCheckBox=dc,Dr.AcroFormTextField=di,Dr.AcroFormPasswordField=fc,Dr.AcroFormAppearance=Nt,Dr.AcroForm={ChoiceField:Hi,ListBox:$i,ComboBox:zi,EditBox:cc,Button:sa,PushButton:uc,RadioButton:Vi,CheckBox:dc,TextField:di,PasswordField:fc,Appearance:Nt},Tt.AcroForm={ChoiceField:Hi,ListBox:$i,ComboBox:zi,EditBox:cc,Button:sa,PushButton:uc,RadioButton:Vi,CheckBox:dc,TextField:di,PasswordField:fc,Appearance:Nt};var NE=Tt.AcroForm;function Gg(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(A,b){var R,W,Y,q,U,H=t;if((b=b||t)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(B(A))for(U in r)for(Y=r[U],R=0;R<Y.length;R+=1){for(q=!0,W=0;W<Y[R].length;W+=1)if(Y[R][W]!==void 0&&Y[R][W]!==A[W]){q=!1;break}if(q===!0){H=U;break}}else for(U in r)for(Y=r[U],R=0;R<Y.length;R+=1){for(q=!0,W=0;W<Y[R].length;W+=1)if(Y[R][W]!==void 0&&Y[R][W]!==A.charCodeAt(W)){q=!1;break}if(q===!0){H=U;break}}return H===t&&b!==t&&(H=b),H},n=function A(b){for(var R=this.internal.write,W=this.internal.putStream,Y=(0,this.internal.getFilters)();Y.indexOf("FlateEncode")!==-1;)Y.splice(Y.indexOf("FlateEncode"),1);b.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:b.width}),q.push({key:"Height",value:b.height}),b.colorSpace===y.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(b.palette.length/3-1)+" "+("sMask"in b&&b.sMask!==void 0?b.objectId+2:b.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+b.colorSpace}),b.colorSpace===y.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:b.bitsPerComponent}),"decodeParameters"in b&&b.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+b.decodeParameters+">>"}),"transparency"in b&&Array.isArray(b.transparency)){for(var U="",H=0,Q=b.transparency.length;H<Q;H++)U+=b.transparency[H]+" "+b.transparency[H]+" ";q.push({key:"Mask",value:"["+U+"]"})}b.sMask!==void 0&&q.push({key:"SMask",value:b.objectId+1+" 0 R"});var ne=b.filter!==void 0?["/"+b.filter]:void 0;if(W({data:b.data,additionalKeyValues:q,alreadyAppliedFilters:ne,objectId:b.objectId}),R("endobj"),"sMask"in b&&b.sMask!==void 0){var ee="/Predictor "+b.predictor+" /Colors 1 /BitsPerComponent "+b.bitsPerComponent+" /Columns "+b.width,N={width:b.width,height:b.height,colorSpace:"DeviceGray",bitsPerComponent:b.bitsPerComponent,decodeParameters:ee,data:b.sMask};"filter"in b&&(N.filter=b.filter),A.call(this,N)}if(b.colorSpace===y.INDEXED){var L=this.internal.newObject();W({data:P(new Uint8Array(b.palette)),objectId:L}),R("endobj")}},s=function(){var A=this.internal.collections.addImage_images;for(var b in A)n.call(this,A[b])},o=function(){var A,b=this.internal.collections.addImage_images,R=this.internal.write;for(var W in b)R("/I"+(A=b[W]).index,A.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var A=this.internal.collections.addImage_images;return l.call(this),A},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(A){return typeof e["process"+A.toUpperCase()]=="function"},m=function(A){return ar(A)==="object"&&A.nodeType===1},g=function(A,b){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var R=""+A.getAttribute("src");if(R.indexOf("data:image/")===0)return lc(unescape(R).split("base64,").pop());var W=e.loadFile(R,!0);if(W!==void 0)return W}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var Y;switch(b){case"PNG":Y="image/png";break;case"WEBP":Y="image/webp";break;case"JPEG":case"JPG":default:Y="image/jpeg"}return lc(A.toDataURL(Y,1).split("base64,").pop())}},h=function(A){var b=this.internal.collections.addImage_images;if(b){for(var R in b)if(A===b[R].alias)return b[R]}},x=function(A,b,R){return A||b||(A=-96,b=-96),A<0&&(A=-1*R.width*72/A/this.internal.scaleFactor),b<0&&(b=-1*R.height*72/b/this.internal.scaleFactor),A===0&&(A=b*R.width/R.height),b===0&&(b=A*R.height/R.width),[A,b]},p=function(A,b,R,W,Y,q){var U=x.call(this,R,W,Y),H=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,ne=c.call(this);if(R=U[0],W=U[1],ne[Y.index]=Y,q){q*=Math.PI/180;var ee=Math.cos(q),N=Math.sin(q),L=function(M){return M.toFixed(4)},D=[L(ee),L(N),L(-1*N),L(ee),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,H(A),Q(b+W),"cm"].join(" ")),this.internal.write(D.join(" ")),this.internal.write([H(R),"0","0",H(W),"0","0","cm"].join(" "))):this.internal.write([H(R),"0","0",H(W),H(A),Q(b+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Y.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(A){var b,R,W=0;if(typeof A=="string")for(R=A.length,b=0;b<R;b++)W=(W<<5)-W+A.charCodeAt(b),W|=0;else if(B(A))for(R=A.byteLength/2,b=0;b<R;b++)W=(W<<5)-W+A[b],W|=0;return W},E=e.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var b=!0;return A.length===0&&(b=!1),A.length%4!=0&&(b=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(b=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(b=!1),b},C=e.__addimage__.extractImageFromDataUrl=function(A){var b=(A=A||"").split("base64,"),R=null;if(b.length===2){var W=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(b[0]);Array.isArray(W)&&(R={mimeType:W[1],charset:W[2],data:b[1]})}return R},F=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(A){return F()&&A instanceof ArrayBuffer};var B=e.__addimage__.isArrayBufferView=function(A){return F()&&typeof Uint32Array<"u"&&(A instanceof Int8Array||A instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array)},T=e.__addimage__.binaryStringToUint8Array=function(A){for(var b=A.length,R=new Uint8Array(b),W=0;W<b;W++)R[W]=A.charCodeAt(W);return R},P=e.__addimage__.arrayBufferToBinaryString=function(A){for(var b="",R=B(A)?A:new Uint8Array(A),W=0;W<R.length;W+=8192)b+=String.fromCharCode.apply(null,R.subarray(W,W+8192));return b};e.addImage=function(){var A,b,R,W,Y,q,U,H,Q;if(typeof arguments[1]=="number"?(b=t,R=arguments[1],W=arguments[2],Y=arguments[3],q=arguments[4],U=arguments[5],H=arguments[6],Q=arguments[7]):(b=arguments[1],R=arguments[2],W=arguments[3],Y=arguments[4],q=arguments[5],U=arguments[6],H=arguments[7],Q=arguments[8]),ar(A=arguments[0])==="object"&&!m(A)&&"imageData"in A){var ne=A;A=ne.imageData,b=ne.format||b||t,R=ne.x||R||0,W=ne.y||W||0,Y=ne.w||ne.width||Y,q=ne.h||ne.height||q,U=ne.alias||U,H=ne.compression||H,Q=ne.rotation||ne.angle||Q}var ee=this.internal.getFilters();if(H===void 0&&ee.indexOf("FlateEncode")!==-1&&(H="SLOW"),isNaN(R)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var N=k.call(this,A,b,U,H);return p.call(this,R,W,Y,q,N,Q),this};var k=function(A,b,R,W){var Y,q,U;if(typeof A=="string"&&a(A)===t){A=unescape(A);var H=I(A,!1);(H!==""||(H=e.loadFile(A,!0))!==void 0)&&(A=H)}if(m(A)&&(A=g(A,b)),b=a(A,b),!d(b))throw new Error("addImage does not support files of type '"+b+"', please ensure that a plugin for '"+b+"' support is added.");if(((U=R)==null||U.length===0)&&(R=function(Q){return typeof Q=="string"||B(Q)?S(Q):B(Q.data)?S(Q.data):null}(A)),(Y=h.call(this,R))||(F()&&(A instanceof Uint8Array||b==="RGBA"||(q=A,A=T(A))),Y=this["process"+b.toUpperCase()](A,u.call(this),R,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in e.image_compression?Q:_.NONE}(W),q)),!Y)throw new Error("An unknown error occurred whilst processing the image.");return Y},I=e.__addimage__.convertBase64ToBinaryString=function(A,b){var R;b=typeof b!="boolean"||b;var W,Y="";if(typeof A=="string"){W=(R=C(A))!==null?R.data:A;try{Y=lc(W)}catch(q){if(b)throw E(W)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};e.getImageProperties=function(A){var b,R,W="";if(m(A)&&(A=g(A)),typeof A=="string"&&a(A)===t&&((W=I(A,!1))===""&&(W=e.loadFile(A)||""),A=W),R=a(A),!d(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(!F()||A instanceof Uint8Array||(A=T(A)),!(b=this["process"+R.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return b.fileType=R,b}})(Tt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Tt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,n,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,m=0;m<u.length&&!d;m++)switch((a=u[m]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){a=u[g];var h=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),_=this.internal.getEncryptor(p.objId),S=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y)+"] ")+"/Contents ("+h(_(a.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(_(S))+") >>",p.content=s;var E=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+l(a.bounds.y)+"] ")+" /Parent "+E,a.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(p.objId,"0 R",y.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y+a.bounds.h)+"] ";var C=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+h(x(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var F=this.annotations._nameMap[a.options.name];a.options.pageNumber=F.page,a.options.top=F.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+h(x(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var B=l(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+B+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,n,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(a),w:c(r+n),h:u(a+s)},options:o,type:"link"})},e.textWithLink=function(r,a,n,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,a,n,s),n+=.2*u,s.align==="center"&&(a-=c/2),s.align==="right"&&(a-=c),this.link(a,n-u,l,o,s),c},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(Tt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(p){return t[p.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=e.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&t[p.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&n.indexOf(p.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&t[p.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&t[p.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&t[p.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&t[p.charCodeAt(0)].length==4},m=e.__arabicParser__.resolveLigatures=function(p){var y=0,_=r,S="",E=0;for(y=0;y<p.length;y+=1)_[p.charCodeAt(y)]!==void 0?(E++,typeof(_=_[p.charCodeAt(y)])=="number"&&(S+=String.fromCharCode(_),_=r,E=0),y===p.length-1&&(_=r,S+=p.charAt(y-(E-1)),y-=E-1,E=0)):(_=r,S+=p.charAt(y-E),y-=E,E=0);return S};e.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&a[p.charCodeAt(0)]!==void 0};var g=e.__arabicParser__.getCorrectForm=function(p,y,_){return o(p)?s(p)===!1?-1:!u(p)||!o(y)&&!o(_)||!o(_)&&l(y)||l(p)&&!o(y)||l(p)&&c(y)||l(p)&&l(y)?0:d(p)&&o(y)&&!l(y)&&o(_)&&u(_)?3:l(p)||!o(_)?1:2:-1},h=function(p){var y=0,_=0,S=0,E="",C="",F="",B=(p=p||"").split("\\s+"),T=[];for(y=0;y<B.length;y+=1){for(T.push(""),_=0;_<B[y].length;_+=1)E=B[y][_],C=B[y][_-1],F=B[y][_+1],o(E)?(S=g(E,C,F),T[y]+=S!==-1?String.fromCharCode(t[E.charCodeAt(0)][S]):E):T[y]+=E;T[y]=m(T[y])}return T.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var p,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,_=[];if(Array.isArray(y)){var S=0;for(_=[],S=0;S<y.length;S+=1)Array.isArray(y[S])?_.push([h(y[S][0]),y[S][1],y[S][2]]):_.push([h(y[S])]);p=_}else p=h(y);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};e.events.push(["preProcessText",x])}(Tt.API),Tt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Tt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(p){m=p}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(p){g=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(p){x=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return a.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){a.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),m=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,h=0,x=0,p=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var _=u.maxWidth;_>0?typeof c=="string"?c=this.splitTextToSize(c,_):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(E,C){return E.concat(y.splitTextToSize(C,_))},[])):c=Array.isArray(c)?c:[c];for(var S=0;S<c.length;S++)h<(p=this.getStringUnitWidth(c[S],{font:m})*d)&&(h=p);return h!==0&&(x=c.length),{w:h/=g,h:Math.max((x*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/g,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,m=this.internal.__cell__.margins||t,g=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,h&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,m,g){if(a.call(this),!d)throw new Error("No data for PDF table.");var h,x,p,y,_=[],S=[],E=[],C={},F={},B=[],T=[],P=(g=g||{}).autoSize||!1,k=g.printHeaders!==!1,I=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,A=g.margins||Object.assign({width:this.getPageWidth()},t),b=typeof g.padding=="number"?g.padding:3,R=g.headerBackgroundColor||"#c8c8c8",W=g.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=b,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=W,this.setFontSize(I),m==null)S=_=Object.keys(d[0]),E=_.map(function(){return"left"});else if(Array.isArray(m)&&ar(m[0])==="object")for(_=m.map(function(ne){return ne.name}),S=m.map(function(ne){return ne.prompt||ne.name||""}),E=m.map(function(ne){return ne.align||"left"}),h=0;h<m.length;h+=1)F[m[h].name]=m[h].width*(19.049976/25.4);else Array.isArray(m)&&typeof m[0]=="string"&&(S=_=m,E=_.map(function(){return"left"}));if(P||Array.isArray(m)&&typeof m[0]=="string")for(h=0;h<_.length;h+=1){for(C[y=_[h]]=d.map(function(ne){return ne[y]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(S[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=C[y],this.setFont(void 0,"normal"),p=0;p<x.length;p+=1)B.push(this.getTextDimensions(x[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[y]=Math.max.apply(null,B)+b+b,B=[]}if(k){var Y={};for(h=0;h<_.length;h+=1)Y[_[h]]={},Y[_[h]].text=S[h],Y[_[h]].align=E[h];var q=l.call(this,Y,F);T=_.map(function(ne){return new s(c,u,F[ne],q,Y[ne].text,void 0,Y[ne].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var U=m.reduce(function(ne,ee){return ne[ee.name]=ee.align,ne},{});for(h=0;h<d.length;h+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:h,data:d[h]},this);var H=l.call(this,d[h],F);for(p=0;p<_.length;p+=1){var Q=d[h][_[p]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:h,col:p,data:Q},this),o.call(this,new s(c,u,F[_[p]],H,Q,h+2,U[_[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(h){var x=c[h];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*m/g+d+d},this).reduce(function(h,x){return Math.max(h,x)},0)};e.setTableHeaderRow=function(c){a.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,g.push(d)),d.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(x)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(Tt.API);var Yg={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Xg=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Pf=Gg(Xg),Kg=[100,200,300,400,500,600,700,800,900],_E=Gg(Kg);function Lf(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Yg[s=s||"normal"]?s:"normal"}(e.style),a=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),n=function(s){return typeof Pf[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function Op(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var SE={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Ip={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Rp(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function AE(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},SE,r.genericFontFamilies||{}),s=null,o=null,l=0;l<t.length;++l)if(n[(s=Lf(t[l])).family]&&(s.family=n[s.family]),e.hasOwnProperty(s.family)){o=e[s.family];break}if(!(o=o||e[a]))throw new Error("Could not find a font-family for the rule '"+Rp(s)+"' and default family '"+a+"'.");if(o=function(c,u){if(u[c])return u[c];var d=Pf[c],m=d<=Pf.normal?-1:1,g=Op(u,Xg,d,m);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(s.stretch,o),o=function(c,u){if(u[c])return u[c];for(var d=Yg[c],m=0;m<d.length;++m)if(u[d[m]])return u[d[m]];throw new Error("Could not find a matching font-style for "+c)}(s.style,o),!(o=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var d=_E[c],m=Op(u,Kg,d,c<400?-1:1);if(!m)throw new Error("Could not find a matching font-weight for value "+c);return m}(s.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Rp(s)+"'.");return o}function Mp(e){return e.trimLeft()}function jE(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function EE(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Iu,Bp,Up,Zd=["times"];(function(e){var t,r,a,n,s,o,l,c,u,d=function(N){return N=N||{},this.isStrokeTransparent=N.isStrokeTransparent||!1,this.strokeOpacity=N.strokeOpacity||1,this.strokeStyle=N.strokeStyle||"#000000",this.fillStyle=N.fillStyle||"#000000",this.isFillTransparent=N.isFillTransparent||!1,this.fillOpacity=N.fillOpacity||1,this.font=N.font||"10px sans-serif",this.textBaseline=N.textBaseline||"alphabetic",this.textAlign=N.textAlign||"left",this.lineWidth=N.lineWidth||1,this.lineJoin=N.lineJoin||"miter",this.lineCap=N.lineCap||"butt",this.path=N.path||[],this.transform=N.transform!==void 0?N.transform.clone():new c,this.globalCompositeOperation=N.globalCompositeOperation||"normal",this.globalAlpha=N.globalAlpha||1,this.clip_path=N.clip_path||[],this.currentPoint=N.currentPoint||new o,this.miterLimit=N.miterLimit||10,this.lastPoint=N.lastPoint||new o,this.lineDashOffset=N.lineDashOffset||0,this.lineDash=N.lineDash||[],this.margin=N.margin||[0,0,0,0],this.prevPageLastElemOffset=N.prevPageLastElemOffset||0,this.ignoreClearRect=typeof N.ignoreClearRect!="boolean"||N.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new m(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var m=function(N){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=N;Object.defineProperty(this,"pdf",{get:function(){return L}});var D=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return D},set:function(Fe){D=!!Fe}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(Fe){M=!!Fe}});var z=0;Object.defineProperty(this,"posX",{get:function(){return z},set:function(Fe){isNaN(Fe)||(z=Fe)}});var ue=0;Object.defineProperty(this,"posY",{get:function(){return ue},set:function(Fe){isNaN(Fe)||(ue=Fe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Fe){var le;typeof Fe=="number"?le=[Fe,Fe,Fe,Fe]:((le=new Array(4))[0]=Fe[0],le[1]=Fe.length>=2?Fe[1]:le[0],le[2]=Fe.length>=3?Fe[2]:le[0],le[3]=Fe.length>=4?Fe[3]:le[1]),u.margin=le}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(Fe){pe=Fe}});var me=0;Object.defineProperty(this,"lastBreak",{get:function(){return me},set:function(Fe){me=Fe}});var Ne=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ne},set:function(Fe){Ne=Fe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Fe){Fe instanceof d&&(u=Fe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Fe){u.path=Fe}});var Oe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Oe},set:function(Fe){Oe=Fe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Fe){var le;le=g(Fe),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Fe){var le=g(Fe);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Fe){["butt","round","square"].indexOf(Fe)!==-1&&(this.ctx.lineCap=Fe,this.pdf.setLineCap(Fe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Fe){isNaN(Fe)||(this.ctx.lineWidth=Fe,this.pdf.setLineWidth(Fe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Fe){["bevel","round","miter"].indexOf(Fe)!==-1&&(this.ctx.lineJoin=Fe,this.pdf.setLineJoin(Fe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Fe){isNaN(Fe)||(this.ctx.miterLimit=Fe,this.pdf.setMiterLimit(Fe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Fe){this.ctx.textBaseline=Fe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Fe){["right","end","center","left","start"].indexOf(Fe)!==-1&&(this.ctx.textAlign=Fe)}});var Ie=null;function Ze(Fe,le){if(Ie===null){var Xe=function(xt){var $e=[];return Object.keys(xt).forEach(function(ie){xt[ie].forEach(function(ge){var ye=null;switch(ge){case"bold":ye={family:ie,weight:"bold"};break;case"italic":ye={family:ie,style:"italic"};break;case"bolditalic":ye={family:ie,weight:"bold",style:"italic"};break;case"":case"normal":ye={family:ie}}ye!==null&&(ye.ref={name:ie,style:ge},$e.push(ye))})}),$e}(Fe.getFontList());Ie=function(xt){for(var $e={},ie=0;ie<xt.length;++ie){var ge=Lf(xt[ie]),ye=ge.family,qe=ge.stretch,De=ge.style,Re=ge.weight;$e[ye]=$e[ye]||{},$e[ye][qe]=$e[ye][qe]||{},$e[ye][qe][De]=$e[ye][qe][De]||{},$e[ye][qe][De][Re]=ge}return $e}(Xe.concat(le))}return Ie}var st=null;Object.defineProperty(this,"fontFaces",{get:function(){return st},set:function(Fe){Ie=null,st=Fe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Fe){var le;if(this.ctx.font=Fe,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Fe))!==null){var Xe=le[1],xt=(le[2],le[3]),$e=le[4],ie=(le[5],le[6]),ge=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec($e)[2];$e=Math.floor(ge==="px"?parseFloat($e)*this.pdf.internal.scaleFactor:ge==="em"?parseFloat($e)*this.pdf.getFontSize():parseFloat($e)*this.pdf.internal.scaleFactor),this.pdf.setFontSize($e);var ye=function(bt){var kt,ot,Ar=[],Ut=bt.trim();if(Ut==="")return Zd;if(Ut in Ip)return[Ip[Ut]];for(;Ut!=="";){switch(ot=null,kt=(Ut=Mp(Ut)).charAt(0)){case'"':case"'":ot=jE(Ut.substring(1),kt);break;default:ot=EE(Ut)}if(ot===null||(Ar.push(ot[0]),(Ut=Mp(ot[1]))!==""&&Ut.charAt(0)!==","))return Zd;Ut=Ut.replace(/^,/,"")}return Ar}(ie);if(this.fontFaces){var qe=AE(Ze(this.pdf,this.fontFaces),ye.map(function(bt){return{family:bt,stretch:"normal",weight:xt,style:Xe}}));this.pdf.setFont(qe.ref.name,qe.ref.style)}else{var De="";(xt==="bold"||parseInt(xt,10)>=700||Xe==="bold")&&(De="bold"),Xe==="italic"&&(De+="italic"),De.length===0&&(De="normal");for(var Re="",Je={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},mt=0;mt<ye.length;mt++){if(this.pdf.internal.getFont(ye[mt],De,{noFallback:!0,disableWarning:!0})!==void 0){Re=ye[mt];break}if(De==="bolditalic"&&this.pdf.internal.getFont(ye[mt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Re=ye[mt],De="bold";else if(this.pdf.internal.getFont(ye[mt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Re=ye[mt],De="normal";break}}if(Re===""){for(var wt=0;wt<ye.length;wt++)if(Je[ye[wt]]){Re=Je[ye[wt]];break}}Re=Re===""?"Times":Re,this.pdf.setFont(Re,De)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Fe){this.ctx.globalCompositeOperation=Fe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Fe){this.ctx.globalAlpha=Fe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Fe){this.ctx.lineDashOffset=Fe,ee.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Fe){this.ctx.lineDash=Fe,ee.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Fe){this.ctx.ignoreClearRect=!!Fe}})};m.prototype.setLineDash=function(N){this.lineDash=N},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){C.call(this,"fill",!1)},m.prototype.stroke=function(){C.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(N,L){if(isNaN(N)||isNaN(L))throw xr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var D=this.ctx.transform.applyToPoint(new o(N,L));this.path.push({type:"mt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(N,L)},m.prototype.closePath=function(){var N=new o(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&ar(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){N=new o(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(N.x,N.y)},m.prototype.lineTo=function(N,L){if(isNaN(N)||isNaN(L))throw xr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var D=this.ctx.transform.applyToPoint(new o(N,L));this.path.push({type:"lt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},m.prototype.quadraticCurveTo=function(N,L,D,M){if(isNaN(D)||isNaN(M)||isNaN(N)||isNaN(L))throw xr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var z=this.ctx.transform.applyToPoint(new o(D,M)),ue=this.ctx.transform.applyToPoint(new o(N,L));this.path.push({type:"qct",x1:ue.x,y1:ue.y,x:z.x,y:z.y}),this.ctx.lastPoint=new o(z.x,z.y)},m.prototype.bezierCurveTo=function(N,L,D,M,z,ue){if(isNaN(z)||isNaN(ue)||isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M))throw xr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new o(z,ue)),me=this.ctx.transform.applyToPoint(new o(N,L)),Ne=this.ctx.transform.applyToPoint(new o(D,M));this.path.push({type:"bct",x1:me.x,y1:me.y,x2:Ne.x,y2:Ne.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new o(pe.x,pe.y)},m.prototype.arc=function(N,L,D,M,z,ue){if(isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M)||isNaN(z))throw xr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ue=!!ue,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new o(N,L));N=pe.x,L=pe.y;var me=this.ctx.transform.applyToPoint(new o(0,D)),Ne=this.ctx.transform.applyToPoint(new o(0,0));D=Math.sqrt(Math.pow(me.x-Ne.x,2)+Math.pow(me.y-Ne.y,2))}Math.abs(z-M)>=2*Math.PI&&(M=0,z=2*Math.PI),this.path.push({type:"arc",x:N,y:L,radius:D,startAngle:M,endAngle:z,counterclockwise:ue})},m.prototype.arcTo=function(N,L,D,M,z){throw new Error("arcTo not implemented.")},m.prototype.rect=function(N,L,D,M){if(isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M))throw xr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(N,L),this.lineTo(N+D,L),this.lineTo(N+D,L+M),this.lineTo(N,L+M),this.lineTo(N,L),this.lineTo(N+D,L),this.lineTo(N,L)},m.prototype.fillRect=function(N,L,D,M){if(isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M))throw xr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var z={};this.lineCap!=="butt"&&(z.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(z.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(N,L,D,M),this.fill(),z.hasOwnProperty("lineCap")&&(this.lineCap=z.lineCap),z.hasOwnProperty("lineJoin")&&(this.lineJoin=z.lineJoin)}},m.prototype.strokeRect=function(N,L,D,M){if(isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M))throw xr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(N,L,D,M),this.stroke())},m.prototype.clearRect=function(N,L,D,M){if(isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M))throw xr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(N,L,D,M))},m.prototype.save=function(N){N=typeof N!="boolean"||N;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),N){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},m.prototype.restore=function(N){N=typeof N!="boolean"||N;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("Q");this.pdf.setPage(L),N&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(N){var L,D,M,z;if(N.isCanvasGradient===!0&&(N=N.getColor()),!N)return{r:0,g:0,b:0,a:0,style:N};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(N))L=0,D=0,M=0,z=0;else{var ue=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(N);if(ue!==null)L=parseInt(ue[1]),D=parseInt(ue[2]),M=parseInt(ue[3]),z=1;else if((ue=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(N))!==null)L=parseInt(ue[1]),D=parseInt(ue[2]),M=parseInt(ue[3]),z=parseFloat(ue[4]);else{if(z=1,typeof N=="string"&&N.charAt(0)!=="#"){var pe=new qg(N);N=pe.ok?pe.toHex():"#000000"}N.length===4?(L=N.substring(1,2),L+=L,D=N.substring(2,3),D+=D,M=N.substring(3,4),M+=M):(L=N.substring(1,3),D=N.substring(3,5),M=N.substring(5,7)),L=parseInt(L,16),D=parseInt(D,16),M=parseInt(M,16)}}return{r:L,g:D,b:M,a:z,style:N}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(N,L,D,M){if(isNaN(L)||isNaN(D)||typeof N!="string")throw xr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!h.call(this)){var z=H(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;b.call(this,{text:N,x:L,y:D,scale:ue,angle:z,align:this.textAlign,maxWidth:M})}},m.prototype.strokeText=function(N,L,D,M){if(isNaN(L)||isNaN(D)||typeof N!="string")throw xr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){M=isNaN(M)?void 0:M;var z=H(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;b.call(this,{text:N,x:L,y:D,scale:ue,renderingMode:"stroke",angle:z,align:this.textAlign,maxWidth:M})}},m.prototype.measureText=function(N){if(typeof N!="string")throw xr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,D=this.pdf.internal.scaleFactor,M=L.internal.getFontSize(),z=L.getStringUnitWidth(N)*M/L.internal.scaleFactor,ue=function(pe){var me=(pe=pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this};return new ue({width:z*=Math.round(96*D/72*1e4)/1e4})},m.prototype.scale=function(N,L){if(isNaN(N)||isNaN(L))throw xr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var D=new c(N,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(D)},m.prototype.rotate=function(N){if(isNaN(N))throw xr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(N),Math.sin(N),-Math.sin(N),Math.cos(N),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},m.prototype.translate=function(N,L){if(isNaN(N)||isNaN(L))throw xr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var D=new c(1,0,0,1,N,L);this.ctx.transform=this.ctx.transform.multiply(D)},m.prototype.transform=function(N,L,D,M,z,ue){if(isNaN(N)||isNaN(L)||isNaN(D)||isNaN(M)||isNaN(z)||isNaN(ue))throw xr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new c(N,L,D,M,z,ue);this.ctx.transform=this.ctx.transform.multiply(pe)},m.prototype.setTransform=function(N,L,D,M,z,ue){N=isNaN(N)?1:N,L=isNaN(L)?0:L,D=isNaN(D)?0:D,M=isNaN(M)?1:M,z=isNaN(z)?0:z,ue=isNaN(ue)?0:ue,this.ctx.transform=new c(N,L,D,M,z,ue)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(N,L,D,M,z,ue,pe,me,Ne){var Oe=this.pdf.getImageProperties(N),Ie=1,Ze=1,st=1,Fe=1;M!==void 0&&me!==void 0&&(st=me/M,Fe=Ne/z,Ie=Oe.width/M*me/M,Ze=Oe.height/z*Ne/z),ue===void 0&&(ue=L,pe=D,L=0,D=0),M!==void 0&&me===void 0&&(me=M,Ne=z),M===void 0&&me===void 0&&(me=Oe.width,Ne=Oe.height);for(var le,Xe=this.ctx.transform.decompose(),xt=H(Xe.rotate.shx),$e=new c,ie=($e=($e=($e=$e.multiply(Xe.translate)).multiply(Xe.skew)).multiply(Xe.scale)).applyToRectangle(new l(ue-L*st,pe-D*Fe,M*Ie,z*Ze)),ge=y.call(this,ie),ye=[],qe=0;qe<ge.length;qe+=1)ye.indexOf(ge[qe])===-1&&ye.push(ge[qe]);if(E(ye),this.autoPaging)for(var De=ye[0],Re=ye[ye.length-1],Je=De;Je<Re+1;Je++){this.pdf.setPage(Je);var mt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],wt=Je===1?this.posY+this.margin[0]:this.margin[0],bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ot=Je===1?0:bt+(Je-2)*kt;if(this.ctx.clip_path.length!==0){var Ar=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(le,this.posX+this.margin[3],-ot+wt+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=Ar}var Ut=JSON.parse(JSON.stringify(ie));Ut=S([Ut],this.posX+this.margin[3],-ot+wt+this.ctx.prevPageLastElemOffset)[0];var Rr=(Je>De||Je<Re)&&p.call(this);Rr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],mt,kt,null).clip().discardPath()),this.pdf.addImage(N,"JPEG",Ut.x,Ut.y,Ut.w,Ut.h,null,null,xt),Rr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(N,"JPEG",ie.x,ie.y,ie.w,ie.h,null,null,xt)};var y=function(N,L,D){var M=[];L=L||this.pdf.internal.pageSize.width,D=D||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var z=this.posY+this.ctx.prevPageLastElemOffset;switch(N.type){default:case"mt":case"lt":M.push(Math.floor((N.y+z)/D)+1);break;case"arc":M.push(Math.floor((N.y+z-N.radius)/D)+1),M.push(Math.floor((N.y+z+N.radius)/D)+1);break;case"qct":var ue=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x,N.y);M.push(Math.floor((ue.y+z)/D)+1),M.push(Math.floor((ue.y+ue.h+z)/D)+1);break;case"bct":var pe=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x2,N.y2,N.x,N.y);M.push(Math.floor((pe.y+z)/D)+1),M.push(Math.floor((pe.y+pe.h+z)/D)+1);break;case"rect":M.push(Math.floor((N.y+z)/D)+1),M.push(Math.floor((N.y+N.h+z)/D)+1)}for(var me=0;me<M.length;me+=1)for(;this.pdf.internal.getNumberOfPages()<M[me];)_.call(this);return M},_=function(){var N=this.fillStyle,L=this.strokeStyle,D=this.font,M=this.lineCap,z=this.lineWidth,ue=this.lineJoin;this.pdf.addPage(),this.fillStyle=N,this.strokeStyle=L,this.font=D,this.lineCap=M,this.lineWidth=z,this.lineJoin=ue},S=function(N,L,D){for(var M=0;M<N.length;M++)switch(N[M].type){case"bct":N[M].x2+=L,N[M].y2+=D;case"qct":N[M].x1+=L,N[M].y1+=D;case"mt":case"lt":case"arc":default:N[M].x+=L,N[M].y+=D}return N},E=function(N){return N.sort(function(L,D){return L-D})},C=function(N,L){for(var D,M,z=this.fillStyle,ue=this.strokeStyle,pe=this.lineCap,me=this.lineWidth,Ne=Math.abs(me*this.ctx.transform.scaleX),Oe=this.lineJoin,Ie=JSON.parse(JSON.stringify(this.path)),Ze=JSON.parse(JSON.stringify(this.path)),st=[],Fe=0;Fe<Ze.length;Fe++)if(Ze[Fe].x!==void 0)for(var le=y.call(this,Ze[Fe]),Xe=0;Xe<le.length;Xe+=1)st.indexOf(le[Xe])===-1&&st.push(le[Xe]);for(var xt=0;xt<st.length;xt++)for(;this.pdf.internal.getNumberOfPages()<st[xt];)_.call(this);if(E(st),this.autoPaging)for(var $e=st[0],ie=st[st.length-1],ge=$e;ge<ie+1;ge++){this.pdf.setPage(ge),this.fillStyle=z,this.strokeStyle=ue,this.lineCap=pe,this.lineWidth=Ne,this.lineJoin=Oe;var ye=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qe=ge===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Re=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Je=ge===1?0:De+(ge-2)*Re;if(this.ctx.clip_path.length!==0){var mt=this.path;D=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(D,this.posX+this.margin[3],-Je+qe+this.ctx.prevPageLastElemOffset),F.call(this,N,!0),this.path=mt}if(M=JSON.parse(JSON.stringify(Ie)),this.path=S(M,this.posX+this.margin[3],-Je+qe+this.ctx.prevPageLastElemOffset),L===!1||ge===0){var wt=(ge>$e||ge<ie)&&p.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ye,Re,null).clip().discardPath()),F.call(this,N,L),wt&&this.pdf.restoreGraphicsState()}this.lineWidth=me}else this.lineWidth=Ne,F.call(this,N,L),this.lineWidth=me;this.path=Ie},F=function(N,L){if((N!=="stroke"||L||!x.call(this))&&(N==="stroke"||L||!h.call(this))){for(var D,M,z=[],ue=this.path,pe=0;pe<ue.length;pe++){var me=ue[pe];switch(me.type){case"begin":z.push({begin:!0});break;case"close":z.push({close:!0});break;case"mt":z.push({start:me,deltas:[],abs:[]});break;case"lt":var Ne=z.length;if(ue[pe-1]&&!isNaN(ue[pe-1].x)&&(D=[me.x-ue[pe-1].x,me.y-ue[pe-1].y],Ne>0)){for(;Ne>=0;Ne--)if(z[Ne-1].close!==!0&&z[Ne-1].begin!==!0){z[Ne-1].deltas.push(D),z[Ne-1].abs.push(me);break}}break;case"bct":D=[me.x1-ue[pe-1].x,me.y1-ue[pe-1].y,me.x2-ue[pe-1].x,me.y2-ue[pe-1].y,me.x-ue[pe-1].x,me.y-ue[pe-1].y],z[z.length-1].deltas.push(D);break;case"qct":var Oe=ue[pe-1].x+2/3*(me.x1-ue[pe-1].x),Ie=ue[pe-1].y+2/3*(me.y1-ue[pe-1].y),Ze=me.x+2/3*(me.x1-me.x),st=me.y+2/3*(me.y1-me.y),Fe=me.x,le=me.y;D=[Oe-ue[pe-1].x,Ie-ue[pe-1].y,Ze-ue[pe-1].x,st-ue[pe-1].y,Fe-ue[pe-1].x,le-ue[pe-1].y],z[z.length-1].deltas.push(D);break;case"arc":z.push({deltas:[],abs:[],arc:!0}),Array.isArray(z[z.length-1].abs)&&z[z.length-1].abs.push(me)}}M=L?null:N==="stroke"?"stroke":"fill";for(var Xe=!1,xt=0;xt<z.length;xt++)if(z[xt].arc)for(var $e=z[xt].abs,ie=0;ie<$e.length;ie++){var ge=$e[ie];ge.type==="arc"?P.call(this,ge.x,ge.y,ge.radius,ge.startAngle,ge.endAngle,ge.counterclockwise,void 0,L,!Xe):R.call(this,ge.x,ge.y),Xe=!0}else if(z[xt].close===!0)this.pdf.internal.out("h"),Xe=!1;else if(z[xt].begin!==!0){var ye=z[xt].start.x,qe=z[xt].start.y;W.call(this,z[xt].deltas,ye,qe),Xe=!0}M&&k.call(this,M),L&&I.call(this)}},B=function(N){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,D=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return N-D;case"top":return N+L-D;case"hanging":return N+L-2*D;case"middle":return N+L/2-D;case"ideographic":return N;case"alphabetic":default:return N}},T=function(N){return N+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var N=function(){};return N.colorStops=[],N.addColorStop=function(L,D){this.colorStops.push([L,D])},N.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},N.isCanvasGradient=!0,N},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(N,L,D,M,z,ue,pe,me,Ne){for(var Oe=q.call(this,D,M,z,ue),Ie=0;Ie<Oe.length;Ie++){var Ze=Oe[Ie];Ie===0&&(Ne?A.call(this,Ze.x1+N,Ze.y1+L):R.call(this,Ze.x1+N,Ze.y1+L)),Y.call(this,N,L,Ze.x2,Ze.y2,Ze.x3,Ze.y3,Ze.x4,Ze.y4)}me?I.call(this):k.call(this,pe)},k=function(N){switch(N){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(N,L){this.pdf.internal.out(r(N)+" "+a(L)+" m")},b=function(N){var L;switch(N.align){case"right":case"end":L="right";break;case"center":L="center";break;case"left":case"start":default:L="left"}var D=this.pdf.getTextDimensions(N.text),M=B.call(this,N.y),z=T.call(this,M)-D.h,ue=this.ctx.transform.applyToPoint(new o(N.x,M)),pe=this.ctx.transform.decompose(),me=new c;me=(me=(me=me.multiply(pe.translate)).multiply(pe.skew)).multiply(pe.scale);for(var Ne,Oe,Ie,Ze=this.ctx.transform.applyToRectangle(new l(N.x,M,D.w,D.h)),st=me.applyToRectangle(new l(N.x,z,D.w,D.h)),Fe=y.call(this,st),le=[],Xe=0;Xe<Fe.length;Xe+=1)le.indexOf(Fe[Xe])===-1&&le.push(Fe[Xe]);if(E(le),this.autoPaging)for(var xt=le[0],$e=le[le.length-1],ie=xt;ie<$e+1;ie++){this.pdf.setPage(ie);var ge=ie===1?this.posY+this.margin[0]:this.margin[0],ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[2],De=qe-this.margin[0],Re=this.pdf.internal.pageSize.width-this.margin[1],Je=Re-this.margin[3],mt=ie===1?0:ye+(ie-2)*De;if(this.ctx.clip_path.length!==0){var wt=this.path;Ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(Ne,this.posX+this.margin[3],-1*mt+ge),F.call(this,"fill",!0),this.path=wt}var bt=S([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-mt+ge+this.ctx.prevPageLastElemOffset)[0];N.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*N.scale),Ie=this.lineWidth,this.lineWidth=Ie*N.scale);var kt=this.autoPaging!=="text";if(kt||bt.y+bt.h<=qe){if(kt||bt.y>=ge&&bt.x<=Re){var ot=kt?N.text:this.pdf.splitTextToSize(N.text,N.maxWidth||Re-bt.x)[0],Ar=S([JSON.parse(JSON.stringify(Ze))],this.posX+this.margin[3],-mt+ge+this.ctx.prevPageLastElemOffset)[0],Ut=kt&&(ie>xt||ie<$e)&&p.call(this);Ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,De,null).clip().discardPath()),this.pdf.text(ot,Ar.x,Ar.y,{angle:N.angle,align:L,renderingMode:N.renderingMode}),Ut&&this.pdf.restoreGraphicsState()}}else bt.y<qe&&(this.ctx.prevPageLastElemOffset+=qe-bt.y);N.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=Ie)}else N.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*N.scale),Ie=this.lineWidth,this.lineWidth=Ie*N.scale),this.pdf.text(N.text,ue.x+this.posX,ue.y+this.posY,{angle:N.angle,align:L,renderingMode:N.renderingMode,maxWidth:N.maxWidth}),N.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=Ie)},R=function(N,L,D,M){D=D||0,M=M||0,this.pdf.internal.out(r(N+D)+" "+a(L+M)+" l")},W=function(N,L,D){return this.pdf.lines(N,L,D,null,null)},Y=function(N,L,D,M,z,ue,pe,me){this.pdf.internal.out([t(n(D+N)),t(s(M+L)),t(n(z+N)),t(s(ue+L)),t(n(pe+N)),t(s(me+L)),"c"].join(" "))},q=function(N,L,D,M){for(var z=2*Math.PI,ue=Math.PI/2;L>D;)L-=z;var pe=Math.abs(D-L);pe<z&&M&&(pe=z-pe);for(var me=[],Ne=M?-1:1,Oe=L;pe>1e-5;){var Ie=Oe+Ne*Math.min(pe,ue);me.push(U.call(this,N,Oe,Ie)),pe-=Math.abs(Ie-Oe),Oe=Ie}return me},U=function(N,L,D){var M=(D-L)/2,z=N*Math.cos(M),ue=N*Math.sin(M),pe=z,me=-ue,Ne=pe*pe+me*me,Oe=Ne+pe*z+me*ue,Ie=4/3*(Math.sqrt(2*Ne*Oe)-Oe)/(pe*ue-me*z),Ze=pe-Ie*me,st=me+Ie*pe,Fe=Ze,le=-st,Xe=M+L,xt=Math.cos(Xe),$e=Math.sin(Xe);return{x1:N*Math.cos(L),y1:N*Math.sin(L),x2:Ze*xt-st*$e,y2:Ze*$e+st*xt,x3:Fe*xt-le*$e,y3:Fe*$e+le*xt,x4:N*Math.cos(D),y4:N*Math.sin(D)}},H=function(N){return 180*N/Math.PI},Q=function(N,L,D,M,z,ue){var pe=N+.5*(D-N),me=L+.5*(M-L),Ne=z+.5*(D-z),Oe=ue+.5*(M-ue),Ie=Math.min(N,z,pe,Ne),Ze=Math.max(N,z,pe,Ne),st=Math.min(L,ue,me,Oe),Fe=Math.max(L,ue,me,Oe);return new l(Ie,st,Ze-Ie,Fe-st)},ne=function(N,L,D,M,z,ue,pe,me){var Ne,Oe,Ie,Ze,st,Fe,le,Xe,xt,$e,ie,ge,ye,qe,De=D-N,Re=M-L,Je=z-D,mt=ue-M,wt=pe-z,bt=me-ue;for(Oe=0;Oe<41;Oe++)xt=(le=(Ie=N+(Ne=Oe/40)*De)+Ne*((st=D+Ne*Je)-Ie))+Ne*(st+Ne*(z+Ne*wt-st)-le),$e=(Xe=(Ze=L+Ne*Re)+Ne*((Fe=M+Ne*mt)-Ze))+Ne*(Fe+Ne*(ue+Ne*bt-Fe)-Xe),Oe==0?(ie=xt,ge=$e,ye=xt,qe=$e):(ie=Math.min(ie,xt),ge=Math.min(ge,$e),ye=Math.max(ye,xt),qe=Math.max(qe,$e));return new l(Math.round(ie),Math.round(ge),Math.round(ye-ie),Math.round(qe-ge))},ee=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var N,L,D=(N=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:N,lineDashOffset:L}));this.prevLineDash!==D&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=D)}}})(Tt.API),function(e){var t=function(s){var o,l,c,u,d,m,g,h,x,p;for(l=[],c=0,u=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;u>c;c+=4)(d=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(m=(d=((d=((d=((d=(d-(p=d%85))/85)-(x=d%85))/85)-(h=d%85))/85)-(g=d%85))/85)%85,l.push(m+33,g+33,h+33,x+33,p+33)):l.push(122);return function(y,_){for(var S=_;S>0;S--)y.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(s){var o,l,c,u,d,m=String,g="length",h=255,x="charCodeAt",p="slice",y="replace";for(s[p](-2),s=s[p](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),c=[],u=0,d=(s+=o="uuuuu"[p](s[g]%5||5))[g];d>u;u+=5)l=52200625*(s[x](u)-33)+614125*(s[x](u+1)-33)+7225*(s[x](u+2)-33)+85*(s[x](u+3)-33)+(s[x](u+4)-33),c.push(h&l>>24,h&l>>16,h&l>>8,h&l);return function(_,S){for(var E=S;E>0;E--)_.pop()}(c,o[g]),m.fromCharCode.apply(m,c)},a=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var l="",c=0;c<s.length;c+=2)l+=String.fromCharCode("0x"+(s[c]+s[c+1]));return l},n=function(s){for(var o=new Uint8Array(s.length),l=s.length;l--;)o[l]=s.charCodeAt(l);return s=(o=Af(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,o){var l=0,c=s||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=n(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(Tt.API),function(e){e.loadFile=function(t,r,a){return function(n,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var m=new XMLHttpRequest,g=0,h=function(x){var p=x.length,y=[],_=String.fromCharCode;for(g=0;g<p;g+=1)y.push(_(255&x.charCodeAt(g)));return y.join("")};if(m.open("GET",c,!u),m.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(m.onload=function(){m.status===200?d(h(this.responseText)):d(void 0)}),m.send(null),u&&m.status===200)return h(m.responseText)}(n,s,o)}catch{}return l}(t,r,a)},e.loadImageFile=e.loadFile}(Tt.API),function(e){function t(){return(Ft.html2canvas?Promise.resolve(Ft.html2canvas):Ga(()=>import("./charts-bc1c71da.js").then(o=>o.h),["assets/charts-bc1c71da.js","assets/vendor-348d559c.js"])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ft.DOMPurify?Promise.resolve(Ft.DOMPurify):Ga(()=>import("./purify.es-2de9db7f.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var a=function(o){var l=ar(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},n=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},s=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,o,1,[o])).set(l)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,l){return o.__proto__=l||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(a(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(c){return this.set({src:n("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,d){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)d!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||m.appendChild(c(g,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var g=0;g<u.length;++g){var h=u[g],x=h.src.find(function(p){return p.format==="truetype"});x&&c.addFont(x.url,h.ref.name,h.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,c.context2d.save(!0),l(this.prop.container,m)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},s.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(a(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},s.prototype.get=function(o,l){return this.then(function(){var c=o in s.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},s.prototype.setMargin=function(o){return this.then(function(){switch(a(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||Tt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,d){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return c.updateProgress(null,u),m}).then(u,d).then(function(m){return c.updateProgress(1),m})})},s.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),d=c.call(u,o,l);return s.convert(d,this.__proto__)},s.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},s.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},s.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return s.convert(l,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Tt.getPageSize=function(o,l,c){if(ar(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,m=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var h,x=0,p=0;if(g.hasOwnProperty(m))x=g[m][1]/d,p=g[m][0]/d;else try{x=c[1],p=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",p>x&&(h=p,p=x,x=h);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",x>p&&(h=p,p=x,x=h)}return{width:p,height:x,unit:l,k:d,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Lf):null;var c=new s(l);return l.worker?c:c.from(o).doCallback()}}(Tt.API),Tt.API.addJS=function(e){return Up=e,this.internal.events.subscribe("postPutResources",function(){Iu=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Iu+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Bp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Up+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Iu!==void 0&&Bp!==void 0&&this.internal.out("/Names <</JavaScript "+Iu+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var o=n[s],l=a.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var m=r.internal.newObject();d.push(m);var g=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var o={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var o=a.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var u=0;u<a.children.length;u++)this.renderItems(a.children[u])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])}(Tt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,n,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(m){for(var g,h=256*m.charCodeAt(4)+m.charCodeAt(5),x=m.length,p={width:0,height:0,numcomponents:1},y=4;y<x;y+=2){if(y+=h,t.indexOf(m.charCodeAt(y+1))!==-1){g=256*m.charCodeAt(y+5)+m.charCodeAt(y+6),p={width:256*m.charCodeAt(y+7)+m.charCodeAt(y+8),height:g,numcomponents:m.charCodeAt(y+9)};break}h=256*m.charCodeAt(y+2)+m.charCodeAt(y+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:a,alias:n}}return d}}(Tt.API);var Ro,Ru,qp,Wp,Hp,TE=function(){var e,t,r;function a(s){var o,l,c,u,d,m,g,h,x,p,y,_,S,E;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(o=this.readUInt32(),x=(function(){var C,F;for(F=[],C=0;C<4;++C)F.push(String.fromCharCode(this.data[this.pos++]));return F}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,m.delay=1e3*d/u,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(x==="fdAT"&&(this.pos+=4,o-=4),s=(m!=null?m.data:void 0)||this.imgData,_=0;0<=o?_<o:_>o;0<=o?++_:--_)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((p=c-this.transparency.indexed.length)>0)for(S=0;0<=p?S<p:S>p;0<=p?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":g=(y=this.read(o)).indexOf(0),h=String.fromCharCode.apply(String,y.slice(0,g)),this.text[h]=String.fromCharCode.apply(String,y.slice(g+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(E=this.colorType)===4||E===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(s){var o,l;for(l=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)l.push(this.data[this.pos++]);return l},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(s){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,u=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function d(m,g,h,x){var p,y,_,S,E,C,F,B,T,P,k,I,A,b,R,W,Y,q,U,H,Q,ne=Math.ceil((u.width-m)/h),ee=Math.ceil((u.height-g)/x),N=u.width==ne&&u.height==ee;for(b=o*ne,I=N?l:new Uint8Array(b*ee),C=s.length,A=0,y=0;A<ee&&c<C;){switch(s[c++]){case 0:for(S=Y=0;Y<b;S=Y+=1)I[y++]=s[c++];break;case 1:for(S=q=0;q<b;S=q+=1)p=s[c++],E=S<o?0:I[y-o],I[y++]=(p+E)%256;break;case 2:for(S=U=0;U<b;S=U+=1)p=s[c++],_=(S-S%o)/o,R=A&&I[(A-1)*b+_*o+S%o],I[y++]=(R+p)%256;break;case 3:for(S=H=0;H<b;S=H+=1)p=s[c++],_=(S-S%o)/o,E=S<o?0:I[y-o],R=A&&I[(A-1)*b+_*o+S%o],I[y++]=(p+Math.floor((E+R)/2))%256;break;case 4:for(S=Q=0;Q<b;S=Q+=1)p=s[c++],_=(S-S%o)/o,E=S<o?0:I[y-o],A===0?R=W=0:(R=I[(A-1)*b+_*o+S%o],W=_&&I[(A-1)*b+(_-1)*o+S%o]),F=E+R-W,B=Math.abs(F-E),P=Math.abs(F-R),k=Math.abs(F-W),T=B<=P&&B<=k?E:P<=k?R:W,I[y++]=(p+T)%256;break;default:throw new Error("Invalid filter algorithm: "+s[c-1])}if(!N){var L=((g+A*x)*u.width+m)*o,D=A*b;for(S=0;S<ne;S+=1){for(var M=0;M<o;M+=1)l[L++]=I[D++];L+=(h-1)*o}}A++}}return s=sE(s),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},a.prototype.decodePalette=function(){var s,o,l,c,u,d,m,g,h;for(l=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+l.length),c=0,s=0,o=m=0,g=l.length;m<g;o=m+=3)u[c++]=l[o],u[c++]=l[o+1],u[c++]=l[o+2],u[c++]=(h=d[s++])!=null?h:255;return u},a.prototype.copyToImageData=function(s,o){var l,c,u,d,m,g,h,x,p,y,_;if(c=this.colors,p=null,l=this.hasAlphaChannel,this.palette.length&&(p=(_=this._decodedPalette)!=null?_:this._decodedPalette=this.decodePalette(),c=4,l=!0),x=(u=s.data||s).length,m=p||o,d=g=0,c===1)for(;d<x;)h=p?4*o[d/4]:g,y=m[h++],u[d++]=y,u[d++]=y,u[d++]=y,u[d++]=l?m[h++]:255,g=h;else for(;d<x;)h=p?4*o[d/4]:g,u[d++]=m[h++],u[d++]=m[h++],u[d++]=m[h++],u[d++]=l?m[h++]:255,g=h},a.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var n=function(){if(Object.prototype.toString.call(Ft)==="[object Window]"){try{t=Ft.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return n(),e=function(s){var o;if(n()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(s){var o,l,c,u,d,m,g,h;if(this.animation){for(h=[],l=d=0,m=(g=this.animation.frames).length;d<m;l=++d)o=g[l],c=s.createImageData(o.width,o.height),u=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,u),o.imageData=c,h.push(o.image=e(c));return h}},a.prototype.renderFrame=function(s,o){var l,c,u;return l=(c=this.animation.frames)[o],u=c[o-1],o===0&&s.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?s.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&s.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&s.clearRect(l.xOffset,l.yOffset,l.width,l.height),s.drawImage(l.image,l.xOffset,l.yOffset)},a.prototype.animate=function(s){var o,l,c,u,d,m,g=this;return l=0,m=this.animation,u=m.numFrames,c=m.frames,d=m.numPlays,(o=function(){var h,x;if(h=l++%u,x=c[h],g.renderFrame(s,h),u>1&&l/u<d)return g.animation._timeout=setTimeout(o,x.delay)})()},a.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},a.prototype.render=function(s){var o,l;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function CE(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],s=n>>7,o=1<<(7&n)+1;e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,d=[],m=0,g=null,h=0,x=null;for(this.width=r,this.height=a;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((A=e[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var p=e[t++];m=e[t++]|e[t++]<<8,g=e[t++],!(1&p)&&(g=null),h=p>>2&7,t++;break;case 254:for(;;){if(!((A=e[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,C=e[t++],F=C>>6&1,B=1<<(7&C)+1,T=l,P=c,k=!1;C>>7&&(k=!0,T=t,P=B,t+=3*B);var I=t;for(t++;;){var A;if(!((A=e[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}d.push({x:y,y:_,width:S,height:E,has_local_palette:k,palette_offset:T,palette_size:P,data_offset:I,data_length:t-I,transparent_index:g,interlaced:!!F,delay:m,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return x},this.frameInfo=function(b){if(b<0||b>=d.length)throw new Error("Frame index out of range.");return d[b]},this.decodeAndBlitFrameBGRA=function(b,R){var W=this.frameInfo(b),Y=W.width*W.height,q=new Uint8Array(Y);$p(e,W.data_offset,q,Y);var U=W.palette_offset,H=W.transparent_index;H===null&&(H=256);var Q=W.width,ne=r-Q,ee=Q,N=4*(W.y*r+W.x),L=4*((W.y+W.height)*r+W.x),D=N,M=4*ne;W.interlaced===!0&&(M+=4*r*7);for(var z=8,ue=0,pe=q.length;ue<pe;++ue){var me=q[ue];if(ee===0&&(ee=Q,(D+=M)>=L&&(M=4*ne+4*r*(z-1),D=N+(Q+ne)*(z<<1),z>>=1)),me===H)D+=4;else{var Ne=e[U+3*me],Oe=e[U+3*me+1],Ie=e[U+3*me+2];R[D++]=Ie,R[D++]=Oe,R[D++]=Ne,R[D++]=255}--ee}},this.decodeAndBlitFrameRGBA=function(b,R){var W=this.frameInfo(b),Y=W.width*W.height,q=new Uint8Array(Y);$p(e,W.data_offset,q,Y);var U=W.palette_offset,H=W.transparent_index;H===null&&(H=256);var Q=W.width,ne=r-Q,ee=Q,N=4*(W.y*r+W.x),L=4*((W.y+W.height)*r+W.x),D=N,M=4*ne;W.interlaced===!0&&(M+=4*r*7);for(var z=8,ue=0,pe=q.length;ue<pe;++ue){var me=q[ue];if(ee===0&&(ee=Q,(D+=M)>=L&&(M=4*ne+4*r*(z-1),D=N+(Q+ne)*(z<<1),z>>=1)),me===H)D+=4;else{var Ne=e[U+3*me],Oe=e[U+3*me+1],Ie=e[U+3*me+2];R[D++]=Ne,R[D++]=Oe,R[D++]=Ie,R[D++]=255}--ee}}}function $p(e,t,r,a){for(var n=e[t++],s=1<<n,o=s+1,l=o+1,c=n+1,u=(1<<c)-1,d=0,m=0,g=0,h=e[t++],x=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)m|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var y=m&u;if(m>>=c,d-=c,y!==s){if(y===o)break;for(var _=y<l?y:p,S=0,E=_;E>s;)E=x[E]>>8,++S;var C=E;if(g+S+(_!==y?1:0)>a)return void xr.log("Warning, gif stream longer than expected.");r[g++]=C;var F=g+=S;for(_!==y&&(r[g++]=C),E=_;S--;)E=x[E],r[--F]=255&E,E>>=8;p!==null&&l<4096&&(x[l++]=p<<8|C,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=y}else l=o+1,u=(1<<(c=n+1))-1,p=null}return g!==a&&xr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ef(e){var t,r,a,n,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),m=new Array(65535),g=new Array(65535),h=new Array(64),x=new Array(64),p=[],y=0,_=7,S=new Array(64),E=new Array(64),C=new Array(64),F=new Array(256),B=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],b=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Y=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(N,L){for(var D=0,M=0,z=new Array,ue=1;ue<=16;ue++){for(var pe=1;pe<=N[ue];pe++)z[L[M]]=[],z[L[M]][0]=D,z[L[M]][1]=ue,M++,D++;D*=2}return z}function U(N){for(var L=N[0],D=N[1]-1;D>=0;)L&1<<D&&(y|=1<<_),D--,--_<0&&(y==255?(H(255),H(0)):H(y),_=7,y=0)}function H(N){p.push(N)}function Q(N){H(N>>8&255),H(255&N)}function ne(N,L,D,M,z){for(var ue,pe=z[0],me=z[240],Ne=function($e,ie){var ge,ye,qe,De,Re,Je,mt,wt,bt,kt,ot=0;for(bt=0;bt<8;++bt){ge=$e[ot],ye=$e[ot+1],qe=$e[ot+2],De=$e[ot+3],Re=$e[ot+4],Je=$e[ot+5],mt=$e[ot+6];var Ar=ge+(wt=$e[ot+7]),Ut=ge-wt,Rr=ye+mt,zt=ye-mt,Yt=qe+Je,Vr=qe-Je,Ot=De+Re,Ka=De-Re,nr=Ar+Ot,ma=Ar-Ot,sr=Rr+Yt,Vt=Rr-Yt;$e[ot]=nr+sr,$e[ot+4]=nr-sr;var Pt=.707106781*(Vt+ma);$e[ot+2]=ma+Pt,$e[ot+6]=ma-Pt;var $t=.382683433*((nr=Ka+Vr)-(Vt=zt+Ut)),Aa=.5411961*nr+$t,Mr=1.306562965*Vt+$t,Ua=.707106781*(sr=Vr+zt),ja=Ut+Ua,_t=Ut-Ua;$e[ot+5]=_t+Aa,$e[ot+3]=_t-Aa,$e[ot+1]=ja+Mr,$e[ot+7]=ja-Mr,ot+=8}for(ot=0,bt=0;bt<8;++bt){ge=$e[ot],ye=$e[ot+8],qe=$e[ot+16],De=$e[ot+24],Re=$e[ot+32],Je=$e[ot+40],mt=$e[ot+48];var Ea=ge+(wt=$e[ot+56]),pa=ge-wt,gr=ye+mt,Kt=ye-mt,Nr=qe+Je,K=qe-Je,fe=De+Re,ae=De-Re,re=Ea+fe,ce=Ea-fe,de=gr+Nr,Ae=gr-Nr;$e[ot]=re+de,$e[ot+32]=re-de;var Me=.707106781*(Ae+ce);$e[ot+16]=ce+Me,$e[ot+48]=ce-Me;var Ee=.382683433*((re=ae+K)-(Ae=Kt+pa)),Te=.5411961*re+Ee,Le=1.306562965*Ae+Ee,tt=.707106781*(de=K+Kt),it=pa+tt,pt=pa-tt;$e[ot+40]=pt+Te,$e[ot+24]=pt-Te,$e[ot+8]=it+Le,$e[ot+56]=it-Le,ot++}for(bt=0;bt<64;++bt)kt=$e[bt]*ie[bt],h[bt]=kt>0?kt+.5|0:kt-.5|0;return h}(N,L),Oe=0;Oe<64;++Oe)x[T[Oe]]=Ne[Oe];var Ie=x[0]-D;D=x[0],Ie==0?U(M[0]):(U(M[g[ue=32767+Ie]]),U(m[ue]));for(var Ze=63;Ze>0&&x[Ze]==0;)Ze--;if(Ze==0)return U(pe),D;for(var st,Fe=1;Fe<=Ze;){for(var le=Fe;x[Fe]==0&&Fe<=Ze;)++Fe;var Xe=Fe-le;if(Xe>=16){st=Xe>>4;for(var xt=1;xt<=st;++xt)U(me);Xe&=15}ue=32767+x[Fe],U(z[(Xe<<4)+g[ue]]),U(m[ue]),Fe++}return Ze!=63&&U(pe),D}function ee(N){N=Math.min(Math.max(N,1),100),s!=N&&(function(L){for(var D=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var z=o((D[M]*L+50)/100);z=Math.min(Math.max(z,1),255),l[T[M]]=z}for(var ue=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var me=o((ue[pe]*L+50)/100);me=Math.min(Math.max(me,1),255),c[T[pe]]=me}for(var Ne=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Oe=0,Ie=0;Ie<8;Ie++)for(var Ze=0;Ze<8;Ze++)u[Oe]=1/(l[T[Oe]]*Ne[Ie]*Ne[Ze]*8),d[Oe]=1/(c[T[Oe]]*Ne[Ie]*Ne[Ze]*8),Oe++}(N<50?Math.floor(5e3/N):Math.floor(200-2*N)),s=N)}this.encode=function(N,L){L&&ee(L),p=new Array,y=0,_=7,Q(65496),Q(65504),Q(16),H(74),H(70),H(73),H(70),H(0),H(1),H(1),H(0),Q(1),Q(1),H(0),H(0),function(){Q(65499),Q(132),H(0);for(var ye=0;ye<64;ye++)H(l[ye]);H(1);for(var qe=0;qe<64;qe++)H(c[qe])}(),function(ye,qe){Q(65472),Q(17),H(8),Q(qe),Q(ye),H(3),H(1),H(17),H(0),H(2),H(17),H(1),H(3),H(17),H(1)}(N.width,N.height),function(){Q(65476),Q(418),H(0);for(var ye=0;ye<16;ye++)H(P[ye+1]);for(var qe=0;qe<=11;qe++)H(k[qe]);H(16);for(var De=0;De<16;De++)H(I[De+1]);for(var Re=0;Re<=161;Re++)H(A[Re]);H(1);for(var Je=0;Je<16;Je++)H(b[Je+1]);for(var mt=0;mt<=11;mt++)H(R[mt]);H(17);for(var wt=0;wt<16;wt++)H(W[wt+1]);for(var bt=0;bt<=161;bt++)H(Y[bt])}(),Q(65498),Q(12),H(3),H(1),H(0),H(2),H(17),H(3),H(17),H(0),H(63),H(0);var D=0,M=0,z=0;y=0,_=7,this.encode.displayName="_encode_";for(var ue,pe,me,Ne,Oe,Ie,Ze,st,Fe,le=N.data,Xe=N.width,xt=N.height,$e=4*Xe,ie=0;ie<xt;){for(ue=0;ue<$e;){for(Oe=$e*ie+ue,Ze=-1,st=0,Fe=0;Fe<64;Fe++)Ie=Oe+(st=Fe>>3)*$e+(Ze=4*(7&Fe)),ie+st>=xt&&(Ie-=$e*(ie+1+st-xt)),ue+Ze>=$e&&(Ie-=ue+Ze-$e+4),pe=le[Ie++],me=le[Ie++],Ne=le[Ie++],S[Fe]=(B[pe]+B[me+256>>0]+B[Ne+512>>0]>>16)-128,E[Fe]=(B[pe+768>>0]+B[me+1024>>0]+B[Ne+1280>>0]>>16)-128,C[Fe]=(B[pe+1280>>0]+B[me+1536>>0]+B[Ne+1792>>0]>>16)-128;D=ne(S,u,D,t,a),M=ne(E,d,M,r,n),z=ne(C,d,z,r,n),ue+=32}ie+=8}if(_>=0){var ge=[];ge[1]=_+1,ge[0]=(1<<_+1)-1,U(ge)}return Q(65497),new Uint8Array(p)},e=e||50,function(){for(var N=String.fromCharCode,L=0;L<256;L++)F[L]=N(L)}(),t=q(P,k),r=q(b,R),a=q(I,A),n=q(W,Y),function(){for(var N=1,L=2,D=1;D<=15;D++){for(var M=N;M<L;M++)g[32767+M]=D,m[32767+M]=[],m[32767+M][1]=D,m[32767+M][0]=M;for(var z=-(L-1);z<=-N;z++)g[32767+z]=D,m[32767+z]=[],m[32767+z][1]=D,m[32767+z][0]=L-1+z;N<<=1,L<<=1}}(),function(){for(var N=0;N<256;N++)B[N]=19595*N,B[N+256>>0]=38470*N,B[N+512>>0]=7471*N+32768,B[N+768>>0]=-11059*N,B[N+1024>>0]=-21709*N,B[N+1280>>0]=32768*N+8421375,B[N+1536>>0]=-27439*N,B[N+1792>>0]=-5329*N}(),ee(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Gn(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zp(e){function t(P){if(!P)throw Error("assert :P")}function r(P,k,I){for(var A=0;4>A;A++)if(P[k+A]!=I.charCodeAt(A))return!0;return!1}function a(P,k,I,A,b){for(var R=0;R<b;R++)P[k+R]=I[A+R]}function n(P,k,I,A){for(var b=0;b<A;b++)P[k+b]=I}function s(P){return new Int32Array(P)}function o(P,k){for(var I=[],A=0;A<P;A++)I.push(new k);return I}function l(P,k){var I=[];return function A(b,R,W){for(var Y=W[R],q=0;q<Y&&(b.push(W.length>R+1?[]:new k),!(W.length<R+1));q++)A(b[q],R+1,W)}(I,0,P),I}var c=function(){var P=this;function k(f,v){for(var j=1<<v-1>>>0;f&j;)j>>>=1;return j?(f&j-1)+j:f}function I(f,v,j,O,V){t(!(O%j));do f[v+(O-=j)]=V;while(0<O)}function A(f,v,j,O,V){if(t(2328>=V),512>=V)var X=s(512);else if((X=s(V))==null)return 0;return function(J,Z,te,oe,we,Ce){var Pe,Se,Ge=Z,Ue=1<<te,be=s(16),_e=s(16);for(t(we!=0),t(oe!=null),t(J!=null),t(0<te),Se=0;Se<we;++Se){if(15<oe[Se])return 0;++be[oe[Se]]}if(be[0]==we)return 0;for(_e[1]=0,Pe=1;15>Pe;++Pe){if(be[Pe]>1<<Pe)return 0;_e[Pe+1]=_e[Pe]+be[Pe]}for(Se=0;Se<we;++Se)Pe=oe[Se],0<oe[Se]&&(Ce[_e[Pe]++]=Se);if(_e[15]==1)return(oe=new b).g=0,oe.value=Ce[0],I(J,Ge,1,Ue,oe),Ue;var ze,et=-1,Ve=Ue-1,yt=0,ft=1,Ct=1,gt=1<<te;for(Se=0,Pe=1,we=2;Pe<=te;++Pe,we<<=1){if(ft+=Ct<<=1,0>(Ct-=be[Pe]))return 0;for(;0<be[Pe];--be[Pe])(oe=new b).g=Pe,oe.value=Ce[Se++],I(J,Ge+yt,we,gt,oe),yt=k(yt,Pe)}for(Pe=te+1,we=2;15>=Pe;++Pe,we<<=1){if(ft+=Ct<<=1,0>(Ct-=be[Pe]))return 0;for(;0<be[Pe];--be[Pe]){if(oe=new b,(yt&Ve)!=et){for(Ge+=gt,ze=1<<(et=Pe)-te;15>et&&!(0>=(ze-=be[et]));)++et,ze<<=1;Ue+=gt=1<<(ze=et-te),J[Z+(et=yt&Ve)].g=ze+te,J[Z+et].value=Ge-Z-et}oe.g=Pe-te,oe.value=Ce[Se++],I(J,Ge+(yt>>te),we,gt,oe),yt=k(yt,Pe)}}return ft!=2*_e[15]-1?0:Ue}(f,v,j,O,V,X)}function b(){this.value=this.g=0}function R(){this.value=this.g=0}function W(){this.G=o(5,b),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ga,R)}function Y(f,v,j,O){t(f!=null),t(v!=null),t(2147483648>O),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=v,f.pa=j,f.Jd=v,f.Yc=j+O,f.Zc=4<=O?j+O-4+1:j,ue(f)}function q(f,v){for(var j=0;0<v--;)j|=me(f,128)<<v;return j}function U(f,v){var j=q(f,v);return pe(f)?-j:j}function H(f,v,j,O){var V,X=0;for(t(f!=null),t(v!=null),t(4294967288>O),f.Sb=O,f.Ra=0,f.u=0,f.h=0,4<O&&(O=4),V=0;V<O;++V)X+=v[j+V]<<8*V;f.Ra=X,f.bb=O,f.oa=v,f.pa=j}function Q(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<vo-8>>>0,++f.bb,f.u-=8;D(f)&&(f.h=1,f.u=0)}function ne(f,v){if(t(0<=v),!f.h&&v<=go){var j=L(f)&xo[v];return f.u+=v,Q(f),j}return f.h=1,f.u=0}function ee(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function N(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L(f){return f.Ra>>>(f.u&vo-1)>>>0}function D(f){return t(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>vo}function M(f,v){f.u=v,f.h=D(f)}function z(f){f.u>=Al&&(t(f.u>=Al),Q(f))}function ue(f){t(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(t(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function pe(f){return q(f,1)}function me(f,v){var j=f.Ca;0>f.b&&ue(f);var O=f.b,V=j*v>>>8,X=(f.I>>>O>V)+0;for(X?(j-=V,f.I-=V+1<<O>>>0):j=V+1,O=j,V=0;256<=O;)V+=8,O>>=8;return O=7^V+Za[O],f.b-=O,f.Ca=(j<<O)-1,X}function Ne(f,v,j){f[v+0]=j>>24&255,f[v+1]=j>>16&255,f[v+2]=j>>8&255,f[v+3]=j>>0&255}function Oe(f,v){return f[v+0]<<0|f[v+1]<<8}function Ie(f,v){return Oe(f,v)|f[v+2]<<16}function Ze(f,v){return Oe(f,v)|Oe(f,v+2)<<16}function st(f,v){var j=1<<v;return t(f!=null),t(0<v),f.X=s(j),f.X==null?0:(f.Mb=32-v,f.Xa=v,1)}function Fe(f,v){t(f!=null),t(v!=null),t(f.Xa==v.Xa),a(v.X,0,f.X,0,1<<v.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function Xe(f,v,j,O){t(j!=null),t(O!=null);var V=j[0],X=O[0];return V==0&&(V=(f*X+v/2)/v),X==0&&(X=(v*V+f/2)/f),0>=V||0>=X?0:(j[0]=V,O[0]=X,1)}function xt(f,v){return f+(1<<v)-1>>>v}function $e(f,v){return((4278255360&f)+(4278255360&v)>>>0&4278255360)+((16711935&f)+(16711935&v)>>>0&16711935)>>>0}function ie(f,v){P[v]=function(j,O,V,X,J,Z,te){var oe;for(oe=0;oe<J;++oe){var we=P[f](Z[te+oe-1],V,X+oe);Z[te+oe]=$e(j[O+oe],we)}}}function ge(){this.ud=this.hd=this.jd=0}function ye(f,v){return((4278124286&(f^v))>>>1)+(f&v)>>>0}function qe(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function De(f,v){return qe(f+(f-v+.5>>1))}function Re(f,v,j){return Math.abs(v-j)-Math.abs(f-j)}function Je(f,v,j,O,V,X,J){for(O=X[J-1],j=0;j<V;++j)X[J+j]=O=$e(f[v+j],O)}function mt(f,v,j,O,V){var X;for(X=0;X<j;++X){var J=f[v+X],Z=J>>8&255,te=16711935&(te=(te=16711935&J)+((Z<<16)+Z));O[V+X]=(4278255360&J)+te>>>0}}function wt(f,v){v.jd=f>>0&255,v.hd=f>>8&255,v.ud=f>>16&255}function bt(f,v,j,O,V,X){var J;for(J=0;J<O;++J){var Z=v[j+J],te=Z>>>8,oe=Z,we=255&(we=(we=Z>>>16)+((f.jd<<24>>24)*(te<<24>>24)>>>5));oe=255&(oe=(oe=oe+((f.hd<<24>>24)*(te<<24>>24)>>>5))+((f.ud<<24>>24)*(we<<24>>24)>>>5)),V[X+J]=(4278255360&Z)+(we<<16)+oe}}function kt(f,v,j,O,V){P[v]=function(X,J,Z,te,oe,we,Ce,Pe,Se){for(te=Ce;te<Pe;++te)for(Ce=0;Ce<Se;++Ce)oe[we++]=V(Z[O(X[J++])])},P[f]=function(X,J,Z,te,oe,we,Ce){var Pe=8>>X.b,Se=X.Ea,Ge=X.K[0],Ue=X.w;if(8>Pe)for(X=(1<<X.b)-1,Ue=(1<<Pe)-1;J<Z;++J){var be,_e=0;for(be=0;be<Se;++be)be&X||(_e=O(te[oe++])),we[Ce++]=V(Ge[_e&Ue]),_e>>=Pe}else P["VP8LMapColor"+j](te,oe,Ge,Ue,we,Ce,J,Z,Se)}}function ot(f,v,j,O,V){for(j=v+j;v<j;){var X=f[v++];O[V++]=X>>16&255,O[V++]=X>>8&255,O[V++]=X>>0&255}}function Ar(f,v,j,O,V){for(j=v+j;v<j;){var X=f[v++];O[V++]=X>>16&255,O[V++]=X>>8&255,O[V++]=X>>0&255,O[V++]=X>>24&255}}function Ut(f,v,j,O,V){for(j=v+j;v<j;){var X=(J=f[v++])>>16&240|J>>12&15,J=J>>0&240|J>>28&15;O[V++]=X,O[V++]=J}}function Rr(f,v,j,O,V){for(j=v+j;v<j;){var X=(J=f[v++])>>16&248|J>>13&7,J=J>>5&224|J>>3&31;O[V++]=X,O[V++]=J}}function zt(f,v,j,O,V){for(j=v+j;v<j;){var X=f[v++];O[V++]=X>>0&255,O[V++]=X>>8&255,O[V++]=X>>16&255}}function Yt(f,v,j,O,V,X){if(X==0)for(j=v+j;v<j;)Ne(O,((X=f[v++])[0]>>24|X[1]>>8&65280|X[2]<<8&16711680|X[3]<<24)>>>0),V+=32;else a(O,V,f,v,j)}function Vr(f,v){P[v][0]=P[f+"0"],P[v][1]=P[f+"1"],P[v][2]=P[f+"2"],P[v][3]=P[f+"3"],P[v][4]=P[f+"4"],P[v][5]=P[f+"5"],P[v][6]=P[f+"6"],P[v][7]=P[f+"7"],P[v][8]=P[f+"8"],P[v][9]=P[f+"9"],P[v][10]=P[f+"10"],P[v][11]=P[f+"11"],P[v][12]=P[f+"12"],P[v][13]=P[f+"13"],P[v][14]=P[f+"0"],P[v][15]=P[f+"0"]}function Ot(f){return f==hd||f==md||f==iu||f==pd}function Ka(){this.eb=[],this.size=this.A=this.fb=0}function nr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ma(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ka,this.f.kb=new nr,this.sd=null}function sr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Vt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pt(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function $t(f,v){var j=f.T,O=v.ba.f.RGBA,V=O.eb,X=O.fb+f.ka*O.A,J=Fn[v.ba.S],Z=f.y,te=f.O,oe=f.f,we=f.N,Ce=f.ea,Pe=f.W,Se=v.cc,Ge=v.dc,Ue=v.Mc,be=v.Nc,_e=f.ka,ze=f.ka+f.T,et=f.U,Ve=et+1>>1;for(_e==0?J(Z,te,null,null,oe,we,Ce,Pe,oe,we,Ce,Pe,V,X,null,null,et):(J(v.ec,v.fc,Z,te,Se,Ge,Ue,be,oe,we,Ce,Pe,V,X-O.A,V,X,et),++j);_e+2<ze;_e+=2)Se=oe,Ge=we,Ue=Ce,be=Pe,we+=f.Rc,Pe+=f.Rc,X+=2*O.A,J(Z,(te+=2*f.fa)-f.fa,Z,te,Se,Ge,Ue,be,oe,we,Ce,Pe,V,X-O.A,V,X,et);return te+=f.fa,f.j+ze<f.o?(a(v.ec,v.fc,Z,te,et),a(v.cc,v.dc,oe,we,Ve),a(v.Mc,v.Nc,Ce,Pe,Ve),j--):1&ze||J(Z,te,null,null,oe,we,Ce,Pe,oe,we,Ce,Pe,V,X+O.A,null,null,et),j}function Aa(f,v,j){var O=f.F,V=[f.J];if(O!=null){var X=f.U,J=v.ba.S,Z=J==su||J==iu;v=v.ba.f.RGBA;var te=[0],oe=f.ka;te[0]=f.T,f.Kb&&(oe==0?--te[0]:(--oe,V[0]-=f.width),f.j+f.ka+f.T==f.o&&(te[0]=f.o-f.j-oe));var we=v.eb;oe=v.fb+oe*v.A,f=wr(O,V[0],f.width,X,te,we,oe+(Z?0:3),v.A),t(j==te),f&&Ot(J)&&Pn(we,oe,Z,X,te,v.A)}return 0}function Mr(f){var v=f.ma,j=v.ba.S,O=11>j,V=j==au||j==nu||j==su||j==fd||j==12||Ot(j);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!_l(v.Oa,f,V?11:12))return 0;if(V&&Ot(j)&&rt(),f.da)alert("todo:use_scaling");else{if(O){if(v.Ib=Pt,f.Kb){if(j=f.U+1>>1,v.memory=s(f.U+2*j),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+f.U,v.Mc=v.cc,v.Nc=v.dc+j,v.Ib=$t,rt()}}else alert("todo:EmitYUV");V&&(v.Jb=Aa,O&&je())}if(O&&!kh){for(f=0;256>f;++f)w2[f]=89858*(f-128)+lu>>ou,_2[f]=-22014*(f-128)+lu,N2[f]=-45773*(f-128),b2[f]=113618*(f-128)+lu>>ou;for(f=Fl;f<vd;++f)v=76283*(f-16)+lu>>ou,S2[f-Fl]=pn(v,255),A2[f-Fl]=pn(v+8>>4,15);kh=1}return 1}function Ua(f){var v=f.ma,j=f.U,O=f.T;return t(!(1&f.ka)),0>=j||0>=O?0:(j=v.Ib(f,v),v.Jb!=null&&v.Jb(f,v,j),v.Dc+=j,1)}function ja(f){f.ma.memory=null}function _t(f,v,j,O){return ne(f,8)!=47?0:(v[0]=ne(f,14)+1,j[0]=ne(f,14)+1,O[0]=ne(f,1),ne(f,3)!=0?0:!f.h)}function Ea(f,v){if(4>f)return f+1;var j=f-2>>1;return(2+(1&f)<<j)+ne(v,j)+1}function pa(f,v){return 120<v?v-120:1<=(j=((j=i2[v-1])>>4)*f+(8-(15&j)))?j:1;var j}function gr(f,v,j){var O=L(j),V=f[v+=255&O].g-8;return 0<V&&(M(j,j.u+8),O=L(j),v+=f[v].value,v+=O&(1<<V)-1),M(j,j.u+f[v].g),f[v].value}function Kt(f,v,j){return j.g+=f.g,j.value+=f.value<<v>>>0,t(8>=j.g),f.g}function Nr(f,v,j){var O=f.xc;return t((v=O==0?0:f.vc[f.md*(j>>O)+(v>>O)])<f.Wb),f.Ya[v]}function K(f,v,j,O){var V=f.ab,X=f.c*v,J=f.C;v=J+v;var Z=j,te=O;for(O=f.Ta,j=f.Ua;0<V--;){var oe=f.gc[V],we=J,Ce=v,Pe=Z,Se=te,Ge=(te=O,Z=j,oe.Ea);switch(t(we<Ce),t(Ce<=oe.nc),oe.hc){case 2:Kc(Pe,Se,(Ce-we)*Ge,te,Z);break;case 0:var Ue=we,be=Ce,_e=te,ze=Z,et=(gt=oe).Ea;Ue==0&&(ud(Pe,Se,null,null,1,_e,ze),Je(Pe,Se+1,0,0,et-1,_e,ze+1),Se+=et,ze+=et,++Ue);for(var Ve=1<<gt.b,yt=Ve-1,ft=xt(et,gt.b),Ct=gt.K,gt=gt.w+(Ue>>gt.b)*ft;Ue<be;){var tr=Ct,ir=gt,Qt=1;for(jl(Pe,Se,_e,ze-et,1,_e,ze);Qt<et;){var Gt=(Qt&~yt)+Ve;Gt>et&&(Gt=et),(0,Hs[tr[ir++]>>8&15])(Pe,Se+ +Qt,_e,ze+Qt-et,Gt-Qt,_e,ze+Qt),Qt=Gt}Se+=et,ze+=et,++Ue&yt||(gt+=ft)}Ce!=oe.nc&&a(te,Z-Ge,te,Z+(Ce-we-1)*Ge,Ge);break;case 1:for(Ge=Pe,be=Se,et=(Pe=oe.Ea)-(ze=Pe&~(_e=(Se=1<<oe.b)-1)),Ue=xt(Pe,oe.b),Ve=oe.K,oe=oe.w+(we>>oe.b)*Ue;we<Ce;){for(yt=Ve,ft=oe,Ct=new ge,gt=be+ze,tr=be+Pe;be<gt;)wt(yt[ft++],Ct),Ei(Ct,Ge,be,Se,te,Z),be+=Se,Z+=Se;be<tr&&(wt(yt[ft++],Ct),Ei(Ct,Ge,be,et,te,Z),be+=et,Z+=et),++we&_e||(oe+=Ue)}break;case 3:if(Pe==te&&Se==Z&&0<oe.b){for(be=te,Pe=Ge=Z+(Ce-we)*Ge-(ze=(Ce-we)*xt(oe.Ea,oe.b)),Se=te,_e=Z,Ue=[],ze=(et=ze)-1;0<=ze;--ze)Ue[ze]=Se[_e+ze];for(ze=et-1;0<=ze;--ze)be[Pe+ze]=Ue[ze];En(oe,we,Ce,te,Ge,te,Z)}else En(oe,we,Ce,Pe,Se,te,Z)}Z=O,te=j}te!=j&&a(O,j,Z,te,X)}function fe(f,v){var j=f.V,O=f.Ba+f.c*f.C,V=v-f.C;if(t(v<=f.l.o),t(16>=V),0<V){var X=f.l,J=f.Ta,Z=f.Ua,te=X.width;if(K(f,V,j,O),V=Z=[Z],t((j=f.C)<(O=v)),t(X.v<X.va),O>X.o&&(O=X.o),j<X.j){var oe=X.j-j;j=X.j,V[0]+=oe*te}if(j>=O?j=0:(V[0]+=4*X.v,X.ka=j-X.j,X.U=X.va-X.v,X.T=O-j,j=1),j){if(Z=Z[0],11>(j=f.ca).S){var we=j.f.RGBA,Ce=(O=j.S,V=X.U,X=X.T,oe=we.eb,we.A),Pe=X;for(we=we.fb+f.Ma*we.A;0<Pe--;){var Se=J,Ge=Z,Ue=V,be=oe,_e=we;switch(O){case ru:en(Se,Ge,Ue,be,_e);break;case au:qa(Se,Ge,Ue,be,_e);break;case hd:qa(Se,Ge,Ue,be,_e),Pn(be,_e,0,Ue,1,0);break;case _h:Ss(Se,Ge,Ue,be,_e);break;case nu:Yt(Se,Ge,Ue,be,_e,1);break;case md:Yt(Se,Ge,Ue,be,_e,1),Pn(be,_e,0,Ue,1,0);break;case su:Yt(Se,Ge,Ue,be,_e,0);break;case iu:Yt(Se,Ge,Ue,be,_e,0),Pn(be,_e,1,Ue,1,0);break;case fd:$s(Se,Ge,Ue,be,_e);break;case pd:$s(Se,Ge,Ue,be,_e),yr(be,_e,Ue,1,0);break;case Sh:_s(Se,Ge,Ue,be,_e);break;default:t(0)}Z+=te,we+=Ce}f.Ma+=X}else alert("todo:EmitRescaledRowsYUVA");t(f.Ma<=j.height)}}f.C=v,t(f.C<=f.i)}function ae(f){var v;if(0<f.ua)return 0;for(v=0;v<f.Wb;++v){var j=f.Ya[v].G,O=f.Ya[v].H;if(0<j[1][O[1]+0].g||0<j[2][O[2]+0].g||0<j[3][O[3]+0].g)return 0}return 1}function re(f,v,j,O,V,X){if(f.Z!=0){var J=f.qd,Z=f.rd;for(t(Ys[f.Z]!=null);v<j;++v)Ys[f.Z](J,Z,O,V,O,V,X),J=O,Z=V,V+=X;f.qd=J,f.rd=Z}}function ce(f,v){var j=f.l.ma,O=j.Z==0||j.Z==1?f.l.j:f.C;if(O=f.C<O?O:f.C,t(v<=f.l.o),v>O){var V=f.l.width,X=j.ca,J=j.tb+V*O,Z=f.V,te=f.Ba+f.c*O,oe=f.gc;t(f.ab==1),t(oe[0].hc==3),Jc(oe[0],O,v,Z,te,X,J),re(j,O,v,X,J,V)}f.C=f.Ma=v}function de(f,v,j,O,V,X,J){var Z=f.$/O,te=f.$%O,oe=f.m,we=f.s,Ce=j+f.$,Pe=Ce;V=j+O*V;var Se=j+O*X,Ge=280+we.ua,Ue=f.Pb?Z:16777216,be=0<we.ua?we.Wa:null,_e=we.wc,ze=Ce<Se?Nr(we,te,Z):null;t(f.C<X),t(Se<=V);var et=!1;e:for(;;){for(;et||Ce<Se;){var Ve=0;if(Z>=Ue){var yt=Ce-j;t((Ue=f).Pb),Ue.wd=Ue.m,Ue.xd=yt,0<Ue.s.ua&&Fe(Ue.s.Wa,Ue.s.vb),Ue=Z+l2}if(te&_e||(ze=Nr(we,te,Z)),t(ze!=null),ze.Qb&&(v[Ce]=ze.qb,et=!0),!et)if(z(oe),ze.jc){Ve=oe,yt=v;var ft=Ce,Ct=ze.pd[L(Ve)&ga-1];t(ze.jc),256>Ct.g?(M(Ve,Ve.u+Ct.g),yt[ft]=Ct.value,Ve=0):(M(Ve,Ve.u+Ct.g-256),t(256<=Ct.value),Ve=Ct.value),Ve==0&&(et=!0)}else Ve=gr(ze.G[0],ze.H[0],oe);if(oe.h)break;if(et||256>Ve){if(!et)if(ze.nd)v[Ce]=(ze.qb|Ve<<8)>>>0;else{if(z(oe),et=gr(ze.G[1],ze.H[1],oe),z(oe),yt=gr(ze.G[2],ze.H[2],oe),ft=gr(ze.G[3],ze.H[3],oe),oe.h)break;v[Ce]=(ft<<24|et<<16|Ve<<8|yt)>>>0}if(et=!1,++Ce,++te>=O&&(te=0,++Z,J!=null&&Z<=X&&!(Z%16)&&J(f,Z),be!=null))for(;Pe<Ce;)Ve=v[Pe++],be.X[(506832829*Ve&4294967295)>>>be.Mb]=Ve}else if(280>Ve){if(Ve=Ea(Ve-256,oe),yt=gr(ze.G[4],ze.H[4],oe),z(oe),yt=pa(O,yt=Ea(yt,oe)),oe.h)break;if(Ce-j<yt||V-Ce<Ve)break e;for(ft=0;ft<Ve;++ft)v[Ce+ft]=v[Ce+ft-yt];for(Ce+=Ve,te+=Ve;te>=O;)te-=O,++Z,J!=null&&Z<=X&&!(Z%16)&&J(f,Z);if(t(Ce<=V),te&_e&&(ze=Nr(we,te,Z)),be!=null)for(;Pe<Ce;)Ve=v[Pe++],be.X[(506832829*Ve&4294967295)>>>be.Mb]=Ve}else{if(!(Ve<Ge))break e;for(et=Ve-280,t(be!=null);Pe<Ce;)Ve=v[Pe++],be.X[(506832829*Ve&4294967295)>>>be.Mb]=Ve;Ve=Ce,t(!(et>>>(yt=be).Xa)),v[Ve]=yt.X[et],et=!0}et||t(oe.h==D(oe))}if(f.Pb&&oe.h&&Ce<V)t(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&Fe(f.s.vb,f.s.Wa);else{if(oe.h)break e;J!=null&&J(f,Z>X?X:Z),f.a=0,f.$=Ce-j}return 1}return f.a=3,0}function Ae(f){t(f!=null),f.vc=null,f.yc=null,f.Ya=null;var v=f.Wa;v!=null&&(v.X=null),f.vb=null,t(f!=null)}function Me(){var f=new cd;return f==null?null:(f.a=0,f.xb=Eh,Vr("Predictor","VP8LPredictors"),Vr("Predictor","VP8LPredictors_C"),Vr("PredictorAdd","VP8LPredictorsAdd"),Vr("PredictorAdd","VP8LPredictorsAdd_C"),Kc=mt,Ei=bt,en=ot,qa=Ar,$s=Ut,_s=Rr,Ss=zt,P.VP8LMapColor32b=yo,P.VP8LMapColor8b=Qc,f)}function Ee(f,v,j,O,V){var X=1,J=[f],Z=[v],te=O.m,oe=O.s,we=null,Ce=0;e:for(;;){if(j)for(;X&&ne(te,1);){var Pe=J,Se=Z,Ge=O,Ue=1,be=Ge.m,_e=Ge.gc[Ge.ab],ze=ne(be,2);if(Ge.Oc&1<<ze)X=0;else{switch(Ge.Oc|=1<<ze,_e.hc=ze,_e.Ea=Pe[0],_e.nc=Se[0],_e.K=[null],++Ge.ab,t(4>=Ge.ab),ze){case 0:case 1:_e.b=ne(be,3)+2,Ue=Ee(xt(_e.Ea,_e.b),xt(_e.nc,_e.b),0,Ge,_e.K),_e.K=_e.K[0];break;case 3:var et,Ve=ne(be,8)+1,yt=16<Ve?0:4<Ve?1:2<Ve?2:3;if(Pe[0]=xt(_e.Ea,yt),_e.b=yt,et=Ue=Ee(Ve,1,0,Ge,_e.K)){var ft,Ct=Ve,gt=_e,tr=1<<(8>>gt.b),ir=s(tr);if(ir==null)et=0;else{var Qt=gt.K[0],Gt=gt.w;for(ir[0]=gt.K[0][0],ft=1;ft<1*Ct;++ft)ir[ft]=$e(Qt[Gt+ft],ir[ft-1]);for(;ft<4*tr;++ft)ir[ft]=0;gt.K[0]=null,gt.K[0]=ir,et=1}}Ue=et;break;case 2:break;default:t(0)}X=Ue}}if(J=J[0],Z=Z[0],X&&ne(te,1)&&!(X=1<=(Ce=ne(te,4))&&11>=Ce)){O.a=3;break e}var pr;if(pr=X)t:{var hr,qt,Yr,tn=O,Xr=J,rn=Z,or=Ce,gn=j,vn=tn.m,oa=tn.s,va=[null],Ha=1,kn=0,cs=o2[or];r:for(;;){if(gn&&ne(vn,1)){var la=ne(vn,3)+2,Ts=xt(Xr,la),Fi=xt(rn,la),So=Ts*Fi;if(!Ee(Ts,Fi,0,tn,va))break r;for(va=va[0],oa.xc=la,hr=0;hr<So;++hr){var Xs=va[hr]>>8&65535;va[hr]=Xs,Xs>=Ha&&(Ha=Xs+1)}}if(vn.h)break r;for(qt=0;5>qt;++qt){var kr=Ah[qt];!qt&&0<or&&(kr+=1<<or),kn<kr&&(kn=kr)}var yd=o(Ha*cs,b),Ih=Ha,Rh=o(Ih,W);if(Rh==null)var uu=null;else t(65536>=Ih),uu=Rh;var kl=s(kn);if(uu==null||kl==null||yd==null){tn.a=1;break r}var du=yd;for(hr=Yr=0;hr<Ha;++hr){var Hn=uu[hr],Ao=Hn.G,jo=Hn.H,Mh=0,fu=1,Bh=0;for(qt=0;5>qt;++qt){kr=Ah[qt],Ao[qt]=du,jo[qt]=Yr,!qt&&0<or&&(kr+=1<<or);n:{var hu,wd=kr,mu=tn,Dl=kl,T2=du,C2=Yr,bd=0,Ks=mu.m,P2=ne(Ks,1);if(n(Dl,0,0,wd),P2){var L2=ne(Ks,1)+1,F2=ne(Ks,1),Uh=ne(Ks,F2==0?1:8);Dl[Uh]=1,L2==2&&(Dl[Uh=ne(Ks,8)]=1);var pu=1}else{var qh=s(19),Wh=ne(Ks,4)+4;if(19<Wh){mu.a=3;var xu=0;break n}for(hu=0;hu<Wh;++hu)qh[s2[hu]]=ne(Ks,3);var Nd=void 0,Ol=void 0,Hh=mu,k2=qh,gu=wd,$h=Dl,_d=0,Js=Hh.m,zh=8,Vh=o(128,b);a:for(;A(Vh,0,7,k2,19);){if(ne(Js,1)){var D2=2+2*ne(Js,3);if((Nd=2+ne(Js,D2))>gu)break a}else Nd=gu;for(Ol=0;Ol<gu&&Nd--;){z(Js);var Gh=Vh[0+(127&L(Js))];M(Js,Js.u+Gh.g);var Eo=Gh.value;if(16>Eo)$h[Ol++]=Eo,Eo!=0&&(zh=Eo);else{var O2=Eo==16,Yh=Eo-16,I2=a2[Yh],Xh=ne(Js,r2[Yh])+I2;if(Ol+Xh>gu)break a;for(var R2=O2?zh:0;0<Xh--;)$h[Ol++]=R2}}_d=1;break a}_d||(Hh.a=3),pu=_d}(pu=pu&&!Ks.h)&&(bd=A(T2,C2,8,Dl,wd)),pu&&bd!=0?xu=bd:(mu.a=3,xu=0)}if(xu==0)break r;if(fu&&n2[qt]==1&&(fu=du[Yr].g==0),Mh+=du[Yr].g,Yr+=xu,3>=qt){var Il,Sd=kl[0];for(Il=1;Il<kr;++Il)kl[Il]>Sd&&(Sd=kl[Il]);Bh+=Sd}}if(Hn.nd=fu,Hn.Qb=0,fu&&(Hn.qb=(Ao[3][jo[3]+0].value<<24|Ao[1][jo[1]+0].value<<16|Ao[2][jo[2]+0].value)>>>0,Mh==0&&256>Ao[0][jo[0]+0].value&&(Hn.Qb=1,Hn.qb+=Ao[0][jo[0]+0].value<<8)),Hn.jc=!Hn.Qb&&6>Bh,Hn.jc){var vu,Cs=Hn;for(vu=0;vu<ga;++vu){var Qs=vu,Zs=Cs.pd[Qs],yu=Cs.G[0][Cs.H[0]+Qs];256<=yu.value?(Zs.g=yu.g+256,Zs.value=yu.value):(Zs.g=0,Zs.value=0,Qs>>=Kt(yu,8,Zs),Qs>>=Kt(Cs.G[1][Cs.H[1]+Qs],16,Zs),Qs>>=Kt(Cs.G[2][Cs.H[2]+Qs],0,Zs),Kt(Cs.G[3][Cs.H[3]+Qs],24,Zs))}}}oa.vc=va,oa.Wb=Ha,oa.Ya=uu,oa.yc=yd,pr=1;break t}pr=0}if(!(X=pr)){O.a=3;break e}if(0<Ce){if(oe.ua=1<<Ce,!st(oe.Wa,Ce)){O.a=1,X=0;break e}}else oe.ua=0;var Ad=O,Kh=J,M2=Z,jd=Ad.s,Ed=jd.xc;if(Ad.c=Kh,Ad.i=M2,jd.md=xt(Kh,Ed),jd.wc=Ed==0?-1:(1<<Ed)-1,j){O.xb=p2;break e}if((we=s(J*Z))==null){O.a=1,X=0;break e}X=(X=de(O,we,0,J,Z,Z,null))&&!te.h;break e}return X?(V!=null?V[0]=we:(t(we==null),t(j)),O.$=0,j||Ae(oe)):Ae(oe),X}function Te(f,v){var j=f.c*f.i,O=j+v+16*v;return t(f.c<=v),f.V=s(O),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+j+v,1)}function Le(f,v){var j=f.C,O=v-j,V=f.V,X=f.Ba+f.c*j;for(t(v<=f.l.o);0<O;){var J=16<O?16:O,Z=f.l.ma,te=f.l.width,oe=te*J,we=Z.ca,Ce=Z.tb+te*j,Pe=f.Ta,Se=f.Ua;K(f,J,V,X),Ur(Pe,Se,we,Ce,oe),re(Z,j,j+J,we,Ce,te),O-=J,V+=J*f.c,j+=J}t(j==v),f.C=f.Ma=v}function tt(){this.ub=this.yd=this.td=this.Rb=0}function it(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function pt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function at(){this.Yb=function(){var f=[];return function v(j,O,V){for(var X=V[O],J=0;J<X&&(j.push(V.length>O+1?[]:0),!(V.length<O+1));J++)v(j[J],O+1,V)}(f,0,[3,11]),f}()}function ht(){this.jb=s(3),this.Wc=l([4,8],at),this.Xc=l([4,17],at)}function Lt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Jt(){this.ld=this.La=this.dd=this.tc=0}function er(){this.Na=this.la=0}function Tr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ja(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function he(){this.uc=this.M=this.Nb=0,this.wa=Array(new Jt),this.Y=0,this.ya=Array(new Ja),this.aa=0,this.l=new St}function ke(){this.y=s(16),this.f=s(8),this.ea=s(8)}function nt(){this.cb=this.a=0,this.sc="",this.m=new ee,this.Od=new tt,this.Kc=new it,this.ed=new Lt,this.Qa=new pt,this.Ic=this.$c=this.Aa=0,this.D=new he,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ee),this.ia=0,this.pb=o(4,Tr),this.Pa=new ht,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ke),this.Hd=0,this.rb=Array(new er),this.sb=0,this.wa=Array(new Jt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ja),this.L=this.aa=0,this.gd=l([4,2],Jt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function St(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ke(){var f=new nt;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Ll||(Ll=xa)),f}function dt(f,v,j){return f.a==0&&(f.a=v,f.sc=j,f.cb=0),0}function Dt(f,v,j){return 3<=j&&f[v+0]==157&&f[v+1]==1&&f[v+2]==42}function vr(f,v){if(f==null)return 0;if(f.a=0,f.sc="OK",v==null)return dt(f,2,"null VP8Io passed to VP8GetHeaders()");var j=v.data,O=v.w,V=v.ha;if(4>V)return dt(f,7,"Truncated header.");var X=j[O+0]|j[O+1]<<8|j[O+2]<<16,J=f.Od;if(J.Rb=!(1&X),J.td=X>>1&7,J.yd=X>>4&1,J.ub=X>>5,3<J.td)return dt(f,3,"Incorrect keyframe parameters.");if(!J.yd)return dt(f,4,"Frame not displayable.");O+=3,V-=3;var Z=f.Kc;if(J.Rb){if(7>V)return dt(f,7,"cannot parse picture header");if(!Dt(j,O,V))return dt(f,3,"Bad code word");Z.c=16383&(j[O+4]<<8|j[O+3]),Z.Td=j[O+4]>>6,Z.i=16383&(j[O+6]<<8|j[O+5]),Z.Ud=j[O+6]>>6,O+=7,V-=7,f.za=Z.c+15>>4,f.Ub=Z.i+15>>4,v.width=Z.c,v.height=Z.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,n((X=f.Pa).jb,0,255,X.jb.length),t((X=f.Qa)!=null),X.Cb=0,X.Bb=0,X.Fb=1,n(X.Zb,0,0,X.Zb.length),n(X.Lb,0,0,X.Lb)}if(J.ub>V)return dt(f,7,"bad partition length");Y(X=f.m,j,O,J.ub),O+=J.ub,V-=J.ub,J.Rb&&(Z.Ld=pe(X),Z.Kd=pe(X)),Z=f.Qa;var te,oe=f.Pa;if(t(X!=null),t(Z!=null),Z.Cb=pe(X),Z.Cb){if(Z.Bb=pe(X),pe(X)){for(Z.Fb=pe(X),te=0;4>te;++te)Z.Zb[te]=pe(X)?U(X,7):0;for(te=0;4>te;++te)Z.Lb[te]=pe(X)?U(X,6):0}if(Z.Bb)for(te=0;3>te;++te)oe.jb[te]=pe(X)?q(X,8):255}else Z.Bb=0;if(X.Ka)return dt(f,3,"cannot parse segment header");if((Z=f.ed).zd=pe(X),Z.Tb=q(X,6),Z.wb=q(X,3),Z.Pc=pe(X),Z.Pc&&pe(X)){for(oe=0;4>oe;++oe)pe(X)&&(Z.vd[oe]=U(X,6));for(oe=0;4>oe;++oe)pe(X)&&(Z.od[oe]=U(X,6))}if(f.L=Z.Tb==0?0:Z.zd?1:2,X.Ka)return dt(f,3,"cannot parse filter header");var we=V;if(V=te=O,O=te+we,Z=we,f.Xb=(1<<q(f.m,2))-1,we<3*(oe=f.Xb))j=7;else{for(te+=3*oe,Z-=3*oe,we=0;we<oe;++we){var Ce=j[V+0]|j[V+1]<<8|j[V+2]<<16;Ce>Z&&(Ce=Z),Y(f.Jc[+we],j,te,Ce),te+=Ce,Z-=Ce,V+=3}Y(f.Jc[+oe],j,te,Z),j=te<O?0:5}if(j!=0)return dt(f,j,"cannot parse partitions");for(j=q(te=f.m,7),V=pe(te)?U(te,4):0,O=pe(te)?U(te,4):0,Z=pe(te)?U(te,4):0,oe=pe(te)?U(te,4):0,te=pe(te)?U(te,4):0,we=f.Qa,Ce=0;4>Ce;++Ce){if(we.Cb){var Pe=we.Zb[Ce];we.Fb||(Pe+=j)}else{if(0<Ce){f.pb[Ce]=f.pb[0];continue}Pe=j}var Se=f.pb[Ce];Se.Sc[0]=xd[pn(Pe+V,127)],Se.Sc[1]=gd[pn(Pe+0,127)],Se.Eb[0]=2*xd[pn(Pe+O,127)],Se.Eb[1]=101581*gd[pn(Pe+Z,127)]>>16,8>Se.Eb[1]&&(Se.Eb[1]=8),Se.Qc[0]=xd[pn(Pe+oe,117)],Se.Qc[1]=gd[pn(Pe+te,127)],Se.lc=Pe+te}if(!J.Rb)return dt(f,4,"Not a key frame.");for(pe(X),J=f.Pa,j=0;4>j;++j){for(V=0;8>V;++V)for(O=0;3>O;++O)for(Z=0;11>Z;++Z)oe=me(X,h2[j][V][O][Z])?q(X,8):d2[j][V][O][Z],J.Wc[j][V].Yb[O][Z]=oe;for(V=0;17>V;++V)J.Xc[j][V]=J.Wc[j][m2[V]]}return f.kc=pe(X),f.kc&&(f.Bd=q(X,8)),f.cb=1}function xa(f,v,j,O,V,X,J){var Z=v[V].Yb[j];for(j=0;16>V;++V){if(!me(f,Z[j+0]))return V;for(;!me(f,Z[j+1]);)if(Z=v[++V].Yb[0],j=0,V==16)return 16;var te=v[V+1].Yb;if(me(f,Z[j+2])){var oe=f,we=0;if(me(oe,(Pe=Z)[(Ce=j)+3]))if(me(oe,Pe[Ce+6])){for(Z=0,Ce=2*(we=me(oe,Pe[Ce+8]))+(Pe=me(oe,Pe[Ce+9+we])),we=0,Pe=c2[Ce];Pe[Z];++Z)we+=we+me(oe,Pe[Z]);we+=3+(8<<Ce)}else me(oe,Pe[Ce+7])?(we=7+2*me(oe,165),we+=me(oe,145)):we=5+me(oe,159);else we=me(oe,Pe[Ce+4])?3+me(oe,Pe[Ce+5]):2;Z=te[2]}else we=1,Z=te[1];te=J+u2[V],0>(oe=f).b&&ue(oe);var Ce,Pe=oe.b,Se=(Ce=oe.Ca>>1)-(oe.I>>Pe)>>31;--oe.b,oe.Ca+=Se,oe.Ca|=1,oe.I-=(Ce+1&Se)<<Pe,X[te]=((we^Se)-Se)*O[(0<V)+0]}return 16}function mn(f){var v=f.rb[f.sb-1];v.la=0,v.Na=0,n(f.zc,0,0,f.zc.length),f.ja=0}function V0(f,v){if(f==null)return 0;if(v==null)return dt(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!vr(f,v))return 0;if(t(f.cb),v.ac==null||v.ac(v)){v.ob&&(f.L=0);var j=cu[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=v.v-j>>4,f.zb=v.j-j>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=v.o+15+j>>4,f.Hb=v.va+15+j>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var O=f.ed;for(j=0;4>j;++j){var V;if(f.Qa.Cb){var X=f.Qa.Lb[j];f.Qa.Fb||(X+=O.Tb)}else X=O.Tb;for(V=0;1>=V;++V){var J=f.gd[j][V],Z=X;if(O.Pc&&(Z+=O.vd[0],V&&(Z+=O.od[0])),0<(Z=0>Z?0:63<Z?63:Z)){var te=Z;0<O.wb&&(te=4<O.wb?te>>2:te>>1)>9-O.wb&&(te=9-O.wb),1>te&&(te=1),J.dd=te,J.tc=2*Z+te,J.ld=40<=Z?2:15<=Z?1:0}else J.tc=0;J.La=V}}}j=0}else dt(f,6,"Frame setup failed"),j=f.a;if(j=j==0){if(j){f.$c=0,0<f.Aa||(f.Ic=E2);e:{j=f.Ic,O=4*(te=f.za);var oe=32*te,we=te+1,Ce=0<f.L?te*(0<f.Aa?2:1):0,Pe=(f.Aa==2?2:1)*te;if((J=O+832+(V=3*(16*j+cu[f.L])/2*oe)+(X=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=J)j=0;else{if(J>f.Vb){if(f.Vb=0,f.Ec=s(J),f.Fc=0,f.Ec==null){j=dt(f,1,"no memory during frame initialization.");break e}f.Vb=J}J=f.Ec,Z=f.Fc,f.Ac=J,f.Bc=Z,Z+=O,f.Gd=o(oe,ke),f.Hd=0,f.rb=o(we+1,er),f.sb=1,f.wa=Ce?o(Ce,Jt):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=te),t(!0),f.oc=J,f.pc=Z,Z+=832,f.ya=o(Pe,Ja),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=te),f.R=16*te,f.B=8*te,te=(oe=cu[f.L])*f.R,oe=oe/2*f.B,f.sa=J,f.ta=Z+te,f.qa=f.sa,f.ra=f.ta+16*j*f.R+oe,f.Ha=f.qa,f.Ia=f.ra+8*j*f.B+oe,f.$c=0,Z+=V,f.mb=X?J:null,f.nb=X?Z:null,t(Z+X<=f.Fc+f.Vb),mn(f),n(f.Ac,f.Bc,0,O),j=1}}if(j){if(v.ka=0,v.y=f.sa,v.O=f.ta,v.f=f.qa,v.N=f.ra,v.ea=f.Ha,v.Vd=f.Ia,v.fa=f.R,v.Rc=f.B,v.F=null,v.J=0,!eu){for(j=-255;255>=j;++j)ra[255+j]=0>j?-j:j;for(j=-1020;1020>=j;++j)js[1020+j]=-128>j?-128:127<j?127:j;for(j=-112;112>=j;++j)Pl[112+j]=-16>j?-16:15<j?15:j;for(j=-255;510>=j;++j)_o[255+j]=0>j?0:255<j?255:j;eu=1}wo=X0,As=G0,El=Rc,Wa=Y0,Tn=Mc,Br=Ic,bo=ml,Zc=Ai,Tl=ld,Ti=pl,Ci=od,zs=uo,Pi=xl,No=Gc,Li=Vc,Vs=os,Cl=Ns,Cn=id,Wn[0]=is,Wn[1]=K0,Wn[2]=ed,Wn[3]=td,Wn[4]=qc,Wn[5]=lo,Wn[6]=Wc,Wn[7]=dl,Wn[8]=ad,Wn[9]=rd,Gs[0]=Bc,Gs[1]=Q0,Gs[2]=bs,Gs[3]=io,Gs[4]=Ta,Gs[5]=Z0,Gs[6]=Uc,Es[0]=Us,Es[1]=J0,Es[2]=nd,Es[3]=fl,Es[4]=Si,Es[5]=sd,Es[6]=hl,j=1}else j=0}j&&(j=function(Se,Ge){for(Se.M=0;Se.M<Se.Va;++Se.M){var Ue,be=Se.Jc[Se.M&Se.Xb],_e=Se.m,ze=Se;for(Ue=0;Ue<ze.za;++Ue){var et=_e,Ve=ze,yt=Ve.Ac,ft=Ve.Bc+4*Ue,Ct=Ve.zc,gt=Ve.ya[Ve.aa+Ue];if(Ve.Qa.Bb?gt.$b=me(et,Ve.Pa.jb[0])?2+me(et,Ve.Pa.jb[2]):me(et,Ve.Pa.jb[1]):gt.$b=0,Ve.kc&&(gt.Ad=me(et,Ve.Bd)),gt.Za=!me(et,145)+0,gt.Za){var tr=gt.Ob,ir=0;for(Ve=0;4>Ve;++Ve){var Qt,Gt=Ct[0+Ve];for(Qt=0;4>Qt;++Qt){Gt=f2[yt[ft+Qt]][Gt];for(var pr=jh[me(et,Gt[0])];0<pr;)pr=jh[2*pr+me(et,Gt[pr])];Gt=-pr,yt[ft+Qt]=Gt}a(tr,ir,yt,ft,4),ir+=4,Ct[0+Ve]=Gt}}else Gt=me(et,156)?me(et,128)?1:3:me(et,163)?2:0,gt.Ob[0]=Gt,n(yt,ft,Gt,4),n(Ct,0,Gt,4);gt.Dd=me(et,142)?me(et,114)?me(et,183)?1:3:2:0}if(ze.m.Ka)return dt(Se,7,"Premature end-of-partition0 encountered.");for(;Se.ja<Se.za;++Se.ja){if(ze=be,et=(_e=Se).rb[_e.sb-1],yt=_e.rb[_e.sb+_e.ja],Ue=_e.ya[_e.aa+_e.ja],ft=_e.kc?Ue.Ad:0)et.la=yt.la=0,Ue.Za||(et.Na=yt.Na=0),Ue.Hc=0,Ue.Gc=0,Ue.ia=0;else{var hr,qt;if(et=yt,yt=ze,ft=_e.Pa.Xc,Ct=_e.ya[_e.aa+_e.ja],gt=_e.pb[Ct.$b],Ve=Ct.ad,tr=0,ir=_e.rb[_e.sb-1],Gt=Qt=0,n(Ve,tr,0,384),Ct.Za)var Yr=0,tn=ft[3];else{pr=s(16);var Xr=et.Na+ir.Na;if(Xr=Ll(yt,ft[1],Xr,gt.Eb,0,pr,0),et.Na=ir.Na=(0<Xr)+0,1<Xr)wo(pr,0,Ve,tr);else{var rn=pr[0]+3>>3;for(pr=0;256>pr;pr+=16)Ve[tr+pr]=rn}Yr=1,tn=ft[0]}var or=15&et.la,gn=15&ir.la;for(pr=0;4>pr;++pr){var vn=1&gn;for(rn=qt=0;4>rn;++rn)or=or>>1|(vn=(Xr=Ll(yt,tn,Xr=vn+(1&or),gt.Sc,Yr,Ve,tr))>Yr)<<7,qt=qt<<2|(3<Xr?3:1<Xr?2:Ve[tr+0]!=0),tr+=16;or>>=4,gn=gn>>1|vn<<7,Qt=(Qt<<8|qt)>>>0}for(tn=or,Yr=gn>>4,hr=0;4>hr;hr+=2){for(qt=0,or=et.la>>4+hr,gn=ir.la>>4+hr,pr=0;2>pr;++pr){for(vn=1&gn,rn=0;2>rn;++rn)Xr=vn+(1&or),or=or>>1|(vn=0<(Xr=Ll(yt,ft[2],Xr,gt.Qc,0,Ve,tr)))<<3,qt=qt<<2|(3<Xr?3:1<Xr?2:Ve[tr+0]!=0),tr+=16;or>>=2,gn=gn>>1|vn<<5}Gt|=qt<<4*hr,tn|=or<<4<<hr,Yr|=(240&gn)<<hr}et.la=tn,ir.la=Yr,Ct.Hc=Qt,Ct.Gc=Gt,Ct.ia=43690&Gt?0:gt.ia,ft=!(Qt|Gt)}if(0<_e.L&&(_e.wa[_e.Y+_e.ja]=_e.gd[Ue.$b][Ue.Za],_e.wa[_e.Y+_e.ja].La|=!ft),ze.Ka)return dt(Se,7,"Premature end-of-file encountered.")}if(mn(Se),_e=Ge,ze=1,Ue=(be=Se).D,et=0<be.L&&be.M>=be.zb&&be.M<=be.Va,be.Aa==0)e:{if(Ue.M=be.M,Ue.uc=et,Nl(be,Ue),ze=1,Ue=(qt=be.D).Nb,et=(Gt=cu[be.L])*be.R,yt=Gt/2*be.B,pr=16*Ue*be.R,rn=8*Ue*be.B,ft=be.sa,Ct=be.ta-et+pr,gt=be.qa,Ve=be.ra-yt+rn,tr=be.Ha,ir=be.Ia-yt+rn,gn=(or=qt.M)==0,Qt=or>=be.Va-1,be.Aa==2&&Nl(be,qt),qt.uc)for(vn=(Xr=be).D.M,t(Xr.D.uc),qt=Xr.yb;qt<Xr.Hb;++qt){Yr=qt,tn=vn;var oa=(va=(kr=Xr).D).Nb;hr=kr.R;var va=va.wa[va.Y+Yr],Ha=kr.sa,kn=kr.ta+16*oa*hr+16*Yr,cs=va.dd,la=va.tc;if(la!=0)if(t(3<=la),kr.L==1)0<Yr&&Vs(Ha,kn,hr,la+4),va.La&&Cn(Ha,kn,hr,la),0<tn&&Li(Ha,kn,hr,la+4),va.La&&Cl(Ha,kn,hr,la);else{var Ts=kr.B,Fi=kr.qa,So=kr.ra+8*oa*Ts+8*Yr,Xs=kr.Ha,kr=kr.Ia+8*oa*Ts+8*Yr;oa=va.ld,0<Yr&&(Zc(Ha,kn,hr,la+4,cs,oa),Ti(Fi,So,Xs,kr,Ts,la+4,cs,oa)),va.La&&(zs(Ha,kn,hr,la,cs,oa),No(Fi,So,Xs,kr,Ts,la,cs,oa)),0<tn&&(bo(Ha,kn,hr,la+4,cs,oa),Tl(Fi,So,Xs,kr,Ts,la+4,cs,oa)),va.La&&(Ci(Ha,kn,hr,la,cs,oa),Pi(Fi,So,Xs,kr,Ts,la,cs,oa))}}if(be.ia&&alert("todo:DitherRow"),_e.put!=null){if(qt=16*or,or=16*(or+1),gn?(_e.y=be.sa,_e.O=be.ta+pr,_e.f=be.qa,_e.N=be.ra+rn,_e.ea=be.Ha,_e.W=be.Ia+rn):(qt-=Gt,_e.y=ft,_e.O=Ct,_e.f=gt,_e.N=Ve,_e.ea=tr,_e.W=ir),Qt||(or-=Gt),or>_e.o&&(or=_e.o),_e.F=null,_e.J=null,be.Fa!=null&&0<be.Fa.length&&qt<or&&(_e.J=wl(be,_e,qt,or-qt),_e.F=be.mb,_e.F==null&&_e.F.length==0)){ze=dt(be,3,"Could not decode alpha data.");break e}qt<_e.j&&(Gt=_e.j-qt,qt=_e.j,t(!(1&Gt)),_e.O+=be.R*Gt,_e.N+=be.B*(Gt>>1),_e.W+=be.B*(Gt>>1),_e.F!=null&&(_e.J+=_e.width*Gt)),qt<or&&(_e.O+=_e.v,_e.N+=_e.v>>1,_e.W+=_e.v>>1,_e.F!=null&&(_e.J+=_e.v),_e.ka=qt-_e.j,_e.U=_e.va-_e.v,_e.T=or-qt,ze=_e.put(_e))}Ue+1!=be.Ic||Qt||(a(be.sa,be.ta-et,ft,Ct+16*be.R,et),a(be.qa,be.ra-yt,gt,Ve+8*be.B,yt),a(be.Ha,be.Ia-yt,tr,ir+8*be.B,yt))}if(!ze)return dt(Se,6,"Output aborted.")}return 1}(f,v)),v.bc!=null&&v.bc(v),j&=1}return j?(f.cb=0,j):0}function Bn(f,v,j,O,V){V=f[v+j+32*O]+(V>>3),f[v+j+32*O]=-256&V?0>V?0:255:V}function so(f,v,j,O,V,X){Bn(f,v,0,j,O+V),Bn(f,v,1,j,O+X),Bn(f,v,2,j,O-X),Bn(f,v,3,j,O-V)}function Qa(f){return(20091*f>>16)+f}function cl(f,v,j,O){var V,X=0,J=s(16);for(V=0;4>V;++V){var Z=f[v+0]+f[v+8],te=f[v+0]-f[v+8],oe=(35468*f[v+4]>>16)-Qa(f[v+12]),we=Qa(f[v+4])+(35468*f[v+12]>>16);J[X+0]=Z+we,J[X+1]=te+oe,J[X+2]=te-oe,J[X+3]=Z-we,X+=4,v++}for(V=X=0;4>V;++V)Z=(f=J[X+0]+4)+J[X+8],te=f-J[X+8],oe=(35468*J[X+4]>>16)-Qa(J[X+12]),Bn(j,O,0,0,Z+(we=Qa(J[X+4])+(35468*J[X+12]>>16))),Bn(j,O,1,0,te+oe),Bn(j,O,2,0,te-oe),Bn(j,O,3,0,Z-we),X++,O+=32}function Ic(f,v,j,O){var V=f[v+0]+4,X=35468*f[v+4]>>16,J=Qa(f[v+4]),Z=35468*f[v+1]>>16;so(j,O,0,V+J,f=Qa(f[v+1]),Z),so(j,O,1,V+X,f,Z),so(j,O,2,V-X,f,Z),so(j,O,3,V-J,f,Z)}function G0(f,v,j,O,V){cl(f,v,j,O),V&&cl(f,v+16,j,O+4)}function Rc(f,v,j,O){As(f,v+0,j,O,1),As(f,v+32,j,O+128,1)}function Y0(f,v,j,O){var V;for(f=f[v+0]+4,V=0;4>V;++V)for(v=0;4>v;++v)Bn(j,O,v,V,f)}function Mc(f,v,j,O){f[v+0]&&Wa(f,v+0,j,O),f[v+16]&&Wa(f,v+16,j,O+4),f[v+32]&&Wa(f,v+32,j,O+128),f[v+48]&&Wa(f,v+48,j,O+128+4)}function X0(f,v,j,O){var V,X=s(16);for(V=0;4>V;++V){var J=f[v+0+V]+f[v+12+V],Z=f[v+4+V]+f[v+8+V],te=f[v+4+V]-f[v+8+V],oe=f[v+0+V]-f[v+12+V];X[0+V]=J+Z,X[8+V]=J-Z,X[4+V]=oe+te,X[12+V]=oe-te}for(V=0;4>V;++V)J=(f=X[0+4*V]+3)+X[3+4*V],Z=X[1+4*V]+X[2+4*V],te=X[1+4*V]-X[2+4*V],oe=f-X[3+4*V],j[O+0]=J+Z>>3,j[O+16]=oe+te>>3,j[O+32]=J-Z>>3,j[O+48]=oe-te>>3,O+=64}function ul(f,v,j){var O,V=v-32,X=xn,J=255-f[V-1];for(O=0;O<j;++O){var Z,te=X,oe=J+f[v-1];for(Z=0;Z<j;++Z)f[v+Z]=te[oe+f[V+Z]];v+=32}}function K0(f,v){ul(f,v,4)}function J0(f,v){ul(f,v,8)}function Q0(f,v){ul(f,v,16)}function bs(f,v){var j;for(j=0;16>j;++j)a(f,v+32*j,f,v-32,16)}function io(f,v){var j;for(j=16;0<j;--j)n(f,v,f[v-1],16),v+=32}function oo(f,v,j){var O;for(O=0;16>O;++O)n(v,j+32*O,f,16)}function Bc(f,v){var j,O=16;for(j=0;16>j;++j)O+=f[v-1+32*j]+f[v+j-32];oo(O>>5,f,v)}function Ta(f,v){var j,O=8;for(j=0;16>j;++j)O+=f[v-1+32*j];oo(O>>4,f,v)}function Z0(f,v){var j,O=8;for(j=0;16>j;++j)O+=f[v+j-32];oo(O>>4,f,v)}function Uc(f,v){oo(128,f,v)}function It(f,v,j){return f+2*v+j+2>>2}function ed(f,v){var j,O=v-32;for(O=new Uint8Array([It(f[O-1],f[O+0],f[O+1]),It(f[O+0],f[O+1],f[O+2]),It(f[O+1],f[O+2],f[O+3]),It(f[O+2],f[O+3],f[O+4])]),j=0;4>j;++j)a(f,v+32*j,O,0,O.length)}function td(f,v){var j=f[v-1],O=f[v-1+32],V=f[v-1+64],X=f[v-1+96];Ne(f,v+0,16843009*It(f[v-1-32],j,O)),Ne(f,v+32,16843009*It(j,O,V)),Ne(f,v+64,16843009*It(O,V,X)),Ne(f,v+96,16843009*It(V,X,X))}function is(f,v){var j,O=4;for(j=0;4>j;++j)O+=f[v+j-32]+f[v-1+32*j];for(O>>=3,j=0;4>j;++j)n(f,v+32*j,O,4)}function qc(f,v){var j=f[v-1+0],O=f[v-1+32],V=f[v-1+64],X=f[v-1-32],J=f[v+0-32],Z=f[v+1-32],te=f[v+2-32],oe=f[v+3-32];f[v+0+96]=It(O,V,f[v-1+96]),f[v+1+96]=f[v+0+64]=It(j,O,V),f[v+2+96]=f[v+1+64]=f[v+0+32]=It(X,j,O),f[v+3+96]=f[v+2+64]=f[v+1+32]=f[v+0+0]=It(J,X,j),f[v+3+64]=f[v+2+32]=f[v+1+0]=It(Z,J,X),f[v+3+32]=f[v+2+0]=It(te,Z,J),f[v+3+0]=It(oe,te,Z)}function Wc(f,v){var j=f[v+1-32],O=f[v+2-32],V=f[v+3-32],X=f[v+4-32],J=f[v+5-32],Z=f[v+6-32],te=f[v+7-32];f[v+0+0]=It(f[v+0-32],j,O),f[v+1+0]=f[v+0+32]=It(j,O,V),f[v+2+0]=f[v+1+32]=f[v+0+64]=It(O,V,X),f[v+3+0]=f[v+2+32]=f[v+1+64]=f[v+0+96]=It(V,X,J),f[v+3+32]=f[v+2+64]=f[v+1+96]=It(X,J,Z),f[v+3+64]=f[v+2+96]=It(J,Z,te),f[v+3+96]=It(Z,te,te)}function lo(f,v){var j=f[v-1+0],O=f[v-1+32],V=f[v-1+64],X=f[v-1-32],J=f[v+0-32],Z=f[v+1-32],te=f[v+2-32],oe=f[v+3-32];f[v+0+0]=f[v+1+64]=X+J+1>>1,f[v+1+0]=f[v+2+64]=J+Z+1>>1,f[v+2+0]=f[v+3+64]=Z+te+1>>1,f[v+3+0]=te+oe+1>>1,f[v+0+96]=It(V,O,j),f[v+0+64]=It(O,j,X),f[v+0+32]=f[v+1+96]=It(j,X,J),f[v+1+32]=f[v+2+96]=It(X,J,Z),f[v+2+32]=f[v+3+96]=It(J,Z,te),f[v+3+32]=It(Z,te,oe)}function dl(f,v){var j=f[v+0-32],O=f[v+1-32],V=f[v+2-32],X=f[v+3-32],J=f[v+4-32],Z=f[v+5-32],te=f[v+6-32],oe=f[v+7-32];f[v+0+0]=j+O+1>>1,f[v+1+0]=f[v+0+64]=O+V+1>>1,f[v+2+0]=f[v+1+64]=V+X+1>>1,f[v+3+0]=f[v+2+64]=X+J+1>>1,f[v+0+32]=It(j,O,V),f[v+1+32]=f[v+0+96]=It(O,V,X),f[v+2+32]=f[v+1+96]=It(V,X,J),f[v+3+32]=f[v+2+96]=It(X,J,Z),f[v+3+64]=It(J,Z,te),f[v+3+96]=It(Z,te,oe)}function rd(f,v){var j=f[v-1+0],O=f[v-1+32],V=f[v-1+64],X=f[v-1+96];f[v+0+0]=j+O+1>>1,f[v+2+0]=f[v+0+32]=O+V+1>>1,f[v+2+32]=f[v+0+64]=V+X+1>>1,f[v+1+0]=It(j,O,V),f[v+3+0]=f[v+1+32]=It(O,V,X),f[v+3+32]=f[v+1+64]=It(V,X,X),f[v+3+64]=f[v+2+64]=f[v+0+96]=f[v+1+96]=f[v+2+96]=f[v+3+96]=X}function ad(f,v){var j=f[v-1+0],O=f[v-1+32],V=f[v-1+64],X=f[v-1+96],J=f[v-1-32],Z=f[v+0-32],te=f[v+1-32],oe=f[v+2-32];f[v+0+0]=f[v+2+32]=j+J+1>>1,f[v+0+32]=f[v+2+64]=O+j+1>>1,f[v+0+64]=f[v+2+96]=V+O+1>>1,f[v+0+96]=X+V+1>>1,f[v+3+0]=It(Z,te,oe),f[v+2+0]=It(J,Z,te),f[v+1+0]=f[v+3+32]=It(j,J,Z),f[v+1+32]=f[v+3+64]=It(O,j,J),f[v+1+64]=f[v+3+96]=It(V,O,j),f[v+1+96]=It(X,V,O)}function nd(f,v){var j;for(j=0;8>j;++j)a(f,v+32*j,f,v-32,8)}function fl(f,v){var j;for(j=0;8>j;++j)n(f,v,f[v-1],8),v+=32}function _i(f,v,j){var O;for(O=0;8>O;++O)n(v,j+32*O,f,8)}function Us(f,v){var j,O=8;for(j=0;8>j;++j)O+=f[v+j-32]+f[v-1+32*j];_i(O>>4,f,v)}function sd(f,v){var j,O=4;for(j=0;8>j;++j)O+=f[v+j-32];_i(O>>3,f,v)}function Si(f,v){var j,O=4;for(j=0;8>j;++j)O+=f[v-1+32*j];_i(O>>3,f,v)}function hl(f,v){_i(128,f,v)}function co(f,v,j){var O=f[v-j],V=f[v+0],X=3*(V-O)+dd[1020+f[v-2*j]-f[v+j]],J=tu[112+(X+4>>3)];f[v-j]=xn[255+O+tu[112+(X+3>>3)]],f[v+0]=xn[255+V-J]}function Hc(f,v,j,O){var V=f[v+0],X=f[v+j];return Ln[255+f[v-2*j]-f[v-j]]>O||Ln[255+X-V]>O}function $c(f,v,j,O){return 4*Ln[255+f[v-j]-f[v+0]]+Ln[255+f[v-2*j]-f[v+j]]<=O}function zc(f,v,j,O,V){var X=f[v-3*j],J=f[v-2*j],Z=f[v-j],te=f[v+0],oe=f[v+j],we=f[v+2*j],Ce=f[v+3*j];return 4*Ln[255+Z-te]+Ln[255+J-oe]>O?0:Ln[255+f[v-4*j]-X]<=V&&Ln[255+X-J]<=V&&Ln[255+J-Z]<=V&&Ln[255+Ce-we]<=V&&Ln[255+we-oe]<=V&&Ln[255+oe-te]<=V}function Vc(f,v,j,O){var V=2*O+1;for(O=0;16>O;++O)$c(f,v+O,j,V)&&co(f,v+O,j)}function os(f,v,j,O){var V=2*O+1;for(O=0;16>O;++O)$c(f,v+O*j,1,V)&&co(f,v+O*j,1)}function Ns(f,v,j,O){var V;for(V=3;0<V;--V)Vc(f,v+=4*j,j,O)}function id(f,v,j,O){var V;for(V=3;0<V;--V)os(f,v+=4,j,O)}function qs(f,v,j,O,V,X,J,Z){for(X=2*X+1;0<V--;){if(zc(f,v,j,X,J))if(Hc(f,v,j,Z))co(f,v,j);else{var te=f,oe=v,we=j,Ce=te[oe-2*we],Pe=te[oe-we],Se=te[oe+0],Ge=te[oe+we],Ue=te[oe+2*we],be=27*(ze=dd[1020+3*(Se-Pe)+dd[1020+Ce-Ge]])+63>>7,_e=18*ze+63>>7,ze=9*ze+63>>7;te[oe-3*we]=xn[255+te[oe-3*we]+ze],te[oe-2*we]=xn[255+Ce+_e],te[oe-we]=xn[255+Pe+be],te[oe+0]=xn[255+Se-be],te[oe+we]=xn[255+Ge-_e],te[oe+2*we]=xn[255+Ue-ze]}v+=O}}function Un(f,v,j,O,V,X,J,Z){for(X=2*X+1;0<V--;){if(zc(f,v,j,X,J))if(Hc(f,v,j,Z))co(f,v,j);else{var te=f,oe=v,we=j,Ce=te[oe-we],Pe=te[oe+0],Se=te[oe+we],Ge=tu[112+((Ue=3*(Pe-Ce))+4>>3)],Ue=tu[112+(Ue+3>>3)],be=Ge+1>>1;te[oe-2*we]=xn[255+te[oe-2*we]+be],te[oe-we]=xn[255+Ce+Ue],te[oe+0]=xn[255+Pe-Ge],te[oe+we]=xn[255+Se-be]}v+=O}}function ml(f,v,j,O,V,X){qs(f,v,j,1,16,O,V,X)}function Ai(f,v,j,O,V,X){qs(f,v,1,j,16,O,V,X)}function od(f,v,j,O,V,X){var J;for(J=3;0<J;--J)Un(f,v+=4*j,j,1,16,O,V,X)}function uo(f,v,j,O,V,X){var J;for(J=3;0<J;--J)Un(f,v+=4,1,j,16,O,V,X)}function ld(f,v,j,O,V,X,J,Z){qs(f,v,V,1,8,X,J,Z),qs(j,O,V,1,8,X,J,Z)}function pl(f,v,j,O,V,X,J,Z){qs(f,v,1,V,8,X,J,Z),qs(j,O,1,V,8,X,J,Z)}function xl(f,v,j,O,V,X,J,Z){Un(f,v+4*V,V,1,8,X,J,Z),Un(j,O+4*V,V,1,8,X,J,Z)}function Gc(f,v,j,O,V,X,J,Z){Un(f,v+4,1,V,8,X,J,Z),Un(j,O+4,1,V,8,X,J,Z)}function fo(){this.ba=new ma,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Vt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function vl(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Yc(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new W,this.yc=new b}function cd(){this.xb=this.a=0,this.l=new St,this.ca=new ma,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new N,this.Pb=0,this.wd=new N,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Yc,this.ab=0,this.gc=o(4,vl),this.Oc=0}function ho(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new St,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ji(f,v,j,O,V,X,J){for(f=f==null?0:f[v+0],v=0;v<J;++v)V[X+v]=f+j[O+v]&255,f=V[X+v]}function yl(f,v,j,O,V,X,J){var Z;if(f==null)ji(null,null,j,O,V,X,J);else for(Z=0;Z<J;++Z)V[X+Z]=f[v+Z]+j[O+Z]&255}function Ws(f,v,j,O,V,X,J){if(f==null)ji(null,null,j,O,V,X,J);else{var Z,te=f[v+0],oe=te,we=te;for(Z=0;Z<J;++Z)oe=we+(te=f[v+Z])-oe,we=j[O+Z]+(-256&oe?0>oe?0:255:oe)&255,oe=te,V[X+Z]=we}}function wl(f,v,j,O){var V=v.width,X=v.o;if(t(f!=null&&v!=null),0>j||0>=O||j+O>X)return null;if(!f.Cc){if(f.ga==null){var J;if(f.ga=new ho,(J=f.ga==null)||(J=v.width*v.o,t(f.Gb.length==0),f.Gb=s(J),f.Uc=0,f.Gb==null?J=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,J=1),J=!J),!J){J=f.ga;var Z=f.Fa,te=f.P,oe=f.qc,we=f.mb,Ce=f.nb,Pe=te+1,Se=oe-1,Ge=J.l;if(t(Z!=null&&we!=null&&v!=null),Ys[0]=null,Ys[1]=ji,Ys[2]=yl,Ys[3]=Ws,J.ca=we,J.tb=Ce,J.c=v.width,J.i=v.height,t(0<J.c&&0<J.i),1>=oe)v=0;else if(J.$a=Z[te+0]>>0&3,J.Z=Z[te+0]>>2&3,J.Lc=Z[te+0]>>4&3,te=Z[te+0]>>6&3,0>J.$a||1<J.$a||4<=J.Z||1<J.Lc||te)v=0;else if(Ge.put=Ua,Ge.ac=Mr,Ge.bc=ja,Ge.ma=J,Ge.width=v.width,Ge.height=v.height,Ge.Da=v.Da,Ge.v=v.v,Ge.va=v.va,Ge.j=v.j,Ge.o=v.o,J.$a)e:{t(J.$a==1),v=Me();t:for(;;){if(v==null){v=0;break e}if(t(J!=null),J.mc=v,v.c=J.c,v.i=J.i,v.l=J.l,v.l.ma=J,v.l.width=J.c,v.l.height=J.i,v.a=0,H(v.m,Z,Pe,Se),!Ee(J.c,J.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&ae(v.s)?(J.ic=1,Z=v.c*v.i,v.Ta=null,v.Ua=0,v.V=s(Z),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(J.ic=0,v=Te(v,J.c)),!v))break t;v=1;break e}J.mc=null,v=0}else v=Se>=J.c*J.i;J=!v}if(J)return null;f.ga.Lc!=1?f.Ga=0:O=X-j}t(f.ga!=null),t(j+O<=X);e:{if(v=(Z=f.ga).c,X=Z.l.o,Z.$a==0){if(Pe=f.rc,Se=f.Vc,Ge=f.Fa,te=f.P+1+j*v,oe=f.mb,we=f.nb+j*v,t(te<=f.P+f.qc),Z.Z!=0)for(t(Ys[Z.Z]!=null),J=0;J<O;++J)Ys[Z.Z](Pe,Se,Ge,te,oe,we,v),Pe=oe,Se=we,we+=v,te+=v;else for(J=0;J<O;++J)a(oe,we,Ge,te,v),Pe=oe,Se=we,we+=v,te+=v;f.rc=Pe,f.Vc=Se}else{if(t(Z.mc!=null),v=j+O,t((J=Z.mc)!=null),t(v<=J.i),J.C>=v)v=1;else if(Z.ic||je(),Z.ic){Z=J.V,Pe=J.Ba,Se=J.c;var Ue=J.i,be=(Ge=1,te=J.$/Se,oe=J.$%Se,we=J.m,Ce=J.s,J.$),_e=Se*Ue,ze=Se*v,et=Ce.wc,Ve=be<ze?Nr(Ce,oe,te):null;t(be<=_e),t(v<=Ue),t(ae(Ce));t:for(;;){for(;!we.h&&be<ze;){if(oe&et||(Ve=Nr(Ce,oe,te)),t(Ve!=null),z(we),256>(Ue=gr(Ve.G[0],Ve.H[0],we)))Z[Pe+be]=Ue,++be,++oe>=Se&&(oe=0,++te<=v&&!(te%16)&&ce(J,te));else{if(!(280>Ue)){Ge=0;break t}Ue=Ea(Ue-256,we);var yt,ft=gr(Ve.G[4],Ve.H[4],we);if(z(we),!(be>=(ft=pa(Se,ft=Ea(ft,we)))&&_e-be>=Ue)){Ge=0;break t}for(yt=0;yt<Ue;++yt)Z[Pe+be+yt]=Z[Pe+be+yt-ft];for(be+=Ue,oe+=Ue;oe>=Se;)oe-=Se,++te<=v&&!(te%16)&&ce(J,te);be<ze&&oe&et&&(Ve=Nr(Ce,oe,te))}t(we.h==D(we))}ce(J,te>v?v:te);break t}!Ge||we.h&&be<_e?(Ge=0,J.a=we.h?5:3):J.$=be,v=Ge}else v=de(J,J.V,J.Ba,J.c,J.i,v,Le);if(!v){O=0;break e}}j+O>=X&&(f.Cc=1),O=1}if(!O)return null;if(f.Cc&&((O=f.ga)!=null&&(O.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+j*V}function w(f,v,j,O,V,X){for(;0<V--;){var J,Z=f,te=v+(j?1:0),oe=f,we=v+(j?0:3);for(J=0;J<O;++J){var Ce=oe[we+4*J];Ce!=255&&(Ce*=32897,Z[te+4*J+0]=Z[te+4*J+0]*Ce>>23,Z[te+4*J+1]=Z[te+4*J+1]*Ce>>23,Z[te+4*J+2]=Z[te+4*J+2]*Ce>>23)}v+=X}}function G(f,v,j,O,V){for(;0<O--;){var X;for(X=0;X<j;++X){var J=f[v+2*X+0],Z=15&(oe=f[v+2*X+1]),te=4369*Z,oe=(240&oe|oe>>4)*te>>16;f[v+2*X+0]=(240&J|J>>4)*te>>16&240|(15&J|J<<4)*te>>16>>4&15,f[v+2*X+1]=240&oe|Z}v+=V}}function xe(f,v,j,O,V,X,J,Z){var te,oe,we=255;for(oe=0;oe<V;++oe){for(te=0;te<O;++te){var Ce=f[v+te];X[J+4*te]=Ce,we&=Ce}v+=j,J+=Z}return we!=255}function ve(f,v,j,O,V){var X;for(X=0;X<V;++X)j[O+X]=f[v+X]>>8}function je(){Pn=w,yr=G,wr=xe,Ur=ve}function We(f,v,j){P[f]=function(O,V,X,J,Z,te,oe,we,Ce,Pe,Se,Ge,Ue,be,_e,ze,et){var Ve,yt=et-1>>1,ft=Z[te+0]|oe[we+0]<<16,Ct=Ce[Pe+0]|Se[Ge+0]<<16;t(O!=null);var gt=3*ft+Ct+131074>>2;for(v(O[V+0],255&gt,gt>>16,Ue,be),X!=null&&(gt=3*Ct+ft+131074>>2,v(X[J+0],255&gt,gt>>16,_e,ze)),Ve=1;Ve<=yt;++Ve){var tr=Z[te+Ve]|oe[we+Ve]<<16,ir=Ce[Pe+Ve]|Se[Ge+Ve]<<16,Qt=ft+tr+Ct+ir+524296,Gt=Qt+2*(tr+Ct)>>3;gt=Gt+ft>>1,ft=(Qt=Qt+2*(ft+ir)>>3)+tr>>1,v(O[V+2*Ve-1],255&gt,gt>>16,Ue,be+(2*Ve-1)*j),v(O[V+2*Ve-0],255&ft,ft>>16,Ue,be+(2*Ve-0)*j),X!=null&&(gt=Qt+Ct>>1,ft=Gt+ir>>1,v(X[J+2*Ve-1],255&gt,gt>>16,_e,ze+(2*Ve-1)*j),v(X[J+2*Ve+0],255&ft,ft>>16,_e,ze+(2*Ve+0)*j)),ft=tr,Ct=ir}1&et||(gt=3*ft+Ct+131074>>2,v(O[V+et-1],255&gt,gt>>16,Ue,be+(et-1)*j),X!=null&&(gt=3*Ct+ft+131074>>2,v(X[J+et-1],255&gt,gt>>16,_e,ze+(et-1)*j)))}}function rt(){Fn[ru]=x2,Fn[au]=Th,Fn[_h]=g2,Fn[nu]=Ch,Fn[su]=Ph,Fn[fd]=Lh,Fn[Sh]=v2,Fn[hd]=Th,Fn[md]=Ch,Fn[iu]=Ph,Fn[pd]=Lh}function vt(f){return f&~y2?0>f?0:255:f>>Fh}function jt(f,v){return vt((19077*f>>8)+(26149*v>>8)-14234)}function Bt(f,v,j){return vt((19077*f>>8)-(6419*v>>8)-(13320*j>>8)+8708)}function Rt(f,v){return vt((19077*f>>8)+(33050*v>>8)-17685)}function Xt(f,v,j,O,V){O[V+0]=jt(f,j),O[V+1]=Bt(f,v,j),O[V+2]=Rt(f,v)}function Cr(f,v,j,O,V){O[V+0]=Rt(f,v),O[V+1]=Bt(f,v,j),O[V+2]=jt(f,j)}function Fr(f,v,j,O,V){var X=Bt(f,v,j);v=X<<3&224|Rt(f,v)>>3,O[V+0]=248&jt(f,j)|X>>5,O[V+1]=v}function Gr(f,v,j,O,V){var X=240&Rt(f,v)|15;O[V+0]=240&jt(f,j)|Bt(f,v,j)>>4,O[V+1]=X}function Ca(f,v,j,O,V){O[V+0]=255,Xt(f,v,j,O,V+1)}function ia(f,v,j,O,V){Cr(f,v,j,O,V),O[V+3]=255}function qn(f,v,j,O,V){Xt(f,v,j,O,V),O[V+3]=255}function pn(f,v){return 0>f?0:f>v?v:f}function ls(f,v,j){P[f]=function(O,V,X,J,Z,te,oe,we,Ce){for(var Pe=we+(-2&Ce)*j;we!=Pe;)v(O[V+0],X[J+0],Z[te+0],oe,we),v(O[V+1],X[J+0],Z[te+0],oe,we+j),V+=2,++J,++te,we+=2*j;1&Ce&&v(O[V+0],X[J+0],Z[te+0],oe,we)}}function Xc(f,v,j){return j==0?f==0?v==0?6:5:v==0?4:0:j}function bl(f,v,j,O,V){switch(f>>>30){case 3:As(v,j,O,V,0);break;case 2:Br(v,j,O,V);break;case 1:Wa(v,j,O,V)}}function Nl(f,v){var j,O,V=v.M,X=v.Nb,J=f.oc,Z=f.pc+40,te=f.oc,oe=f.pc+584,we=f.oc,Ce=f.pc+600;for(j=0;16>j;++j)J[Z+32*j-1]=129;for(j=0;8>j;++j)te[oe+32*j-1]=129,we[Ce+32*j-1]=129;for(0<V?J[Z-1-32]=te[oe-1-32]=we[Ce-1-32]=129:(n(J,Z-32-1,127,21),n(te,oe-32-1,127,9),n(we,Ce-32-1,127,9)),O=0;O<f.za;++O){var Pe=v.ya[v.aa+O];if(0<O){for(j=-1;16>j;++j)a(J,Z+32*j-4,J,Z+32*j+12,4);for(j=-1;8>j;++j)a(te,oe+32*j-4,te,oe+32*j+4,4),a(we,Ce+32*j-4,we,Ce+32*j+4,4)}var Se=f.Gd,Ge=f.Hd+O,Ue=Pe.ad,be=Pe.Hc;if(0<V&&(a(J,Z-32,Se[Ge].y,0,16),a(te,oe-32,Se[Ge].f,0,8),a(we,Ce-32,Se[Ge].ea,0,8)),Pe.Za){var _e=J,ze=Z-32+16;for(0<V&&(O>=f.za-1?n(_e,ze,Se[Ge].y[15],4):a(_e,ze,Se[Ge+1].y,0,4)),j=0;4>j;j++)_e[ze+128+j]=_e[ze+256+j]=_e[ze+384+j]=_e[ze+0+j];for(j=0;16>j;++j,be<<=2)_e=J,ze=Z+Dh[j],Wn[Pe.Ob[j]](_e,ze),bl(be,Ue,16*+j,_e,ze)}else if(_e=Xc(O,V,Pe.Ob[0]),Gs[_e](J,Z),be!=0)for(j=0;16>j;++j,be<<=2)bl(be,Ue,16*+j,J,Z+Dh[j]);for(j=Pe.Gc,_e=Xc(O,V,Pe.Dd),Es[_e](te,oe),Es[_e](we,Ce),be=Ue,_e=te,ze=oe,255&(Pe=j>>0)&&(170&Pe?El(be,256,_e,ze):Tn(be,256,_e,ze)),Pe=we,be=Ce,255&(j>>=8)&&(170&j?El(Ue,320,Pe,be):Tn(Ue,320,Pe,be)),V<f.Ub-1&&(a(Se[Ge].y,0,J,Z+480,16),a(Se[Ge].f,0,te,oe+224,8),a(Se[Ge].ea,0,we,Ce+224,8)),j=8*X*f.B,Se=f.sa,Ge=f.ta+16*O+16*X*f.R,Ue=f.qa,Pe=f.ra+8*O+j,be=f.Ha,_e=f.Ia+8*O+j,j=0;16>j;++j)a(Se,Ge+j*f.R,J,Z+32*j,16);for(j=0;8>j;++j)a(Ue,Pe+j*f.B,te,oe+32*j,8),a(be,_e+j*f.B,we,Ce+32*j,8)}}function mo(f,v,j,O,V,X,J,Z,te){var oe=[0],we=[0],Ce=0,Pe=te!=null?te.kd:0,Se=te??new gl;if(f==null||12>j)return 7;Se.data=f,Se.w=v,Se.ha=j,v=[v],j=[j],Se.gb=[Se.gb];e:{var Ge=v,Ue=j,be=Se.gb;if(t(f!=null),t(Ue!=null),t(be!=null),be[0]=0,12<=Ue[0]&&!r(f,Ge[0],"RIFF")){if(r(f,Ge[0]+8,"WEBP")){be=3;break e}var _e=Ze(f,Ge[0]+4);if(12>_e||4294967286<_e){be=3;break e}if(Pe&&_e>Ue[0]-8){be=7;break e}be[0]=_e,Ge[0]+=12,Ue[0]-=12}be=0}if(be!=0)return be;for(_e=0<Se.gb[0],j=j[0];;){e:{var ze=f;Ue=v,be=j;var et=oe,Ve=we,yt=Ge=[0];if((gt=Ce=[Ce])[0]=0,8>be[0])be=7;else{if(!r(ze,Ue[0],"VP8X")){if(Ze(ze,Ue[0]+4)!=10){be=3;break e}if(18>be[0]){be=7;break e}var ft=Ze(ze,Ue[0]+8),Ct=1+Ie(ze,Ue[0]+12);if(2147483648<=Ct*(ze=1+Ie(ze,Ue[0]+15))){be=3;break e}yt!=null&&(yt[0]=ft),et!=null&&(et[0]=Ct),Ve!=null&&(Ve[0]=ze),Ue[0]+=18,be[0]-=18,gt[0]=1}be=0}}if(Ce=Ce[0],Ge=Ge[0],be!=0)return be;if(Ue=!!(2&Ge),!_e&&Ce)return 3;if(X!=null&&(X[0]=!!(16&Ge)),J!=null&&(J[0]=Ue),Z!=null&&(Z[0]=0),J=oe[0],Ge=we[0],Ce&&Ue&&te==null){be=0;break}if(4>j){be=7;break}if(_e&&Ce||!_e&&!Ce&&!r(f,v[0],"ALPH")){j=[j],Se.na=[Se.na],Se.P=[Se.P],Se.Sa=[Se.Sa];e:{ft=f,be=v,_e=j;var gt=Se.gb;et=Se.na,Ve=Se.P,yt=Se.Sa,Ct=22,t(ft!=null),t(_e!=null),ze=be[0];var tr=_e[0];for(t(et!=null),t(yt!=null),et[0]=null,Ve[0]=null,yt[0]=0;;){if(be[0]=ze,_e[0]=tr,8>tr){be=7;break e}var ir=Ze(ft,ze+4);if(4294967286<ir){be=3;break e}var Qt=8+ir+1&-2;if(Ct+=Qt,0<gt&&Ct>gt){be=3;break e}if(!r(ft,ze,"VP8 ")||!r(ft,ze,"VP8L")){be=0;break e}if(tr[0]<Qt){be=7;break e}r(ft,ze,"ALPH")||(et[0]=ft,Ve[0]=ze+8,yt[0]=ir),ze+=Qt,tr-=Qt}}if(j=j[0],Se.na=Se.na[0],Se.P=Se.P[0],Se.Sa=Se.Sa[0],be!=0)break}j=[j],Se.Ja=[Se.Ja],Se.xa=[Se.xa];e:if(gt=f,be=v,_e=j,et=Se.gb[0],Ve=Se.Ja,yt=Se.xa,ft=be[0],ze=!r(gt,ft,"VP8 "),Ct=!r(gt,ft,"VP8L"),t(gt!=null),t(_e!=null),t(Ve!=null),t(yt!=null),8>_e[0])be=7;else{if(ze||Ct){if(gt=Ze(gt,ft+4),12<=et&&gt>et-12){be=3;break e}if(Pe&&gt>_e[0]-8){be=7;break e}Ve[0]=gt,be[0]+=8,_e[0]-=8,yt[0]=Ct}else yt[0]=5<=_e[0]&&gt[ft+0]==47&&!(gt[ft+4]>>5),Ve[0]=_e[0];be=0}if(j=j[0],Se.Ja=Se.Ja[0],Se.xa=Se.xa[0],v=v[0],be!=0)break;if(4294967286<Se.Ja)return 3;if(Z==null||Ue||(Z[0]=Se.xa?2:1),J=[J],Ge=[Ge],Se.xa){if(5>j){be=7;break}Z=J,Pe=Ge,Ue=X,f==null||5>j?f=0:5<=j&&f[v+0]==47&&!(f[v+4]>>5)?(_e=[0],gt=[0],et=[0],H(Ve=new N,f,v,j),_t(Ve,_e,gt,et)?(Z!=null&&(Z[0]=_e[0]),Pe!=null&&(Pe[0]=gt[0]),Ue!=null&&(Ue[0]=et[0]),f=1):f=0):f=0}else{if(10>j){be=7;break}Z=Ge,f==null||10>j||!Dt(f,v+3,j-3)?f=0:(Pe=f[v+0]|f[v+1]<<8|f[v+2]<<16,Ue=16383&(f[v+7]<<8|f[v+6]),f=16383&(f[v+9]<<8|f[v+8]),1&Pe||3<(Pe>>1&7)||!(Pe>>4&1)||Pe>>5>=Se.Ja||!Ue||!f?f=0:(J&&(J[0]=Ue),Z&&(Z[0]=f),f=1))}if(!f||(J=J[0],Ge=Ge[0],Ce&&(oe[0]!=J||we[0]!=Ge)))return 3;te!=null&&(te[0]=Se,te.offset=v-te.w,t(4294967286>v-te.w),t(te.offset==te.ha-j));break}return be==0||be==7&&Ce&&te==null?(X!=null&&(X[0]|=Se.na!=null&&0<Se.na.length),O!=null&&(O[0]=J),V!=null&&(V[0]=Ge),0):be}function _l(f,v,j){var O=v.width,V=v.height,X=0,J=0,Z=O,te=V;if(v.Da=f!=null&&0<f.Da,v.Da&&(Z=f.cd,te=f.bd,X=f.v,J=f.j,11>j||(X&=-2,J&=-2),0>X||0>J||0>=Z||0>=te||X+Z>O||J+te>V))return 0;if(v.v=X,v.j=J,v.va=X+Z,v.o=J+te,v.U=Z,v.T=te,v.da=f!=null&&0<f.da,v.da){if(!Xe(Z,te,j=[f.ib],X=[f.hb]))return 0;v.ib=j[0],v.hb=X[0]}return v.ob=f!=null&&f.ob,v.Kb=f==null||!f.Sd,v.da&&(v.ob=v.ib<3*O/4&&v.hb<3*V/4,v.Kb=0),1}function Sl(f){if(f==null)return 2;if(11>f.S){var v=f.f.RGBA;v.fb+=(f.height-1)*v.A,v.A=-v.A}else v=f.f.kb,f=f.height,v.O+=(f-1)*v.fa,v.fa=-v.fa,v.N+=(f-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(f-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(f-1)*v.lb,v.lb=-v.lb);return 0}function po(f,v,j,O){if(O==null||0>=f||0>=v)return 2;if(j!=null){if(j.Da){var V=j.cd,X=j.bd,J=-2&j.v,Z=-2&j.j;if(0>J||0>Z||0>=V||0>=X||J+V>f||Z+X>v)return 2;f=V,v=X}if(j.da){if(!Xe(f,v,V=[j.ib],X=[j.hb]))return 2;f=V[0],v=X[0]}}O.width=f,O.height=v;e:{var te=O.width,oe=O.height;if(f=O.S,0>=te||0>=oe||!(f>=ru&&13>f))f=2;else{if(0>=O.Rd&&O.sd==null){J=X=V=v=0;var we=(Z=te*Oh[f])*oe;if(11>f||(X=(oe+1)/2*(v=(te+1)/2),f==12&&(J=(V=te)*oe)),(oe=s(we+2*X+J))==null){f=1;break e}O.sd=oe,11>f?((te=O.f.RGBA).eb=oe,te.fb=0,te.A=Z,te.size=we):((te=O.f.kb).y=oe,te.O=0,te.fa=Z,te.Fd=we,te.f=oe,te.N=0+we,te.Ab=v,te.Cd=X,te.ea=oe,te.W=0+we+X,te.Db=v,te.Ed=X,f==12&&(te.F=oe,te.J=0+we+2*X),te.Tc=J,te.lb=V)}if(v=1,V=O.S,X=O.width,J=O.height,V>=ru&&13>V)if(11>V)f=O.f.RGBA,v&=(Z=Math.abs(f.A))*(J-1)+X<=f.size,v&=Z>=X*Oh[V],v&=f.eb!=null;else{f=O.f.kb,Z=(X+1)/2,we=(J+1)/2,te=Math.abs(f.fa),oe=Math.abs(f.Ab);var Ce=Math.abs(f.Db),Pe=Math.abs(f.lb),Se=Pe*(J-1)+X;v&=te*(J-1)+X<=f.Fd,v&=oe*(we-1)+Z<=f.Cd,v=(v&=Ce*(we-1)+Z<=f.Ed)&te>=X&oe>=Z&Ce>=Z,v&=f.y!=null,v&=f.f!=null,v&=f.ea!=null,V==12&&(v&=Pe>=X,v&=Se<=f.Tc,v&=f.F!=null)}else v=0;f=v?0:2}}return f!=0||j!=null&&j.fd&&(f=Sl(O)),f}var ga=64,xo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],go=24,vo=32,Al=8,Za=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ie("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(f){return f},P.Predictor2=function(f,v,j){return v[j+0]},P.Predictor3=function(f,v,j){return v[j+1]},P.Predictor4=function(f,v,j){return v[j-1]},P.Predictor5=function(f,v,j){return ye(ye(f,v[j+1]),v[j+0])},P.Predictor6=function(f,v,j){return ye(f,v[j-1])},P.Predictor7=function(f,v,j){return ye(f,v[j+0])},P.Predictor8=function(f,v,j){return ye(v[j-1],v[j+0])},P.Predictor9=function(f,v,j){return ye(v[j+0],v[j+1])},P.Predictor10=function(f,v,j){return ye(ye(f,v[j-1]),ye(v[j+0],v[j+1]))},P.Predictor11=function(f,v,j){var O=v[j+0];return 0>=Re(O>>24&255,f>>24&255,(v=v[j-1])>>24&255)+Re(O>>16&255,f>>16&255,v>>16&255)+Re(O>>8&255,f>>8&255,v>>8&255)+Re(255&O,255&f,255&v)?O:f},P.Predictor12=function(f,v,j){var O=v[j+0];return(qe((f>>24&255)+(O>>24&255)-((v=v[j-1])>>24&255))<<24|qe((f>>16&255)+(O>>16&255)-(v>>16&255))<<16|qe((f>>8&255)+(O>>8&255)-(v>>8&255))<<8|qe((255&f)+(255&O)-(255&v)))>>>0},P.Predictor13=function(f,v,j){var O=v[j-1];return(De((f=ye(f,v[j+0]))>>24&255,O>>24&255)<<24|De(f>>16&255,O>>16&255)<<16|De(f>>8&255,O>>8&255)<<8|De(f>>0&255,O>>0&255))>>>0};var ud=P.PredictorAdd0;P.PredictorAdd1=Je,ie("Predictor2","PredictorAdd2"),ie("Predictor3","PredictorAdd3"),ie("Predictor4","PredictorAdd4"),ie("Predictor5","PredictorAdd5"),ie("Predictor6","PredictorAdd6"),ie("Predictor7","PredictorAdd7"),ie("Predictor8","PredictorAdd8"),ie("Predictor9","PredictorAdd9"),ie("Predictor10","PredictorAdd10"),ie("Predictor11","PredictorAdd11"),ie("Predictor12","PredictorAdd12"),ie("Predictor13","PredictorAdd13");var jl=P.PredictorAdd2;kt("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),kt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var Kc,En=P.ColorIndexInverseTransform,yo=P.MapARGB,Jc=P.VP8LColorIndexInverseTransformAlpha,Qc=P.MapAlpha,Hs=P.VP8LPredictorsAdd=[];Hs.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var Ei,en,qa,$s,_s,Ss,wo,As,Br,El,Wa,Tn,bo,Zc,Tl,Ti,Ci,zs,Pi,No,Li,Vs,Cl,Cn,Pn,yr,wr,Ur,ra=s(511),js=s(2041),Pl=s(225),_o=s(767),eu=0,dd=js,tu=Pl,xn=_o,Ln=ra,ru=0,au=1,_h=2,nu=3,su=4,fd=5,Sh=6,hd=7,md=8,iu=9,pd=10,r2=[2,3,7],a2=[3,3,11],Ah=[280,256,256,256,40],n2=[0,1,1,1,0],s2=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],i2=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],o2=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],l2=8,xd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],gd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ll=null,c2=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],u2=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],jh=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],d2=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],f2=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],h2=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],m2=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Gs=[],Wn=[],Es=[],p2=1,Eh=2,Ys=[],Fn=[];We("UpsampleRgbLinePair",Xt,3),We("UpsampleBgrLinePair",Cr,3),We("UpsampleRgbaLinePair",qn,4),We("UpsampleBgraLinePair",ia,4),We("UpsampleArgbLinePair",Ca,4),We("UpsampleRgba4444LinePair",Gr,2),We("UpsampleRgb565LinePair",Fr,2);var x2=P.UpsampleRgbLinePair,g2=P.UpsampleBgrLinePair,Th=P.UpsampleRgbaLinePair,Ch=P.UpsampleBgraLinePair,Ph=P.UpsampleArgbLinePair,Lh=P.UpsampleRgba4444LinePair,v2=P.UpsampleRgb565LinePair,ou=16,lu=1<<ou-1,Fl=-227,vd=482,Fh=6,y2=(256<<Fh)-1,kh=0,w2=s(256),b2=s(256),N2=s(256),_2=s(256),S2=s(vd-Fl),A2=s(vd-Fl);ls("YuvToRgbRow",Xt,3),ls("YuvToBgrRow",Cr,3),ls("YuvToRgbaRow",qn,4),ls("YuvToBgraRow",ia,4),ls("YuvToArgbRow",Ca,4),ls("YuvToRgba4444Row",Gr,2),ls("YuvToRgb565Row",Fr,2);var Dh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],cu=[0,2,8],j2=[8,7,6,4,4,2,2,2,1,1,1,1],E2=1;this.WebPDecodeRGBA=function(f,v,j,O,V){var X=au,J=new fo,Z=new ma;J.ba=Z,Z.S=X,Z.width=[Z.width],Z.height=[Z.height];var te=Z.width,oe=Z.height,we=new sr;if(we==null||f==null)var Ce=2;else t(we!=null),Ce=mo(f,v,j,we.width,we.height,we.Pd,we.Qd,we.format,null);if(Ce!=0?te=0:(te!=null&&(te[0]=we.width[0]),oe!=null&&(oe[0]=we.height[0]),te=1),te){Z.width=Z.width[0],Z.height=Z.height[0],O!=null&&(O[0]=Z.width),V!=null&&(V[0]=Z.height);e:{if(O=new St,(V=new gl).data=f,V.w=v,V.ha=j,V.kd=1,v=[0],t(V!=null),((f=mo(V.data,V.w,V.ha,null,null,null,v,null,V))==0||f==7)&&v[0]&&(f=4),(v=f)==0){if(t(J!=null),O.data=V.data,O.w=V.w+V.offset,O.ha=V.ha-V.offset,O.put=Ua,O.ac=Mr,O.bc=ja,O.ma=J,V.xa){if((f=Me())==null){J=1;break e}if(function(Pe,Se){var Ge=[0],Ue=[0],be=[0];t:for(;;){if(Pe==null)return 0;if(Se==null)return Pe.a=2,0;if(Pe.l=Se,Pe.a=0,H(Pe.m,Se.data,Se.w,Se.ha),!_t(Pe.m,Ge,Ue,be)){Pe.a=3;break t}if(Pe.xb=Eh,Se.width=Ge[0],Se.height=Ue[0],!Ee(Ge[0],Ue[0],1,Pe,null))break t;return 1}return t(Pe.a!=0),0}(f,O)){if(O=(v=po(O.width,O.height,J.Oa,J.ba))==0){t:{O=f;r:for(;;){if(O==null){O=0;break t}if(t(O.s.yc!=null),t(O.s.Ya!=null),t(0<O.s.Wb),t((j=O.l)!=null),t((V=j.ma)!=null),O.xb!=0){if(O.ca=V.ba,O.tb=V.tb,t(O.ca!=null),!_l(V.Oa,j,nu)){O.a=2;break r}if(!Te(O,j.width)||j.da)break r;if((j.da||Ot(O.ca.S))&&je(),11>O.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),O.ca.f.kb.F!=null&&je()),O.Pb&&0<O.s.ua&&O.s.vb.X==null&&!st(O.s.vb,O.s.Wa.Xa)){O.a=1;break r}O.xb=0}if(!de(O,O.V,O.Ba,O.c,O.i,j.o,fe))break r;V.Dc=O.Ma,O=1;break t}t(O.a!=0),O=0}O=!O}O&&(v=f.a)}else v=f.a}else{if((f=new Ke)==null){J=1;break e}if(f.Fa=V.na,f.P=V.P,f.qc=V.Sa,vr(f,O)){if((v=po(O.width,O.height,J.Oa,J.ba))==0){if(f.Aa=0,j=J.Oa,t((V=f)!=null),j!=null){if(0<(te=0>(te=j.Md)?0:100<te?255:255*te/100)){for(oe=we=0;4>oe;++oe)12>(Ce=V.pb[oe]).lc&&(Ce.ia=te*j2[0>Ce.lc?0:Ce.lc]>>3),we|=Ce.ia;we&&(alert("todo:VP8InitRandom"),V.ia=1)}V.Ga=j.Id,100<V.Ga?V.Ga=100:0>V.Ga&&(V.Ga=0)}V0(f,O)||(v=f.a)}}else v=f.a}v==0&&J.Oa!=null&&J.Oa.fd&&(v=Sl(J.ba))}J=v}X=J!=0?null:11>X?Z.f.RGBA.eb:Z.f.kb.y}else X=null;return X};var Oh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(P,k){for(var I="",A=0;A<4;A++)I+=String.fromCharCode(P[k++]);return I}function d(P,k){return(P[k+0]<<0|P[k+1]<<8|P[k+2]<<16)>>>0}function m(P,k){return(P[k+0]<<0|P[k+1]<<8|P[k+2]<<16|P[k+3]<<24)>>>0}new c;var g=[0],h=[0],x=[],p=new c,y=e,_=function(P,k){var I={},A=0,b=!1,R=0,W=0;if(I.frames=[],!function(L,D,M,z){for(var ue=0;ue<z;ue++)if(L[D+ue]!=M.charCodeAt(ue))return!0;return!1}(P,k,"RIFF",4)){var Y,q;for(m(P,k+=4),k+=8;k<P.length;){var U=u(P,k),H=m(P,k+=4);k+=4;var Q=H+(1&H);switch(U){case"VP8 ":case"VP8L":I.frames[A]===void 0&&(I.frames[A]={}),(N=I.frames[A]).src_off=b?W:k-8,N.src_size=R+H+8,A++,b&&(b=!1,R=0,W=0);break;case"VP8X":(N=I.header={}).feature_flags=P[k];var ne=k+4;N.canvas_width=1+d(P,ne),ne+=3,N.canvas_height=1+d(P,ne),ne+=3;break;case"ALPH":b=!0,R=Q+8,W=k-8;break;case"ANIM":(N=I.header).bgcolor=m(P,k),ne=k+4,N.loop_count=(Y=P)[(q=ne)+0]<<0|Y[q+1]<<8,ne+=2;break;case"ANMF":var ee,N;(N=I.frames[A]={}).offset_x=2*d(P,k),k+=3,N.offset_y=2*d(P,k),k+=3,N.width=1+d(P,k),k+=3,N.height=1+d(P,k),k+=3,N.duration=d(P,k),k+=3,ee=P[k++],N.dispose=1&ee,N.blend=ee>>1&1}U!="ANMF"&&(k+=Q)}return I}}(y,0);_.response=y,_.rgbaoutput=!0,_.dataurl=!1;var S=_.header?_.header:null,E=_.frames?_.frames:null;if(S){S.loop_counter=S.loop_count,g=[S.canvas_height],h=[S.canvas_width];for(var C=0;C<E.length&&E[C].blend!=0;C++);}var F=E[0],B=p.WebPDecodeRGBA(y,F.src_off,F.src_size,h,g);F.rgba=B,F.imgwidth=h[0],F.imgheight=g[0];for(var T=0;T<h[0]*g[0]*4;T++)x[T]=B[T];return this.width=h,this.height=g,this.data=x,this}(function(e){var t=function(){return typeof Af=="function"},r=function(g,h,x,p){var y=4,_=o;switch(p){case e.image_compression.FAST:y=1,_=s;break;case e.image_compression.MEDIUM:y=6,_=l;break;case e.image_compression.SLOW:y=9,_=c}g=a(g,h,x,_);var S=Af(g,{level:y});return e.__addimage__.arrayBufferToBinaryString(S)},a=function(g,h,x,p){for(var y,_,S,E=g.length/h,C=new Uint8Array(g.length+E),F=d(),B=0;B<E;B+=1){if(S=B*h,y=g.subarray(S,S+h),p)C.set(p(y,x,_),S+B);else{for(var T,P=F.length,k=[];T<P;T+=1)k[T]=F[T](y,x,_);var I=m(k.concat());C.set(k[I],S+B)}_=y}return C},n=function(g){var h=Array.apply([],g);return h.unshift(0),h},s=function(g,h){var x,p=[],y=g.length;p[0]=1;for(var _=0;_<y;_+=1)x=g[_-h]||0,p[_+1]=g[_]-x+256&255;return p},o=function(g,h,x){var p,y=[],_=g.length;y[0]=2;for(var S=0;S<_;S+=1)p=x&&x[S]||0,y[S+1]=g[S]-p+256&255;return y},l=function(g,h,x){var p,y,_=[],S=g.length;_[0]=3;for(var E=0;E<S;E+=1)p=g[E-h]||0,y=x&&x[E]||0,_[E+1]=g[E]+256-(p+y>>>1)&255;return _},c=function(g,h,x){var p,y,_,S,E=[],C=g.length;E[0]=4;for(var F=0;F<C;F+=1)p=g[F-h]||0,y=x&&x[F]||0,_=x&&x[F-h]||0,S=u(p,y,_),E[F+1]=g[F]-S+256&255;return E},u=function(g,h,x){if(g===h&&h===x)return g;var p=Math.abs(h-x),y=Math.abs(g-x),_=Math.abs(g+h-x-x);return p<=y&&p<=_?g:y<=_?h:x},d=function(){return[n,s,o,l,c]},m=function(g){var h=g.map(function(x){return x.reduce(function(p,y){return p+Math.abs(y)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(g,h,x,p){var y,_,S,E,C,F,B,T,P,k,I,A,b,R,W,Y=this.decode.FLATE_DECODE,q="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(S=new TE(g)).imgData,_=S.bits,y=S.colorSpace,C=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){P=(T=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,I=new Uint8Array(P*S.colors),k=new Uint8Array(P);var U,H=S.pixelBitlength-S.bits;for(R=0,W=0;R<P;R++){for(b=T[R],U=0;U<H;)I[W++]=b>>>U&255,U+=S.bits;k[R]=b>>>U&255}}if(S.bits===16){P=(T=new Uint32Array(S.decodePixels().buffer)).length,I=new Uint8Array(P*(32/S.pixelBitlength)*S.colors),k=new Uint8Array(P*(32/S.pixelBitlength)),A=S.colors>1,R=0,W=0;for(var Q=0;R<P;)b=T[R++],I[W++]=b>>>0&255,A&&(I[W++]=b>>>16&255,b=T[R++],I[W++]=b>>>0&255),k[Q++]=b>>>16&255;_=8}p!==e.image_compression.NONE&&t()?(g=r(I,S.width*S.colors,S.colors,p),B=r(k,S.width,1,p)):(g=I,B=k,Y=void 0)}if(S.colorType===3&&(y=this.color_spaces.INDEXED,F=S.palette,S.transparency.indexed)){var ne=S.transparency.indexed,ee=0;for(R=0,P=ne.length;R<P;++R)ee+=ne[R];if((ee/=255)===P-1&&ne.indexOf(0)!==-1)E=[ne.indexOf(0)];else if(ee!==P){for(T=S.decodePixels(),k=new Uint8Array(T.length),R=0,P=T.length;R<P;R++)k[R]=ne[T[R]];B=r(k,S.width,1)}}var N=function(L){var D;switch(L){case e.image_compression.FAST:D=11;break;case e.image_compression.MEDIUM:D=13;break;case e.image_compression.SLOW:D=14;break;default:D=12}return D}(p);return Y===this.decode.FLATE_DECODE&&(q="/Predictor "+N+" "),q+="/Colors "+C+" /BitsPerComponent "+_+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(B&&this.__addimage__.isArrayBuffer(B)||this.__addimage__.isArrayBufferView(B))&&(B=this.__addimage__.arrayBufferToBinaryString(B)),{alias:x,data:g,index:h,filter:Y,decodeParameters:q,transparency:E,palette:F,sMask:B,predictor:N,width:S.width,height:S.height,bitsPerComponent:_,colorSpace:y}}}})(Tt.API),function(e){e.processGIF89A=function(t,r,a,n){var s=new CE(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new ef(100).encode(u,100);return e.processJPEG.call(this,d,r,a,n)},e.processGIF87A=e.processGIF89A}(Tt.API),Gn.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Gn.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){xr.log("bit decode error:"+r)}},Gn.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,l=0;l<8&&8*n+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Gn.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*n+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Gn.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Gn.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=a*this.width*4+4*n;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},Gn.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=n*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},Gn.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},Gn.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=o}},Gn.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var s=new Gn(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new ef(100).encode(c,100);return e.processJPEG.call(this,u,r,a,n)}}(Tt.API),zp.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var s=new zp(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new ef(100).encode(c,100);return e.processJPEG.call(this,u,r,a,n)}}(Tt.API),Tt.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,s=new Uint8Array(n/4*3),o=new Uint8Array(n/4),l=0,c=0,u=0;u<n;u+=4){var d=a[u],m=a[u+1],g=a[u+2],h=a[u+3];s[l++]=d,s[l++]=m,s[l++]=g,o[c++]=h}var x=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Tt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ro=Tt.API,Ru=Ro.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:n.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:n.metadata.Unicode.kerning,d=u.fof?u.fof:1,m=t.doKerning!==!1,g=0,h=e.length,x=0,p=l[0]||c,y=[];for(r=0;r<h;r++)a=e.charCodeAt(r),typeof n.metadata.widthOfString=="function"?y.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/s)||0)/1e3):(g=m&&ar(u[a])==="object"&&!isNaN(parseInt(u[a][x],10))?u[a][x]/d:0,y.push((l[a]||p)/c+g)),x=a;return y},qp=Ro.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Ro.processArabic&&(e=Ro.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,n)/r:Ru.apply(this,arguments).reduce(function(s,o){return s+o},0)},Wp=function(e,t,r,a){for(var n=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;n.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>a&&(n.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&n.push(e.slice(c,s)),n},Hp=function(e,t,r){r||(r={});var a,n,s,o,l,c,u,d=[],m=[d],g=r.textIndent||0,h=0,x=0,p=e.split(" "),y=Ru.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var _=Array(c).join(" "),S=[];p.map(function(C){(C=C.split(/\s*\n/)).length>1?S=S.concat(C.map(function(F,B){return(B&&F.length?`
`:"")+F})):S.push(C[0])}),p=S,c=qp.apply(this,[_,r])}for(s=0,o=p.length;s<o;s++){var E=0;if(a=p[s],c&&a[0]==`
`&&(a=a.substr(1),E=1),g+h+(x=(n=Ru.apply(this,[a,r])).reduce(function(C,F){return C+F},0))>t||E){if(x>t){for(l=Wp.apply(this,[a,n,t-(g+h),t]),d.push(l.shift()),d=[l.pop()];l.length;)m.push([l.shift()]);x=n.slice(a.length-(d[0]?d[0].length:0)).reduce(function(C,F){return C+F},0)}else d=[a];m.push(d),g=x+c,h=y}else d.push(a),g+=h+x,h=y}return u=c?function(C,F){return(F?_:"")+C.join(" ")}:function(C){return C.join(" ")},m.map(u)},Ro.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var m=this.internal.getFont(d.fontName,d.fontStyle);return m.metadata.Unicode?{widths:m.metadata.Unicode.widths||{0:1},kerning:m.metadata.Unicode.kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=a.length;l<c;l++)u=u.concat(Hp.apply(this,[a[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},a={},n=0;n<t.length;n++)r[t[n]]="0123456789abcdef"[n],a["0123456789abcdef"[n]]=t[n];var s=function(m){return"0x"+parseInt(m,10).toString(16)},o=e.__fontmetrics__.compress=function(m){var g,h,x,p,y=["{"];for(var _ in m){if(g=m[_],isNaN(parseInt(_,10))?h="'"+_+"'":(_=parseInt(_,10),h=(h=s(_).slice(2)).slice(0,-1)+a[h.slice(-1)]),typeof g=="number")g<0?(x=s(g).slice(3),p="-"):(x=s(g).slice(2),p=""),x=p+x.slice(0,-1)+a[x.slice(-1)];else{if(ar(g)!=="object")throw new Error("Don't know what to do with value type "+ar(g)+".");x=o(g)}y.push(h+x)}return y.push("}"),y.join("")},l=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,h,x,p,y={},_=1,S=y,E=[],C="",F="",B=m.length-1,T=1;T<B;T+=1)(p=m[T])=="'"?g?(x=g.join(""),g=void 0):g=[]:g?g.push(p):p=="{"?(E.push([S,x]),S={},x=void 0):p=="}"?((h=E.pop())[0][h[1]]=S,x=void 0,S=h[0]):p=="-"?_=-1:x===void 0?r.hasOwnProperty(p)?(C+=r[p],x=parseInt(C,16)*_,_=1,C=""):C+=p:r.hasOwnProperty(p)?(F+=r[p],S[x]=parseInt(F,16)*_,_=1,x=void 0,F=""):F+=p;return y},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var g=m.font,h=d.Unicode[g.postScriptName];h&&(g.metadata.Unicode={},g.metadata.Unicode.widths=h.widths,g.metadata.Unicode.kerning=h.kerning);var x=u.Unicode[g.postScriptName];x&&(g.metadata.Unicode.encoding=x,g.encoding=x.codePages[0])}])}(Tt.API),function(e){var t=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(lc(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])}(Tt),function(e){function t(){return(Ft.canvg?Promise.resolve(Ft.canvg):Ga(()=>import("./index.es-f73a5d93.js"),["assets/index.es-f73a5d93.js","assets/vendor-348d559c.js","assets/ui-58a945e4.js","assets/charts-bc1c71da.js"])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Tt.API.addSvgAsImage=function(r,a,n,s,o,l,c,u){if(isNaN(a)||isNaN(n))throw xr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(o))throw xr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=s,d.height=o;var m=d.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,d.width,d.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(x){return x.fromString(m,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(g)}).then(function(){h.addImage(d.toDataURL("image/jpeg",1),a,n,s,o,c,u)})}}(),Tt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},Tt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,m=0;function g(x,p){var y,_=!1;for(y=0;y<x.length;y+=1)x[y]===p&&(_=!0);return _}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(m=0;m<h;m+=1)r[l[m]].value=r[l[m]].defaultValue,r[l[m]].explicitSet=!1}if(ar(e)==="object"){for(n in e)if(s=e[n],g(l,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&g(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(u=0;u<s.length;u+=1)if(a=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(a=!1);a===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[n].value="["+c.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,p=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?p.push("/"+x+" /"+r[x].value):p.push("/"+x+" "+r[x].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(n+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Tt.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],m=0,g=s.length;m<g;++m){if(l=o.metadata.characterToGlyph(s.charCodeAt(m)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(m),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},a=function(s){var o,l,c,u,d,m,g;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,g=(l=Object.keys(s).sort(function(h,x){return h-x})).length;m<g;m++)o=l[m],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var m=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",x=0;x<g.length;x++)h+=String.fromCharCode(g[x]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var y=u();d({data:a(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var _=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+zo(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var S=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+zo(l.fontName)),c("/FontDescriptor "+_+" 0 R"),c("/W "+e.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+zo(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+S+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var m=l.metadata.rawData,g="",h=0;h<m.length;h++)g+=String.fromCharCode(m[h]);var x=u();d({data:g,addLength1:!0,objectId:x}),c("endobj");var p=u();d({data:a(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+zo(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var _=0;_<l.metadata.hmtx.widths.length;_++)l.metadata.hmtx.widths[_]=parseInt(l.metadata.hmtx.widths[_]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+zo(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var n=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},m=s.mutex||{},g=m.pdfEscape,h=m.activeFontKey,x=m.fonts,p=h,y="",_=0,S="",E=x[p].encoding;if(x[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:m};for(S=l,p=h,Array.isArray(l)&&(S=l[0]),_=0;_<S.length;_+=1)x[p].metadata.hasOwnProperty("cmap")&&(o=x[p].metadata.cmap.unicode.codeMap[S[_].charCodeAt(0)]),o||S[_].charCodeAt(0)<256&&x[p].metadata.hasOwnProperty("Unicode")?y+=S[_]:y+="";var C="";return parseInt(p.slice(1))<14||E==="WinAnsiEncoding"?C=g(y,p).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(C=r(y,x[p])),m.isHex=!0,{text:C,x:c,y:u,options:d,mutex:m}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([n(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(n(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=n(Object.assign({},c,{text:o})).text}])}(Tt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Tt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var n,s,o,l,c,u,d,m=t,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],_=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,E=0;this.__bidiEngine__={};var C=function(A){var b=A.charCodeAt(),R=b>>8,W=p[R];return W!==void 0?m[256*W+(255&b)]:R===252||R===253?"AL":_.test(R)?"L":R===8?"R":"N"},F=function(A){for(var b,R=0;R<A.length;R++){if((b=C(A.charAt(R)))==="L")return!1;if(b==="R")return!0}return!1},B=function(A,b,R,W){var Y,q,U,H,Q=b[W];switch(Q){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(Q="AN");break;case"AL":S=!0,Q="R";break;case"WS":Q="N";break;case"CS":W<1||W+1>=b.length||(Y=R[W-1])!=="EN"&&Y!=="AN"||(q=b[W+1])!=="EN"&&q!=="AN"?Q="N":S&&(q="AN"),Q=q===Y?q:"N";break;case"ES":Q=(Y=W>0?R[W-1]:"B")==="EN"&&W+1<b.length&&b[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&R[W-1]==="EN"){Q="EN";break}if(S){Q="N";break}for(U=W+1,H=b.length;U<H&&b[U]==="ET";)U++;Q=U<H&&b[U]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(H=b.length,U=W+1;U<H&&b[U]==="NSM";)U++;if(U<H){var ne=A[W],ee=ne>=1425&&ne<=2303||ne===64286;if(Y=b[U],ee&&(Y==="R"||Y==="AL")){Q="R";break}}}Q=W<1||(Y=b[W-1])==="B"?"N":R[W-1];break;case"B":S=!1,n=!0,Q=E;break;case"S":s=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":Q="N"}return Q},T=function(A,b,R){var W=A.split("");return R&&P(W,R,{hiLevel:E}),W.reverse(),b&&b.reverse(),W.join("")},P=function(A,b,R){var W,Y,q,U,H,Q=-1,ne=A.length,ee=0,N=[],L=E?h:g,D=[];for(S=!1,n=!1,s=!1,Y=0;Y<ne;Y++)D[Y]=C(A[Y]);for(q=0;q<ne;q++){if(H=ee,N[q]=B(A,D,N,q),W=240&(ee=L[H][x[N[q]]]),ee&=15,b[q]=U=L[ee][5],W>0)if(W===16){for(Y=Q;Y<q;Y++)b[Y]=1;Q=-1}else Q=-1;if(L[ee][6])Q===-1&&(Q=q);else if(Q>-1){for(Y=Q;Y<q;Y++)b[Y]=U;Q=-1}D[q]==="B"&&(b[q]=0),R.hiLevel|=U}s&&function(M,z,ue){for(var pe=0;pe<ue;pe++)if(M[pe]==="S"){z[pe]=E;for(var me=pe-1;me>=0&&M[me]==="WS";me--)z[me]=E}}(D,b,ne)},k=function(A,b,R,W,Y){if(!(Y.hiLevel<A)){if(A===1&&E===1&&!n)return b.reverse(),void(R&&R.reverse());for(var q,U,H,Q,ne=b.length,ee=0;ee<ne;){if(W[ee]>=A){for(H=ee+1;H<ne&&W[H]>=A;)H++;for(Q=ee,U=H-1;Q<U;Q++,U--)q=b[Q],b[Q]=b[U],b[U]=q,R&&(q=R[Q],R[Q]=R[U],R[U]=q);ee=H}ee++}}},I=function(A,b,R){var W=A.split(""),Y={hiLevel:E};return R||(R=[]),P(W,R,Y),function(q,U,H){if(H.hiLevel!==0&&d)for(var Q,ne=0;ne<q.length;ne++)U[ne]===1&&(Q=y.indexOf(q[ne]))>=0&&(q[ne]=y[Q+1])}(W,R,Y),k(2,W,b,R,Y),k(1,W,b,R,Y),W.join("")};return this.__bidiEngine__.doBidiReorder=function(A,b,R){if(function(Y,q){if(q)for(var U=0;U<Y.length;U++)q[U]=U;l===void 0&&(l=F(Y)),u===void 0&&(u=F(Y))}(A,b),o||!c||u)if(o&&c&&l^u)E=l?1:0,A=T(A,b,R);else if(!o&&c&&u)E=l?1:0,A=I(A,b,R),A=T(A,b);else if(!o||l||c||u){if(o&&!c&&l^u)A=T(A,b),l?(E=0,A=I(A,b,R)):(E=1,A=I(A,b,R),A=T(A,b));else if(o&&l&&!c&&u)E=1,A=I(A,b,R),A=T(A,b);else if(!o&&!c&&l^u){var W=d;l?(E=1,A=I(A,b,R),E=0,d=!1,A=I(A,b,R),d=W):(E=0,A=I(A,b,R),A=T(A,b),E=1,d=!1,A=I(A,b,R),d=W,A=T(A,b))}}else E=0,A=I(A,b,R);else E=l?1:0,A=I(A,b,R);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,c=A.isOutputVisual,l=A.isInputRtl,u=A.isOutputRtl,d=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var n=a.text,s=(a.x,a.y,a.options||{}),o=(a.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var l=0;for(o=[],l=0;l<n.length;l+=1)Object.prototype.toString.call(n[l])==="[object Array]"?o.push([r.doBidiReorder(n[l][0]),n[l][1],n[l][2]]):o.push([r.doBidiReorder(n[l])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])}(Tt),Tt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new bi(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new $E(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new PE(this.contents),this.head=new FE(this),this.name=new RE(this),this.cmap=new Jg(this),this.toUnicode={},this.hhea=new kE(this),this.maxp=new ME(this),this.hmtx=new BE(this),this.post=new OE(this),this.os2=new DE(this),this.loca=new HE(this),this.glyf=new UE(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var n,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)n=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var ss,bi=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,n,s,o,l,c;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,n,s;for(s=[],a=0,n=t.length;a<n;a++)r=t[a],s.push(this.writeByte(r));return s},e}(),PE=function(){var e;function t(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,s,o,l,c,u,d,m,g,h,x,p;for(p in h=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(h)/c),o=Math.floor(m/c),d=16*h-m,(n=new bi).writeInt(this.scalarType),n.writeShort(h),n.writeShort(m),n.writeShort(o),n.writeShort(d),s=16*h,u=n.pos+s,l=null,x=[],r)for(g=r[p],n.writeString(p),n.writeInt(e(g)),n.writeInt(u),n.writeInt(g.length),x=x.concat(g),p==="head"&&(l=u),u+=g.length;u%4;)x.push(0),u++;return n.write(x),a=2981146554-e(n.data),n.pos=l+8,n.writeUInt32(a),n.data},e=function(r){var a,n,s,o;for(r=Qg.call(r);r.length%4;)r.push(0);for(s=new bi(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=s.readUInt32();return 4294967295&n},t}(),LE={}.hasOwnProperty,ws=function(e,t){for(var r in t)LE.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};ss=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var FE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var a;return(a=new bi).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},t}(),Vp=function(){function e(t,r){var a,n,s,o,l,c,u,d,m,g,h,x,p,y,_,S,E;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),m=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),g=h/2,t.pos+=6,s=function(){var C,F;for(F=[],c=C=0;0<=g?C<g:C>g;c=0<=g?++C:--C)F.push(t.readUInt16());return F}(),t.pos+=2,p=function(){var C,F;for(F=[],c=C=0;0<=g?C<g:C>g;c=0<=g?++C:--C)F.push(t.readUInt16());return F}(),u=function(){var C,F;for(F=[],c=C=0;0<=g?C<g:C>g;c=0<=g?++C:--C)F.push(t.readUInt16());return F}(),d=function(){var C,F;for(F=[],c=C=0;0<=g?C<g:C>g;c=0<=g?++C:--C)F.push(t.readUInt16());return F}(),n=(this.length-t.pos+this.offset)/2,l=function(){var C,F;for(F=[],c=C=0;0<=n?C<n:C>n;c=0<=n?++C:--C)F.push(t.readUInt16());return F}(),c=_=0,E=s.length;_<E;c=++_)for(y=s[c],a=S=x=p[c];x<=y?S<=y:S>=y;a=x<=y?++S:--S)d[c]===0?o=a+u[c]:(o=l[d[c]/2+(a-x)-(g-c)]||0)!==0&&(o+=u[c]),this.codeMap[a]=65535&o}t.pos=m}return e.encode=function(t,r){var a,n,s,o,l,c,u,d,m,g,h,x,p,y,_,S,E,C,F,B,T,P,k,I,A,b,R,W,Y,q,U,H,Q,ne,ee,N,L,D,M,z,ue,pe,me,Ne,Oe,Ie;switch(W=new bi,o=Object.keys(t).sort(function(Ze,st){return Ze-st}),r){case"macroman":for(p=0,y=function(){var Ze=[];for(x=0;x<256;++x)Ze.push(0);return Ze}(),S={0:0},s={},Y=0,Q=o.length;Y<Q;Y++)S[me=t[n=o[Y]]]==null&&(S[me]=++p),s[n]={old:t[n],new:S[t[n]]},y[n]=S[t[n]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(y),{charMap:s,subtable:W.data,maxGlyphID:p+1};case"unicode":for(b=[],m=[],E=0,S={},a={},_=u=null,q=0,ne=o.length;q<ne;q++)S[F=t[n=o[q]]]==null&&(S[F]=++E),a[n]={old:F,new:S[F]},l=S[F]-n,_!=null&&l===u||(_&&m.push(_),b.push(n),u=l),_=n;for(_&&m.push(_),m.push(65535),b.push(65535),I=2*(k=b.length),P=2*Math.pow(Math.log(k)/Math.LN2,2),g=Math.log(P/2)/Math.LN2,T=2*k-P,c=[],B=[],h=[],x=U=0,ee=b.length;U<ee;x=++U){if(A=b[x],d=m[x],A===65535){c.push(0),B.push(0);break}if(A-(R=a[A].new)>=32768)for(c.push(0),B.push(2*(h.length+k-x)),n=H=A;A<=d?H<=d:H>=d;n=A<=d?++H:--H)h.push(a[n].new);else c.push(R-A),B.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*k+2*h.length),W.writeUInt16(0),W.writeUInt16(I),W.writeUInt16(P),W.writeUInt16(g),W.writeUInt16(T),ue=0,N=m.length;ue<N;ue++)n=m[ue],W.writeUInt16(n);for(W.writeUInt16(0),pe=0,L=b.length;pe<L;pe++)n=b[pe],W.writeUInt16(n);for(Ne=0,D=c.length;Ne<D;Ne++)l=c[Ne],W.writeUInt16(l);for(Oe=0,M=B.length;Oe<M;Oe++)C=B[Oe],W.writeUInt16(C);for(Ie=0,z=h.length;Ie<z;Ie++)p=h[Ie],W.writeUInt16(p);return{charMap:a,subtable:W.data,maxGlyphID:E+1}}},e}(),Jg=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="cmap",t.prototype.parse=function(r){var a,n,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)a=new Vp(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(r,a){var n,s;return a==null&&(a="macroman"),n=Vp.encode(r,a),(s=new bi).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),kE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),DE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var a,n;for(n=[],a=0;a<10;++a)n.push(r.readByte());return n}(),this.charRange=function(){var a,n;for(n=[],a=0;a<4;++a)n.push(r.readInt());return n}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var a,n;for(n=[],a=0;a<2;a=++a)n.push(r.readInt());return n}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),OE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="post",t.prototype.parse=function(r){var a,n,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(n=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)a=r.readByte(),s.push(this.names.push(r.readString(a)));return s;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var l,c,u;for(u=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)u.push(r.readUInt32());return u}).call(this)}},t}(),IE=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},RE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="name",t.prototype.parse=function(r){var a,n,s,o,l,c,u,d,m,g,h;for(r.pos=this.offset,r.readShort(),a=r.readShort(),c=r.readShort(),n=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},o=m=0,g=n.length;m<g;o=++m)s=n[o],r.pos=s.offset,d=r.readString(s.length),l=new IE(d,s),u[h=s.nameID]==null&&(u[h]=[]),u[s.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t}(),ME=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),BE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="hmtx",t.prototype.parse=function(r){var a,n,s,o,l,c,u;for(r.pos=this.offset,this.metrics=[],a=0,c=this.file.hhea.numberOfMetrics;0<=c?a<c:a>c;a=0<=c?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,m;for(m=[],a=d=0;0<=s?d<s:d>s;a=0<=s?++d:--d)m.push(r.readInt16());return m}(),this.widths=(function(){var d,m,g,h;for(h=[],d=0,m=(g=this.metrics).length;d<m;d++)o=g[d],h.push(o.advance);return h}).call(this),n=this.widths[this.widths.length-1],u=[],a=l=0;0<=s?l<s:l>s;a=0<=s?++l:--l)u.push(this.widths.push(n));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),Qg=[].slice,UE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var a,n,s,o,l,c,u,d,m,g;return r in this.cache?this.cache[r]:(o=this.file.loca,a=this.file.contents,n=o.indexOf(r),(s=o.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+n,l=(c=new bi(a.read(s))).readShort(),d=c.readShort(),g=c.readShort(),u=c.readShort(),m=c.readShort(),this.cache[r]=l===-1?new WE(c,d,g,u,m):new qE(c,l,d,g,u,m),this.cache[r]))},t.prototype.encode=function(r,a,n){var s,o,l,c,u;for(l=[],o=[],c=0,u=a.length;c<u;c++)s=r[a[c]],o.push(l.length),s&&(l=l.concat(s.encode(n)));return o.push(l.length),{table:l,offsets:o}},t}(),qE=function(){function e(t,r,a,n,s,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),WE=function(){function e(t,r,a,n,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new bi(Qg.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),HE=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ws(t,ss),t.prototype.tag="loca",t.prototype.parse=function(r){var a,n;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,a){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,l=0;l<n.length;++l)if(n[l]=s,o<a.length&&a[o]==l){++o,n[l]=s;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(s+=u)}for(var d=new Array(4*n.length),m=0;m<n.length;++m)d[4*m+3]=255&n[m],d[4*m+2]=(65280&n[m])>>8,d[4*m+1]=(16711680&n[m])>>16,d[4*m]=(4278190080&n[m])>>24;return d},t}(),$E=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,t={},s=this.subset)a=s[r],t[r]=n[a];return t},e.prototype.glyphsFor=function(t){var r,a,n,s,o,l,c;for(n={},o=0,l=t.length;o<l;o++)n[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))a=c[s],n[s]=a;return n},e.prototype.encode=function(t,r){var a,n,s,o,l,c,u,d,m,g,h,x,p,y,_;for(n in a=Jg.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),h={0:0},_=a.charMap)h[(c=_[n]).old]=c.new;for(x in g=a.maxGlyphID,o)x in h||(h[x]=g++);return d=function(S){var E,C;for(E in C={},S)C[S[E]]=E;return C}(h),m=Object.keys(d).sort(function(S,E){return S-E}),p=function(){var S,E,C;for(C=[],S=0,E=m.length;S<E;S++)l=m[S],C.push(d[l]);return C}(),s=this.font.glyf.encode(o,p,h),u=this.font.loca.encode(s.offsets,p),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Tt.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)a=r[l],u.push(t.convert(a));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)o=r[n],s.push("/"+n+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();const zE=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:NE,AcroFormAppearance:Nt,AcroFormButton:sa,AcroFormCheckBox:dc,AcroFormChoiceField:Hi,AcroFormComboBox:zi,AcroFormEditBox:cc,AcroFormListBox:$i,AcroFormPasswordField:fc,AcroFormPushButton:uc,AcroFormRadioButton:Vi,AcroFormTextField:di,GState:_c,ShadingPattern:ii,TilingPattern:qi,default:Tt,jsPDF:Tt},Symbol.toStringTag,{value:"Module"}));var VE={exports:{}};const GE=W2(zE);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(a,n){e.exports=n(function(){try{return GE}catch{}}())})(typeof globalThis<"u"?globalThis:typeof Td<"u"?Td:typeof window<"u"?window:typeof self<"u"?self:Td,function(r){return function(){var a={172:function(l,c){var u=this&&this.__extends||function(){var g=function(h,x){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,y){p.__proto__=y}||function(p,y){for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(p[_]=y[_])},g(h,x)};return function(h,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");g(h,x);function p(){this.constructor=h}h.prototype=x===null?Object.create(x):(p.prototype=x.prototype,new p)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.CellHookData=c.HookData=void 0;var d=function(){function g(h,x,p){this.table=x,this.pageNumber=x.pageNumber,this.pageCount=this.pageNumber,this.settings=x.settings,this.cursor=p,this.doc=h.getDocument()}return g}();c.HookData=d;var m=function(g){u(h,g);function h(x,p,y,_,S,E){var C=g.call(this,x,p,E)||this;return C.cell=y,C.row=_,C.column=S,C.section=_.section,C}return h}(d);c.CellHookData=m},340:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0});var d=u(4),m=u(136),g=u(744),h=u(776),x=u(664),p=u(972);function y(_){_.API.autoTable=function(){for(var S=[],E=0;E<arguments.length;E++)S[E]=arguments[E];var C;S.length===1?C=S[0]:(console.error("Use of deprecated autoTable initiation"),C=S[2]||{},C.columns=S[0],C.body=S[1]);var F=(0,h.parseInput)(this,C),B=(0,p.createTable)(this,F);return(0,x.drawTable)(this,B),this},_.API.lastAutoTable=!1,_.API.previousAutoTable=!1,_.API.autoTable.previous=!1,_.API.autoTableText=function(S,E,C,F){(0,m.default)(S,E,C,F,this)},_.API.autoTableSetDefaults=function(S){return g.DocHandler.setDefaults(S,this),this},_.autoTableSetDefaults=function(S,E){g.DocHandler.setDefaults(S,E)},_.API.autoTableHtmlToJson=function(S,E){var C;if(E===void 0&&(E=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var F=new g.DocHandler(this),B=(0,d.parseHtml)(F,S,window,E,!1),T=B.head,P=B.body,k=((C=T[0])===null||C===void 0?void 0:C.map(function(I){return I.content}))||[];return{columns:k,rows:P,data:P}},_.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var S=this.lastAutoTable;return S&&S.finalY?S.finalY:0},_.API.autoTableAddPageContent=function(S){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),_.API.autoTable.globalDefaults||(_.API.autoTable.globalDefaults={}),_.API.autoTable.globalDefaults.addPageContent=S,this},_.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}c.default=y},136:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function u(d,m,g,h,x){h=h||{};var p=1.15,y=x.internal.scaleFactor,_=x.internal.getFontSize()/y,S=x.getLineHeightFactor?x.getLineHeightFactor():p,E=_*S,C=/\r\n|\r|\n/g,F="",B=1;if((h.valign==="middle"||h.valign==="bottom"||h.halign==="center"||h.halign==="right")&&(F=typeof d=="string"?d.split(C):d,B=F.length||1),g+=_*(2-p),h.valign==="middle"?g-=B/2*E:h.valign==="bottom"&&(g-=B*E),h.halign==="center"||h.halign==="right"){var T=_;if(h.halign==="center"&&(T*=.5),F&&B>=1){for(var P=0;P<F.length;P++)x.text(F[P],m-x.getStringUnitWidth(F[P])*T,g),g+=E;return x}m-=x.getStringUnitWidth(d)*T}return h.halign==="justify"?x.text(d,m,g,{maxWidth:h.maxWidth||100,align:"justify"}):x.text(d,m,g),x}c.default=u},420:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.getPageAvailableWidth=c.parseSpacing=c.getFillStyle=c.addTableBorder=c.getStringWidth=void 0;function u(x,p,y){y.applyStyles(p,!0);var _=Array.isArray(x)?x:[x],S=_.map(function(E){return y.getTextWidth(E)}).reduce(function(E,C){return Math.max(E,C)},0);return S}c.getStringWidth=u;function d(x,p,y,_){var S=p.settings.tableLineWidth,E=p.settings.tableLineColor;x.applyStyles({lineWidth:S,lineColor:E});var C=m(S,!1);C&&x.rect(y.x,y.y,p.getWidth(x.pageSize().width),_.y-y.y,C)}c.addTableBorder=d;function m(x,p){var y=x>0,_=p||p===0;return y&&_?"DF":y?"S":_?"F":null}c.getFillStyle=m;function g(x,p){var y,_,S,E;if(x=x||p,Array.isArray(x)){if(x.length>=4)return{top:x[0],right:x[1],bottom:x[2],left:x[3]};if(x.length===3)return{top:x[0],right:x[1],bottom:x[2],left:x[1]};if(x.length===2)return{top:x[0],right:x[1],bottom:x[0],left:x[1]};x.length===1?x=x[0]:x=p}return typeof x=="object"?(typeof x.vertical=="number"&&(x.top=x.vertical,x.bottom=x.vertical),typeof x.horizontal=="number"&&(x.right=x.horizontal,x.left=x.horizontal),{left:(y=x.left)!==null&&y!==void 0?y:p,top:(_=x.top)!==null&&_!==void 0?_:p,right:(S=x.right)!==null&&S!==void 0?S:p,bottom:(E=x.bottom)!==null&&E!==void 0?E:p}):(typeof x!="number"&&(x=p),{top:x,right:x,bottom:x,left:x})}c.parseSpacing=g;function h(x,p){var y=g(p.settings.margin,0);return x.pageSize().width-(y.left+y.right)}c.getPageAvailableWidth=h},796:function(l,c){var u=this&&this.__extends||function(){var h=function(x,p){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,_){y.__proto__=_}||function(y,_){for(var S in _)Object.prototype.hasOwnProperty.call(_,S)&&(y[S]=_[S])},h(x,p)};return function(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Class extends value "+String(p)+" is not a constructor or null");h(x,p);function y(){this.constructor=x}x.prototype=p===null?Object.create(p):(y.prototype=p.prototype,new y)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.getTheme=c.defaultStyles=c.HtmlRowInput=void 0;var d=function(h){u(x,h);function x(p){var y=h.call(this)||this;return y._element=p,y}return x}(Array);c.HtmlRowInput=d;function m(h){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/h,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}c.defaultStyles=m;function g(h){var x={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return x[h]}c.getTheme=g},903:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.parseCss=void 0;var d=u(420);function m(y,_,S,E,C){var F={},B=1.3333333333333333,T=h(_,function(Q){return C.getComputedStyle(Q).backgroundColor});T!=null&&(F.fillColor=T);var P=h(_,function(Q){return C.getComputedStyle(Q).color});P!=null&&(F.textColor=P);var k=p(E,S);k&&(F.cellPadding=k);var I="borderTopColor",A=B*S,b=E.borderTopWidth;if(E.borderBottomWidth===b&&E.borderRightWidth===b&&E.borderLeftWidth===b){var R=(parseFloat(b)||0)/A;R&&(F.lineWidth=R)}else F.lineWidth={top:(parseFloat(E.borderTopWidth)||0)/A,right:(parseFloat(E.borderRightWidth)||0)/A,bottom:(parseFloat(E.borderBottomWidth)||0)/A,left:(parseFloat(E.borderLeftWidth)||0)/A},F.lineWidth.top||(F.lineWidth.right?I="borderRightColor":F.lineWidth.bottom?I="borderBottomColor":F.lineWidth.left&&(I="borderLeftColor"));var W=h(_,function(Q){return C.getComputedStyle(Q)[I]});W!=null&&(F.lineColor=W);var Y=["left","right","center","justify"];Y.indexOf(E.textAlign)!==-1&&(F.halign=E.textAlign),Y=["middle","bottom","top"],Y.indexOf(E.verticalAlign)!==-1&&(F.valign=E.verticalAlign);var q=parseInt(E.fontSize||"");isNaN(q)||(F.fontSize=q/B);var U=g(E);U&&(F.fontStyle=U);var H=(E.fontFamily||"").toLowerCase();return y.indexOf(H)!==-1&&(F.font=H),F}c.parseCss=m;function g(y){var _="";return(y.fontWeight==="bold"||y.fontWeight==="bolder"||parseInt(y.fontWeight)>=700)&&(_="bold"),(y.fontStyle==="italic"||y.fontStyle==="oblique")&&(_+="italic"),_}function h(y,_){var S=x(y,_);if(!S)return null;var E=S.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!E||!Array.isArray(E))return null;var C=[parseInt(E[1]),parseInt(E[2]),parseInt(E[3])],F=parseInt(E[4]);return F===0||isNaN(C[0])||isNaN(C[1])||isNaN(C[2])?null:C}function x(y,_){var S=_(y);return S==="rgba(0, 0, 0, 0)"||S==="transparent"||S==="initial"||S==="inherit"?y.parentElement==null?null:x(y.parentElement,_):S}function p(y,_){var S=[y.paddingTop,y.paddingRight,y.paddingBottom,y.paddingLeft],E=96/(72/_),C=(parseInt(y.lineHeight)-parseInt(y.fontSize))/_/2,F=S.map(function(T){return parseInt(T||"0")/E}),B=(0,d.parseSpacing)(F,0);return C>B.top&&(B.top=C),C>B.bottom&&(B.bottom=C),B}},744:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.DocHandler=void 0;var u={},d=function(){function m(g){this.jsPDFDocument=g,this.userStyles={textColor:g.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:g.internal.getFontSize(),fontStyle:g.internal.getFont().fontStyle,font:g.internal.getFont().fontName,lineWidth:g.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:g.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return m.setDefaults=function(g,h){h===void 0&&(h=null),h?h.__autoTableDocumentDefaults=g:u=g},m.unifyColor=function(g){return Array.isArray(g)?g:typeof g=="number"?[g,g,g]:typeof g=="string"?[g]:null},m.prototype.applyStyles=function(g,h){var x,p,y;h===void 0&&(h=!1),g.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(g.fontStyle);var _=this.jsPDFDocument.internal.getFont(),S=_.fontStyle,E=_.fontName;if(g.font&&(E=g.font),g.fontStyle){S=g.fontStyle;var C=this.getFontList()[E];C&&C.indexOf(S)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(C[0]),S=C[0])}if(this.jsPDFDocument.setFont(E,S),g.fontSize&&this.jsPDFDocument.setFontSize(g.fontSize),!h){var F=m.unifyColor(g.fillColor);F&&(x=this.jsPDFDocument).setFillColor.apply(x,F),F=m.unifyColor(g.textColor),F&&(p=this.jsPDFDocument).setTextColor.apply(p,F),F=m.unifyColor(g.lineColor),F&&(y=this.jsPDFDocument).setDrawColor.apply(y,F),typeof g.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(g.lineWidth)}},m.prototype.splitTextToSize=function(g,h,x){return this.jsPDFDocument.splitTextToSize(g,h,x)},m.prototype.rect=function(g,h,x,p,y){return this.jsPDFDocument.rect(g,h,x,p,y)},m.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},m.prototype.getTextWidth=function(g){return this.jsPDFDocument.getTextWidth(g)},m.prototype.getDocument=function(){return this.jsPDFDocument},m.prototype.setPage=function(g){this.jsPDFDocument.setPage(g)},m.prototype.addPage=function(){return this.jsPDFDocument.addPage()},m.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},m.prototype.getGlobalOptions=function(){return u||{}},m.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},m.prototype.pageSize=function(){var g=this.jsPDFDocument.internal.pageSize;return g.width==null&&(g={width:g.getWidth(),height:g.getHeight()}),g},m.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},m.prototype.getLineHeightFactor=function(){var g=this.jsPDFDocument;return g.getLineHeightFactor?g.getLineHeightFactor():1.15},m.prototype.getLineHeight=function(g){return g/this.scaleFactor()*this.getLineHeightFactor()},m.prototype.pageNumber=function(){var g=this.jsPDFDocument.internal.getCurrentPageInfo();return g?g.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},m}();c.DocHandler=d},4:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.parseHtml=void 0;var d=u(903),m=u(796);function g(p,y,_,S,E){var C,F;S===void 0&&(S=!1),E===void 0&&(E=!1);var B;typeof y=="string"?B=_.document.querySelector(y):B=y;var T=Object.keys(p.getFontList()),P=p.scaleFactor(),k=[],I=[],A=[];if(!B)return console.error("Html table could not be found with input: ",y),{head:k,body:I,foot:A};for(var b=0;b<B.rows.length;b++){var R=B.rows[b],W=(F=(C=R==null?void 0:R.parentElement)===null||C===void 0?void 0:C.tagName)===null||F===void 0?void 0:F.toLowerCase(),Y=h(T,P,_,R,S,E);Y&&(W==="thead"?k.push(Y):W==="tfoot"?A.push(Y):I.push(Y))}return{head:k,body:I,foot:A}}c.parseHtml=g;function h(p,y,_,S,E,C){for(var F=new m.HtmlRowInput(S),B=0;B<S.cells.length;B++){var T=S.cells[B],P=_.getComputedStyle(T);if(E||P.display!=="none"){var k=void 0;C&&(k=(0,d.parseCss)(p,T,y,P,_)),F.push({rowSpan:T.rowSpan,colSpan:T.colSpan,styles:k,_element:T,content:x(T)})}}var I=_.getComputedStyle(S);if(F.length>0&&(E||I.display!=="none"))return F}function x(p){var y=p.cloneNode(!0);return y.innerHTML=y.innerHTML.replace(/\n/g,"").replace(/ +/g," "),y.innerHTML=y.innerHTML.split(/<br.*?>/).map(function(_){return _.trim()}).join(`
`),y.innerText||y.textContent||""}},776:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.parseInput=void 0;var d=u(4),m=u(356),g=u(420),h=u(744),x=u(792);function p(B,T){var P=new h.DocHandler(B),k=P.getDocumentOptions(),I=P.getGlobalOptions();(0,x.default)(P,I,k,T);var A=(0,m.assign)({},I,k,T),b;typeof window<"u"&&(b=window);var R=y(I,k,T),W=_(I,k,T),Y=S(P,A),q=C(P,A,b);return{id:T.tableId,content:q,hooks:W,styles:R,settings:Y}}c.parseInput=p;function y(B,T,P){for(var k={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},I=function(W){if(W==="columnStyles"){var Y=B[W],q=T[W],U=P[W];k.columnStyles=(0,m.assign)({},Y,q,U)}else{var H=[B,T,P],Q=H.map(function(ne){return ne[W]||{}});k[W]=(0,m.assign)({},Q[0],Q[1],Q[2])}},A=0,b=Object.keys(k);A<b.length;A++){var R=b[A];I(R)}return k}function _(B,T,P){for(var k=[B,T,P],I={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},A=0,b=k;A<b.length;A++){var R=b[A];R.didParseCell&&I.didParseCell.push(R.didParseCell),R.willDrawCell&&I.willDrawCell.push(R.willDrawCell),R.didDrawCell&&I.didDrawCell.push(R.didDrawCell),R.willDrawPage&&I.willDrawPage.push(R.willDrawPage),R.didDrawPage&&I.didDrawPage.push(R.didDrawPage)}return I}function S(B,T){var P,k,I,A,b,R,W,Y,q,U,H,Q,ne=(0,g.parseSpacing)(T.margin,40/B.scaleFactor()),ee=(P=E(B,T.startY))!==null&&P!==void 0?P:ne.top,N;T.showFoot===!0?N="everyPage":T.showFoot===!1?N="never":N=(k=T.showFoot)!==null&&k!==void 0?k:"everyPage";var L;T.showHead===!0?L="everyPage":T.showHead===!1?L="never":L=(I=T.showHead)!==null&&I!==void 0?I:"everyPage";var D=(A=T.useCss)!==null&&A!==void 0?A:!1,M=T.theme||(D?"plain":"striped"),z=!!T.horizontalPageBreak,ue=(b=T.horizontalPageBreakRepeat)!==null&&b!==void 0?b:null;return{includeHiddenHtml:(R=T.includeHiddenHtml)!==null&&R!==void 0?R:!1,useCss:D,theme:M,startY:ee,margin:ne,pageBreak:(W=T.pageBreak)!==null&&W!==void 0?W:"auto",rowPageBreak:(Y=T.rowPageBreak)!==null&&Y!==void 0?Y:"auto",tableWidth:(q=T.tableWidth)!==null&&q!==void 0?q:"auto",showHead:L,showFoot:N,tableLineWidth:(U=T.tableLineWidth)!==null&&U!==void 0?U:0,tableLineColor:(H=T.tableLineColor)!==null&&H!==void 0?H:200,horizontalPageBreak:z,horizontalPageBreakRepeat:ue,horizontalPageBreakBehaviour:(Q=T.horizontalPageBreakBehaviour)!==null&&Q!==void 0?Q:"afterAllRows"}}function E(B,T){var P=B.getLastAutoTable(),k=B.scaleFactor(),I=B.pageNumber(),A=!1;if(P&&P.startPageNumber){var b=P.startPageNumber+P.pageNumber-1;A=b===I}return typeof T=="number"?T:(T==null||T===!1)&&A&&(P==null?void 0:P.finalY)!=null?P.finalY+20/k:null}function C(B,T,P){var k=T.head||[],I=T.body||[],A=T.foot||[];if(T.html){var b=T.includeHiddenHtml;if(P){var R=(0,d.parseHtml)(B,T.html,P,b,T.useCss)||{};k=R.head||k,I=R.body||k,A=R.foot||k}else console.error("Cannot parse html in non browser environment")}var W=T.columns||F(k,I,A);return{columns:W,head:k,body:I,foot:A}}function F(B,T,P){var k=B[0]||T[0]||P[0]||[],I=[];return Object.keys(k).filter(function(A){return A!=="_element"}).forEach(function(A){var b=1,R;Array.isArray(k)?R=k[parseInt(A)]:R=k[A],typeof R=="object"&&!Array.isArray(R)&&(b=(R==null?void 0:R.colSpan)||1);for(var W=0;W<b;W++){var Y=void 0;Array.isArray(k)?Y=I.length:Y=A+(W>0?"_".concat(W):"");var q={dataKey:Y};I.push(q)}}),I}},792:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function u(m,g,h,x){for(var p=function(E){E&&typeof E!="object"&&console.error("The options parameter should be of type object, is: "+typeof E),typeof E.extendWidth<"u"&&(E.tableWidth=E.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof E.margins<"u"&&(typeof E.margin>"u"&&(E.margin=E.margins),console.error("Use of deprecated option: margins, use margin instead.")),E.startY&&typeof E.startY!="number"&&(console.error("Invalid value for startY option",E.startY),delete E.startY),!E.didDrawPage&&(E.afterPageContent||E.beforePageContent||E.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),E.didDrawPage=function(A){m.applyStyles(m.userStyles),E.beforePageContent&&E.beforePageContent(A),m.applyStyles(m.userStyles),E.afterPageContent&&E.afterPageContent(A),m.applyStyles(m.userStyles),E.afterPageAdd&&A.pageNumber>1&&A.afterPageAdd(A),m.applyStyles(m.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(A){E[A]&&console.error('The "'.concat(A,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(A){var b=A[0],R=A[1];E[R]&&(console.error("Use of deprecated option ".concat(R,". Use ").concat(b," instead")),E[b]=E[R])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(A){var b=typeof A=="string"?A:A[0],R=typeof A=="string"?A:A[1];typeof E[b]<"u"&&(typeof E.styles[R]>"u"&&(E.styles[R]=E[b]),console.error("Use of deprecated option: "+b+", use the style "+R+" instead."))});for(var C=0,F=["styles","bodyStyles","headStyles","footStyles"];C<F.length;C++){var B=F[C];d(E[B]||{})}for(var T=E.columnStyles||{},P=0,k=Object.keys(T);P<k.length;P++){var I=k[P];d(T[I]||{})}},y=0,_=[g,h,x];y<_.length;y++){var S=_[y];p(S)}}c.default=u;function d(m){m.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),m.minCellHeight||(m.minCellHeight=m.rowHeight)):m.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),m.cellWidth||(m.cellWidth=m.columnWidth))}},260:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.Column=c.Cell=c.Row=c.Table=void 0;var d=u(796),m=u(172),g=u(420),h=function(){function _(S,E){this.pageNumber=1,this.pageCount=1,this.id=S.id,this.settings=S.settings,this.styles=S.styles,this.hooks=S.hooks,this.columns=E.columns,this.head=E.head,this.body=E.body,this.foot=E.foot}return _.prototype.getHeadHeight=function(S){return this.head.reduce(function(E,C){return E+C.getMaxCellHeight(S)},0)},_.prototype.getFootHeight=function(S){return this.foot.reduce(function(E,C){return E+C.getMaxCellHeight(S)},0)},_.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},_.prototype.callCellHooks=function(S,E,C,F,B,T){for(var P=0,k=E;P<k.length;P++){var I=k[P],A=new m.CellHookData(S,this,C,F,B,T),b=I(A)===!1;if(C.text=Array.isArray(C.text)?C.text:[C.text],b)return!1}return!0},_.prototype.callEndPageHooks=function(S,E){S.applyStyles(S.userStyles);for(var C=0,F=this.hooks.didDrawPage;C<F.length;C++){var B=F[C];B(new m.HookData(S,this,E))}},_.prototype.callWillDrawPageHooks=function(S,E){for(var C=0,F=this.hooks.willDrawPage;C<F.length;C++){var B=F[C];B(new m.HookData(S,this,E))}},_.prototype.getWidth=function(S){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var E=this.columns.reduce(function(F,B){return F+B.wrappedWidth},0);return E}else{var C=this.settings.margin;return S-C.left-C.right}},_}();c.Table=h;var x=function(){function _(S,E,C,F,B){B===void 0&&(B=!1),this.height=0,this.raw=S,S instanceof d.HtmlRowInput&&(this.raw=S._element,this.element=S._element),this.index=E,this.section=C,this.cells=F,this.spansMultiplePages=B}return _.prototype.getMaxCellHeight=function(S){var E=this;return S.reduce(function(C,F){var B;return Math.max(C,((B=E.cells[F.index])===null||B===void 0?void 0:B.height)||0)},0)},_.prototype.hasRowSpan=function(S){var E=this;return S.filter(function(C){var F=E.cells[C.index];return F?F.rowSpan>1:!1}).length>0},_.prototype.canEntireRowFit=function(S,E){return this.getMaxCellHeight(E)<=S},_.prototype.getMinimumRowHeight=function(S,E){var C=this;return S.reduce(function(F,B){var T=C.cells[B.index];if(!T)return 0;var P=E.getLineHeight(T.styles.fontSize),k=T.padding("vertical"),I=k+P;return I>F?I:F},0)},_}();c.Row=x;var p=function(){function _(S,E,C){var F,B;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=E,this.section=C,this.raw=S;var T=S;S!=null&&typeof S=="object"&&!Array.isArray(S)?(this.rowSpan=S.rowSpan||1,this.colSpan=S.colSpan||1,T=(B=(F=S.content)!==null&&F!==void 0?F:S.title)!==null&&B!==void 0?B:S,S._element&&(this.raw=S._element)):(this.rowSpan=1,this.colSpan=1);var P=T!=null?""+T:"",k=/\r\n|\r|\n/g;this.text=P.split(k)}return _.prototype.getTextPos=function(){var S;if(this.styles.valign==="top")S=this.y+this.padding("top");else if(this.styles.valign==="bottom")S=this.y+this.height-this.padding("bottom");else{var E=this.height-this.padding("vertical");S=this.y+E/2+this.padding("top")}var C;if(this.styles.halign==="right")C=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var F=this.width-this.padding("horizontal");C=this.x+F/2+this.padding("left")}else C=this.x+this.padding("left");return{x:C,y:S}},_.prototype.getContentHeight=function(S,E){E===void 0&&(E=1.15);var C=Array.isArray(this.text)?this.text.length:1,F=this.styles.fontSize/S*E,B=C*F+this.padding("vertical");return Math.max(B,this.styles.minCellHeight)},_.prototype.padding=function(S){var E=(0,g.parseSpacing)(this.styles.cellPadding,0);return S==="vertical"?E.top+E.bottom:S==="horizontal"?E.left+E.right:E[S]},_}();c.Cell=p;var y=function(){function _(S,E,C){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=S,this.raw=E,this.index=C}return _.prototype.getMaxCustomCellWidth=function(S){for(var E=0,C=0,F=S.allRows();C<F.length;C++){var B=F[C],T=B.cells[this.index];T&&typeof T.styles.cellWidth=="number"&&(E=Math.max(E,T.styles.cellWidth))}return E},_}();c.Column=y},356:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.assign=void 0;function u(d,m,g,h,x){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var p=Object(d),y=1;y<arguments.length;y++){var _=arguments[y];if(_!=null)for(var S in _)Object.prototype.hasOwnProperty.call(_,S)&&(p[S]=_[S])}return p}c.assign=u},972:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.createTable=void 0;var d=u(744),m=u(260),g=u(324),h=u(796),x=u(356);function p(B,T){var P=new d.DocHandler(B),k=y(T,P.scaleFactor()),I=new m.Table(T,k);return(0,g.calculateWidths)(P,I),P.applyStyles(P.userStyles),I}c.createTable=p;function y(B,T){var P=B.content,k=C(P.columns);if(P.head.length===0){var I=S(k,"head");I&&P.head.push(I)}if(P.foot.length===0){var I=S(k,"foot");I&&P.foot.push(I)}var A=B.settings.theme,b=B.styles;return{columns:k,head:_("head",P.head,k,b,A,T),body:_("body",P.body,k,b,A,T),foot:_("foot",P.foot,k,b,A,T)}}function _(B,T,P,k,I,A){var b={},R=T.map(function(W,Y){for(var q=0,U={},H=0,Q=0,ne=0,ee=P;ne<ee.length;ne++){var N=ee[ne];if(b[N.index]==null||b[N.index].left===0)if(Q===0){var L=void 0;Array.isArray(W)?L=W[N.index-H-q]:L=W[N.dataKey];var D={};typeof L=="object"&&!Array.isArray(L)&&(D=(L==null?void 0:L.styles)||{});var M=F(B,N,Y,I,k,A,D),z=new m.Cell(L,M,B);U[N.dataKey]=z,U[N.index]=z,Q=z.colSpan-1,b[N.index]={left:z.rowSpan-1,times:Q}}else Q--,H++;else b[N.index].left--,Q=b[N.index].times,q++}return new m.Row(W,Y,B,U)});return R}function S(B,T){var P={};return B.forEach(function(k){if(k.raw!=null){var I=E(T,k.raw);I!=null&&(P[k.dataKey]=I)}}),Object.keys(P).length>0?P:null}function E(B,T){if(B==="head"){if(typeof T=="object")return T.header||T.title||null;if(typeof T=="string"||typeof T=="number")return T}else if(B==="foot"&&typeof T=="object")return T.footer;return null}function C(B){return B.map(function(T,P){var k,I,A;return typeof T=="object"?A=(I=(k=T.dataKey)!==null&&k!==void 0?k:T.key)!==null&&I!==void 0?I:P:A=P,new m.Column(A,T,P)})}function F(B,T,P,k,I,A,b){var R=(0,h.getTheme)(k),W;B==="head"?W=I.headStyles:B==="body"?W=I.bodyStyles:B==="foot"&&(W=I.footStyles);var Y=(0,x.assign)({},R.table,R[B],I.styles,W),q=I.columnStyles[T.dataKey]||I.columnStyles[T.index]||{},U=B==="body"?q:{},H=B==="body"&&P%2===0?(0,x.assign)({},R.alternateRow,I.alternateRowStyles):{},Q=(0,h.defaultStyles)(A),ne=(0,x.assign)({},Q,Y,H,U);return(0,x.assign)(ne,b)}},664:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.addPage=c.drawTable=void 0;var d=u(420),m=u(260),g=u(744),h=u(356),x=u(136),p=u(224);function y(q,U){var H=U.settings,Q=H.startY,ne=H.margin,ee={x:ne.left,y:Q},N=U.getHeadHeight(U.columns)+U.getFootHeight(U.columns),L=Q+ne.bottom+N;if(H.pageBreak==="avoid"){var D=U.body,M=D.reduce(function(pe,me){return pe+me.height},0);L+=M}var z=new g.DocHandler(q);(H.pageBreak==="always"||H.startY!=null&&L>z.pageSize().height)&&(Y(z),ee.y=ne.top),U.callWillDrawPageHooks(z,ee);var ue=(0,h.assign)({},ee);U.startPageNumber=z.pageNumber(),H.horizontalPageBreak?_(z,U,ue,ee):(z.applyStyles(z.userStyles),(H.showHead==="firstPage"||H.showHead==="everyPage")&&U.head.forEach(function(pe){return I(z,U,pe,ee,U.columns)}),z.applyStyles(z.userStyles),U.body.forEach(function(pe,me){var Ne=me===U.body.length-1;k(z,U,pe,Ne,ue,ee,U.columns)}),z.applyStyles(z.userStyles),(H.showFoot==="lastPage"||H.showFoot==="everyPage")&&U.foot.forEach(function(pe){return I(z,U,pe,ee,U.columns)})),(0,d.addTableBorder)(z,U,ue,ee),U.callEndPageHooks(z,ee),U.finalY=ee.y,q.lastAutoTable=U,q.previousAutoTable=U,q.autoTable&&(q.autoTable.previous=U),z.applyStyles(z.userStyles)}c.drawTable=y;function _(q,U,H,Q){var ne=(0,p.calculateAllColumnsCanFitInPage)(q,U),ee=U.settings;if(ee.horizontalPageBreakBehaviour==="afterAllRows")ne.forEach(function(M,z){q.applyStyles(q.userStyles),z>0?W(q,U,H,Q,M.columns,!0):S(q,U,Q,M.columns),E(q,U,H,Q,M.columns),F(q,U,Q,M.columns)});else for(var N=-1,L=ne[0],D=function(){var M=N;if(L){q.applyStyles(q.userStyles);var z=L.columns;N>=0?W(q,U,H,Q,z,!0):S(q,U,Q,z),M=C(q,U,N+1,Q,z),F(q,U,Q,z)}var ue=M-N;ne.slice(1).forEach(function(pe){q.applyStyles(q.userStyles),W(q,U,H,Q,pe.columns,!0),C(q,U,N+1,Q,pe.columns,ue),F(q,U,Q,pe.columns)}),N=M};N<U.body.length-1;)D()}function S(q,U,H,Q){var ne=U.settings;q.applyStyles(q.userStyles),(ne.showHead==="firstPage"||ne.showHead==="everyPage")&&U.head.forEach(function(ee){return I(q,U,ee,H,Q)})}function E(q,U,H,Q,ne){q.applyStyles(q.userStyles),U.body.forEach(function(ee,N){var L=N===U.body.length-1;k(q,U,ee,L,H,Q,ne)})}function C(q,U,H,Q,ne,ee){q.applyStyles(q.userStyles),ee=ee??U.body.length;var N=Math.min(H+ee,U.body.length),L=-1;return U.body.slice(H,N).forEach(function(D,M){var z=H+M===U.body.length-1,ue=R(q,U,z,Q);D.canEntireRowFit(ue,ne)&&(I(q,U,D,Q,ne),L=H+M)}),L}function F(q,U,H,Q){var ne=U.settings;q.applyStyles(q.userStyles),(ne.showFoot==="lastPage"||ne.showFoot==="everyPage")&&U.foot.forEach(function(ee){return I(q,U,ee,H,Q)})}function B(q,U,H){var Q=H.getLineHeight(q.styles.fontSize),ne=q.padding("vertical"),ee=Math.floor((U-ne)/Q);return Math.max(0,ee)}function T(q,U,H,Q){var ne={};q.spansMultiplePages=!0,q.height=0;for(var ee=0,N=0,L=H.columns;N<L.length;N++){var D=L[N],M=q.cells[D.index];if(M){Array.isArray(M.text)||(M.text=[M.text]);var z=new m.Cell(M.raw,M.styles,M.section);z=(0,h.assign)(z,M),z.text=[];var ue=B(M,U,Q);M.text.length>ue&&(z.text=M.text.splice(ue,M.text.length));var pe=Q.scaleFactor(),me=Q.getLineHeightFactor();M.contentHeight=M.getContentHeight(pe,me),M.contentHeight>=U&&(M.contentHeight=U,z.styles.minCellHeight-=U),M.contentHeight>q.height&&(q.height=M.contentHeight),z.contentHeight=z.getContentHeight(pe,me),z.contentHeight>ee&&(ee=z.contentHeight),ne[D.index]=z}}var Ne=new m.Row(q.raw,-1,q.section,ne,!0);Ne.height=ee;for(var Oe=0,Ie=H.columns;Oe<Ie.length;Oe++){var D=Ie[Oe],z=Ne.cells[D.index];z&&(z.height=Ne.height);var M=q.cells[D.index];M&&(M.height=q.height)}return Ne}function P(q,U,H,Q){var ne=q.pageSize().height,ee=Q.settings.margin,N=ee.top+ee.bottom,L=ne-N;U.section==="body"&&(L-=Q.getHeadHeight(Q.columns)+Q.getFootHeight(Q.columns));var D=U.getMinimumRowHeight(Q.columns,q),M=D<H;if(D>L)return console.error("Will not be able to print row ".concat(U.index," correctly since it's minimum height is larger than page height")),!0;if(!M)return!1;var z=U.hasRowSpan(Q.columns),ue=U.getMaxCellHeight(Q.columns)>L;return ue?(z&&console.error("The content of row ".concat(U.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(z||Q.settings.rowPageBreak==="avoid")}function k(q,U,H,Q,ne,ee,N){var L=R(q,U,Q,ee);if(H.canEntireRowFit(L,N))I(q,U,H,ee,N);else if(P(q,H,L,U)){var D=T(H,L,U,q);I(q,U,H,ee,N),W(q,U,ne,ee,N),k(q,U,D,Q,ne,ee,N)}else W(q,U,ne,ee,N),k(q,U,H,Q,ne,ee,N)}function I(q,U,H,Q,ne){Q.x=U.settings.margin.left;for(var ee=0,N=ne;ee<N.length;ee++){var L=N[ee],D=H.cells[L.index];if(!D){Q.x+=L.width;continue}q.applyStyles(D.styles),D.x=Q.x,D.y=Q.y;var M=U.callCellHooks(q,U.hooks.willDrawCell,D,H,L,Q);if(M===!1){Q.x+=L.width;continue}A(q,D,Q);var z=D.getTextPos();(0,x.default)(D.text,z.x,z.y,{halign:D.styles.halign,valign:D.styles.valign,maxWidth:Math.ceil(D.width-D.padding("left")-D.padding("right"))},q.getDocument()),U.callCellHooks(q,U.hooks.didDrawCell,D,H,L,Q),Q.x+=L.width}Q.y+=H.height}function A(q,U,H){var Q=U.styles;if(q.getDocument().setFillColor(q.getDocument().getFillColor()),typeof Q.lineWidth=="number"){var ne=(0,d.getFillStyle)(Q.lineWidth,Q.fillColor);ne&&q.rect(U.x,H.y,U.width,U.height,ne)}else typeof Q.lineWidth=="object"&&(Q.fillColor&&q.rect(U.x,H.y,U.width,U.height,"F"),b(q,U,H,Q.lineWidth))}function b(q,U,H,Q){var ne,ee,N,L;Q.top&&(ne=H.x,ee=H.y,N=H.x+U.width,L=H.y,Q.right&&(N+=.5*Q.right),Q.left&&(ne-=.5*Q.left),D(Q.top,ne,ee,N,L)),Q.bottom&&(ne=H.x,ee=H.y+U.height,N=H.x+U.width,L=H.y+U.height,Q.right&&(N+=.5*Q.right),Q.left&&(ne-=.5*Q.left),D(Q.bottom,ne,ee,N,L)),Q.left&&(ne=H.x,ee=H.y,N=H.x,L=H.y+U.height,Q.top&&(ee-=.5*Q.top),Q.bottom&&(L+=.5*Q.bottom),D(Q.left,ne,ee,N,L)),Q.right&&(ne=H.x+U.width,ee=H.y,N=H.x+U.width,L=H.y+U.height,Q.top&&(ee-=.5*Q.top),Q.bottom&&(L+=.5*Q.bottom),D(Q.right,ne,ee,N,L));function D(M,z,ue,pe,me){q.getDocument().setLineWidth(M),q.getDocument().line(z,ue,pe,me,"S")}}function R(q,U,H,Q){var ne=U.settings.margin.bottom,ee=U.settings.showFoot;return(ee==="everyPage"||ee==="lastPage"&&H)&&(ne+=U.getFootHeight(U.columns)),q.pageSize().height-Q.y-ne}function W(q,U,H,Q,ne,ee){ne===void 0&&(ne=[]),ee===void 0&&(ee=!1),q.applyStyles(q.userStyles),U.settings.showFoot==="everyPage"&&!ee&&U.foot.forEach(function(L){return I(q,U,L,Q,ne)}),U.callEndPageHooks(q,Q);var N=U.settings.margin;(0,d.addTableBorder)(q,U,H,Q),Y(q),U.pageNumber++,U.pageCount++,Q.x=N.left,Q.y=N.top,H.y=N.top,U.callWillDrawPageHooks(q,Q),U.settings.showHead==="everyPage"&&(U.head.forEach(function(L){return I(q,U,L,Q,ne)}),q.applyStyles(q.userStyles))}c.addPage=W;function Y(q){var U=q.pageNumber();q.setPage(U+1);var H=q.pageNumber();return H===U?(q.addPage(),!0):!1}},224:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.calculateAllColumnsCanFitInPage=void 0;var d=u(420);function m(h,x,p){var y;p===void 0&&(p={});var _=(0,d.getPageAvailableWidth)(h,x),S=new Map,E=[],C=[],F=[];x.settings.horizontalPageBreakRepeat,Array.isArray(x.settings.horizontalPageBreakRepeat)?F=x.settings.horizontalPageBreakRepeat:(typeof x.settings.horizontalPageBreakRepeat=="string"||typeof x.settings.horizontalPageBreakRepeat=="number")&&(F=[x.settings.horizontalPageBreakRepeat]),F.forEach(function(k){var I=x.columns.find(function(A){return A.dataKey===k||A.index===k});I&&!S.has(I.index)&&(S.set(I.index,!0),E.push(I.index),C.push(x.columns[I.index]),_-=I.wrappedWidth)});for(var B=!0,T=(y=p==null?void 0:p.start)!==null&&y!==void 0?y:0;T<x.columns.length;){if(S.has(T)){T++;continue}var P=x.columns[T].wrappedWidth;if(B||_>=P)B=!1,E.push(T),C.push(x.columns[T]),_-=P;else break;T++}return{colIndexes:E,columns:C,lastIndex:T-1}}function g(h,x){for(var p=[],y=0;y<x.columns.length;y++){var _=m(h,x,{start:y});_.columns.length&&(p.push(_),y=_.lastIndex)}return p}c.calculateAllColumnsCanFitInPage=g},324:function(l,c,u){Object.defineProperty(c,"__esModule",{value:!0}),c.ellipsize=c.resizeColumns=c.calculateWidths=void 0;var d=u(420);function m(E,C){g(E,C);var F=[],B=0;C.columns.forEach(function(P){var k=P.getMaxCustomCellWidth(C);k?P.width=k:(P.width=P.wrappedWidth,F.push(P)),B+=P.width});var T=C.getWidth(E.pageSize().width)-B;T&&(T=h(F,T,function(P){return Math.max(P.minReadableWidth,P.minWidth)})),T&&(T=h(F,T,function(P){return P.minWidth})),T=Math.abs(T),!C.settings.horizontalPageBreak&&T>.1/E.scaleFactor()&&(T=T<1?T:Math.round(T),console.warn("Of the table content, ".concat(T," units width could not fit page"))),p(C),y(C,E),x(C)}c.calculateWidths=m;function g(E,C){var F=E.scaleFactor(),B=C.settings.horizontalPageBreak,T=(0,d.getPageAvailableWidth)(E,C);C.allRows().forEach(function(P){for(var k=0,I=C.columns;k<I.length;k++){var A=I[k],b=P.cells[A.index];if(b){var R=C.hooks.didParseCell;C.callCellHooks(E,R,b,P,A,null);var W=b.padding("horizontal");b.contentWidth=(0,d.getStringWidth)(b.text,b.styles,E)+W;var Y=(0,d.getStringWidth)(b.text.join(" ").split(/[^\S\u00A0]+/),b.styles,E);if(b.minReadableWidth=Y+b.padding("horizontal"),typeof b.styles.cellWidth=="number")b.minWidth=b.styles.cellWidth,b.wrappedWidth=b.styles.cellWidth;else if(b.styles.cellWidth==="wrap"||B===!0)b.contentWidth>T?(b.minWidth=T,b.wrappedWidth=T):(b.minWidth=b.contentWidth,b.wrappedWidth=b.contentWidth);else{var q=10/F;b.minWidth=b.styles.minCellWidth||q,b.wrappedWidth=b.contentWidth,b.minWidth>b.wrappedWidth&&(b.wrappedWidth=b.minWidth)}}}}),C.allRows().forEach(function(P){for(var k=0,I=C.columns;k<I.length;k++){var A=I[k],b=P.cells[A.index];if(b&&b.colSpan===1)A.wrappedWidth=Math.max(A.wrappedWidth,b.wrappedWidth),A.minWidth=Math.max(A.minWidth,b.minWidth),A.minReadableWidth=Math.max(A.minReadableWidth,b.minReadableWidth);else{var R=C.styles.columnStyles[A.dataKey]||C.styles.columnStyles[A.index]||{},W=R.cellWidth||R.minCellWidth;W&&typeof W=="number"&&(A.minWidth=W,A.wrappedWidth=W)}b&&(b.colSpan>1&&!A.minWidth&&(A.minWidth=b.minWidth),b.colSpan>1&&!A.wrappedWidth&&(A.wrappedWidth=b.minWidth))}})}function h(E,C,F){for(var B=C,T=E.reduce(function(q,U){return q+U.wrappedWidth},0),P=0;P<E.length;P++){var k=E[P],I=k.wrappedWidth/T,A=B*I,b=k.width+A,R=F(k),W=b<R?R:b;C-=W-k.width,k.width=W}if(C=Math.round(C*1e10)/1e10,C){var Y=E.filter(function(q){return C<0?q.width>F(q):!0});Y.length&&(C=h(Y,C,F))}return C}c.resizeColumns=h;function x(E){for(var C={},F=1,B=E.allRows(),T=0;T<B.length;T++)for(var P=B[T],k=0,I=E.columns;k<I.length;k++){var A=I[k],b=C[A.index];if(F>1)F--,delete P.cells[A.index];else if(b)b.cell.height+=P.height,F=b.cell.colSpan,delete P.cells[A.index],b.left--,b.left<=1&&delete C[A.index];else{var R=P.cells[A.index];if(!R)continue;if(R.height=P.height,R.rowSpan>1){var W=B.length-T,Y=R.rowSpan>W?W:R.rowSpan;C[A.index]={cell:R,left:Y,row:P}}}}}function p(E){for(var C=E.allRows(),F=0;F<C.length;F++)for(var B=C[F],T=null,P=0,k=0,I=0;I<E.columns.length;I++){var A=E.columns[I];if(k-=1,k>1&&E.columns[I+1])P+=A.width,delete B.cells[A.index];else if(T){var b=T;delete B.cells[A.index],T=null,b.width=A.width+P}else{var b=B.cells[A.index];if(!b)continue;if(k=b.colSpan,P=0,b.colSpan>1){T=b,P+=A.width;continue}b.width=A.width+P}}}function y(E,C){for(var F={count:0,height:0},B=0,T=E.allRows();B<T.length;B++){for(var P=T[B],k=0,I=E.columns;k<I.length;k++){var A=I[k],b=P.cells[A.index];if(b){C.applyStyles(b.styles,!0);var R=b.width-b.padding("horizontal");if(b.styles.overflow==="linebreak")b.text=C.splitTextToSize(b.text,R+1/C.scaleFactor(),{fontSize:b.styles.fontSize});else if(b.styles.overflow==="ellipsize")b.text=_(b.text,R,b.styles,C,"...");else if(b.styles.overflow==="hidden")b.text=_(b.text,R,b.styles,C,"");else if(typeof b.styles.overflow=="function"){var W=b.styles.overflow(b.text,R);typeof W=="string"?b.text=[W]:b.text=W}b.contentHeight=b.getContentHeight(C.scaleFactor(),C.getLineHeightFactor());var Y=b.contentHeight/b.rowSpan;b.rowSpan>1&&F.count*F.height<Y*b.rowSpan?F={height:Y,count:b.rowSpan}:F&&F.count>0&&F.height>Y&&(Y=F.height),Y>P.height&&(P.height=Y)}}F.count--}}function _(E,C,F,B,T){return E.map(function(P){return S(P,C,F,B,T)})}c.ellipsize=_;function S(E,C,F,B,T){var P=1e4*B.scaleFactor();if(C=Math.ceil(C*P)/P,C>=(0,d.getStringWidth)(E,F,B))return E;for(;C<(0,d.getStringWidth)(E+T,F,B)&&!(E.length<=1);)E=E.substring(0,E.length-1);return E.trim()+T}},964:function(l){if(typeof r>"u"){var c=new Error("Cannot find module 'undefined'");throw c.code="MODULE_NOT_FOUND",c}l.exports=r}},n={};function s(l){var c=n[l];if(c!==void 0)return c.exports;var u=n[l]={exports:{}};return a[l].call(u.exports,u,u.exports,s),u.exports}var o={};return function(){var l=o;Object.defineProperty(l,"__esModule",{value:!0}),l.Cell=l.Column=l.Row=l.Table=l.CellHookData=l.__drawTable=l.__createTable=l.applyPlugin=void 0;var c=s(340),u=s(776),d=s(664),m=s(972),g=s(260);Object.defineProperty(l,"Table",{enumerable:!0,get:function(){return g.Table}});var h=s(172);Object.defineProperty(l,"CellHookData",{enumerable:!0,get:function(){return h.CellHookData}});var x=s(260);Object.defineProperty(l,"Cell",{enumerable:!0,get:function(){return x.Cell}}),Object.defineProperty(l,"Column",{enumerable:!0,get:function(){return x.Column}}),Object.defineProperty(l,"Row",{enumerable:!0,get:function(){return x.Row}});function p(C){(0,c.default)(C)}l.applyPlugin=p;function y(C,F){var B=(0,u.parseInput)(C,F),T=(0,m.createTable)(C,B);(0,d.drawTable)(C,T)}function _(C,F){var B=(0,u.parseInput)(C,F);return(0,m.createTable)(C,B)}l.__createTable=_;function S(C,F){(0,d.drawTable)(C,F)}l.__drawTable=S;try{var E=s(964);E.jsPDF&&(E=E.jsPDF),p(E)}catch{}l.default=y}(),o}()})})(VE);const YE=()=>{const[e,t]=se.useState(!1),[r,a]=se.useState(0),n=se.useCallback(async(c,u={})=>{t(!0),a(0);try{const{includeDetails:d=!0,selectedColumns:m=null,filename:g=`imports_${new Date().toISOString().split("T")[0]}.xlsx`}=u,h=c.map((y,_)=>{var E,C;a(_/c.length*50);const S={ID:y.id,Date:Pr(y.imp_date),Staff:((E=y.staff)==null?void 0:E.full_name)||`Staff ${y.staff_id}`,Supplier:((C=y.supplier)==null?void 0:C.supplier)||y.supplier||"N/A","Total Amount":parseFloat(y.total||0).toFixed(2),"Total Qty":y.total_quantity||0,"Products Count":y.products_count||0,Status:tf(y)};if(m&&Array.isArray(m)){const F={};return m.forEach(B=>{S[B]!==void 0&&(F[B]=S[B])}),F}return S}),x=ps.book_new(),p=ps.json_to_sheet(h);if(ps.book_append_sheet(x,p,"Imports Summary"),d){const y=[];if(c.forEach((_,S)=>{a(50+S/c.length*50),(_.import_details||_.importDetails||[]).forEach(C=>{y.push({"Import ID":_.id,"Import Date":Pr(_.imp_date),"Product Name":C.pro_name,Quantity:C.qty,"Unit Price":parseFloat(C.price||0).toFixed(2),Amount:parseFloat(C.amount||0).toFixed(2),"Batch Number":C.batch_number||"N/A","Expiration Date":C.expiration_date?new Date(C.expiration_date).toLocaleDateString():"N/A"})})}),y.length>0){const _=ps.json_to_sheet(y);ps.book_append_sheet(x,_,"Import Details")}}return Tg(x,g),a(100),!0}catch(d){throw console.error("Excel export failed:",d),d}finally{t(!1),a(0)}},[]),s=se.useCallback(async(c,u={})=>{t(!0),a(0);try{const{selectedColumns:d=null,filename:m=`imports_${new Date().toISOString().split("T")[0]}.csv`}=u,g=c.map((S,E)=>{var F,B;a(E/c.length*100);const C={ID:S.id,Date:Pr(S.imp_date),Staff:((F=S.staff)==null?void 0:F.full_name)||`Staff ${S.staff_id}`,Supplier:((B=S.supplier)==null?void 0:B.supplier)||S.supplier||"N/A","Total Amount":parseFloat(S.total||0).toFixed(2),"Total Qty":S.total_quantity||0,"Products Count":S.products_count||0,Status:tf(S)};if(d&&Array.isArray(d)){const T={};return d.forEach(P=>{C[P]!==void 0&&(T[P]=C[P])}),T}return C}),h=ps.json_to_sheet(g),x=ps.sheet_to_csv(h),p=new Blob([x],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a"),_=URL.createObjectURL(p);return y.setAttribute("href",_),y.setAttribute("download",m),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y),a(100),!0}catch(d){throw console.error("CSV export failed:",d),d}finally{t(!1),a(0)}},[]),o=se.useCallback(async(c,u={})=>{t(!0),a(0);try{const{filename:d=`imports_${new Date().toISOString().split("T")[0]}.pdf`,includeDetails:m=!1}=u,g=new Tt;g.setFontSize(20),g.text("Imports Report",14,22),g.setFontSize(12),g.text(`Generated on: ${new Date().toLocaleDateString()}`,14,32);const h=c.length,x=c.reduce((y,_)=>y+parseFloat(_.total||0),0);g.text(`Total Imports: ${h}`,14,42),g.text(`Total Value: ${br(x)}`,14,52);const p=c.map((y,_)=>{var S,E;return a(_/c.length*(m?50:100)),[y.id,Pr(y.imp_date),((S=y.staff)==null?void 0:S.full_name)||`Staff ${y.staff_id}`,((E=y.supplier)==null?void 0:E.supplier)||y.supplier||"N/A",br(y.total),tf(y)]});if(g.autoTable({head:[["ID","Date","Staff","Supplier","Total","Status"]],body:p,startY:62,styles:{fontSize:8},headStyles:{fillColor:[66,139,202]}}),m){let y=g.lastAutoTable.finalY+20;c.forEach((_,S)=>{a(50+S/c.length*50);const E=_.import_details||_.importDetails||[];if(E.length>0){y>250&&(g.addPage(),y=20),g.setFontSize(14),g.text(`Import #${_.id} Details`,14,y),y+=10;const C=E.map(F=>[F.pro_name,F.qty,br(F.price),br(F.amount),F.batch_number||"N/A"]);g.autoTable({head:[["Product","Qty","Price","Amount","Batch"]],body:C,startY:y,styles:{fontSize:7},headStyles:{fillColor:[92,184,92]}}),y=g.lastAutoTable.finalY+15}})}return g.save(d),a(100),!0}catch(d){throw console.error("PDF export failed:",d),d}finally{t(!1),a(0)}},[]),l=se.useCallback(()=>["ID","Date","Staff","Supplier","Total Amount","Total Qty","Products Count","Status"],[]);return{exportToExcel:n,exportToCSV:s,exportToPDF:o,getAvailableColumns:l,isExporting:e,exportProgress:r}},tf=e=>{const t=e.import_details||e.importDetails||[];return t.length===0?"Draft":t.some(a=>a.expiration_date?new Date(a.expiration_date)<new Date:!1)?"Expired":"Completed"},XE=({importItem:e,mode:t,onClose:r,onSuccess:a})=>{var R,W,Y;const n=t==="view",s=t==="edit",o=t4(),l=r4(),{data:c}=Cc(),{data:u}=L0(),{data:d}=Tc(),m=((R=c==null?void 0:c.data)==null?void 0:R.data)||(c==null?void 0:c.data)||c||[],g=((W=u==null?void 0:u.data)==null?void 0:W.data)||(u==null?void 0:u.data)||u||[],h=((Y=d==null?void 0:d.data)==null?void 0:Y.data)||(d==null?void 0:d.data)||d||[],[x,p]=se.useState([]),[y,_]=se.useState(!1),{register:S,handleSubmit:E,formState:{errors:C},reset:F,watch:B,setValue:T}=Xa({defaultValues:{imp_date:"",staff_id:"",sup_id:"",supplier:"",total:"",...e}}),P=B("sup_id");se.useEffect(()=>{if(e){const U={imp_date:e.imp_date?new Date(e.imp_date).toISOString().split("T")[0]:"",staff_id:e.staff_id||"",sup_id:e.sup_id||"",supplier:e.supplier||""};F(U),e.importDetails&&e.importDetails.length>0?p(e.importDetails.map(H=>({pro_code:parseInt(H.pro_code),pro_name:H.pro_name,qty:parseInt(H.qty),price:parseFloat(H.price),amount:parseFloat(H.amount),batch_number:H.batch_number,expiration_date:H.expiration_date?new Date(H.expiration_date).toISOString().split("T")[0]:""}))):e.import_details&&e.import_details.length>0&&p(e.import_details.map(H=>({pro_code:parseInt(H.pro_code),pro_name:H.pro_name,qty:parseInt(H.qty),price:parseFloat(H.price),amount:parseFloat(H.amount),batch_number:H.batch_number,expiration_date:H.expiration_date?new Date(H.expiration_date).toISOString().split("T")[0]:""})))}else F({imp_date:"",staff_id:"",sup_id:"",supplier:"",total:""}),p([])},[e,F]),se.useEffect(()=>{const q=x.reduce((U,H)=>U+parseFloat(H.amount||0),0);T("total",q.toFixed(2))},[x,T]),se.useEffect(()=>{if(P&&g.length>0){const q=g.find(U=>U.id===parseInt(P));q&&T("supplier",q.supplier)}},[P,g,T]);const k=q=>{if(console.log("addProduct called with:",q),!q.pro_code){Ye.error("Please select a product");return}const U=h.find(ee=>ee.id===parseInt(q.pro_code));if(!U){Ye.error("Product not found");return}if(x.find(ee=>ee.pro_code===parseInt(q.pro_code))){Ye.error("Product already added to this import");return}const Q=parseFloat(q.qty||0)*parseFloat(q.price||0),ne={pro_code:parseInt(q.pro_code),pro_name:U.pro_name,qty:parseInt(q.qty||0),price:parseFloat(q.price||0),amount:Q,batch_number:q.batch_number||"",expiration_date:q.expiration_date||""};console.log("Adding new detail:",ne),p(ee=>{const N=[...ee,ne];return console.log("Updated import details:",N),N}),_(!1),setTimeout(()=>{const ee=document.querySelector('[data-testid="add-product-button"]');ee&&ee.focus()},100)},I=q=>{p(U=>U.filter((H,Q)=>Q!==q))},A=async q=>{var U,H;try{if(console.log("Import details:",x),x.length===0){Ye.error("Please add at least one product to the import");return}const Q={imp_date:q.imp_date,staff_id:parseInt(q.staff_id),sup_id:parseInt(q.sup_id),supplier:q.supplier,total:parseFloat(q.total),items:x.map(ne=>({product_id:ne.pro_code,qty:ne.qty,price:ne.price,amount:ne.amount,batch_number:ne.batch_number||null,expiration_date:ne.expiration_date||null}))};s?(await l.mutateAsync({id:e.id,data:Q}),Ye.success("Import updated successfully")):await o.mutateAsync(Q),a?a():r()}catch(Q){console.error("Submit failed:",Q),Ye.error(((H=(U=Q.response)==null?void 0:U.data)==null?void 0:H.message)||"Failed to save import")}},b=({products:q,onAdd:U,onCancel:H})=>{const{register:Q,formState:{errors:ne},watch:ee,reset:N,setValue:L}=Xa({defaultValues:{pro_code:"",qty:"",price:"",batch_number:"",expiration_date:""}}),D=ee("pro_code"),M=ee("qty"),z=ee("price");se.useEffect(()=>{if(D&&q.length>0){const me=q.find(Ne=>Ne.id===parseInt(D));me&&me.upis&&L("price",me.upis)}},[D,q,L]);const ue=M&&z?(parseFloat(M)*parseFloat(z)).toFixed(2):"0.00",pe=me=>{if(console.log("ProductForm onSubmit called with:",me),!me.pro_code){Ye.error("Please select a product");return}if(!me.qty||parseFloat(me.qty)<=0){Ye.error("Please enter a valid quantity");return}if(!me.price||parseFloat(me.price)<=0){Ye.error("Please enter a valid price");return}U(me),N()};return i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 modal-form",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Product"}),i.jsx("button",{type:"button",onClick:me=>{console.log("Cancel clicked"),H()},className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-3",style:{position:"relative",zIndex:20},children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),i.jsxs("select",{...Q("pro_code",{required:"Product is required"}),className:"w-full input",style:{position:"relative",zIndex:1e3,pointerEvents:"auto",backgroundColor:"white"},onClick:me=>{me.stopPropagation()},onChange:me=>{const Ne=q.find(Oe=>Oe.id===parseInt(me.target.value));Ne&&Ne.upis&&L("price",Ne.upis)},children:[i.jsx("option",{value:"",children:"Select Product"}),Array.isArray(q)&&q.length>0?q.map(me=>i.jsx("option",{value:me.id,children:me.pro_name},me.id)):i.jsx("option",{disabled:!0,children:"Loading products..."})]}),ne.pro_code&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.pro_code.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),i.jsx("input",{...Q("qty",{required:"Quantity is required",min:{value:1,message:"Quantity must be at least 1"}}),type:"number",min:"1",className:"w-full input",placeholder:"Enter quantity"}),ne.qty&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.qty.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price *"}),i.jsx("input",{...Q("price",{required:"Price is required",min:{value:.01,message:"Price must be greater than 0"}}),type:"number",step:"0.01",min:"0.01",className:"w-full input",placeholder:"0.00"}),ne.price&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.price.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),i.jsxs("div",{className:"w-full input bg-gray-100",children:["$",ue]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch Number"}),i.jsx("input",{...Q("batch_number"),type:"text",className:"w-full input",placeholder:"Enter batch number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiration Date"}),i.jsx("input",{...Q("expiration_date"),type:"date",className:"w-full input"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[i.jsx("button",{type:"button",onClick:H,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:()=>{const me=ee();pe(me)},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700","data-testid":"add-product-button",children:[i.jsx(An,{className:"w-4 h-4 inline mr-1"}),"Add Product"]})]})]})]})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t==="create"?"Create New Import":t==="edit"?"Edit Import":"Import Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"p-6",children:i.jsxs("form",{onSubmit:E(A),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Import Date *"}),i.jsx("input",{...S("imp_date",{required:"Import date is required"}),type:"date",className:"w-full input",disabled:n}),C.imp_date&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:C.imp_date.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Staff Member *"}),i.jsxs("select",{...S("staff_id",{required:"Staff member is required"}),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Staff Member"}),m.map(q=>i.jsx("option",{value:q.id,children:q.full_name},q.id))]}),C.staff_id&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:C.staff_id.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),i.jsxs("select",{...S("sup_id",{required:"Supplier is required"}),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Supplier"}),g.map(q=>i.jsx("option",{value:q.id,children:q.supplier},q.id))]}),C.sup_id&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:C.sup_id.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name"}),i.jsx("input",{...S("supplier"),type:"text",className:"w-full input bg-gray-100",disabled:!0,placeholder:"Auto-filled from supplier selection"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount *"}),i.jsx("input",{...S("total",{required:"Total amount is required",min:{value:0,message:"Total must be positive"}}),type:"number",step:"0.01",className:"w-full input bg-gray-100",disabled:!0,placeholder:"0.00"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[i.jsx(av,{className:"w-3 h-3 mr-1"}),"Total will update automatically when you add products"]}),C.total&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:C.total.message})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Import Products"}),!n&&i.jsxs("button",{type:"button",onClick:()=>_(!0),className:"flex items-center px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:[i.jsx(An,{className:"w-4 h-4 mr-1"}),"Add Product"]})]}),y&&!n&&i.jsx(b,{products:h,onAdd:k,onCancel:()=>_(!1)}),x.length>0?i.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expiration"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),!n&&i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map((q,U)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:q.pro_name}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:q.qty}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:["$",parseFloat(q.price||0).toFixed(2)]}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:q.batch_number||"-"}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:q.expiration_date?new Date(q.expiration_date).toLocaleDateString():"-"}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-semibold text-gray-900",children:["$",parseFloat(q.amount||0).toFixed(2)]}),!n&&i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:i.jsx("button",{type:"button",onClick:()=>I(U),className:"text-red-600 hover:text-red-900",title:"Remove product",children:i.jsx(un,{className:"w-4 h-4"})})})]},U))})]}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total:"}),i.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",x.reduce((q,U)=>q+parseFloat(U.amount||0),0).toFixed(2)]})]})})]}):i.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx(Lr,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-500",children:"No products added to this import yet"}),!n&&i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:'Click "Add Product" to add items to this import'})]})]}),!n&&i.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:s?"Update Import":"Create Import"})]}),n&&i.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})]})})},KE=()=>{var ne,ee;const{hasPermission:e}=ha(),[t,r]=se.useState(null),[a,n]=se.useState(!1),[s,o]=se.useState("create"),[l,c]=se.useState(""),[u,d]=se.useState(new Set),{data:m,isLoading:g,error:h,refetch:x}=e4(),{data:p}=Cc(),{data:y}=L0(),_=a4(),{exportToExcel:S,exportToPDF:E}=YE(),C=se.useMemo(()=>{var N;return((N=m==null?void 0:m.data)==null?void 0:N.data)||(m==null?void 0:m.data)||m||[]},[m]);(ne=p==null?void 0:p.data)!=null&&ne.data||p!=null&&p.data;const F=((ee=y==null?void 0:y.data)==null?void 0:ee.data)||(y==null?void 0:y.data)||y||[],B=C.length,T=C.reduce((N,L)=>N+parseFloat(L.total||0),0),P=C.reduce((N,L)=>{const D=L.import_details||L.importDetails||[];return N+D.reduce((M,z)=>M+parseInt(z.qty||0),0)},0),k=C.filter(N=>{const L=new Date(N.imp_date),D=new Date;return L.getMonth()===D.getMonth()&&L.getFullYear()===D.getFullYear()}).length,I=()=>{r(null),o("create"),n(!0)},A=N=>{r(N),o("view"),n(!0)},b=N=>{r(N),o("edit"),n(!0)},R=async N=>{var L,D;if(window.confirm(`Are you sure you want to delete import "#${N.id}"?`))try{await _.mutateAsync(N.id),await x(),Ye.success("Import deleted successfully")}catch(M){console.error("Delete failed:",M),Ye.error(((D=(L=M.response)==null?void 0:L.data)==null?void 0:D.message)||"Failed to delete import")}},W=N=>{const L=new Set(u);L.has(N)?L.delete(N):L.add(N),d(L)},Y=async()=>{try{await x(),Ye.success("Data refreshed successfully")}catch(N){console.error("Refresh failed:",N),Ye.error("Failed to refresh data")}},q=()=>{S(C)},U=()=>{E(C)},H=Array.isArray(C)?C.filter(N=>{var z,ue,pe,me,Ne;const L=l.toLowerCase(),M=(N.import_details||N.importDetails||[]).map(Oe=>Oe.pro_name).filter(Oe=>Oe);return((z=N.full_name)==null?void 0:z.toLowerCase().includes(L))||((pe=((ue=N.supplier)==null?void 0:ue.supplier)||N.supplier||"")==null?void 0:pe.toLowerCase().includes(L))||((Ne=(me=N.staff)==null?void 0:me.full_name)==null?void 0:Ne.toLowerCase().includes(L))||M.some(Oe=>Oe.toLowerCase().includes(L))}):[];if(g)return i.jsx(Er,{className:"h-64"});if(h)return i.jsxs("div",{className:"text-red-600",children:["Error loading imports: ",h.message]});const Q=e(["create","create_import"]);return e(["update","update_import"]),e(["delete","manage_users"]),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Imports"}),i.jsx("p",{className:"text-gray-600",children:"Manage inventory imports and stock receipts"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("button",{onClick:Y,className:"btn-secondary flex items-center",title:"Refresh Data",children:[i.jsx(sn,{className:"w-4 h-4 mr-2"}),"Refresh"]}),i.jsxs("button",{onClick:q,className:"btn-secondary flex items-center",title:"Export to Excel",children:[i.jsx(Gi,{className:"w-4 h-4 mr-2"}),"Excel"]}),i.jsxs("button",{onClick:U,className:"btn-secondary flex items-center",title:"Export to PDF",children:[i.jsx(nv,{className:"w-4 h-4 mr-2"}),"PDF"]}),Q&&i.jsxs("button",{onClick:I,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"New Import"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(Lr,{className:"h-8 w-8 text-blue-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Imports"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(Go,{className:"h-8 w-8 text-green-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"This Month"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"h-8 w-8 text-purple-600 flex items-center justify-center",children:i.jsx("span",{className:"text-lg font-bold",children:"$"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Value"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:br(T)})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"h-8 w-8 text-orange-600 flex items-center justify-center",children:i.jsx("span",{className:"text-lg font-bold",children:"#"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Items"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:P})]})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search imports by product name, supplier, or staff...",value:l,onChange:N=>c(N.target.value),className:"input pl-10"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table min-w-full",children:[i.jsx("thead",{className:"table-header bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"table-head w-12 text-center",children:""}),i.jsx("th",{className:"table-head font-semibold",children:"ID"}),i.jsx("th",{className:"table-head font-semibold",children:"Date"}),i.jsx("th",{className:"table-head font-semibold",children:"Staff"}),i.jsx("th",{className:"table-head font-semibold",children:"Supplier"}),i.jsx("th",{className:"table-head font-semibold",children:"Summary"}),i.jsx("th",{className:"table-head font-semibold",children:"Actions"})]})}),i.jsx("tbody",{children:H.map(N=>{var z,ue,pe;const L=N.import_details||N.importDetails||[],D=L.reduce((me,Ne)=>me+parseInt(Ne.qty||0),0),M=u.has(N.id);return i.jsxs("tr",{className:"table-row hover:bg-gray-50",children:[i.jsx("td",{className:"table-cell w-16",children:i.jsx("button",{onClick:()=>W(N.id),className:"p-2 hover:bg-gray-200 rounded-full transition-colors",title:M?"Collapse details":"Expand details",children:M?i.jsx(Go,{className:"w-4 h-4 text-gray-600"}):i.jsx(Go,{className:"w-4 h-4 text-gray-600"})})}),i.jsx("td",{className:"table-cell",children:i.jsxs("span",{className:"font-bold text-blue-600 text-lg",children:["#",N.id]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:Pr(N.imp_date)})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:((z=N.staff)==null?void 0:z.full_name)||`Staff ${N.staff_id}`})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-600",children:((ue=N.supplier)==null?void 0:ue.supplier)||((pe=F.find(me=>me.id===N.sup_id))==null?void 0:pe.supplier)||"Unknown Supplier"})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:[i.jsx("span",{className:"font-medium",children:D})," ","items"]}),i.jsx("span",{className:"font-semibold text-green-600",children:br(N.total)})]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[L.length," product",L.length!==1?"s":""]})]})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>A(N),className:"p-2 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded-full",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>b(N),className:"p-2 text-green-600 hover:text-green-900 hover:bg-green-50 rounded-full",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>R(N),className:"p-2 text-red-600 hover:text-red-900 hover:bg-red-50 rounded-full",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},N.id)})})]})}),H.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Lr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No imports found"}),i.jsx("p",{className:"text-gray-500 mb-2",children:l?"Try adjusting your search terms":"Get started by creating your first import"})]})]}),a&&i.jsx(XE,{importItem:t,mode:s,onClose:()=>n(!1),onSuccess:()=>{n(!1)}})]})},JE=({order:e,mode:t,onClose:r,onSave:a})=>{var Y,q,U;const n=t==="view";$1(),z1();const{data:s}=Cc(),{data:o}=K1(),{data:l}=Tc(),c=((Y=s==null?void 0:s.data)==null?void 0:Y.data)||(s==null?void 0:s.data)||s||[],u=((q=o==null?void 0:o.data)==null?void 0:q.data)||(o==null?void 0:o.data)||o||[],d=((U=l==null?void 0:l.data)==null?void 0:U.data)||(l==null?void 0:l.data)||l||[],[m,g]=se.useState([]),[h,x]=se.useState(!1),{register:p,handleSubmit:y,formState:{errors:_},reset:S,watch:E,setValue:C}=Xa({defaultValues:{ord_date:"",staff_id:"",cus_id:"",cus_name:"",total:"",subtotal:"",tax:"",tax_percent:"",discount:"",discount_percent:"",...e}}),F=E("cus_id");E("tax_percent"),E("discount_percent");const B=E("subtotal")||0,T=E("tax")||0,P=E("discount")||0,k=E("total")||0;se.useEffect(()=>{if(e){const H=e.ord_date?new Date(e.ord_date).toISOString().split("T")[0]:"",Q=e.order_details||e.orderDetails||[];let ne=[];Q&&Q.length>0&&(ne=Q.map(L=>({pro_code:parseInt(L.pro_code||L.product_id||L.prod_id||0),pro_name:L.pro_name||L.product_name||L.prod_name||"Unknown Product",qty:parseInt(L.qty||L.quantity||0),price:parseFloat(L.price||L.unit_price||0),amount:parseFloat(L.amount||(L.qty||L.quantity)*(L.price||L.unit_price)||0)})));const ee=ne.length>0?ne.reduce((L,D)=>L+parseFloat(D.amount||0),0):0,N={ord_date:H,staff_id:e.staff_id||"",cus_id:e.cus_id||"",cus_name:e.cus_name||"",total:e.total||"0.00",subtotal:ee>0?ee.toFixed(2):e.subtotal||"0.00",tax:e.tax||"0.00",tax_percent:e.tax_percent||"0",discount:e.discount||"0.00",discount_percent:e.discount_percent||"0"};S(N),g(ne)}else S({ord_date:"",staff_id:"",cus_id:"",cus_name:"",total:"0.00",subtotal:"0.00",tax:"0.00",tax_percent:"0",discount:"0.00",discount_percent:"0"}),g([])},[e,S]),se.useEffect(()=>{const H=m.length>0?m.reduce((D,M)=>D+parseFloat(M.amount||0),0):0;C("subtotal",H.toFixed(2));const Q=parseFloat(E("tax_percent"))||0,ne=H*(Q/100);C("tax",ne.toFixed(2));const ee=parseFloat(E("discount_percent"))||0,N=H*(ee/100);C("discount",N.toFixed(2));const L=H+ne-N;C("total",L.toFixed(2))},[m,C,E]),se.useEffect(()=>{if(F&&u.length>0){const H=u.find(Q=>Q.id===parseInt(F));H&&C("cus_name",H.cus_name)}},[F,u,C]);const I=H=>{if(!H.pro_code||!H.qty||!H.price){Ye.error("Please fill all required product fields");return}const Q=parseInt(H.pro_code),ne=d.find(M=>M.id===Q);if(!ne){Ye.error("Product not found");return}const ee=parseInt(H.qty),N=parseFloat(H.price);if(ee<=0){Ye.error("Quantity must be greater than 0");return}if(N<=0){Ye.error("Price must be greater than 0");return}const L=ee*N,D={pro_code:Q,pro_name:ne.pro_name,qty:ee,price:N,amount:L};g(M=>[...M,D]),x(!1),Ye.success(`Added ${ne.pro_name} to order`)},A=H=>{g(Q=>Q.filter((ne,ee)=>ee!==H))},b=async H=>{var Q,ne,ee;try{if(m.length===0){Ye.error("Please add at least one product to the order");return}let N=((Q=H.cus_name)==null?void 0:Q.trim())||"";if(H.cus_id){const D=u.find(M=>M.id===parseInt(H.cus_id));D&&D.cus_name&&(N=D.cus_name)}N||(N="Walk-in Customer");const L={ord_date:H.ord_date,staff_id:parseInt(H.staff_id),cus_id:H.cus_id?parseInt(H.cus_id):null,cus_name:N,total:parseFloat(H.total)||0,subtotal:parseFloat(H.subtotal)||0,tax:parseFloat(H.tax)||0,tax_percent:parseFloat(H.tax_percent)||0,discount:parseFloat(H.discount)||0,discount_percent:parseFloat(H.discount_percent)||0,items:m.map(D=>({product_id:D.pro_code,qty:D.qty,price:D.price,amount:D.amount}))};if(!L.items||L.items.length===0){Ye.error("Please add at least one product to the order");return}a(L)}catch(N){console.error("Submit failed:",N),Ye.error(((ee=(ne=N.response)==null?void 0:ne.data)==null?void 0:ee.message)||"Failed to save order")}},R=async H=>{var Q,ne,ee;try{if(m.length===0){Ye.error("Please add at least one product to the order");return}let N=((Q=H.cus_name)==null?void 0:Q.trim())||"";if(H.cus_id){const D=u.find(M=>M.id===parseInt(H.cus_id));D&&D.cus_name&&(N=D.cus_name)}N||(N="Walk-in Customer");const L={ord_date:H.ord_date,staff_id:parseInt(H.staff_id),cus_id:H.cus_id?parseInt(H.cus_id):null,cus_name:N,total:parseFloat(H.total)||0,subtotal:parseFloat(H.subtotal)||0,tax:parseFloat(H.tax)||0,tax_percent:parseFloat(H.tax_percent)||0,discount:parseFloat(H.discount)||0,discount_percent:parseFloat(H.discount_percent)||0,items:m.map(D=>({product_id:D.pro_code,qty:D.qty,price:D.price,amount:D.amount}))};if(!L.items||L.items.length===0){Ye.error("Please add at least one product to the order");return}a(L),S({ord_date:H.ord_date,staff_id:H.staff_id,cus_id:"",cus_name:"",total:"0.00",subtotal:"0.00",tax:"0.00",tax_percent:"0",discount:"0.00",discount_percent:"0"}),g([]),x(!1)}catch(N){console.error("Submit failed:",N),Ye.error(((ee=(ne=N.response)==null?void 0:ne.data)==null?void 0:ee.message)||"Failed to save order")}},W=({products:H,onAdd:Q,onCancel:ne})=>{const{register:ee,handleSubmit:N,formState:{errors:L},watch:D,reset:M,setValue:z}=Xa(),ue=D("pro_code"),pe=D("qty"),me=D("price");se.useEffect(()=>{if(ue&&H.length>0){const Ie=H.find(Ze=>Ze.id===parseInt(ue));Ie&&Ie.sup&&z("price",Ie.sup)}},[ue,H,z]);const Ne=pe&&me?(parseFloat(pe)*parseFloat(me)).toFixed(2):"0.00",Oe=Ie=>{if(!Ie.pro_code){Ye.error("Please select a product");return}if(!Ie.qty||parseFloat(Ie.qty)<=0){Ye.error("Please enter a valid quantity");return}if(!Ie.price||parseFloat(Ie.price)<=0){Ye.error("Please enter a valid price");return}Q(Ie),M()};return i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Product"}),i.jsx("button",{type:"button",onClick:ne,className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),i.jsxs("select",{...ee("pro_code",{required:"Product is required"}),className:"w-full input",children:[i.jsx("option",{value:"",children:"Select Product"}),H.map(Ie=>i.jsx("option",{value:Ie.id,children:Ie.pro_name},Ie.id))]}),L.pro_code&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:L.pro_code.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),i.jsx("input",{...ee("qty",{required:"Quantity is required",min:{value:1,message:"Quantity must be at least 1"}}),type:"number",min:"1",className:"w-full input",placeholder:"Enter quantity"}),L.qty&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:L.qty.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price *"}),i.jsx("input",{...ee("price",{required:"Price is required",min:{value:.01,message:"Price must be greater than 0"}}),type:"number",step:"0.01",min:"0.01",className:"w-full input",placeholder:"0.00"}),L.price&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:L.price.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),i.jsxs("div",{className:"w-full input bg-gray-100",children:["$",Ne]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[i.jsx("button",{type:"button",onClick:ne,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:N(Oe),className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Add Product"})]})]})]})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t==="create"?"Create New Order":t==="edit"?"Edit Order":"Order Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsxs("form",{onSubmit:y(b),className:"p-6 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Date *"}),i.jsx("input",{...p("ord_date",{required:"Order date is required"}),type:"date",className:"w-full input",disabled:n}),_.ord_date&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:_.ord_date.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Staff Member *"}),i.jsxs("select",{...p("staff_id",{required:"Staff member is required"}),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Staff Member"}),c.map(H=>i.jsx("option",{value:H.id,children:H.full_name},H.id))]}),_.staff_id&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:_.staff_id.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),i.jsxs("select",{...p("cus_id"),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Customer (Optional)"}),u.map(H=>i.jsx("option",{value:H.id,children:H.cus_name},H.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),i.jsx("input",{...p("cus_name"),type:"text",className:"w-full input",placeholder:"Enter customer name",disabled:n})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Order Items"}),!n&&i.jsxs("button",{type:"button",onClick:()=>x(!0),className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"Add Product"]})]}),h&&!n&&i.jsx(W,{products:d,onAdd:I,onCancel:()=>x(!1)}),i.jsx("div",{className:"border rounded-lg overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),!n&&i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.length>0?m.map((H,Q)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:H.pro_name}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.qty}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:br(H.price)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:br(H.amount)}),!n&&i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsx("button",{type:"button",onClick:()=>A(Q),className:"text-red-600 hover:text-red-900",children:i.jsx(un,{className:"w-4 h-4"})})})]},Q)):i.jsx("tr",{children:i.jsx("td",{colSpan:n?4:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No products added yet"})})})]})})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Financial Summary"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subtotal"}),i.jsx("div",{className:"mt-1 text-lg font-medium text-gray-900",children:br(B)})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Tax (%) ",i.jsx("input",{...p("tax_percent"),type:"number",step:"0.01",min:"0",max:"100",className:"w-16 input ml-1 text-xs",disabled:n})]}),i.jsx("div",{className:"mt-1 text-lg font-medium text-gray-900",children:br(T)})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Discount (%) ",i.jsx("input",{...p("discount_percent"),type:"number",step:"0.01",min:"0",max:"100",className:"w-16 input ml-1 text-xs",disabled:n})]}),i.jsx("div",{className:"mt-1 text-lg font-medium text-gray-900",children:br(P)})]}),i.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total"}),i.jsx("div",{className:"mt-1 text-xl font-bold text-blue-600",children:br(k)})]})]})]}),!n&&i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),t==="create"&&i.jsx("button",{type:"button",onClick:y(R),className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700",children:"Save and Add Another"}),i.jsx("button",{type:"button",onClick:y(b),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:t==="edit"?"Update Order":"Create Order"})]})]})]})})},QE=()=>{const{user:e,hasPermission:t}=ha(),[r,a]=se.useState(""),[n,s]=se.useState(null),[o,l]=se.useState(!1),[c,u]=se.useState("create"),{data:d,isLoading:m,error:g,refetch:h}=Kf(),x=Nb(),p=$1(),y=z1(),_=se.useMemo(()=>{var b;return((b=d==null?void 0:d.data)==null?void 0:b.data)||(d==null?void 0:d.data)||d||[]},[d]),S=se.useMemo(()=>Array.isArray(_)?Object.values(_.reduce((b,R)=>(!R||!R.id||(b[R.id]=b[R.id]?{...b[R.id],...R}:R),b),{})):[],[_]),E=t(["create_order","create"]),C=t(["update_order","update"]),F=t(["delete_order","delete"]),B=()=>{s(null),u("create"),l(!0)},T=async b=>{var R;try{const W=await xi.getById(b.id),Y=((R=W==null?void 0:W.data)==null?void 0:R.data)||(W==null?void 0:W.data)||W;s(Y||b),u("view"),l(!0)}catch(W){console.error("Failed to fetch order details:",W),s(b),u("view"),l(!0)}},P=async b=>{var R;try{const W=await xi.getById(b.id),Y=((R=W==null?void 0:W.data)==null?void 0:R.data)||(W==null?void 0:W.data)||W;s(Y||b),u("edit"),l(!0)}catch(W){console.error("Failed to fetch order details:",W),s(b),u("edit"),l(!0)}},k=async b=>{if(window.confirm(`Are you sure you want to delete order #${b.id}?`))try{await x.mutateAsync(b.id),await h()}catch(R){console.error("Delete failed:",R)}},I=async b=>{var R,W;try{c==="edit"?(await y.mutateAsync({id:n.id,data:b}),Ye.success("Order updated successfully"),await h()):(await p.mutateAsync(b),Ye.success("Order created successfully"),await h()),l(!1),s(null)}catch(Y){console.error("Save failed:",Y),Ye.error(((W=(R=Y.response)==null?void 0:R.data)==null?void 0:W.message)||"Failed to save order")}},A=Array.isArray(S)?S.filter(b=>{var U,H;if(!r)return!0;const R=r.toLowerCase(),W=(((U=b.staff)==null?void 0:U.full_name)||b.full_name||"").toLowerCase(),Y=(b.cus_name||"").toLowerCase(),q=((H=b.id)==null?void 0:H.toString())||"";return W.includes(R)||Y.includes(R)||q.includes(R)}):[];return m?i.jsx(Er,{className:"h-64"}):g?i.jsxs("div",{className:"text-red-600",children:["Error loading orders: ",g.message]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),i.jsx("p",{className:"text-gray-600",children:(e==null?void 0:e.type)==="staff_sale"?"Manage sales orders":"View orders"})]}),E&&i.jsxs("button",{onClick:B,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"New Order"]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"Search orders...",className:"input pl-10 w-full",value:r,onChange:b=>a(b.target.value)})]})})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.length>0?A.map(b=>{var U,H,Q;const R=b.payments||b.payment||[],W=Array.isArray(R)?R.reduce((ne,ee)=>ne+parseFloat(ee.deposit||ee.total||ee.amount||0),0):0,q=parseFloat(b.total||0)-W<=.01;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",b.id]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Pr(b.ord_date)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.cus_name||"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((U=b.staff)==null?void 0:U.full_name)||b.full_name||"N/A"}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[((H=b.orderDetails)==null?void 0:H.length)||((Q=b.order_details)==null?void 0:Q.length)||0," items"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:br(b.total)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:q?"Paid":"Pending"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>T(b),className:"text-blue-600 hover:text-blue-900",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),C&&i.jsx("button",{onClick:()=>P(b),className:"text-green-600 hover:text-green-900",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),F&&i.jsx("button",{onClick:()=>k(b),className:"text-red-600 hover:text-red-900",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},b.id)}):i.jsx("tr",{children:i.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No orders found"})})})]})})}),o&&i.jsx(JE,{order:n,mode:c,onClose:()=>l(!1),onSave:I})]})},ZE=({payment:e,mode:t,onClose:r,onSave:a})=>{var P,k;const n=t==="view",s=t==="edit",o=V1(),l=G1(),{data:c}=Kf(),{data:u}=Cc(),d=((P=c==null?void 0:c.data)==null?void 0:P.data)||(c==null?void 0:c.data)||c||[],m=((k=u==null?void 0:u.data)==null?void 0:k.data)||(u==null?void 0:u.data)||u||[],g=I=>{var W;if(!I)return{isPaid:!1,status:"Pending",colorClass:"bg-yellow-100 text-yellow-800"};const A=((W=I.payments)==null?void 0:W.reduce((Y,q)=>Y+parseFloat(q.deposit||0),0))||0,R=parseFloat(I.total||0)-A<=.01;return{isPaid:R,status:R?"Paid":"Pending",colorClass:R?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}},{register:h,handleSubmit:x,formState:{errors:p},reset:y,watch:_,setValue:S}=Xa(),E=_("ord_code"),C=_("total"),F=_("deposit");se.useEffect(()=>{if(e&&t!=="create"){const A={pay_date:e.pay_date?new Date(e.pay_date).toISOString().split("T")[0]:"",staff_id:e.staff_id||"",ord_code:e.ord_code||"",total:e.total||"",deposit:e.deposit||"",remain:e.remain||"",payment_method:e.payment_method||""};y(A)}else t==="create"&&y({pay_date:"",staff_id:"",ord_code:"",total:"",deposit:"",remain:"",payment_method:""})},[e,t,y]),se.useEffect(()=>{if(C&&F){const I=parseFloat(C)-parseFloat(F);isNaN(I)||S("remain",I.toFixed(2))}},[C,F,S]),se.useEffect(()=>{if(E&&d.length>0){const I=d.find(A=>A.id===parseInt(E));I&&(S("total",I.total),t==="create"&&!(e!=null&&e.payment_method)&&S("payment_method","cash"))}},[E,d,e,t,S]);const B=async I=>{try{const A={pay_date:I.pay_date,staff_id:parseInt(I.staff_id),ord_code:parseInt(I.ord_code),total:parseFloat(I.total),deposit:parseFloat(I.deposit),remain:parseFloat(I.remain),payment_method:I.payment_method};console.log("Submitting payment data:",A);let b;s?(console.log("Updating existing payment:",e.id),b=await l.mutateAsync({id:e.id,data:A})):(console.log("Creating new payment"),b=await o.mutateAsync(A)),console.log("Payment operation response:",b),b&&b.success===!0?(console.log("Payment operation successful with data:",b.data),a(b.data||A)):b&&b.data?(console.log("Payment operation successful (alternative format):",b.data),a(b.data||A)):(console.log("Payment operation successful without expected data format"),a(A))}catch(A){console.error("Submit failed:",A),console.error("Full error details:",{message:A.message,stack:A.stack,name:A.name});const b=A.message||A.response&&A.response.data&&A.response.data.message||"Failed to save payment";console.error("Displaying error message:",b),Ye.error(b)}},T=I=>{I.preventDefault(),x(B)(I)};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t==="create"?"Create New Payment":t==="edit"?"Edit Payment":"Payment Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"p-6",children:i.jsxs("form",{onSubmit:T,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),i.jsx("input",{...h("pay_date",{required:"Payment date is required"}),type:"date",className:"w-full input",disabled:n}),p.pay_date&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.pay_date.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Staff Member *"}),i.jsxs("select",{...h("staff_id",{required:"Staff member is required"}),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Staff Member"}),m.map(I=>i.jsx("option",{value:I.id,children:I.full_name},I.id))]}),p.staff_id&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.staff_id.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order *"}),i.jsxs("select",{...h("ord_code",{required:"Order is required"}),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Order"}),d.map(I=>{const{isPaid:A,status:b,colorClass:R}=g(I);return i.jsxs("option",{value:I.id,children:["Order #",I.id," - ",I.cus_name," ($",I.total,") -"," ",b]},I.id)})]}),p.ord_code&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.ord_code.message}),E&&i.jsx("div",{className:"mt-2",children:(()=>{const I=d.find(A=>A.id===parseInt(E));if(I){const{status:A,colorClass:b}=g(I);return i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b}`,children:A})}return null})()})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),i.jsxs("select",{...h("payment_method",{required:"Payment method is required"}),className:"w-full input",disabled:n,children:[i.jsx("option",{value:"",children:"Select Payment Method"}),i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),i.jsx("option",{value:"check",children:"Check"})]}),p.payment_method&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.payment_method.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount *"}),i.jsx("input",{...h("total",{required:"Total amount is required",min:{value:0,message:"Total must be positive"}}),type:"number",step:"0.01",className:"w-full input",disabled:!0,placeholder:"0.00"}),p.total&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.total.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deposit Amount *"}),i.jsx("input",{...h("deposit",{required:"Deposit amount is required",min:{value:0,message:"Deposit must be positive"}}),type:"number",step:"0.01",className:"w-full input",disabled:n,placeholder:"0.00"}),p.deposit&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.deposit.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remaining Amount"}),i.jsx("input",{...h("remain"),type:"number",step:"0.01",className:"w-full input bg-gray-100",disabled:!0,placeholder:"0.00"})]})]}),!n&&i.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:s?"Update Payment":"Create Payment"})]}),n&&i.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})]})})},eT=()=>{var A;const{user:e,hasPermission:t}=ha(),[r,a]=se.useState(""),[n,s]=se.useState(null),[o,l]=se.useState(!1),[c,u]=se.useState("create"),{data:d,isLoading:m,error:g,refetch:h}=Jf(),x=Sb(),p=V1(),y=G1(),_=((A=d==null?void 0:d.data)==null?void 0:A.data)||(d==null?void 0:d.data)||d||[],S=t(["create_payment","create"]),E=t(["update_payment","update"]),C=t(["delete_payment","delete"]),F=()=>{s(null),u("create"),l(!0)},B=b=>{s(b),u("view"),l(!0)},T=b=>{s(b),u("edit"),l(!0)},P=async b=>{if(window.confirm(`Are you sure you want to delete payment #${b.id}?`))try{await x.mutateAsync(b.id),await h()}catch{}},k=async b=>{try{c==="edit"?await y.mutateAsync({id:n.id,data:b}):await p.mutateAsync(b),await new Promise(R=>setTimeout(R,250)),await h()}catch{}finally{l(!1)}},I=Array.isArray(_)?_.filter(b=>{var W,Y,q;const R=r.toLowerCase();return((W=b.full_name)==null?void 0:W.toLowerCase().includes(R))||((q=(Y=b.order)==null?void 0:Y.cus_name)==null?void 0:q.toLowerCase().includes(R))||b.id.toString().includes(R)}):[];return m?i.jsx(Er,{className:"h-64"}):g?i.jsxs("div",{className:"text-red-600",children:["Error loading payments: ",g.message]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Payments"}),i.jsx("p",{className:"text-gray-600",children:(e==null?void 0:e.type)==="staff_sale"?"Manage payments":"View payments"})]}),S&&i.jsxs("button",{onClick:F,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"New Payment"]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),i.jsx("input",{type:"text",placeholder:"Search payments...",className:"input pl-10 w-full",value:r,onChange:b=>a(b.target.value)})]})})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment ID"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deposit"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Remaining"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:I.length>0?I.map(b=>{var R,W;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",b.id]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Pr(b.pay_date)}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["#",b.ord_code]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((R=b.order)==null?void 0:R.cus_name)||"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((W=b.staff)==null?void 0:W.full_name)||"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:br(b.total)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:br(b.deposit)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:br(b.remain)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.remain<=.01?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:b.remain<=.01?"Paid":"Pending"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>B(b),className:"text-blue-600 hover:text-blue-900",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),E&&i.jsx("button",{onClick:()=>T(b),className:"text-green-600 hover:text-green-900",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),C&&i.jsx("button",{onClick:()=>P(b),className:"text-red-600 hover:text-red-900",title:"Delete",children:i.jsx(un,{className:"w-4 h-4"})})]})})]},b.id)}):i.jsx("tr",{children:i.jsx("td",{colSpan:"9",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No payments found"})})})]})})}),o&&i.jsx(ZE,{payment:n,mode:c,onClose:()=>l(!1),onSave:k})]})},Di=6e4,tT=12e4,Et={getImportReport:e=>ut.get("/fast-import-report",e,{timeout:Di}),getSalesReport:e=>ut.get("/fast-sales-report",e,{timeout:Di}),getImportSummary:e=>ut.get("/reports/import-summary",e,{timeout:Di}),getSalesSummary:e=>ut.get("/reports/sales-summary",e,{timeout:Di}),getBestSellingProducts:e=>ut.get("/reports/best-selling-products",e,{timeout:Di}),getLowStockProducts:e=>ut.get("/reports/low-stock-products",e,{timeout:Di}),getInventorySummary:e=>ut.get("/reports/inventory-summary",e,{timeout:Di}),exportImportExcel:e=>Et.buildExportUrl("/reports/export-import-excel",e),exportSalesExcel:e=>Et.buildExportUrl("/reports/export-sales-excel",e),exportImportExcelXlsx:e=>Et.buildExportUrl("/reports/export-import-excel-xlsx",e),exportSalesExcelXlsx:e=>Et.buildExportUrl("/reports/export-sales-excel-xlsx",e),exportImportPdf:e=>Et.buildExportUrl("/reports/export-import-pdf",e),exportSalesPdf:e=>Et.buildExportUrl("/reports/export-sales-pdf",e),exportSingleImportWord:e=>Et.buildExportUrl("/reports/export-single-import-word",e),exportSingleSalesWord:e=>Et.buildExportUrl("/reports/export-single-sales-word",e),buildExportUrl:(e,t)=>{const r=new URLSearchParams(t).toString();return`${Is.base_api_url.replace("/api/","")}/api${e}?${r}`},exportPdf:async(e,t)=>{const r={...t,type:e};let a;switch(e){case"import":a=Et.exportImportPdf(r);break;case"sales":a=Et.exportSalesPdf(r);break;default:throw new Error(`Unsupported PDF export type: ${e}`)}const n=`${e}-report-${new Date().toISOString().split("T")[0]}.pdf`;return await Et.downloadFile(a,n)},exportExcel:async(e,t)=>{const r={...t,type:e};let a;switch(e){case"import":a=Et.exportImportExcelXlsx(r);break;case"sales":a=Et.exportSalesExcelXlsx(r);break;default:throw new Error(`Unsupported Excel export type: ${e}`)}const n=`${e}-report-${new Date().toISOString().split("T")[0]}.xlsx`;return await Et.downloadFile(a,n)},exportCsv:async(e,t)=>await Et.exportExcel(e,t),downloadFile:async(e,t,r=0)=>{try{console.log("Downloading file:",{url:e,filename:t,retryCount:r});const n=localStorage.getItem("token"),s=new AbortController,o=setTimeout(()=>s.abort(),tT),l=await fetch(e,{signal:s.signal,headers:{Authorization:`Bearer ${n}`,Accept:"application/octet-stream, application/pdf, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"}});if(clearTimeout(o),console.log("Download response:",l.status,l.statusText),!l.ok)if(l.status===422){const m=await l.json();throw new Error(`Validation error: ${JSON.stringify(m.errors||m)}`)}else throw l.status===404?new Error("Export endpoint not found. Please check the server configuration."):l.status>=500?new Error("Server error during export. Please try again later."):new Error(`Download failed: ${l.status} ${l.statusText}`);const c=await l.blob();if(!c||c.size===0)throw new Error("Received empty file from server");console.log("Blob created:",c.size,"bytes, type:",c.type);const u=window.URL.createObjectURL(c),d=document.createElement("a");return d.href=u,d.download=t,d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d),setTimeout(()=>{window.URL.revokeObjectURL(u)},100),console.log("File downloaded successfully:",t),{success:!0,filename:t,size:c.size}}catch(n){if(console.error("Download error:",n),n.name==="AbortError"&&r<2)return console.log(`Retrying download (${r+1}/2)...`),await Et.downloadFile(e,t,r+1);let s;throw n.name==="AbortError"?s="Export timed out. The server is taking too long to generate the report.":n.message.includes("Validation error")?s=n.message:n.message.includes("empty file")?s="The server returned an empty file. Please try again.":s=`Export failed: ${n.message}`,new Error(s)}},healthCheck:async()=>{try{return{healthy:!0,response:await ut.get("/reports/health",{},{timeout:1e4})}}catch(e){return{healthy:!1,error:e.message}}}},Ff=Object.freeze(Object.defineProperty({__proto__:null,reportService:Et},Symbol.toStringTag,{value:"Module"})),Nh=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!1),[s,o]=se.useState(null),l=async()=>{try{n(!0);const u=await Et.getImportReport(e);r(u),o(null)}catch(u){o(u),console.error("Import report fetch failed:",u)}finally{n(!1)}};return se.useEffect(()=>{l()},[JSON.stringify(e)]),{data:t,isLoading:a,error:s,refetch:()=>{l()}}},kf=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!1),[s,o]=se.useState(null);return se.useEffect(()=>{(async()=>{try{n(!0);const u=await Et.getSalesReport(e);r(u),o(null)}catch(u){o(u),console.error("Sales report fetch failed:",u)}finally{n(!1)}})()},[JSON.stringify(e)]),{data:t,isLoading:a,error:s,refetch:()=>{(async()=>{try{n(!0);const u=await Et.getSalesReport(e);r(u),o(null)}catch(u){o(u),console.error("Sales report refetch failed:",u)}finally{n(!1)}})()}}},rT=(e={})=>{const[t,r]=se.useState(null),[a,n]=se.useState(!0),[s,o]=se.useState(null),l=se.useRef(!1),c=se.useRef(null),u=JSON.stringify(e);return se.useEffect(()=>{if(l.current){console.log("useBestSellingProducts: Already fetching, skipping...");return}if(c.current===u)return;(async()=>{try{l.current=!0,n(!0);const m=await Et.getBestSellingProducts(e);r(m),o(null),c.current=u}catch(m){o(m),console.error("Best selling products fetch failed:",m)}finally{n(!1),l.current=!1}})()},[u]),{data:t,isLoading:a,error:s}},Zg=async e=>{console.log("Export report:",e);try{const{exportService:t}=await Ga(()=>import("./exportService-437f142c.js"),["assets/exportService-437f142c.js","assets/vendor-348d559c.js","assets/ui-58a945e4.js","assets/charts-bc1c71da.js"]),{type:r,format:a,filename:n,fallbackData:s}=e;let o;if(a==="xlsx"||a==="excel")o=t.exportToExcel(s,n,r);else if(a==="pdf")o=t.exportToPDF(s,n,r);else throw new Error(`Unsupported format: ${a}`);if(o.success){const{toast:l}=await Ga(()=>import("./ui-58a945e4.js").then(c=>c.a6),["assets/ui-58a945e4.js","assets/vendor-348d559c.js"]);l.success(o.message)}else throw new Error(o.message);return o}catch(t){console.error("Export failed:",t);const{toast:r}=await Ga(()=>import("./ui-58a945e4.js").then(a=>a.a6),["assets/ui-58a945e4.js","assets/vendor-348d559c.js"]);throw r.error("Export failed: "+t.message),t}},z0={getAll:()=>ut.get("/users"),getById:e=>ut.get(`/users/${e}`),create:e=>e instanceof FormData?el("/users",e).then(t=>t.data):ut.post("/users",e),update:(e,t)=>t instanceof FormData?(t.append("_method","PUT"),el(`/users/${e}`,t).then(r=>r.data)):ut.put(`/users/${e}`,t),delete:e=>ut.delete(`/users/${e}`)},e2=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await z0.getAll();t(l),s(null)}catch(l){s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},aT=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await z0.create(a);return Ye.success("User created successfully"),o}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to create user"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},nT=()=>{const[e,t]=se.useState(!1),r=async({id:a,data:n})=>{var s,o;try{t(!0);const l=await z0.update(a,n);return Ye.success("User updated successfully"),l}catch(l){throw Ye.error(((o=(s=l.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to update user"),l}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},sT=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await z0.delete(a);return Ye.success("User deleted successfully"),o}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to delete user"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},iT=({dateRange:e,filters:t})=>{const{data:r,isLoading:a,error:n,refetch:s}=Nh({date_from:e.from,date_to:e.to,...t}),[o,l]=se.useState(50);let c=[];r?(console.log("Raw importsResponse type:",typeof r),console.log("Raw importsResponse:",r),Array.isArray(r.data)?(c=r.data,console.log("Using importsResponse.data (array)")):Array.isArray(r)?(c=r,console.log("Using importsResponse directly (array)")):r.success&&Array.isArray(r.data)?(c=r.data,console.log("Using importsResponse.success.data")):r.data&&typeof r.data=="object"?(c=r.data.data||r.data.imports||[],console.log("Using nested importsResponse.data.data")):console.warn("Unknown response format:",r)):console.warn("importsResponse is null or undefined");const u=Array.isArray(c)?c.filter(h=>{if(!h.imp_date)return console.log("Import item without date, including:",h.id),!0;try{const x=h.imp_date.split(" ")[0],p=new Date(x+"T00:00:00"),y=new Date(e.from+"T00:00:00"),_=new Date(e.to+"T23:59:59");if(isNaN(p.getTime())||isNaN(y.getTime())||isNaN(_.getTime()))return console.warn("Invalid date detected:",{importDate:h.imp_date,importDateStr:x,fromDate:e.from,toDate:e.to}),!0;const S=p>=y&&p<=_;return S||console.log("Import filtered out by date:",{id:h.id,importDate:h.imp_date,importDateParsed:p.toISOString(),fromDate:y.toISOString(),toDate:_.toISOString(),range:`${e.from} to ${e.to}`}),S}catch(x){return console.error("Date filtering error:",x,h),!0}}):[];se.useEffect(()=>{c.length>0,u.length>0},[r,u,e]);const d=h=>{var y;const x=h.import_details||h.importDetails||[],p=()=>{var S;const _=h.staff_name||((S=h.staff)==null?void 0:S.full_name)||h.full_name||`Staff ${h.staff_id}`;return _==="Import from"||!_||_.trim()===""?"Unknown Staff":_};return x.length===0?[{id:`${h.id}-0`,importId:h.id,date:h.imp_date,staff:p(),supplier:h.supplier_name||((y=h.supplier)==null?void 0:y.supplier)||h.supplier||"N/A",productName:"General Import",qty:1,amount:h.total_amount||h.total||0,batchNumber:"N/A",expirationDate:"N/A",status:h.status||"Completed"}]:x.map((_,S)=>{var E,C;return{id:`${h.id}-${S}`,importId:h.id,date:h.imp_date,staff:p(),supplier:h.supplier_name||((E=h.supplier)==null?void 0:E.supplier)||h.supplier||"N/A",productName:_.pro_name||((C=_.product)==null?void 0:C.pro_name)||_.product_name||"Unknown Product",qty:_.qty||_.quantity||0,amount:_.amount||_.price||_.total||0,batchNumber:_.batch_number||_.batchNumber||_.batch||"N/A",expirationDate:_.expiration_date||_.expirationDate||_.expiry||"N/A",status:h.status||"Completed"}})},m=u.flatMap(h=>d(h)),g=m.slice(0,o);return a?i.jsx("div",{className:"flex justify-center items-center py-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Lr,{className:"w-5 h-5 animate-spin mx-auto mb-1 text-blue-600"}),i.jsx("p",{className:"text-gray-600 text-xs",children:"Loading..."})]})}):n?(console.error("ImportReportTable Error:",n),i.jsxs("div",{className:"text-red-600 p-4 bg-red-50 rounded-lg",children:[i.jsxs("p",{className:"font-semibold",children:["Error loading imports: ",n.message]}),i.jsx("p",{className:"text-sm mt-2",children:"Please check the browser console for more details."}),i.jsx("button",{onClick:()=>s(),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]})):i.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(Lr,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Import Transactions Report"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Generated on: ",Pr(new Date)," | Total Imports: ",u.length," | Total Value: ",br(m.reduce((h,x)=>h+parseFloat(x.amount||0),0))]})]})]}),i.jsxs("button",{onClick:()=>s(),className:"flex items-center gap-1 px-3 py-1 bg-white text-gray-700 rounded-lg text-sm hover:bg-gray-100 border border-gray-200 transition-colors",title:"Refresh data",children:[i.jsx(Lr,{className:"w-4 h-4"}),"Refresh"]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qty"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expiration Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.length>0?g.map(h=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",h.importId]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Pr(h.date)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.staff}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.supplier}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",title:h.productName,children:h.productName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.qty}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:br(h.amount)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h.batchNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h.expirationDate!=="N/A"&&h.expirationDate?(()=>{try{const x=h.expirationDate;return typeof x=="string"&&x.includes("-")?Pr(x,"MMM dd, yyyy"):Pr(typeof x=="string"?new Date(x):x,"MMM dd, yyyy")}catch(x){return console.warn("Error formatting expiration date:",expDate,x),expDate}})():"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:h.status})})]},h.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:"10",className:"px-6 py-12 text-center",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx(Lr,{className:"w-12 h-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Import Data"}),i.jsxs("p",{className:"text-gray-500",children:["No imports found for the selected date range (",Pr(e.from)," to ",Pr(e.to),")"]})]})})})})]})}),g.length<m.length&&i.jsx("div",{className:"px-6 py-4 text-center border-t border-gray-200",children:i.jsxs("button",{onClick:()=>l(h=>h+50),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[" (",m.length-g.length," )"]})})]})},oT=()=>{var y,_;const[e,t]=se.useState("import"),r=()=>({from:"2024-01-01",to:new Date("2025-12-31").toISOString().split("T")[0]}),[a,n]=se.useState(r()),[s,o]=se.useState({});se.useState({key:null,direction:"asc"}),se.useEffect(()=>{const S=()=>{const E=window.location.hash.substring(1);t(E==="sales"?"sales":"import")};return S(),window.addEventListener("hashchange",S),()=>window.removeEventListener("hashchange",S)},[]);const l={...s,date_from:a.from,date_to:a.to},{data:c,isLoading:u}=Nh(l),{data:d,isLoading:m,error:g}=kf(l),h=async(S,E)=>{const{toast:C}=await Ga(()=>import("./ui-58a945e4.js").then(F=>F.a6),["assets/ui-58a945e4.js","assets/vendor-348d559c.js"]);try{const F=`${S}_report_${a.from}_to_${a.to}.${E}`;let B=[];if(S==="import")try{const{reportService:T}=await Ga(()=>Promise.resolve().then(()=>Ff),void 0),P=await T.getImportReport({date_from:a.from,date_to:a.to,...s});let k=[];P&&(Array.isArray(P.data)?k=P.data:Array.isArray(P)?k=P:P.success&&Array.isArray(P.data)?k=P.data:P.data&&typeof P.data=="object"&&(k=P.data.data||P.data.imports||[])),console.log("=== IMPORT EXPORT DEBUG ==="),console.log("importsResponse:",P),console.log("imports array:",k),console.log("imports length:",k.length),console.log("=========================="),B=(Array.isArray(k)?k.filter(A=>{if(!A.imp_date)return!0;const b=new Date(A.imp_date),R=new Date(a.from);R.setHours(0,0,0,0);const W=new Date(a.to);return W.setHours(23,59,59,999),b>=R&&b<=W}):[]).flatMap(A=>{var R,W;const b=A.import_details||A.importDetails||[];return b.length===0?[{id:`${A.id}-0`,importId:A.id,date:A.imp_date,staff:A.staff_name||((R=A.staff)==null?void 0:R.full_name)||A.full_name||`Staff ${A.staff_id}`,supplier:A.supplier_name||((W=A.supplier)==null?void 0:W.supplier)||A.supplier||"N/A",productName:"General Import",qty:1,amount:A.total_amount||A.total||0,batchNumber:"N/A",expirationDate:"N/A",status:A.status||"Completed"}]:b.map((Y,q)=>{var U,H,Q;return{id:`${A.id}-${q}`,importId:A.id,date:A.imp_date,staff:A.staff_name||((U=A.staff)==null?void 0:U.full_name)||A.full_name||`Staff ${A.staff_id}`,supplier:A.supplier_name||((H=A.supplier)==null?void 0:H.supplier)||A.supplier||"N/A",productName:Y.pro_name||((Q=Y.product)==null?void 0:Q.pro_name)||Y.product_name||"Unknown Product",qty:Y.qty||Y.quantity||0,amount:Y.amount||Y.price||Y.total||0,batchNumber:Y.batch_number||Y.batchNumber||Y.batch||"N/A",expirationDate:Y.expiration_date||Y.expirationDate||Y.expiry||"N/A",status:A.status||"Completed"}})}),console.log("Using real import data from database:",B)}catch(T){console.error("Failed to get real import data:",T),B=[]}else if(S==="sales")try{const{reportService:T}=await Ga(()=>Promise.resolve().then(()=>Ff),void 0),P=await T.getSalesReport({date_from:a.from,date_to:a.to,...s});console.log("=== REAL SALES DATA DEBUG ==="),console.log("salesResponse:",P);let k=[];P&&(Array.isArray(P.data)?k=P.data:Array.isArray(P)?k=P:P.success&&Array.isArray(P.data)?k=P.data:P.orders&&Array.isArray(P.orders)?k=P.orders:P.sales&&Array.isArray(P.sales)?k=P.sales:P.data&&typeof P.data=="object"&&(k=P.data.orders||P.data.data||P.data.sales||[])),console.log("orders array:",k),console.log("orders length:",k.length),console.log("============================");const I=new Map;k.forEach(A=>{const R=A.id||A.order_id||`${A.ord_date||A.order_date||""}-${A.total||""}-${A.cus_name||""}`;I.has(R)||I.set(R,A)}),k=Array.from(I.values()),B=k.flatMap(A=>{var R,W;const b=A.order_details||A.orderDetails||[];return b.length>0?b.map(Y=>{var q,U,H;return{order_id:`#${A.id||A.order_id}`,order_date:A.ord_date||A.order_date,customer_name:A.cus_name||((q=A.customer)==null?void 0:q.name)||A.customer_name||A.customer||"N/A",staff_name:A.staff_name||((U=A.staff)==null?void 0:U.name)||A.full_name||A.staff||"N/A",product_name:Y.pro_name||((H=Y.product)==null?void 0:H.name)||Y.product_name||"Unknown Product",qty:Y.qty||0,amount:Y.amount||0,payment_status:A.payment_status||"Unknown",status:A.status||"completed"}}):[{order_id:`#${A.id||A.order_id}`,order_date:A.ord_date||A.order_date,customer_name:A.cus_name||((R=A.customer)==null?void 0:R.name)||A.customer_name||A.customer||"N/A",staff_name:A.staff_name||((W=A.staff)==null?void 0:W.name)||A.full_name||A.staff||"N/A",product_name:"General Order",qty:1,amount:A.total||A.amount||0,payment_status:A.payment_status||"Unknown",status:A.status||"completed"}]}),console.log("Using real sales data from database:",B)}catch(T){console.error("Failed to get real sales data:",T),B=[]}if(console.log("=== FINAL EXPORT DATA ==="),console.log("Export type:",S),console.log("Export format:",E),console.log("Final exportData:",B),console.log("Data length:",B.length),B.length>0&&console.log("First export item:",B[0]),console.log("========================"),B.length===0){const T=`No ${S} data found for the selected date range (${a.from} to ${a.to}). Please try adjusting the date range or check if there is data in the database.`;throw console.error("Export failed - no data:",{type:S,dateRange:a,filters:s,exportDataLength:B.length}),new Error(T)}await Zg({type:S,format:E,params:l,filename:F,fallbackData:B}),C.success(`${S} report exported successfully!`)}catch(F){console.error("Export error:",F),C.error("Export failed: "+F.message)}},x=({type:S,format:E,icon:C,label:F,color:B="blue"})=>i.jsxs("button",{onClick:()=>h(S,E),className:`flex items-center space-x-2 px-3 py-2 bg-${B}-50 text-${B}-700 rounded-lg hover:bg-${B}-100 transition-colors text-sm font-medium`,children:[i.jsx(C,{className:"w-4 h-4"}),i.jsx("span",{children:F})]}),p=({dateRange:S,filters:E})=>{var W;const{data:C,isLoading:F,error:B,refetch:T}=kf({date_from:S.from,date_to:S.to,...E});if(console.log("UI SalesReportTable data:",C),F)return i.jsx("div",{className:"flex justify-center items-center py-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx(sn,{className:"w-5 h-5 animate-spin mx-auto mb-1 text-blue-600"}),i.jsx("p",{className:"text-gray-600 text-xs",children:"Loading..."})]})});if(B)return i.jsxs("div",{className:"text-center py-12 text-red-500",children:[i.jsx(Qo,{className:"w-16 h-16 mx-auto text-red-300 mb-4"}),i.jsx("p",{className:"text-lg font-medium",children:"Error loading sales data"}),i.jsx("p",{className:"text-sm mt-2",children:B.message}),i.jsxs("button",{onClick:()=>T(),className:"mt-4 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[i.jsx(sn,{className:"w-4 h-4 inline mr-2"}),"Retry"]})]});if(!(C&&(Array.isArray(C.data)&&C.data.length>0||Array.isArray(C)&&C.length>0||C.orders&&Array.isArray(C.orders)&&C.orders.length>0||C.sales&&Array.isArray(C.sales)&&C.sales.length>0)))return i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(In,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),i.jsx("p",{className:"text-lg font-medium",children:"No sales data available"}),i.jsx("p",{className:"text-sm mb-4",children:"Try adjusting your date range or filters"}),i.jsxs("div",{className:"mt-4 flex gap-2 justify-center",children:[i.jsx("button",{onClick:()=>n({from:"2024-01-01",to:new Date().toISOString().split("T")[0]}),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Full Year"}),i.jsx("button",{onClick:()=>{const Y=new Date,q=new Date(Y.getFullYear(),Y.getMonth(),1);n({from:q.toISOString().split("T")[0],to:Y.toISOString().split("T")[0]})},className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"This Month"}),i.jsxs("button",{onClick:()=>T(),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200",children:[i.jsx(sn,{className:"w-3 h-3 inline mr-1"}),"Refetch"]})]})]});let k=[];C&&(Array.isArray(C.data)?k=C.data:Array.isArray(C)?k=C:C.orders&&Array.isArray(C.orders)?k=C.orders:C.sales&&Array.isArray(C.sales)?k=C.sales:C.data&&typeof C.data=="object"&&(k=C.data.orders||C.data.data||C.data.sales||[]));const I=new Map;k.forEach(Y=>{const U=Y.id||Y.order_id||`${Y.ord_date||Y.order_date||""}-${Y.total||""}-${Y.cus_name||""}`;I.has(U)||I.set(U,Y)}),k=Array.from(I.values()),console.log("=== UI TABLE DEBUG ==="),console.log("Processed orders for UI:",k),console.log("First order for UI:",k[0]),console.log("First order details for UI:",(W=k[0])==null?void 0:W.order_details),console.log("=====================");const A=Y=>{switch(Y==null?void 0:Y.toLowerCase()){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"unpaid":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=Y=>{if(Y.payment_status)return Y.payment_status;const U=(Y.payments||[]).reduce((Q,ne)=>Q+(parseFloat(ne.deposit)||0),0),H=parseFloat(Y.total)||0;return U>=H?"Paid":U>0?"Partial":"Unpaid"},R=Y=>(Y.order_details||Y.orderDetails||[]).reduce((U,H)=>U+(parseInt(H.qty)||0),0);return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Sales Orders (",k.length,")"]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:[S.from," to ",S.to]}),i.jsxs("button",{onClick:()=>T(),className:"flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200",children:[i.jsx(sn,{className:"w-3 h-3"}),"Refresh"]})]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ord_ID"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qty"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(Y=>{var ne,ee;const q=b(Y),U=R(Y),H=Y.id||Y.order_id,Q=H||`order-${Y.ord_date||Y.order_date||""}-${Y.cus_name||""}-${Y.total||""}`;return i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",H||"N/A"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Pr(Y.ord_date||Y.order_date||Y.date||Y.created_at||new Date)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Y.cus_name||((ne=Y.customer)==null?void 0:ne.name)||Y.customer_name||Y.customer||"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.staff_name||((ee=Y.staff)==null?void 0:ee.name)||Y.full_name||Y.staff||"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(()=>{var L;const N=Y.order_details||Y.orderDetails||[];if(N.length>0){const D=N.map(M=>{var z;return M.pro_name||((z=M.product)==null?void 0:z.name)||M.product_name||"Unknown"}).filter(M=>M!=="Unknown");if(D.length>0)return D.length>1?`${D[0]} (+${D} )`:D[0]}return Y.product_name||((L=Y.product)==null?void 0:L.name)||Y.pro_name||Y.product||"N/A"})()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U||Y.qty||0}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:br(Y.total||Y.amount||Y.total_amount||0)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${A(q)}`,children:q})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(Y.status||"completed").toLowerCase()==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Y.status||"Completed"})})]},Q)})})]})})]})};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:" Reports"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive import and sales reports"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-3",children:[i.jsxs("div",{className:"flex items-center space-x-2 bg-white rounded-lg border px-3 py-2",children:[i.jsx(Go,{className:"w-4 h-4 text-gray-500"}),i.jsx("input",{type:"date",value:a.from,onChange:S=>n(E=>({...E,from:S.target.value})),className:"text-sm border-none outline-none"}),i.jsx("span",{className:"text-gray-400",children:"to"}),i.jsx("input",{type:"date",value:a.to,onChange:S=>n(E=>({...E,to:S.target.value})),className:"text-sm border-none outline-none"})]}),i.jsxs("button",{onClick:()=>{"caches"in window&&caches.keys().then(S=>{S.forEach(E=>{caches.delete(E)})}),window.location.reload(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:[i.jsx(sn,{className:"w-4 h-4"}),i.jsx("span",{children:"Hard Refresh"})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border-b",children:i.jsx("div",{className:"flex space-x-8 px-6 overflow-x-auto",children:[{id:"import",label:"Import Reports",icon:Lr},{id:"sales",label:"Sales Reports",icon:In}].map(S=>i.jsxs("button",{onClick:()=>{t(S.id),window.location.hash=S.id==="sales"?"sales":""},className:`flex items-center space-x-2 py-4 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${e===S.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(S.icon,{className:"w-4 h-4"}),i.jsx("span",{children:S.label})]},S.id))})}),e==="import"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Export Import Reports"}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:[i.jsx(x,{type:"import",format:"xlsx",icon:Vu,label:"EXCEL",color:"green"}),i.jsx(x,{type:"import",format:"pdf",icon:Gu,label:"PDF",color:"red"})]})]}),(()=>{const S=(c==null?void 0:c.data)||[],C=new Set(S.map(T=>T.id)).size,F=S.reduce((T,P)=>{if(P.total_amount)return T+parseFloat(P.total_amount);const I=(P.import_details||P.importDetails||[]).reduce((A,b)=>A+parseFloat(b.amount||0),0);return T+(I>0?I:parseFloat(P.total||0))},0),B=S.reduce((T,P)=>{const k=P.import_details||P.importDetails||[];return k.length>0?T+k.reduce((I,A)=>I+parseInt(A.qty||0),0):T+1},0);return i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Imports"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:C})]}),i.jsx(Lr,{className:"w-8 h-8 text-blue-500"})]})}),i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Value"}),i.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:br(F)})]}),i.jsx(zu,{className:"w-8 h-8 text-green-500"})]})}),i.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Total Quantity"}),i.jsx("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:B.toLocaleString()})]}),i.jsx(If,{className:"w-8 h-8 text-purple-500"})]})})]})})(),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Import Reports"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[((y=c==null?void 0:c.data)==null?void 0:y.length)||0," records"]})]}),i.jsx(iT,{dateRange:a,filters:s})]})]}),e==="sales"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Export Sales Reports"}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 w-[100px] lg:grid-cols-6 gap-3",children:[i.jsx(x,{type:"sales",format:"xlsx",icon:Vu,label:"EXCEL",color:"green"}),i.jsx(x,{type:"sales",format:"pdf",icon:Gu,label:"PDF",color:"red"})]})]}),g&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Qo,{className:"w-5 h-5 text-red-500 mr-2"}),i.jsx("h4",{className:"font-medium text-red-800",children:"API Error"})]}),i.jsx("p",{className:"text-red-600 text-sm mt-1",children:g.message})]}),(()=>{const S=(d==null?void 0:d.data)||[],E=new Set(S.map(F=>F.id)).size,C=S.reduce((F,B)=>F+parseFloat(B.total||B.amount||B.total_amount||0),0);return i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Total Orders"}),i.jsx("p",{className:"text-2xl font-bold text-orange-900 mt-1",children:E})]}),i.jsx(In,{className:"w-8 h-8 text-orange-500"})]})}),i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Sales"}),i.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:br(C)})]}),i.jsx(zu,{className:"w-8 h-8 text-green-500"})]})})]})})(),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sales Reports"}),i.jsx("div",{className:"text-sm text-gray-500",children:((_=d==null?void 0:d.data)==null?void 0:_.length)||0})]}),i.jsx(p,{dateRange:a,filters:s})]})]})]})},Zl=e=>{const t=new Date,r=new Date;switch(e){case"7d":r.setDate(t.getDate()-7);break;case"30d":r.setDate(t.getDate()-30);break;case"90d":r.setDate(t.getDate()-90);break;case"1y":r.setFullYear(t.getFullYear()-1);break;default:r.setDate(t.getDate()-30)}return{date_from:r.toISOString().split("T")[0],date_to:t.toISOString().split("T")[0]}},rf=e=>{const t=Zl(e),r=new Date(t.date_from),n=new Date(t.date_to)-r,s=new Date(r);return{date_from:new Date(r.getTime()-n).toISOString().split("T")[0],date_to:s.toISOString().split("T")[0]}},lT={async getAnalyticsData(e="30d"){try{return{current:{salesSummary:{total:0,count:0,data:[]},importSummary:{total:0,count:0,data:[]},inventorySummary:{total:0,count:0,data:[]},bestSellingProducts:[],lowStockProducts:[],salesReport:[],importReport:[]},previous:{salesSummary:{total:0,count:0,data:[]},importSummary:{total:0,count:0,data:[]}},timeRange:e,dateParams:{}}}catch(t){throw console.error("Error fetching analytics data:",t),t}},async getRevenueAnalytics(e="30d"){try{const t=Zl(e),r=rf(e),[a,n,s]=await Promise.all([Et.getSalesSummary(t),Et.getSalesSummary(r),Et.getSalesReport(t)]);return{current:a,previous:n,salesReport:s,timeRange:e}}catch(t){throw console.error("Error fetching revenue analytics:",t),t}},async getProductAnalytics(e="30d"){try{const t=Zl(e),r=rf(e),[a,n,s,o]=await Promise.all([Et.getBestSellingProducts({...t,limit:10}),Et.getBestSellingProducts({...r,limit:10}),Et.getLowStockProducts({threshold:10}),Et.getInventorySummary(t)]);return{current:a,previous:n,lowStockProducts:s,inventorySummary:o,timeRange:e}}catch(t){throw console.error("Error fetching product analytics:",t),t}},async getStaffAnalytics(e="30d"){try{return{users:{data:[]},salesReport:[],importReport:[],timeRange:e,staffPerformance:[]}}catch(t){throw console.error("Error fetching staff analytics:",t),t}},async getImportAnalytics(e="30d"){try{const t=Zl(e),r=rf(e),[a,n,s]=await Promise.all([Et.getImportSummary(t),Et.getImportSummary(r),Et.getImportReport(t)]);return{current:a,previous:n,importReport:s,timeRange:e}}catch(t){throw console.error("Error fetching import analytics:",t),t}},async getInventoryAnalytics(){try{const[e,t]=await Promise.all([Et.getInventorySummary(),Et.getLowStockProducts({threshold:10})]);return{inventorySummary:e,lowStockProducts:t}}catch(e){throw console.error("Error fetching inventory analytics:",e),e}},async getImportVsSalesData(e="30d"){try{const t=Zl(e),[r,a,n,s]=await Promise.all([Et.getSalesReport(t),Et.getImportReport(t),Et.getSalesSummary(t),Et.getImportSummary(t)]);return{salesReport:r,importReport:a,salesSummary:n,importSummary:s,timeRange:e}}catch(t){throw console.error("Error fetching import vs sales data:",t),t}},async getDashboardMetrics(){try{const e=new Date().toISOString().split("T")[0],t={date_from:e,date_to:e},[r,a,n,s]=await Promise.all([Et.getSalesSummary(t),Et.getImportSummary(t),Et.getInventorySummary(),Et.getLowStockProducts({threshold:10})]);return{todaySales:r,todayImports:a,inventorySummary:n,lowStockProducts:s}}catch(e){throw console.error("Error fetching dashboard metrics:",e),e}}},cT=(e,t=[],r=[])=>!e||!Array.isArray(e)?[]:e.map(a=>{const n=t.filter(g=>g.staff_name===a.full_name||g.staff_name===a.name),s=n.length,o=n.reduce((g,h)=>g+parseFloat(h.amount||0),0),l=r.filter(g=>g.staff_name===a.full_name||g.staff_name===a.name),c=l.length,u=l.reduce((g,h)=>g+parseFloat(h.amount||0),0),d=s+c,m=Math.min(100,Math.max(0,d/10*100));return{id:a.id,name:a.full_name||a.name,email:a.email,user_type:a.user_type||a.type||"User",salesCount:s,salesRevenue:o,importsCount:c,importsValue:u,efficiency:Math.round(m),target:60,sales:s}}),uT=(e="30d")=>{const[t,r]=se.useState(null),[a,n]=se.useState(!0),[s,o]=se.useState(null),l=se.useCallback(async()=>{try{n(!0);const c=await lT.getStaffAnalytics(e),u=cT(c);r(u),o(null)}catch(c){o(c)}finally{n(!1)}},[e]);return se.useEffect(()=>{l()},[l]),{data:t,isLoading:a,error:s,refetch:l}},Kl={generateExcel:(e,t,r="import")=>{try{if(!Array.isArray(e))throw new Error("Data must be an array");const a=ps.book_new(),n=Df(e,r),s=ps.json_to_sheet(n);return ps.book_append_sheet(a,s,r==="import"?"Import Report":"Sales Report"),Tg(a,t),{success:!0,message:"Excel file generated successfully"}}catch(a){return console.error("Excel generation error:",a),{success:!1,error:a.message}}},generatePDF:(e,t,r="import")=>{try{if(console.log(`Generating PDF for ${r}:`,{filename:t,dataLength:e.length,sampleData:e.slice(0,2)}),!Array.isArray(e))throw new Error("Data must be an array");const a=new Tt;a.setFontSize(16),a.text(r==="import"?"Import Report":"Sales Report",20,20),a.setFontSize(10),a.text(`Generated on: ${new Date().toLocaleDateString()}`,20,30),a.text(`Total Records: ${e.length}`,20,35),a.text(`Data Source: ${t2(e)}`,20,40);const{tableData:n,headers:s}=mT(e,r);return e.length===0?gT(a):a.autoTable({head:[s],body:n,startY:55,styles:{fontSize:8},headStyles:{fillColor:[66,139,202]}}),a.save(t),{success:!0,message:"PDF file generated successfully"}}catch(a){return console.error("PDF generation error:",a),{success:!1,error:a.message}}},generateWord:(e,t,r="import")=>{try{if(!Array.isArray(e))throw new Error("Data must be an array");const a=Df(e,r),n=pT(a,r);return xT(n,t),{success:!0,message:"Word-like HTML file generated successfully"}}catch(a){return console.error("Word generation error:",a),{success:!1,error:a.message}}}},Df=(e,t)=>e.map(r=>t==="import"?dT(r):fT(r)).flat().filter(r=>r!=null),dT=e=>{var c,u,d;const t=e.product_name||e.pro_name||((c=e.product)==null?void 0:c.pro_name)||"Unknown Product",r=e.qty||e.quantity||0;let a=e.amount||e.price||e.total||0;a==0&&r>0&&(e.price||e.unit_price)&&(a=r*(e.price||e.unit_price));const n=e.batch_number||e.batchNumber||e.batch||"N/A",s=e.expiration_date||e.expirationDate||e.expiry||"N/A",o=e.staff_name||e.full_name||((u=e.staff)==null?void 0:u.full_name)||"Unknown Staff",l=e.supplier_name||e.supplier||((d=e.supplier)==null?void 0:d.supplier)||"Unknown Supplier";return{ID:e.id||"N/A",Date:e.imp_date?x0(new Date(e.imp_date)):"N/A",Staff:o,Supplier:l,"Product Name":t,Qty:r,Amount:g0(a),"Batch Number":n,"Expiration Date":s!=="N/A"?x0(new Date(s)):"N/A",Status:e.status||"completed"}},fT=e=>{var o,l;const t=e.product_name||e.pro_name||((o=e.product)==null?void 0:o.pro_name)||"Unknown Product",r=e.qty||e.quantity||0,a=e.amount||e.price||e.total||0,n=e.staff_name||e.full_name||((l=e.staff)==null?void 0:l.full_name)||"Unknown Staff",s=e.customer||e.cus_name||e.customer_name||"Unknown Customer";return e.orderDetails&&e.orderDetails.length>0?e.orderDetails.map(c=>{var u;return{ID:e.id||"N/A",Date:e.ord_date?x0(new Date(e.ord_date)):"N/A",Customer:s,Staff:n,"Product Name":c.pro_name||((u=c.product)==null?void 0:u.pro_name)||"Unknown Product",Qty:c.qty||0,Amount:g0(c.amount||0),"Payment Status":hT(e),Status:e.status||"completed"}}):{ID:e.orderId||e.id||"N/A",Date:e.date?x0(new Date(e.date)):"N/A",Customer:s,Staff:n,"Product Name":t,Qty:r,Amount:g0(a),"Payment Status":e.paymentStatus||"Unpaid",Status:e.status||"completed"}},hT=e=>{const t=parseFloat(e.total)||0,a=(e.payments||[]).reduce((n,s)=>n+(parseFloat(s.deposit)||0),0);return a>=t?"Paid":a>0?"Partial":"Unpaid"},mT=(e,t)=>({tableData:Df(e,t).map(s=>t==="import"?[s.ID,s.Date,s.Staff,s.Supplier,s["Product Name"],s.Qty,s.Amount,s["Batch Number"],s["Expiration Date"],s.Status]:[s.ID,s.Date,s.Customer,s.Staff,s["Product Name"],s.Qty,s.Amount,s["Payment Status"],s.Status]),headers:t==="import"?["ID","Date","Staff","Supplier","Product Name","Qty","Amount","Batch Number","Expiration Date","Status"]:["ID","Date","Customer","Staff","Product Name","Qty","Amount","Payment Status","Status"]}),pT=(e,t)=>{const r=e.reduce((a,n)=>{const s=typeof n.Amount=="string"?parseFloat(n.Amount.replace(/[$,]/g,"")):parseFloat(n.Amount)||0;return a+s},0);return`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>${t==="import"?"Import Report":"Sales Report"}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; }
        .info { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #4CAF50; color: white; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .total { font-weight: bold; background-color: #e8f5e9; }
    </style>
</head>
<body>
    <h1>${t==="import"?"Import Report":"Sales Report"}</h1>
    
    <div class="info">
        <p><strong>Generated on:</strong> ${new Date().toLocaleDateString()}</p>
        <p><strong>Total Records:</strong> ${e.length}</p>
        <p><strong>Data Source:</strong> ${t2(e)}</p>
    </div>
    
    <table>
        <thead>
            <tr>
                ${t==="import"?"<th>ID</th><th>Date</th><th>Staff</th><th>Supplier</th><th>Product Name</th><th>Qty</th><th>Amount</th><th>Batch Number</th><th>Expiration Date</th><th>Status</th>":"<th>ID</th><th>Date</th><th>Customer</th><th>Staff</th><th>Product Name</th><th>Qty</th><th>Amount</th><th>Payment Status</th><th>Status</th>"}
            </tr>
        </thead>
        <tbody>
            ${e.map(a=>`
                <tr>
                    ${t==="import"?`<td>${a.ID}</td><td>${a.Date}</td><td>${a.Staff}</td><td>${a.Supplier}</td><td>${a["Product Name"]}</td><td>${a.Qty}</td><td>${a.Amount}</td><td>${a["Batch Number"]}</td><td>${a["Expiration Date"]}</td><td>${a.Status}</td>`:`<td>${a.ID}</td><td>${a.Date}</td><td>${a.Customer}</td><td>${a.Staff}</td><td>${a["Product Name"]}</td><td>${a.Qty}</td><td>${a.Amount}</td><td>${a["Payment Status"]}</td><td>${a.Status}</td>`}
                </tr>
            `).join("")}
        </tbody>
    </table>
    
    <div class="info total">
        <p><strong>Total Amount:</strong> ${g0(r)}</p>
    </div>
</body>
</html>`},xT=(e,t)=>{const r=new Blob([e],{type:"text/html"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=t.replace(/\.(word|doc)$/i,".html"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},gT=e=>{e.setFontSize(12),e.text("No data available for the selected date range.",20,70),e.setFontSize(10),e.text("Please check:",20,85),e.text(" API endpoints are working",25,95),e.text(" Database has records",25,105),e.text(" Date range includes data",25,115)},t2=e=>e.length===0?"No data available":e[0].staff_name==="Analytics Data"?"Analytics/Mock Data":"Real Database",x0=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),g0=e=>`$${(parseFloat(e)||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,vT=({type:e,title:t,onClose:r,analyticsData:a})=>{var y,_,S,E,C;const[n,s]=se.useState("excel"),[o,l]=se.useState({from:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],to:new Date().toISOString().split("T")[0]}),[c,u]=se.useState({}),[d,m]=se.useState(!1),g=e==="analytics"?[{id:"pdf",label:"PDF Document",icon:Gu,color:"text-red-600",bgColor:"bg-red-50"}]:[{id:"excel",label:"Excel (.xls)",icon:Vu,color:"text-green-600",bgColor:"bg-green-50"},{id:"xlsx",label:"Excel (.xlsx)",icon:Vu,color:"text-green-600",bgColor:"bg-green-50"},{id:"pdf",label:"PDF Document",icon:Gu,color:"text-red-600",bgColor:"bg-red-50"},{id:"word",label:"Word Document",icon:sv,color:"text-blue-600",bgColor:"bg-blue-50"}],h=async()=>{m(!0);try{const F={...c,date_from:o.from,date_to:o.to},B=`${e}_report_${o.from}_to_${o.to}.${n==="json"?"json":n}`;e==="analytics"?await p(F,B):await Zg({type:e,format:n,params:F,filename:B}),console.log("Export completed successfully"),setTimeout(()=>{r()},1500)}catch(F){console.error("Export error:",F),alert(`Export failed: ${F.message}. Please check the console for more details.`)}finally{m(!1)}},x=async()=>{let F=[],B=[];try{const T=await ut.get("/imports");F=Array.isArray(T==null?void 0:T.data)?T.data:Array.isArray(T)?T:[],console.log("Fetched real import data:",F.length,"records")}catch(T){console.log("Could not fetch real import data:",T.message)}try{const T=await ut.get("/orders");B=Array.isArray(T==null?void 0:T.data)?T.data:Array.isArray(T)?T:[],console.log("Fetched real orders data:",B.length,"records")}catch(T){console.log("Could not fetch real orders data:",T.message)}return{importData:F,salesData:B}},p=async(F,B)=>{var T,P,k;try{if(n==="json"){const I={...a,exportParams:F,exportedAt:new Date().toISOString(),summary:{totalRevenue:a.totalRevenue||0,totalOrders:a.totalOrders||0,totalImports:a.totalImports||0,profit:a.profit||0,profitMargin:a.profitMargin||0}},A=Kl.generateJSON(I,B);if(!A.success)throw new Error(A.error);console.log("JSON export completed successfully")}else if(n==="excel")try{const I=Et.exportImportExcelXlsx(F),A=Et.exportSalesExcelXlsx(F);console.log("Trying API Excel export...",{importUrl:I,salesUrl:A}),await Et.downloadFile(I,`analytics_import_${B}`),await new Promise(b=>setTimeout(b,1e3)),await Et.downloadFile(A,`analytics_sales_${B}`),console.log("API Excel export completed successfully")}catch(I){console.log("API failed, using mock Excel export with real data...",I.message);const{importData:A,salesData:b}=await x(),R=A.length>0?A:((T=a.trendData)==null?void 0:T.map((q,U)=>({id:`IMP-${String(U+1).padStart(3,"0")}`,imp_date:q.date,amount:q.imports||0,qty:q.importQty||0,staff_name:"Analytics Data",supplier_name:"System Generated",status:"completed"})))||[],W=Kl.generateExcel(R,`analytics_import_${B}`,"import");if(!W.success)throw new Error(W.error);await new Promise(q=>setTimeout(q,1e3));const Y=Kl.generateExcel(salesData,`analytics_sales_${B}`,"sales");if(!Y.success)throw new Error(Y.error);console.log("Mock Excel export completed successfully")}else if(n==="pdf")try{const I=Et.exportImportPdf(F),A=Et.exportSalesPdf(F);console.log("Trying API PDF export...",{importUrl:I,salesUrl:A}),await Et.downloadFile(I,`analytics_import_${B.replace(".pdf","")}.pdf`),await new Promise(b=>setTimeout(b,1e3)),await Et.downloadFile(A,`analytics_sales_${B.replace(".pdf","")}.pdf`),console.log("API PDF export completed successfully")}catch(I){console.log("API failed, using mock PDF export with real data...",I.message);const{importData:A,salesData:b}=await x(),R=A.length>0?A:((P=a.trendData)==null?void 0:P.map((U,H)=>({id:`IMP-${String(H+1).padStart(3,"0")}`,imp_date:U.date,amount:U.imports||0,qty:U.importQty||0,staff_name:"Analytics Data",supplier_name:"System Generated",status:"completed",batch_number:`BATCH-${String(H+1).padStart(3,"0")}`,expiration_date:new Date(Date.now()+365*24*60*60*1e3).toISOString().split("T")[0]})))||[],W=b.length>0?b:((k=a.trendData)==null?void 0:k.map((U,H)=>({id:`ORD-${String(H+1).padStart(3,"0")}`,ord_date:U.date,amount:U.sales||0,cus_name:"Analytics Customer",staff_name:"Analytics Data",status:"completed"})))||[],Y=Kl.generatePDF(R,`analytics_import_${B.replace(".pdf","")}.pdf`,"import");if(!Y.success)throw new Error(Y.error);await new Promise(U=>setTimeout(U,1e3));const q=Kl.generatePDF(W,`analytics_sales_${B.replace(".pdf","")}.pdf`,"sales");if(!q.success)throw new Error(q.error);console.log("Mock PDF export completed successfully")}}catch(I){throw console.error("Analytics export error:",I),I}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Export ",t," Report"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Choose format and configure export options"})]}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-1",children:i.jsx(zr,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Export Format"}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:g.map(F=>i.jsxs("button",{onClick:()=>s(F.id),className:`flex items-center p-4 rounded-lg border-2 transition-all ${n===F.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[i.jsx("div",{className:`w-10 h-10 rounded-lg ${F.bgColor} flex items-center justify-center mr-3`,children:i.jsx(F.icon,{className:`w-5 h-5 ${F.color}`})}),i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-medium text-gray-900",children:F.label}),i.jsx("div",{className:"text-xs text-gray-500",children:F.id==="excel"||F.id==="xlsx"?"Spreadsheet format":F.id==="pdf"?"Portable document":F.id==="json"?"Raw data format":"Word document"})]}),n===F.id&&i.jsx("div",{className:"ml-auto",children:i.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:i.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})})]},F.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Date Range"}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"From"}),i.jsxs("div",{className:"relative",children:[i.jsx(Go,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"date",value:o.from,onChange:F=>l(B=>({...B,from:F.target.value})),className:"input pl-10"})]})]}),i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"To"}),i.jsxs("div",{className:"relative",children:[i.jsx(Go,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"date",value:o.to,onChange:F=>l(B=>({...B,to:F.target.value})),className:"input pl-10"})]})]})]})]}),e!=="analytics"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Additional Filters (Optional)"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Staff ID"}),i.jsx("input",{type:"text",placeholder:"Filter by staff ID",value:c.staff_id||"",onChange:F=>u(B=>({...B,staff_id:F.target.value})),className:"input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:e==="import"?"Supplier ID":"Customer ID"}),i.jsx("input",{type:"text",placeholder:`Filter by ${e==="import"?"supplier":"customer"} ID`,value:c[e==="import"?"supplier_id":"customer_id"]||"",onChange:F=>u(B=>({...B,[e==="import"?"supplier_id":"customer_id"]:F.target.value})),className:"input"})]})]})]}),e==="analytics"&&a&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Analytics Summary"}),i.jsx("div",{className:"bg-blue-50 rounded-lg p-4 space-y-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total Revenue:"}),i.jsxs("span",{className:"ml-2 text-blue-600",children:["$",((y=a.totalRevenue)==null?void 0:y.toLocaleString())||"0"]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total Orders:"}),i.jsx("span",{className:"ml-2 text-blue-600",children:((_=a.totalOrders)==null?void 0:_.toLocaleString())||"0"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total Imports:"}),i.jsx("span",{className:"ml-2 text-blue-600",children:((S=a.totalImports)==null?void 0:S.toLocaleString())||"0"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Profit:"}),i.jsxs("span",{className:"ml-2 text-green-600",children:["$",((E=a.profit)==null?void 0:E.toLocaleString())||"0"]})]})]})})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Export Preview"}),i.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Report Type:"})," ",t]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Format:"})," ",(C=g.find(F=>F.id===n))==null?void 0:C.label]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Date Range:"})," ",o.from," to ",o.to]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Filename:"})," ",e,"_report_",o.from,"_to_",o.to,".",n]}),e==="analytics"&&(n==="excel"||n==="pdf")&&i.jsxs("p",{className:"text-blue-600",children:[i.jsx("span",{className:"font-medium",children:"Note:"})," Will download 2 files (Import & Sales reports)"]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" Export Information"}),i.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[i.jsxs("p",{children:[" ",i.jsx("strong",{children:"API Export:"})," Will try Laravel API endpoints first"]}),i.jsxs("p",{children:[" ",i.jsx("strong",{children:"Fallback Export:"})," If API fails, will use client-side generation"]}),i.jsxs("p",{children:[" ",i.jsx("strong",{children:"File Quality:"})," API exports are recommended for production use"]}),e==="analytics"&&i.jsxs("p",{children:[" ",i.jsx("strong",{children:"Analytics:"})," Exports both Import and Sales data as separate files"]})]})]}),!1]}),i.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200",children:[i.jsx("button",{onClick:r,className:"btn-secondary",disabled:d,children:"Cancel"}),i.jsx("button",{onClick:h,disabled:d,className:"btn-primary",children:d?i.jsxs(i.Fragment,{children:[i.jsx(Er,{size:"sm"}),i.jsx("span",{className:"ml-2",children:"Exporting..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(Gi,{className:"w-4 h-4 mr-2"}),"Export Report"]})})]})]})})},yT=()=>i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 animate-pulse",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 mb-3"}),i.jsx("div",{className:"h-8 bg-gray-200 rounded w-20"})]}),i.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"})]}),i.jsxs("div",{className:"flex items-center mt-4",children:[i.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded mr-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 mr-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})]})]}),wT=({title:e,message:t,onRetry:r})=>i.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(sf,{className:"w-8 h-8 text-red-500"})}),i.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:e}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t}),r&&i.jsxs("button",{onClick:r,className:"btn-primary text-sm",children:[i.jsx(sn,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}),Jl=(e,t="number")=>{if(e==null||isNaN(e))return 0;switch(t){case"currency":return Math.round(parseFloat(e)*100)/100;case"percentage":return Math.round(parseFloat(e)*10)/10;case"integer":return parseInt(e)||0;default:return parseFloat(e)||0}},Mo=(e,t=[])=>!Array.isArray(e)||e.length===0?!1:e.some(r=>t.length===0?!0:t.some(a=>{const n=r[a];return n!=null&&!isNaN(n)})),bT=()=>{var pt,at,ht,Lt,Jt,er,Tr,Ja;const[e,t]=se.useState("90d"),[r,a]=se.useState("overview"),[n,s]=se.useState(!1),[o,l]=se.useState(!1),[c,u]=se.useState(!1),[d,m]=se.useState(null),[g,h]=se.useState(!1),[x,p]=se.useState(null),[y,_]=se.useState(null),[S,E]=se.useState(!1),[C,F]=se.useState(null),[B,T]=se.useState(null),[P,k]=se.useState(!1),[I,A]=se.useState(null),b=se.useMemo(()=>{const he=new Date,ke=new Date;switch(e){case"7d":ke.setDate(he.getDate()-7);break;case"30d":ke.setDate(he.getDate()-30),he.getFullYear()<=2025&&he.setFullYear(2025,11,31);break;case"90d":ke.setDate(he.getDate()-90),he.getFullYear()<=2025&&he.setFullYear(2025,11,31);break;case"1y":ke.setFullYear(he.getFullYear()-1),he.getFullYear()<=2025&&he.setFullYear(2025,11,31);break;default:ke.setDate(he.getDate()-90),he.getFullYear()<=2025&&he.setFullYear(2025,11,31)}return{date_from:ke.toISOString().split("T")[0],date_to:he.toISOString().split("T")[0]}},[e]);se.useEffect(()=>{const he=ui("/analytics");he&&(he.sales&&!d&&m(he.sales),he.imports&&!y&&_(he.imports),he.inventory&&!B&&T(he.inventory))},[]),se.useEffect(()=>{let he=!0;const ke=async()=>{d||h(!0),y||E(!0),B||k(!0);const[St,Ke,dt]=await Promise.allSettled([Et.getSalesSummary(b),Et.getImportSummary(b),Et.getInventorySummary()]);he&&(St.status==="fulfilled"?(m(St.value),p(null)):(console.error("Sales summary fetch error:",St.reason),p(St.reason)),h(!1),Ke.status==="fulfilled"?(_(Ke.value),F(null)):(console.error("Import summary fetch error:",Ke.reason),F(Ke.reason)),E(!1),dt.status==="fulfilled"?(T(dt.value),A(null)):(console.error("Inventory summary fetch error:",dt.reason),A(dt.reason)),k(!1))},nt=ui("/analytics");return(!nt||!nt.sales||!nt.imports)&&ke(),()=>{he=!1}},[e,d,y,B]);const R=()=>{(async()=>{try{h(!0);const ke=await Et.getSalesSummary(b);m(ke),p(null)}catch(ke){console.error("Sales summary refetch error:",ke),p(ke)}finally{h(!1)}})()},W=()=>{(async()=>{try{E(!0);const ke=await Et.getImportSummary(b);_(ke),F(null)}catch(ke){console.error("Import summary refetch error:",ke),F(ke)}finally{E(!1)}})(),ue()},[Y,q]=se.useState(null);se.useEffect(()=>{const he=ui("/analytics");he!=null&&he.bestSelling&&q(he.bestSelling)},[]);const{data:U,isLoading:H,error:Q}=rT({...b,limit:10}),ne=Y||U,{data:ee,isLoading:N,error:L}=kf(b),{data:D,isLoading:M,error:z,refetch:ue}=Nh(b),{data:pe}=Tc(),{data:me}=Y1(),{data:Ne}=e2(),{data:Oe}=L0(),Ie=Array.isArray(pe==null?void 0:pe.data)?pe.data:Array.isArray(pe)?pe:[],Ze=Array.isArray(Ne==null?void 0:Ne.data)?Ne.data:Array.isArray(Ne)?Ne:[],st=Array.isArray(Oe==null?void 0:Oe.data)?Oe.data:Array.isArray(Oe)?Oe:[],Fe=Array.isArray(me==null?void 0:me.data)?me.data:Array.isArray(me)?me:[],{data:le,isLoading:Xe,refetch:xt}=uT(e),{data:$e,isLoading:ie}=Jf(),ge=(d==null?void 0:d.data)||{},ye=(y==null?void 0:y.data)||{},qe=(B==null?void 0:B.data)||{},De=ne||U,Re=Array.isArray((pt=De==null?void 0:De.data)==null?void 0:pt.data)?De.data.data:Array.isArray(De==null?void 0:De.data)?De.data:Array.isArray(De)?De:[],Je=Array.isArray((at=ee==null?void 0:ee.data)==null?void 0:at.data)?ee.data.data:Array.isArray(ee==null?void 0:ee.data)?ee.data:Array.isArray(ee)?ee:[],mt=Array.isArray((ht=D==null?void 0:D.data)==null?void 0:ht.data)?D.data.data:Array.isArray(D==null?void 0:D.data)?D.data:Array.isArray(D)?D:[],wt=Array.isArray((Lt=$e==null?void 0:$e.data)==null?void 0:Lt.data)?$e.data.data:Array.isArray($e==null?void 0:$e.data)?$e.data:Array.isArray($e)?$e:[],bt=g&&!d||S&&!y||P&&!B||H&&!Ie.length||N&&!Je.length||M&&!mt.length||ie&&!wt.length||Xe&&!le,kt=g&&d||S&&y||P&&B||H||N||M||ie||Xe,ot=x||C||I||Q||L||z,Ar=[x,C,I,Q,L,z].filter(Boolean).length,Ut=Je.length>0?Je.reduce((he,ke)=>he+parseFloat(ke.amount||ke.total||0),0):wt.reduce((he,ke)=>he+parseFloat(ke.total||0),0),Rr=Je.length>0?Je.length:wt.length,zt=new Set;let Yt=0,Vr=0;const Ot=new Map;mt.forEach(he=>{var dt;const ke=he.id||he.import_id;ke&&zt.add(ke);const nt=he.supplier_name||((dt=he.supplier)==null?void 0:dt.supplier)||"Unknown";Ot.has(nt)||Ot.set(nt,{count:0,value:0,quantity:0});const St=Ot.get(nt),Ke=he.import_details||he.importDetails||[];if(Ke.length>0)Ke.forEach(Dt=>{const vr=parseFloat(Dt.amount||Dt.price||0),xa=parseFloat(Dt.qty||Dt.quantity||0);Yt+=vr,Vr+=xa,St.value+=vr,St.quantity+=xa}),St.count+=1;else{const Dt=parseFloat(he.amount||he.total_amount||he.total||0),vr=parseFloat(he.qty||he.quantity||0);Yt+=Dt,Vr+=vr,St.value+=Dt,St.quantity+=vr,St.count+=1}});const Ka=zt.size>0?zt.size:mt.length;Ot.size,st.length>0?st.length:Ot.size;const nr=Ot.size>0?Array.from(Ot.entries()).sort((he,ke)=>ke[1].value-he[1].value)[0]:null,ma=st.length>0?st.length:Ot.size,sr=Ut>0?Ut:parseFloat(ge.total_revenue||0),Vt=Rr>0?Rr:parseInt(ge.total_orders||0),Pt=Ka>0?Ka:parseInt(ye.total_imports||0),$t=Vr>0?Vr:parseInt(ye.total_quantity||ye.total_imports||0),Aa=Yt>0?Yt:parseFloat(ye.total_amount||0),Mr=Vt>0?sr/Vt:0,Ua=parseInt(qe.total_products||0)||Ie.length,ja=parseInt(qe.low_stock_products||0),_t=sr-Aa,Ea=sr>0?_t/sr*100:0;Fe.length,Fe.filter(he=>he.status==="active"||he.status==="1"||!he.status||he.status===null).length,Fe.filter(he=>he.status==="inactive"||he.status==="0").length,Fe.filter(he=>he.image||he.image_url||he.img).length;const pa=he=>{const ke=new Date(he);return isNaN(ke.getTime())?null:{sortKey:ke.toISOString().split("T")[0],displayKey:ke.toLocaleDateString("en-US",{month:"short",day:"numeric"})}},gr={},Kt={};Je.length>0&&Je.forEach(he=>{const ke=pa(he.ord_date||he.created_at);if(!ke)return;const{sortKey:nt,displayKey:St}=ke;gr[nt]||(gr[nt]={date:St,sortKey:nt,sales:0,orders:0,revenue:0,low:0});const Ke=Jl(he.amount||he.total,"currency");gr[nt].sales+=Ke,gr[nt].revenue+=Ke,gr[nt].low+=Ke,gr[nt].orders+=1}),mt.length>0&&mt.forEach(he=>{const ke=pa(he.imp_date||he.created_at);if(!ke)return;const{sortKey:nt,displayKey:St}=ke;Kt[nt]||(Kt[nt]={date:St,sortKey:nt,imports:0,importValue:0,importQty:0});const Ke=he.import_details||he.importDetails||[];if(Ke.length>0)Ke.forEach(dt=>{const Dt=Jl(dt.amount||dt.price||0,"currency"),vr=Jl(dt.qty||dt.quantity||0,"integer");Kt[nt].imports+=Dt,Kt[nt].importValue+=Dt,Kt[nt].importQty+=vr});else{const dt=Jl(he.amount||he.total_amount||he.total||0,"currency"),Dt=Jl(he.qty||he.quantity||0,"integer");Kt[nt].imports+=dt,Kt[nt].importValue+=dt,Kt[nt].importQty+=Dt}});let Nr=Object.values(gr).sort((he,ke)=>he.sortKey.localeCompare(ke.sortKey)).map(({sortKey:he,...ke})=>ke);Nr.length===0&&sr>0&&(Nr=["Oct 27","Oct 28","Oct 29"].map((ke,nt)=>({date:ke,sales:Math.round(sr*(.2+nt*.4)),orders:Math.round(Vt*(.2+nt*.4)),revenue:Math.round(sr*(.2+nt*.4)),low:Math.round(sr*(.2-nt*.4))}))),Object.values(Kt).sort((he,ke)=>he.sortKey.localeCompare(ke.sortKey)).map(({sortKey:he,...ke})=>ke);const K=new Set([...Object.keys(gr),...Object.keys(Kt)]);let ae=Array.from(K).map(he=>{const ke=gr[he],nt=Kt[he];return{date:(ke==null?void 0:ke.date)||(nt==null?void 0:nt.date)||he,sortKey:he,sales:(ke==null?void 0:ke.sales)||0,imports:(nt==null?void 0:nt.importValue)||0,importQty:(nt==null?void 0:nt.importQty)||0}}).sort((he,ke)=>he.sortKey.localeCompare(ke.sortKey)).map(({sortKey:he,...ke})=>ke);ae.length===0&&(ae=["Oct 27","Oct 28","Oct 29"].map((ke,nt)=>({date:ke,sales:Math.max(1e3,Math.round(sr*(.2+nt*.4))),imports:Math.max(500,Math.round(Aa*(.2+nt*.4))),importQty:Math.max(10,Math.round($t*(.2+nt*.4)))})));let re=[];if(Re.length>0?re=Re.map((he,ke)=>{const nt=he.total_quantity||he.qty||0,St=parseInt(nt),Ke=parseFloat(he.total_revenue||he.amount||0);St<=0&&Re.length>0&&console.warn("Top Selling Product has invalid sales value:",{product:he.product_name||he.pro_name,rawQuantity:nt,currentSales:St,fullProduct:he});const dt=he.product_name||he.pro_name||he.name||`Product ${ke+1}`,Dt=Re.reduce((xa,mn)=>xa+parseFloat(mn.total_revenue||mn.amount||0),0)/Re.length,vr=Dt>0?(Ke-Dt)/Dt*100:0;return{name:dt,sales:St,revenue:Ke,growth:Math.round(vr*10)/10,rank:ke+1,salesColor:"#3B82F6",revenueColor:"#10B981"}}):re=[],re.sort((he,ke)=>(ke.sales||0)-(he.sales||0)),re.length>0){const he=re.map(Ke=>Ke.sales||0),ke=Math.max(...he),nt=Math.min(...he),St=ke-nt;re.forEach((Ke,dt)=>{const Dt=Ke.sales||0,vr=ke-St/3,xa=nt+St/3;St===0||he.every(mn=>mn===he[0])||Dt>=vr?(Ke.performanceColor="#10B981",Ke.performanceLevel="High",Ke.bgColor="bg-green-100",Ke.textColor="text-green-800"):Dt>=xa?(Ke.performanceColor="#F59E0B",Ke.performanceLevel="Medium",Ke.bgColor="bg-yellow-100",Ke.textColor="text-yellow-800"):(Ke.performanceColor="#EF4444",Ke.performanceLevel="Low",Ke.bgColor="bg-red-100",Ke.textColor="text-red-800")})}else Ie.length>0&&sr>0&&(re=Ie.slice(0,5).map((he,ke)=>{const nt=sr/Ie.length,St=Math.floor(Math.random()*50)+1;return{name:he.pro_name||he.name||`Product ${ke+1}`,sales:St,revenue:Math.round(nt),growth:Math.round((Math.random()*40-20)*10)/10,rank:ke+1,performanceColor:ke===0?"#10B981":ke===1?"#F59E0B":"#EF4444",performanceLevel:ke===0?"High":ke===1?"Medium":"Low",bgColor:ke===0?"bg-green-100":ke===1?"bg-yellow-100":"bg-red-100",textColor:ke===0?"text-green-800":ke===1?"text-yellow-800":"text-red-800"}}));const ce=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6"],de=se.useMemo(()=>{const he={},ke=Fe.reduce((Ke,dt)=>{if(!dt)return Ke;const Dt=dt.id,vr=dt.name||String(dt).trim();return!Dt||!vr||(he[Dt]=vr,Ke[Dt]={name:vr,count:0,totalValue:0,totalStock:0,avgPrice:0}),Ke},{});Ie.forEach(Ke=>{var mn;if(!Ke)return;const dt=Ke.category_id||((mn=Ke.category)==null?void 0:mn.id),Dt=he[dt],vr=parseFloat(Ke.price||Ke.pro_price||Ke.upis||Ke.sup||0),xa=parseInt(Ke.qty||Ke.quantity||0);!Dt||ke[dt]===void 0||(ke[dt].count+=1,ke[dt].totalValue+=vr,ke[dt].totalStock+=xa,ke[dt].avgPrice=ke[dt].totalValue/ke[dt].count)});const nt=Object.values(ke).reduce((Ke,dt)=>Ke+dt.count,0);let St=Object.values(ke).map((Ke,dt)=>({name:(Ke.name||"").length>20?Ke.name.substring(0,20)+"...":Ke.name,value:nt>0?Math.round(Ke.count/nt*100):0,count:Ke.count,totalValue:Ke.totalValue,totalStock:Ke.totalStock,avgPrice:Math.round(Ke.avgPrice*100)/100,color:ce[dt%ce.length]})).sort((Ke,dt)=>dt.count-Ke.count);if(St.length===0&&Ie.length>0){const Ke=["Laptops","Apple","Desktop"];St=Ke.map((dt,Dt)=>({name:dt,value:Math.round(100/Ke.length),count:Math.ceil(Ie.length/Ke.length),totalValue:1e3*(Dt+1),totalStock:50*(Dt+1),avgPrice:500+Dt*200,color:ce[Dt%ce.length]}))}return St},[Fe,Ie]);let Ae=[];if(le&&le.staffPerformance&&le.staffPerformance.length>0)Ae=le.staffPerformance.map(he=>({name:he.name.length>15?he.name.substring(0,15)+"...":he.name,sales:Math.round(he.salesRevenue*100)/100,target:he.target||1e3,efficiency:he.efficiency,orderCount:he.salesCount,avgOrderValue:he.salesCount>0?Math.round(he.salesRevenue/he.salesCount*100)/100:0,importsCount:he.importsCount||0,importsValue:he.importsValue||0}));else if(Ze.length>0)Ae=Ze.slice(0,6).map((he,ke)=>{const nt=Math.max(1e3,sr/Ze.length),St=.5+Math.random()*.5;return{name:he.full_name||he.name||`Staff ${ke+1}`,sales:Math.round(nt*St),target:1e3,efficiency:Math.round(50+Math.random()*40),orderCount:Math.max(1,Math.round(Vt/Ze.length*St)),avgOrderValue:Math.max(100,Mr*(.8+Math.random()*.4)),importsCount:0,importsValue:0}});else{const he=wt.reduce((Ke,dt)=>{if(!dt||!dt.staff_id)return Ke;const Dt=dt.staff_id,vr=dt.full_name||dt.staff_name||`Staff ${Dt}`,xa=parseFloat(dt.total||dt.deposit||dt.amount||0);return xa<=0||(Ke[Dt]||(Ke[Dt]={id:Dt,name:vr,totalSales:0,orderCount:0,totalAmount:0}),Ke[Dt].totalSales+=xa,Ke[Dt].orderCount+=1,Ke[Dt].totalAmount+=xa),Ke},{}),ke=Object.values(he).reduce((Ke,dt)=>Ke+dt.totalSales,0),nt=Object.values(he).reduce((Ke,dt)=>Ke+dt.orderCount,0),St=nt>0?ke/nt:0;Ae=Object.values(he).map(Ke=>{const dt=Ke.orderCount>0?Ke.totalAmount/Ke.orderCount:0;let Dt=50;St>0&&(Dt=Math.min(100,Math.max(0,dt/St*50+25)));const vr=Math.max(1e3,St*1.2);return{name:Ke.name.length>15?Ke.name.substring(0,15)+"...":Ke.name,sales:Math.round(Ke.totalSales*100)/100,target:Math.round(vr),efficiency:Math.round(Dt),orderCount:Ke.orderCount,avgOrderValue:Math.round(dt*100)/100,importsCount:0,importsValue:0}}).filter(Ke=>Ke.orderCount>0).sort((Ke,dt)=>dt.sales-Ke.sales)}const Me=he=>{switch(he){case"7d":return"Last 7 days";case"30d":return"Last 30 days";case"90d":return"Last 90 days";case"1y":return"Last year";default:return"Last 30 days"}},Ee=[{title:"Total Sales (Revenue)",value:`$${sr.toLocaleString()}`,change:`${Vt} orders`,trend:"up",icon:zu,color:"text-green-600",bgColor:"bg-green-50",period:Me(e)},{title:"Total Imports",value:Pt>0?Pt.toLocaleString():(ye.total_imports||mt.length||0).toLocaleString(),change:$t>0?`${$t.toLocaleString()} qty, $${Aa.toLocaleString()} value`:Aa>0?`$${Aa.toLocaleString()} value`:"No imports in selected period",trend:Pt>0?"up":"neutral",icon:In,color:"text-blue-600",bgColor:"bg-blue-50",period:Me(e)},{title:"Profit",value:`$${_t.toLocaleString()}`,change:`${Ea.toFixed(1)}% margin`,trend:_t>0?"up":_t<0?"down":"neutral",icon:Hu,color:_t>0?"text-green-600":_t<0?"text-red-600":"text-gray-600",bgColor:_t>0?"bg-green-50":_t<0?"bg-red-50":"bg-gray-50",period:Me(e)},{title:"Suppliers",value:ma.toLocaleString(),change:nr?`Top: ${nr[0]} ($${nr[1].value.toLocaleString()})`:st.length>0?`${st.length} total suppliers`:"No suppliers",trend:ma>0?"up":"neutral",icon:mc,color:"text-indigo-600",bgColor:"bg-indigo-50",period:"Active suppliers"},{title:"Products",value:Ua.toLocaleString(),change:`${ja} low stock`,trend:ja>0?"down":"up",icon:Lr,color:"text-orange-600",bgColor:"bg-orange-50",period:"Current inventory"}],Te=()=>{R(),W(),xt()};se.useEffect(()=>{let he;return c&&(he=setInterval(()=>{!g&&!S&&!P&&Te()},3e4)),()=>{he&&clearInterval(he)}},[c]);const Le=()=>{s(!0)},tt={totalRevenue:sr,totalOrders:Vt,totalImports:$t,profit:_t,profitMargin:Ea,trendData:ae,categoryData:de,topProducts:re,staffPerformance:Ae,timeRange:e,dateParams:b,summary:{totalProducts:Ua,lowStockProducts:ja,avgOrderValue:Vt>0?sr/Vt:0}},it=bt&&!d&&!y&&!Ie.length&&!U;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:" Analytics Dashboard"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time business insights from your database"}),i.jsxs("div",{className:"flex items-center mt-2 text-sm text-blue-600",children:[i.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${kt||o?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),i.jsx("span",{children:o?"Updating data...":kt?" Refreshing data...":`Live data (${e}): ${Je.length} sales ($${sr.toLocaleString()}), ${Ka||mt.length} import records (${Vr} total qty, $${Yt.toLocaleString()}), ${Ie.length} products, ${ma} suppliers, ${Ze.length} staff`})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("select",{value:e,onChange:he=>{l(!0),t(he.target.value),setTimeout(()=>l(!1),1e3)},className:"input text-sm",disabled:bt,children:[i.jsx("option",{value:"7d",children:"Last 7 days"}),i.jsx("option",{value:"30d",children:"Last 30 days"}),i.jsx("option",{value:"90d",children:"Last 90 days"}),i.jsx("option",{value:"1y",children:"Last year"})]}),o&&i.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:[i.jsx(sn,{className:"w-4 h-4 mr-1",style:{animation:"spin 0.5s linear infinite",animationFillMode:"forwards"}}),i.jsx("span",{children:"Updating..."})]}),i.jsxs("button",{onClick:Te,disabled:bt,className:"btn-secondary text-sm",children:[i.jsx(sn,{className:"w-4 h-4 mr-2",style:bt?{animation:"spin 0.5s linear infinite",animationFillMode:"forwards"}:{}}),"Refresh"]}),i.jsxs("button",{onClick:()=>u(!c),className:`text-sm px-3 py-2 rounded-md border transition-colors ${c?"bg-green-50 border-green-200 text-green-700 hover:bg-green-100":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(sn,{className:"w-4 h-4 mr-2",style:c?{animation:"spin 0.5s linear infinite",animationFillMode:"forwards"}:{}}),c?"ON":"OFF"]}),i.jsxs("button",{onClick:Le,className:"btn-primary text-sm",children:[i.jsx(Gi,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),ot&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(sf,{className:"w-5 h-5 text-red-500 mr-2"}),i.jsxs("div",{children:[i.jsxs("h4",{className:"text-sm font-medium text-red-800",children:["Data Loading Issues (",Ar," error",Ar>1?"s":"",")"]}),i.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["Some analytics data couldn't be loaded. Charts may show incomplete information.",i.jsx("button",{onClick:Te,className:"underline ml-1 hover:no-underline",children:"Try refreshing"})]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border-b",children:i.jsx("div",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview",icon:If},{id:"products",label:"Products",icon:Lr},{id:"staff",label:"Staff",icon:hi},{id:"gallery",label:"Photo Gallery",icon:cn}].map(he=>i.jsxs("button",{onClick:()=>a(he.id),className:`flex items-center space-x-2 py-4 border-b-2 font-medium text-sm transition-colors ${r===he.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(he.icon,{className:"w-4 h-4"}),i.jsx("span",{children:he.label})]},he.id))})}),r==="overview"&&i.jsxs("div",{className:"space-y-5",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:it?Array.from({length:5}).map((he,ke)=>i.jsx(yT,{},ke)):Ee.map((he,ke)=>i.jsxs("div",{className:`bg-white rounded-lg shadow-sm p-4 transition-opacity ${o?"opacity-50":"opacity-100"}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:he.title}),i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:he.period}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:he.value})]}),i.jsx("div",{className:`w-12 h-12 rounded-lg ${he.bgColor} flex items-center justify-center`,children:i.jsx(he.icon,{className:`w-6 h-6 ${he.color}`})})]}),i.jsxs("div",{className:"flex items-center mt-4",children:[he.trend==="up"?i.jsx(Hu,{className:"w-4 h-4 text-green-500 mr-1"}):he.trend==="down"?i.jsx(sf,{className:"w-4 h-4 text-red-500 mr-1"}):null,i.jsx("span",{className:`text-sm font-medium ${he.trend==="up"?"text-green-600":he.trend==="down"?"text-red-600":"text-gray-600"}`,children:he.change}),he.trend!=="neutral"&&i.jsx("span",{className:"text-sm text-gray-500 ml-1"})]})]},ke))}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:`bg-white rounded-lg shadow-sm p-6 ${o?"opacity-50":""}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Selling Products"}),i.jsx("span",{className:"text-sm text-gray-500",children:Me(e)})]}),re&&re.length>0?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-4 flex flex-wrap gap-3 text-xs",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 rounded mr-1 bg-green-500"}),i.jsx("span",{children:" (High)"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 rounded mr-1 bg-yellow-500"}),i.jsx("span",{children:" (Medium)"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 rounded mr-1 bg-red-500"}),i.jsx("span",{children:" (Low)"})]})]}),i.jsx(To,{width:"100%",height:500,children:i.jsxs(wu,{data:re.slice(0,10),margin:{top:10,right:1,left:-10,bottom:0},isAnimationActive:!1,children:[i.jsx(Rl,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),i.jsx(Ml,{dataKey:"name",angle:-45,textAnchor:"end",height:120,tick:{fontSize:11,fill:"#6b7280"},interval:0,axisLine:{stroke:"#d1d5db"},tickLine:{stroke:"#d1d5db"},type:"category"}),i.jsx(Bl,{label:{value:"Quantity Sold (units)",angle:-90,marginLeft:-40,style:{textAnchor:"middle",fill:"#374151",fontSize:"13px",fontWeight:"500"}},tick:{fontSize:12,fill:"#6b7280"},axisLine:{stroke:"#d1d5db"},tickLine:{stroke:"#d1d5db"},width:60,domain:[0,"dataMax"],allowDecimals:!1}),i.jsx(Co,{formatter:(he,ke,nt)=>(nt.payload,ke==="sales"||ke==="Quantity Sold"?[i.jsxs("span",{style:{fontWeight:"bold",color:"#059669"},children:[he," units"]},"qty"),"Quantity Sold"]:[`$${he.toLocaleString()}`,"Revenue"]),labelFormatter:he=>i.jsx("span",{style:{fontWeight:"bold",fontSize:"14px"},children:he}),contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"12px"},cursor:{fill:"rgba(0, 0, 0, 0.05)"}}),i.jsx(Po,{wrapperStyle:{paddingTop:"20px"},iconType:"square"}),i.jsx(ki,{dataKey:"sales",name:"Quantity Sold",radius:[4,4,0,0],isAnimationActive:!1,minPointSize:5,children:re.slice(0,10).map((he,ke)=>(ke<2&&console.log("Top Product",ke+1,":",{name:he.name,sales:he.sales,performanceColor:he.performanceColor}),i.jsx(bu,{fill:he.performanceColor||"#3B82F6"},`cell-${ke}`)))})]})})]}):i.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Lr,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"No Product Sales Data Available"}),i.jsx("p",{className:"text-sm mt-2",children:Re.length>0?`${Re.length} products found, but no sales data for selected period`:"No product sales data available for selected time period"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Try selecting a different time range or check if there are product sales in the system"})]})})]}),i.jsxs("div",{className:`bg-white rounded-lg shadow-sm p-6 ${o?"opacity-50":""}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Category Distribution"}),i.jsxs("span",{className:"text-sm text-gray-600 font-medium",children:[de.filter(he=>he.count>0).length," ",de.filter(he=>he.count>0).length===1?"Category":"Categories"]})]}),de&&de.length>0?i.jsx(To,{width:"100%",height:350,children:i.jsxs(uv,{children:[i.jsx(dv,{data:de.filter(he=>he.count>0),cx:"50%",cy:"50%",labelLine:!1,label:({name:he,percent:ke,count:nt})=>ke>.05?`${he}: ${(ke*100).toFixed(0)}% (${nt})`:"",outerRadius:100,innerRadius:30,fill:"#8884d8",dataKey:"value",paddingAngle:2,isAnimationActive:!1,children:de.filter(he=>he.count>0).map((he,ke)=>i.jsx(bu,{fill:he.color,stroke:"#fff",strokeWidth:2},`cell-${ke}`))}),i.jsx(Co,{formatter:(he,ke,nt)=>{const St=nt.payload;return[i.jsxs("span",{style:{fontWeight:"bold"},children:[he,"% (",St.count," ",St.count===1?"product":"products",")"]},"tooltip"),ke]},labelFormatter:he=>i.jsx("span",{style:{fontWeight:"bold",fontSize:"14px"},children:he}),contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"12px"}}),i.jsx(Po,{wrapperStyle:{paddingTop:"10px"},iconType:"circle",formatter:(he,ke)=>{const nt=de.find(St=>St.name===he);return nt&&nt.count>0?`${he} (${nt.count} ${nt.count===1?"product":"products"})`:null}})]})}):i.jsx("div",{className:"flex items-center  justify-center h-[300px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Xp,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"No Category Data Available"}),i.jsx("p",{className:"text-sm mt-2 ",children:Fe.length>0?`${Fe.length} categories found, but no products assigned to categories`:Ie.length>0?`${Ie.length} products found, but no categories in system`:"No categories or products found in the system"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Add products with categories to see distribution"})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:`bg-white rounded-lg shadow-sm p-6 ${o?"opacity-50":""}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Import vs Sales Trend"}),i.jsx("span",{className:"text-sm text-gray-500",children:Me(e)})]}),L||z?i.jsx(wT,{title:"Failed to Load Trend Data",message:"Unable to fetch sales or import data for trend analysis.",onRetry:()=>{R(),W()}}):Mo(ae,["sales","imports"])?i.jsx(To,{width:"100%",height:300,children:i.jsxs(fv,{data:ae,children:[i.jsx(Rl,{strokeDasharray:"3 3"}),i.jsx(Ml,{dataKey:"date"}),i.jsx(Bl,{}),i.jsx(Co,{formatter:(he,ke)=>ke.includes("$")?[`$${he.toLocaleString()}`,ke]:ke.includes("Qty")?[`${he.toLocaleString()} units`,ke]:[`${he.toLocaleString()}`,ke],labelFormatter:he=>`Date: ${he}`}),i.jsx(Po,{}),i.jsx(Cd,{type:"monotone",dataKey:"sales",stroke:"#10B981",strokeWidth:2,name:"Sales ($)"}),i.jsx(Cd,{type:"monotone",dataKey:"imports",stroke:"#F59E0B",strokeWidth:2,name:"Imports ($)"}),i.jsx(Cd,{type:"monotone",dataKey:"importQty",stroke:"#3B82F6",strokeWidth:2,name:"Import Qty",strokeDasharray:"5 5"})]})}):i.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsxs("p",{className:"text-lg font-medium",children:["Sales: $",sr.toLocaleString()," | Imports: $",Aa.toLocaleString()," (",$t," qty)"]}),i.jsx("p",{className:"text-sm mt-2",children:Je.length>0||mt.length>0?`Found ${Je.length} sales and ${mt.length} import records, but no daily trend data for selected period`:"No sales or import data available for selected time period"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Try selecting a different time range or add more transactions"})]})})]}),i.jsxs("div",{className:`bg-white rounded-lg shadow-sm p-6 ${o?"opacity-50":""}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Staff Performance"}),i.jsx("span",{className:"text-sm text-gray-500",children:Me(e)})]}),Mo(Ae,["sales"])?i.jsx(To,{width:"100%",height:300,children:i.jsxs(wu,{data:Ae,layout:"horizontal",children:[i.jsx(Rl,{strokeDasharray:"3 3"}),i.jsx(Ml,{type:"number"}),i.jsx(Bl,{dataKey:"name",type:"category",width:80}),i.jsx(Co,{}),i.jsx(Po,{}),i.jsx(ki,{dataKey:"sales",fill:"#3B82F6",name:"Sales ($)"}),i.jsx(ki,{dataKey:"target",fill:"#E5E7EB",name:"Target"})]})}):i.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-medium",children:"No Staff Performance Data Available"}),i.jsx("p",{className:"text-sm mt-2",children:le?"Staff analytics loaded but no performance data for selected period":Ze.length>0?`${Ze.length} staff found but no performance data for selected time period`:"No staff found in the system"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Try selecting a different time range or check if there are staff activities in the system"})]})})]})]})]}),r==="products"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:" Product Performance Analysis (Based on Revenue)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Performance Color Coding by Revenue:"}),i.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Products are color-coded based on revenue performance relative to other products."})]}),re.length>0&&i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Performance Distribution:"}),i.jsxs("div",{className:"text-sm space-y-1",children:[i.jsxs("div",{children:["High:"," ",re.filter(he=>he.performanceLevel==="High").length," ","products"]}),i.jsxs("div",{children:["Medium:"," ",re.filter(he=>he.performanceLevel==="Medium").length," ","products"]}),i.jsxs("div",{children:["Low:"," ",re.filter(he=>he.performanceLevel==="Low").length," ","products"]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Top Performing Products"}),Mo(re,["sales","revenue"])?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Product"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Sales"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Revenue"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Performance"})]})}),i.jsx("tbody",{children:re.map((he,ke)=>i.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center mr-3",style:{backgroundColor:`${he.performanceColor||"#3B82F6"}20`},children:i.jsx("span",{className:"font-bold text-sm",style:{color:he.performanceColor||"#3B82F6"},children:he.rank})}),i.jsx("span",{className:"font-medium",children:he.name})]})}),i.jsxs("td",{className:"py-3 px-4",children:[he.sales," units"]}),i.jsxs("td",{className:"py-3 px-4",children:["$",he.revenue.toLocaleString()]}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${he.bgColor&&he.textColor?`${he.bgColor} ${he.textColor}`:"bg-gray-100 text-gray-800"}`,children:[he.performanceLevel==="High"?"":he.performanceLevel==="Medium"?"":he.performanceLevel==="Low"?"":"",he.performanceLevel||"Standard"]})})]},ke))})]})}):i.jsx("div",{className:"text-center py-8 text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-medium",children:"No Product Performance Data Available"}),i.jsx("p",{className:"text-sm mt-2",children:Re.length>0?`${Re.length} products found, but no sales data for selected period`:"No product sales data available for selected time period"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Try selecting a different time range or check if there are product sales in the system"})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Product Performance Comparison"}),i.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Performance Color Guide with Revenue Thresholds:"}),(()=>{if(re.length===0)return i.jsx("div",{className:"text-sm text-gray-500",children:"No product data available"});const he=re.map(Dt=>Dt.revenue),ke=Math.max(...he),nt=Math.min(...he),St=ke-nt,Ke=ke-St*.33,dt=nt+St*.33;return i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-4 h-4 bg-green-500 rounded mr-2"}),i.jsxs("span",{children:[" ",i.jsx("strong",{children:"High Revenue"}),"  $",Ke.toFixed(0)]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded mr-2"}),i.jsxs("span",{children:[" ",i.jsx("strong",{children:"Medium Revenue"})," $",dt.toFixed(0)," - $",(Ke-1).toFixed(0)]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-4 h-4 bg-red-500 rounded mr-2"}),i.jsxs("span",{children:[" ",i.jsx("strong",{children:"Low Revenue"})," < $",dt.toFixed(0)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-2 p-2 bg-blue-50 rounded",children:[i.jsx("strong",{children:"Current Revenue Range:"})," $",nt.toLocaleString()," - $",ke.toLocaleString()]})]})})()]}),Mo(re,["sales","revenue"])?i.jsx(To,{width:"100%",height:400,children:i.jsxs(wu,{data:re.slice(0,5),children:[i.jsx(Rl,{strokeDasharray:"3 3"}),i.jsx(Ml,{dataKey:"name"}),i.jsx(Bl,{}),i.jsx(Co,{formatter:(he,ke,nt)=>{const St=nt.payload;return[ke.includes("Revenue")?`$${he.toLocaleString()}`:`${he.toLocaleString()} units`,`${ke} (${St.performanceLevel||"Standard"} Performance)`]},labelFormatter:he=>`Product: ${he}`}),i.jsx(Po,{}),i.jsx(ki,{dataKey:"sales",name:"Sales (units)",children:re.slice(0,5).map((he,ke)=>i.jsx(bu,{fill:he.performanceColor||"#3B82F6"},`sales-cell-${ke}`))}),i.jsx(ki,{dataKey:"revenue",name:"Revenue ($)",children:re.slice(0,5).map((he,ke)=>i.jsx(bu,{fill:he.performanceColor||"#10B981"},`revenue-cell-${ke}`))})]})}):i.jsx("div",{className:"flex items-center justify-center h-[400px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-medium",children:"No Product Data Available for Chart"}),i.jsx("p",{className:"text-sm mt-2",children:Re.length>0?`${Re.length} products found, but no sales/revenue data for chart visualization`:"No product data found in the system"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Add products with sales data to see performance comparison"})]})})]})]}),r==="staff"&&i.jsxs("div",{className:"space-y-6",children:[le&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:" Team Performance Summary"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500",children:"Total Staff"}),i.jsx("p",{className:"font-semibold text-lg",children:((Jt=le.teamMetrics)==null?void 0:Jt.totalStaff)||0})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500",children:"Team Sales"}),i.jsxs("p",{className:"font-semibold text-lg",children:["$",(((er=le.teamMetrics)==null?void 0:er.totalSales)||0).toLocaleString()]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500",children:"Total Orders"}),i.jsx("p",{className:"font-semibold text-lg",children:((Tr=le.teamMetrics)==null?void 0:Tr.totalOrders)||0})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500",children:"Avg Efficiency"}),i.jsxs("p",{className:"font-semibold text-lg",children:[Math.round(((Ja=le.teamMetrics)==null?void 0:Ja.averageEfficiency)||0),"%"]})]})]})]}),le&&le.chartData&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Staff Sales vs Imports Activity"}),Mo(le.chartData.salesImportsChart,["sales","imports"])?i.jsx(To,{width:"100%",height:300,children:i.jsxs(wu,{data:le.chartData.salesImportsChart.slice(0,8),children:[i.jsx(Rl,{strokeDasharray:"3 3"}),i.jsx(Ml,{dataKey:"name"}),i.jsx(Bl,{}),i.jsx(Co,{formatter:(he,ke)=>[`$${he.toLocaleString()}`,ke],labelFormatter:he=>`Staff: ${he}`}),i.jsx(Po,{}),i.jsx(ki,{dataKey:"sales",fill:"#10B981",name:"Sales ($)"}),i.jsx(ki,{dataKey:"imports",fill:"#F59E0B",name:"Imports ($)"})]})}):i.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:"No sales vs imports data available for staff"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Staff Performance Details"}),Mo(Ae,["sales"])?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ae.slice(0,6).map((he,ke)=>{const nt=Ze.find(St=>St.full_name===he.name||St.name===he.name)||{};return i.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mr-3 ${he.efficiency>=70?"bg-green-100":he.efficiency>=50?"bg-yellow-100":"bg-red-100"}`,children:i.jsx(hi,{className:`w-6 h-6 ${he.efficiency>=70?"text-green-600":he.efficiency>=50?"text-yellow-600":"text-red-600"}`})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:he.name}),i.jsx("p",{className:"text-sm text-gray-500",children:nt.email||"No email"})]})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Role:"}),i.jsx("span",{className:"font-medium capitalize",children:nt.user_type||nt.type||"Staff"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Total Sales:"}),i.jsxs("span",{className:"font-medium",children:["$",he.sales.toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Orders:"}),i.jsx("span",{className:"font-medium",children:he.orderCount})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Avg Order:"}),i.jsxs("span",{className:"font-medium",children:["$",he.avgOrderValue.toFixed(2)]})]}),he.importsCount!==void 0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Imports:"}),i.jsx("span",{className:"font-medium",children:he.importsCount})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Import Value:"}),i.jsxs("span",{className:"font-medium",children:["$",(he.importsValue||0).toLocaleString()]})]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Performance:"}),i.jsxs("span",{className:`font-medium ${he.efficiency>=70?"text-green-600":he.efficiency>=50?"text-yellow-600":"text-red-600"}`,children:[he.efficiency,"%"]})]}),i.jsx("div",{className:"mt-2 pt-2 border-t",children:i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:`h-2 rounded-full ${he.efficiency>=70?"bg-green-500":he.efficiency>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(100,he.efficiency)}%`}})})})]})]},he.id||ke)})}):i.jsx("div",{className:"text-center py-8 text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-medium",children:"No Staff Performance Data Available"}),i.jsx("p",{className:"text-sm mt-2",children:le?"Staff analytics loaded but no detailed performance data for selected period":"No staff performance data available for selected time period"}),i.jsx("p",{className:"text-xs mt-1 text-gray-400",children:"Try selecting a different time range or check if there are staff activities in the system"})]})})]})]}),r==="gallery"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx(xf,{items:Ie,title:"Products",type:"product"}),i.jsx(xf,{items:Ze,title:"Staff",type:"staff"})]}),r==="debug"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-medium text-yellow-800 mb-2",children:" API Debug Tools"}),i.jsx("p",{className:"text-sm text-yellow-700",children:'Use this tool to test export endpoints and diagnose API issues. Click "Test Export Endpoints" to check which export URLs are available.'})]})}),n&&i.jsx(vT,{type:"analytics",title:"Analytics",analyticsData:tt,onClose:()=>s(!1)})]})},NT=({user:e,mode:t,onClose:r,onSuccess:a})=>{var y,_,S,E,C;const n=t==="view",s=t==="edit",o=aT(),l=nT(),{register:c,handleSubmit:u,formState:{errors:d},reset:m,watch:g}=Xa({defaultValues:e?{name:e.name||"",email:e.email||"",phone:e.phone||((y=e.profile)==null?void 0:y.phone)||"",address:e.address||((_=e.profile)==null?void 0:_.address)||"",type:e.type||e.user_type||""}:{}}),h=g("password");se.useEffect(()=>{var F,B;e&&m({name:e.name||"",email:e.email||"",phone:e.phone||((F=e.profile)==null?void 0:F.phone)||"",address:e.address||((B=e.profile)==null?void 0:B.address)||"",type:e.type||e.user_type||""})},[e,m]);const x=async F=>{var B;try{const{password_confirmation:T,...P}=F,k=P.image&&P.image[0];let I;if(k){const R=P.image[0];if(!R.type.startsWith("image/"))throw new Error("Selected file is not an image");const W=new FormData;W.append("name",String(P.name||"")),W.append("email",String(P.email||"")),W.append("phone",String(P.phone||"")),W.append("address",String(P.address||"")),W.append("type",String(P.type||"")),P.password&&W.append("password",P.password),W.append("image",R),I=W}else I={name:String(P.name||""),email:String(P.email||""),phone:String(P.phone||""),address:String(P.address||""),type:String(P.type||"")},P.password&&(I.password=P.password);let A;s?A=await l.mutateAsync({id:e.id,data:I}):A=await o.mutateAsync(I);const b=A&&(((B=A.data)==null?void 0:B.data)||A.data||A)||null;if(typeof a=="function"){const R=s?"update":"create";try{a({type:R,user:b})}catch{}}r()}catch(T){console.error("Submit failed:",T),alert("Error: "+T.message)}},p=o.isLoading||l.isLoading;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 sticky top-0 bg-white",children:[i.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t==="create"?"Add New User":t==="edit"?"Edit User":"User Details"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 p-1",children:i.jsx(zr,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),i.jsxs("form",{onSubmit:u(x),className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),i.jsx("input",{...c("name",{required:"Name is required"}),type:"text",className:"input",disabled:n}),d.name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.name.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),i.jsx("input",{...c("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email address"}}),type:"email",className:"input",disabled:n}),d.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.email.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{...c("phone"),type:"tel",className:"input",disabled:n})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Type *"}),i.jsxs("select",{...c("type",{required:"User type is required"}),className:"input",disabled:n,children:[i.jsx("option",{value:"",children:"Select User Type"}),i.jsx("option",{value:"admin",children:"Administrator - Full system access"}),i.jsx("option",{value:"manager",children:"Manager - Read-only access (cannot manage users)"}),i.jsx("option",{value:"sales",children:"Sales Staff - Manage orders & payments only"}),i.jsx("option",{value:"inventory",children:"Inventory Staff - Manage products & imports only"}),i.jsx("option",{value:"user",children:"User - Read-only access to all modules"})]}),d.type&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.type.message}),i.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Role Permissions:"}),i.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Admin:"})," Create, Read, Update, Delete all modules"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Manager:"})," Read-only access (cannot update/insert/delete users)"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Sales Staff:"})," Manage sales orders and payments only"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Inventory Staff:"})," Manage products and stock imports only"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"User:"})," Read-only access to view all data"]})]})]})]}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),i.jsx("input",{...c("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",className:"input"}),d.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.password.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password *"}),i.jsx("input",{...c("password_confirmation",{required:"Please confirm your password",validate:F=>F===h||"Passwords do not match"}),type:"password",className:"input"}),d.password_confirmation&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.password_confirmation.message})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("textarea",{...c("address"),rows:3,className:"input",disabled:n})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Photo"}),s&&((e==null?void 0:e.image)||((S=e==null?void 0:e.profile)==null?void 0:S.image))&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Current Photo:"}),i.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full overflow-hidden border border-gray-300",children:i.jsx("img",{src:e.image_url||((E=e.profile)==null?void 0:E.image_url)||pi(e.image||((C=e.profile)==null?void 0:C.image),Is.base_image_url),alt:"User",className:"w-full h-full object-cover"})})]}),i.jsx("input",{...c("image"),type:"file",accept:"image/jpeg,image/png,image/jpg,image/gif,image/webp,image/avif",className:"input text-sm",disabled:n}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Supported formats: JPEG, PNG, JPG, GIF, WEBP, AVIF (max 10MB)"})]}),!n&&i.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-4 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto order-2 sm:order-1",disabled:p,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-primary w-full sm:w-auto order-1 sm:order-2",disabled:p,children:p?i.jsx(Er,{size:"sm"}):s?"Update User":"Create User"})]}),n&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:i.jsx("button",{type:"button",onClick:r,className:"btn-secondary w-full sm:w-auto",children:"Close"})})]})]})})},Gp=e=>({admin:"bg-gradient-to-r from-red-500 to-red-600 text-white border-red-600 shadow-lg font-bold",manager:"bg-gradient-to-r from-purple-500 to-purple-600 text-white border-purple-600 shadow-lg font-bold",sales:"bg-gradient-to-r from-green-500 to-green-600 text-white border-green-600 shadow-lg font-bold",staff_sale:"bg-gradient-to-r from-green-500 to-green-600 text-white border-green-600 shadow-lg font-bold",inventory:"bg-gradient-to-r from-blue-500 to-blue-600 text-white border-blue-600 shadow-lg font-bold",inventory_staff:"bg-gradient-to-r from-blue-500 to-blue-600 text-white border-blue-600 shadow-lg font-bold",user:"bg-gradient-to-r from-gray-500 to-gray-600 text-white border-gray-600 shadow-lg font-semibold"})[e]||"bg-gradient-to-r from-gray-500 to-gray-600 text-white border-gray-600 shadow-lg font-semibold",Yp=e=>{const r={admin:iv,manager:r1,sales:In,staff_sale:In,inventory:Lr,inventory_staff:Lr,user:fi}[e]||fi;return i.jsx(r,{className:"w-4 h-4 mr-1.5 text-white"})},_T=()=>{var B;const{hasPermission:e}=ha(),[t,r]=se.useState(""),[a,n]=se.useState(null),[s,o]=se.useState(!1),[l,c]=se.useState("create"),[u,d]=se.useState([]),{data:m,isLoading:g,error:h,refetch:x}=e2(),p=sT(),y=((B=m==null?void 0:m.data)==null?void 0:B.data)||(m==null?void 0:m.data)||m||[];if(se.useEffect(()=>{Array.isArray(y)&&y.length>0&&d(y)},[m]),!e("manage_users"))return i.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[i.jsx(r1,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-gray-500",children:"You don't have permission to manage users"})]});const _=()=>{n(null),c("create"),o(!0)},S=T=>{n(T),c("view"),o(!0)},E=T=>{n(T),c("edit"),o(!0)},C=async T=>{if(n(T),window.confirm(`Are you sure you want to delete "${T.name}"?`))try{d(P=>P.filter(k=>k.id!==T.id)),await p.mutateAsync(T.id),x()}catch(P){console.error("Delete failed:",P),x()}finally{n(null)}else n(null)};if(g&&!m)return i.jsx(Er,{className:"h-64"});if(h)return i.jsx("div",{className:"text-red-600",children:"Error loading users"});const F=Array.isArray(u)?u.filter(T=>(T.name||"").toLowerCase().includes(t.toLowerCase())||(T.email||"").toLowerCase().includes(t.toLowerCase())):[];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Users"}),i.jsx("p",{className:"text-gray-600",children:"Manage system users and permissions"})]}),i.jsxs("button",{onClick:_,className:"btn-primary",children:[i.jsx(An,{className:"w-4 h-4 mr-2"}),"Add User"]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("div",{className:"relative mb-4",children:[i.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search users...",value:t,onChange:T=>r(T.target.value),className:"input pl-10"})]}),i.jsxs("div",{className:"border-t pt-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:" User Role Colors & Permissions:"}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[{type:"admin",label:"Administrator",desc:"Full Access"},{type:"manager",label:"Manager",desc:"Read Only"},{type:"sales",label:"Sales Staff",desc:"Orders & Payments"},{type:"inventory",label:"Inventory Staff",desc:"Products & Stock"},{type:"user",label:"User",desc:"View Only"}].map(T=>i.jsxs("div",{className:"text-center",children:[i.jsxs("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm border-2 ${Gp(T.type)} mb-1`,children:[Yp(T.type),T.label]}),i.jsx("div",{className:"text-xs text-gray-500",children:T.desc})]},T.type))})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"table",children:[i.jsx("thead",{className:"table-header",children:i.jsxs("tr",{children:[i.jsx("th",{className:"table-head",children:"User"}),i.jsx("th",{className:"table-head",children:"Email"}),i.jsx("th",{className:"table-head",children:"Role"}),i.jsx("th",{className:"table-head",children:"Created"}),i.jsx("th",{className:"table-head",children:"Actions"})]})}),i.jsx("tbody",{children:F.map(T=>{var P,k,I,A,b,R,W,Y,q,U;return i.jsxs("tr",{className:"table-row",children:[i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center",children:[i.jsxs("div",{className:"w-10 h-10 rounded-full overflow-hidden mr-3 border-2 border-gray-200",children:[T.image||(P=T.profile)!=null&&P.image?i.jsx("img",{src:T.image_url||((k=T.profile)==null?void 0:k.image_url)||pi(T.image||((I=T.profile)==null?void 0:I.image),Is.base_image_url),alt:T.name,className:"w-full h-full object-cover",onError:H=>{H.target.style.display="none",H.target.nextSibling.style.display="flex"}}):null,i.jsx("div",{className:`w-full h-full bg-primary-600 flex items-center justify-center ${T.image||(A=T.profile)!=null&&A.image?"hidden":""}`,children:i.jsx(fi,{className:"w-5 h-5 text-white"})})]}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:T.name}),i.jsxs("div",{className:"text-sm text-gray-500 space-y-0.5",children:[(T.phone||((b=T.profile)==null?void 0:b.phone))&&i.jsxs("div",{children:[" ",T.phone||((R=T.profile)==null?void 0:R.phone)]}),(T.address||((W=T.profile)==null?void 0:W.address))&&i.jsxs("div",{className:"truncate max-w-48",children:[" ",T.address||((Y=T.profile)==null?void 0:Y.address)]}),!(T.phone||(q=T.profile)!=null&&q.phone)&&!(T.address||(U=T.profile)!=null&&U.address)&&i.jsx("div",{children:"No contact info"})]})]})]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-gray-900",children:T.email})}),i.jsx("td",{className:"table-cell",children:i.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm border-2 ${Gp(T.type||T.user_type)}`,children:[Yp(T.type||T.user_type),hf(T.type||T.user_type)]})}),i.jsx("td",{className:"table-cell",children:i.jsx("span",{className:"text-sm text-gray-500",children:Pr(T.created_at)})}),i.jsx("td",{className:"table-cell",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>S(T),className:"text-gray-400 hover:text-gray-600",title:"View",children:i.jsx(cn,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>E(T),className:"text-blue-400 hover:text-blue-600",title:"Edit",children:i.jsx(Rn,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>C(T),className:"text-red-400 hover:text-red-600",title:"Delete",disabled:p.isLoading,children:p.isLoading&&(a==null?void 0:a.id)===T.id?i.jsx("div",{className:"w-4 h-4 border-2 border-red-400 border-t-transparent rounded-full animate-spin"}):i.jsx(un,{className:"w-4 h-4"})})]})})]},T.id)})})]})}),F.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(fi,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),i.jsx("p",{className:"text-gray-500",children:t?"Try adjusting your search terms":"Get started by adding your first user"})]})]}),s&&i.jsx(NT,{user:a,mode:l,onClose:()=>o(!1),onSuccess:({type:T,user:P})=>{if(!P){x();return}d(k=>T==="create"?[P,...k]:T==="update"?k.map(I=>I.id===P.id?{...I,...P}:I):k),x()}})]})},ST=()=>{const[e,t]=se.useState(null),[r,a]=se.useState(!0),[n,s]=se.useState(null),o=se.useCallback(async()=>{try{a(!0);const l=await ut.get("/notifications");t(l.data),s(null)}catch(l){s(l)}finally{a(!1)}},[]);return se.useEffect(()=>{o()},[o]),{data:e,isLoading:r,error:n,refetch:o}},AT=()=>{const[e,t]=se.useState(!1),r=async a=>{var n,s;try{t(!0);const o=await ut.patch(`/notifications/${a}/read`);return Ye.success("Notification marked as read"),o.data}catch(o){throw Ye.error(((s=(n=o.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to mark notification as read"),o}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},jT=()=>{const[e,t]=se.useState(!1),r=async()=>{var a,n;try{t(!0);const s=await ut.patch("/notifications/mark-all-read");return Ye.success("All notifications marked as read"),s.data}catch(s){throw Ye.error(((n=(a=s.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to mark all notifications as read"),s}finally{t(!1)}};return{mutate:r,mutateAsync:r,isLoading:e}},ET=()=>{var A;const[e,t]=se.useState("all"),[r,a]=se.useState(new Date),[n,s]=se.useState(!0),{data:o,isLoading:l,error:c,refetch:u}=ST(),d=AT(),m=jT(),[g,h]=se.useState([]),x=async()=>{var b;try{const R=await ut.get("/products"),Y=(Array.isArray((b=R==null?void 0:R.data)==null?void 0:b.data)?R.data.data:Array.isArray(R==null?void 0:R.data)?R.data:Array.isArray(R)?R:[]).filter(q=>{const U=parseInt(q.qty||0),H=parseInt(q.reorder_point||10);return U<=H});h(Y)}catch(R){console.error("Low stock fetch error:",R),h([])}};se.useEffect(()=>{x()},[n]),se.useEffect(()=>{},[n,u,x]);const p=async()=>{try{await Promise.all([u(),x()]),a(new Date)}catch(b){console.error("Manual refresh failed:",b)}},y=()=>{const R=new Date-r,W=Math.floor(R/1e3),Y=Math.floor(W/60);return W<30?"Just now":W<60?`${W}s ago`:Y<60?`${Y}m ago`:r.toLocaleTimeString()},_=((A=o==null?void 0:o.data)==null?void 0:A.data)||(o==null?void 0:o.data)||o||[],C=[...(Array.isArray(g)?g:[]).map(b=>{var q,U;const R=parseInt(b.qty||0),W=parseInt(b.reorder_point||10),Y=R===0?"critical":R<=3?"high":"medium";return{id:`low-stock-${b.id}`,type:R===0?"error":"warning",title:R===0?" Out of Stock":" Low Stock Alert",message:R===0?`${b.pro_name} is completely out of stock! Immediate reorder required.`:`${b.pro_name} is running low with only ${R} units remaining (Reorder at: ${W} units)`,is_read:!1,created_at:new Date().toISOString(),urgency:Y,data:{product_id:b.id,product_name:b.pro_name,current_qty:R,reorder_point:W,category:((q=b.category)==null?void 0:q.cat_name)||"Unknown",brand:((U=b.brand)==null?void 0:U.brand_name)||"Unknown"}}}),..._],F=Array.isArray(C)?C.filter(b=>e==="unread"?!b.is_read:e==="read"?b.is_read:!0):[],B=Array.isArray(C)?C.filter(b=>!b.is_read).length:0,T=async b=>{try{await d.mutateAsync(b)}catch(R){console.error("Failed to mark as read:",R)}},P=async()=>{if(window.confirm("Mark all notifications as read?"))try{await m.mutateAsync()}catch(b){console.error("Failed to mark all as read:",b)}},k=b=>{switch(b){case"success":return i.jsx(y0,{className:"w-5 h-5 text-green-500"});case"warning":return i.jsx(Qo,{className:"w-5 h-5 text-orange-500"});case"error":return i.jsx(zr,{className:"w-5 h-5 text-red-500"});case"low_stock":return i.jsx(Lr,{className:"w-5 h-5 text-red-500"});case"info":default:return i.jsx(ov,{className:"w-5 h-5 text-blue-500"})}},I=b=>{switch(b){case"success":return"border-l-green-500";case"warning":return"border-l-yellow-500";case"info":default:return"border-l-blue-500"}};return l?i.jsx(Er,{className:"h-64"}):c?i.jsxs("div",{className:"text-red-600",children:["Error loading notifications: ",c.message]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notifications"}),i.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[i.jsx("p",{className:"text-gray-600",children:"View system notifications"}),i.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[i.jsxs("span",{children:["Last updated: ",y()]}),i.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-green-500":"bg-gray-400"}`})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>s(!n),className:`px-3 py-1 text-xs rounded-full border transition-colors ${n?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-600 border-gray-200"}`,title:`Auto refresh is ${n?"enabled":"disabled"}`,children:n?" Auto":" Manual"}),i.jsxs("button",{onClick:p,className:"btn-secondary text-sm flex items-center",title:"Refresh now",disabled:l,children:[i.jsx(sn,{className:`w-4 h-4 mr-1 ${l?"animate-spin":""}`}),"Refresh"]}),B>0&&i.jsx("button",{onClick:P,className:"btn-primary text-sm",children:"Mark All as Read"})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"flex space-x-4",children:[i.jsxs("button",{onClick:()=>t("all"),className:`px-4 py-2 rounded-md text-sm font-medium ${e==="all"?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`,children:["All (",C.length||0,")"]}),i.jsxs("button",{onClick:()=>t("unread"),className:`px-4 py-2 rounded-md text-sm font-medium ${e==="unread"?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`,children:["Unread (",B,")"]}),i.jsxs("button",{onClick:()=>t("read"),className:`px-4 py-2 rounded-md text-sm font-medium ${e==="read"?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`,children:["Read (",(C.length||0)-B,")"]})]})}),i.jsx("div",{className:"space-y-4",children:F.length>0?F.map(b=>i.jsx("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${b.is_read?"border-l-gray-300":"border-l-blue-500 bg-blue-50"} ${I(b.type)}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:k(b.type)}),i.jsxs("div",{className:"ml-3 flex-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:`text-sm font-medium ${b.is_read?"text-gray-900":"text-gray-900 font-semibold"}`,children:b.title}),i.jsxs("div",{className:"flex items-center space-x-2",children:[!b.is_read&&i.jsx("button",{onClick:()=>T(b.id),className:"text-xs text-blue-600 hover:text-blue-800",children:"Mark as read"}),i.jsx("span",{className:"text-xs text-gray-500",children:Pr(b.created_at)}),i.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:i.jsx(zr,{className:"w-4 h-4"})})]})]}),i.jsx("div",{className:"mt-1 text-sm text-gray-600",children:b.message}),b.data&&b.data.product_name&&i.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Product:"}),i.jsx("span",{className:"ml-1 text-gray-900",children:b.data.product_name})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Current Stock:"}),i.jsxs("span",{className:`ml-1 font-semibold ${b.data.current_qty===0?"text-red-600":b.data.current_qty<=3?"text-orange-600":"text-yellow-600"}`,children:[b.data.current_qty," units"]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Reorder Point:"}),i.jsxs("span",{className:"ml-1 text-gray-900",children:[b.data.reorder_point," units"]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Category:"}),i.jsx("span",{className:"ml-1 text-gray-900",children:b.data.category})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b.urgency==="critical"?"bg-red-100 text-red-800":b.urgency==="high"?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:b.urgency==="critical"?" Critical":b.urgency==="high"?" High Priority":" Medium Priority"}),i.jsxs("button",{className:"text-xs text-blue-600 hover:text-blue-800 flex items-center",children:[i.jsx(Lr,{className:"w-3 h-3 mr-1"}),"View Product"]})]})]}),b.related_url&&i.jsx("div",{className:"mt-2",children:i.jsxs("a",{href:b.related_url,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[i.jsx(cn,{className:"w-4 h-4 mr-1"}),"View details"]})})]})]})},b.id)):i.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[i.jsx(Rf,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notifications"}),i.jsx("p",{className:"text-gray-500",children:e==="unread"?"You have no unread notifications.":"You have no notifications."})]})})]})},TT=()=>{var q,U,H,Q;const{user:e,updateUser:t}=ha(),[r,a]=se.useState("profile"),[n,s]=se.useState(!1),[o,l]=se.useState((e==null?void 0:e.photo)||null),[c,u]=se.useState(null),[d,m]=se.useState(""),[g,h]=se.useState(""),x=se.useRef(null);se.useEffect(()=>{var ee;const ne=(e==null?void 0:e.photo_url)||((ee=e==null?void 0:e.profile)==null?void 0:ee.image_url)||null;l(ne)},[e]);const{register:p,handleSubmit:y,formState:{errors:_},reset:S}=Xa({defaultValues:{name:(e==null?void 0:e.name)||(e==null?void 0:e.full_name)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",address:(e==null?void 0:e.address)||""}});se.useEffect(()=>{e&&S({name:e.name||e.full_name||"",email:e.email||"",phone:e.phone||"",address:e.address||""})},[e,S]);const{register:E,handleSubmit:C,formState:{errors:F},watch:B,reset:T}=Xa(),P=B("password"),k=async ne=>{var ee,N;s(!0),h(""),m("");try{const L=await ut.put("/profile",{name:ne.name,email:ne.email,phone:ne.phone,address:ne.address});if(L.success){const D={...e,...ne,full_name:ne.name};L.data&&(Object.assign(D,L.data),L.data.profile&&(D.profile={...D.profile,...L.data.profile})),t(D),h("Profile updated successfully!"),setTimeout(()=>h(""),3e3)}else m(L.message||"Failed to update profile")}catch(L){console.error("Profile update error:",L),m(((N=(ee=L.response)==null?void 0:ee.data)==null?void 0:N.message)||"Failed to update profile. Please try again.")}finally{s(!1)}},I=async ne=>{var ee,N;s(!0),h(""),m("");try{const L=await ut.put("/profile/password",{current_password:ne.current_password,password:ne.password,password_confirmation:ne.password_confirmation});L.success?(T(),h("Password updated successfully!"),setTimeout(()=>h(""),3e3)):m(L.message||"Failed to update password")}catch(L){console.error("Password update error:",L),m(((N=(ee=L.response)==null?void 0:ee.data)==null?void 0:N.message)||"Failed to update password. Please try again.")}finally{s(!1)}},A=()=>{var ne;(ne=x.current)==null||ne.click()},b=ne=>{const ee=ne.target.files[0];if(!ee)return;if(!ee.type.startsWith("image/")){m("Please select a valid image file");return}if(ee.size>5*1024*1024){m("Image size must be less than 5MB");return}m("");const N=new FileReader;N.onload=L=>{u(L.target.result)},N.readAsDataURL(ee)},R=async()=>{var ne;if((ne=x.current)!=null&&ne.files[0]){s(!0),m(""),h("");try{if(c){l(c);const ee={...e,photo_url:c,image_url:c,profile:{...e.profile,image_url:c}};t(ee),h("Photo updated successfully! (Demo mode - changes are temporary)"),u(null),x.current&&(x.current.value=""),setTimeout(()=>h(""),3e3)}else m("Please select a photo first");return}catch(ee){console.error("Photo upload error:",ee),m("Photo upload feature is not yet implemented on the backend.")}finally{s(!1)}}},W=()=>{u(null),m(""),x.current&&(x.current.value="")},Y=async()=>{if(confirm("Are you sure you want to remove your profile photo?")){s(!0),m(""),h("");try{l(null);const ne={...e,photo_url:null,image_url:null,profile:{...e.profile,image_url:null}};t(ne),h("Photo removed successfully! (Demo mode - changes are temporary)"),setTimeout(()=>h(""),3e3);return}catch(ne){console.error("Photo removal error:",ne),m("Photo removal feature is not yet implemented on the backend.")}finally{s(!1)}}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Profile"}),i.jsx("p",{className:"text-gray-600",children:"Manage your account settings"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"-mb-px flex",children:[i.jsx("button",{onClick:()=>a("profile"),className:`py-4 px-6 text-sm font-medium border-b-2 ${r==="profile"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Profile Information"}),i.jsx("button",{onClick:()=>a("password"),className:`py-4 px-6 text-sm font-medium border-b-2 ${r==="password"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Change Password"})]})}),i.jsxs("div",{className:"p-6",children:[g&&i.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[i.jsx(y0,{className:"w-5 h-5 text-green-600 mr-2"}),i.jsx("span",{className:"text-green-800",children:g})]}),d&&i.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("span",{className:"text-red-800",children:d})}),r==="profile"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center space-x-6",children:[i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"w-20 h-20 rounded-full overflow-hidden border-4 border-gray-200",children:[c?i.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-cover"}):o||e!=null&&e.photo_url||(q=e==null?void 0:e.profile)!=null&&q.image_url?i.jsx("img",{src:o||(e==null?void 0:e.photo_url)||((U=e==null?void 0:e.profile)==null?void 0:U.image_url),alt:e==null?void 0:e.name,className:"w-full h-full object-cover",onError:ne=>{ne.target.style.display="none",ne.target.nextSibling.style.display="flex"}}):null,i.jsx("div",{className:`w-full h-full bg-primary-600 flex items-center justify-center ${c||o||e!=null&&e.photo_url||(H=e==null?void 0:e.profile)!=null&&H.image_url?"hidden":""}`,children:i.jsx(fi,{className:"w-8 h-8 text-white"})})]}),c&&i.jsx("div",{className:"absolute -top-2 -right-2",children:i.jsx("button",{onClick:W,className:"w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600",children:i.jsx(zr,{className:"w-3 h-3"})})})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e==null?void 0:e.name}),i.jsx("p",{className:"text-sm text-gray-500",children:hf(e==null?void 0:e.type)}),c?i.jsxs("div",{className:"mt-2 space-x-2",children:[i.jsx("button",{onClick:R,disabled:n,className:"inline-flex items-center px-3 py-1 bg-primary-600 text-white rounded-md text-sm hover:bg-primary-700 disabled:opacity-50",children:n?i.jsx(Er,{size:"sm"}):i.jsxs(i.Fragment,{children:[i.jsx(Mf,{className:"w-4 h-4 mr-2"}),"Upload"]})}),i.jsx("button",{onClick:W,className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm text-gray-700 hover:bg-gray-50",children:"Cancel"})]}):i.jsxs("div",{className:"mt-2 space-x-2",children:[i.jsxs("button",{onClick:A,className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm text-gray-700 hover:bg-gray-50",children:[i.jsx(lv,{className:"w-4 h-4 mr-2"}),"Change Photo"]}),(o||(e==null?void 0:e.photo_url)||((Q=e==null?void 0:e.profile)==null?void 0:Q.image_url))&&i.jsxs("button",{onClick:Y,className:"inline-flex items-center px-3 py-1 border border-red-300 text-red-700 rounded-md text-sm hover:bg-red-50",children:[i.jsx(zr,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]})]}),i.jsx("input",{ref:x,type:"file",accept:"image/*",onChange:b,className:"hidden"}),i.jsxs("form",{onSubmit:y(k),className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),i.jsx("input",{...p("name",{required:"Name is required"}),type:"text",className:"input"}),_.name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.name.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{...p("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email address"}}),type:"email",className:"input"}),_.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.email.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{...p("phone"),type:"tel",className:"input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Type"}),i.jsx("input",{value:hf(e==null?void 0:e.type),type:"text",className:"input bg-gray-50",disabled:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("textarea",{...p("address"),rows:3,className:"input"})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?i.jsx(Er,{size:"sm"}):"Update Profile"})})]})]}),r==="password"&&i.jsxs("div",{className:"max-w-md",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx($u,{className:"w-12 h-12 text-gray-400 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Change Password"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Ensure your account is using a long, random password to stay secure."})]}),i.jsxs("form",{onSubmit:C(I),className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),i.jsx("input",{...E("current_password",{required:"Current password is required"}),type:"password",className:"input"}),F.current_password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:F.current_password.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),i.jsx("input",{...E("password",{required:"New password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",className:"input"}),F.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:F.password.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),i.jsx("input",{...E("password_confirmation",{required:"Please confirm your new password",validate:ne=>ne===P||"Passwords do not match"}),type:"password",className:"input"}),F.password_confirmation&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:F.password_confirmation.message})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?i.jsx(Er,{size:"sm"}):"Update Password"})})]})]})]})]})]})};function CT(){return i.jsx(r5,{children:i.jsxs(H2,{children:[i.jsx(aa,{path:"/login",element:i.jsx(fb,{})}),i.jsx(aa,{path:"/register",element:i.jsx(mb,{})}),i.jsxs(aa,{path:"/",element:i.jsx(a5,{children:i.jsx(qw,{})}),children:[i.jsx(aa,{index:!0,element:i.jsx(v0,{to:"/dashboard",replace:!0})}),i.jsx(aa,{path:"dashboard",element:i.jsx(Eb,{})}),i.jsx(aa,{path:"products",element:i.jsx(Ob,{})}),i.jsx(aa,{path:"categories",element:i.jsx(Ib,{})}),i.jsx(aa,{path:"brands",element:i.jsx(Mb,{})}),i.jsx(aa,{path:"suppliers",element:i.jsx(Hb,{})}),i.jsx(aa,{path:"customers",element:i.jsx(Yb,{})}),i.jsx(aa,{path:"staff",element:i.jsx(Zb,{})}),i.jsx(aa,{path:"orders",element:i.jsx(QE,{})}),i.jsx(aa,{path:"imports",element:i.jsx(KE,{})}),i.jsx(aa,{path:"payments",element:i.jsx(eT,{})}),i.jsx(aa,{path:"reports",element:i.jsx(oT,{})}),i.jsx(aa,{path:"analytics",element:i.jsx(bT,{})}),i.jsx(aa,{path:"users",element:i.jsx(_T,{})}),i.jsx(aa,{path:"notifications",element:i.jsx(ET,{})}),i.jsx(aa,{path:"profile",element:i.jsx(TT,{})})]})]})})}class PT extends $a.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("Error caught by boundary:",t,r)}render(){return this.state.hasError?i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:i.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Mu,{className:"w-8 h-8 text-red-600"})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"An error occurred while loading the application. Please try refreshing the page."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("button",{onClick:()=>window.location.reload(),className:"btn-primary w-full justify-center",children:[i.jsx(sn,{className:"w-4 h-4 mr-2"}),"Refresh Page"]}),i.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),className:"btn-secondary w-full justify-center",children:"Try Again"})]}),!1]})}):this.props.children}}window.NativeImage=window.Image;of.createRoot(document.getElementById("root")).render(i.jsx($a.StrictMode,{children:i.jsx(PT,{children:i.jsxs($2,{future:{v7_relativeSplatPath:!0},children:[i.jsx(CT,{}),i.jsx(cv,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})})}));export{Tt as E,ar as _,br as a,Pr as f,ps as u,Tg as w};
