import{f as r,a as p,u as x,w as S,E as b}from"./index-31af9acb.js";import"./vendor-348d559c.js";import"./ui-58a945e4.js";import"./charts-bc1c71da.js";const E={exportToExcel:(o,d,c)=>{try{if(console.log("Excel Export - Input data:",o),console.log("Excel Export - Type:",c),console.log("Excel Export - Filename:",d),!Array.isArray(o)||o.length===0)throw new Error("No data provided for export");let n=[];if(c==="import"?(n=[["ID","Date","Staff","Supplier","Product Name","Qty","Amount","Batch Number","Expiration Date","Status"]],Array.isArray(o)&&o.length>0&&(o[0].importId||o[0].id?o.forEach(e=>{n.push([`#${e.importId||e.id}`,r(e.date||e.imp_date),e.staff||e.staff_name||"Unknown Staff",e.supplier||e.supplier_name||"Unknown Supplier",e.productName||e.pro_name||"Unknown Product",e.qty||0,p(e.amount||0),e.batchNumber||e.batch_number||"N/A",e.expirationDate&&e.expirationDate!=="N/A"?r(e.expirationDate):"N/A",e.status||"Completed"])}):o.forEach(e=>{var f,t;e.import_details&&e.import_details.length>0?e.import_details.forEach(a=>{var l,s,u;n.push([`#${e.id}`,r(e.imp_date),e.staff_name||((l=e.staff)==null?void 0:l.full_name)||"Unknown Staff",e.supplier_name||((s=e.supplier)==null?void 0:s.supplier)||"Unknown Supplier",a.pro_name||((u=a.product)==null?void 0:u.pro_name)||"Unknown Product",a.qty||0,p(a.amount||a.price||0),a.batch_number||"N/A",a.expiration_date&&a.expiration_date!=="N/A"?r(a.expiration_date):"N/A",e.status||"Completed"])}):n.push([`#${e.id}`,r(e.imp_date),e.staff_name||((f=e.staff)==null?void 0:f.full_name)||"Unknown Staff",e.supplier_name||((t=e.supplier)==null?void 0:t.supplier)||"Unknown Supplier","General Import",e.qty||0,p(e.amount||e.total_amount||0),e.batch_number||"N/A",e.expiration_date&&e.expiration_date!=="N/A"?r(e.expiration_date):"N/A",e.status||"Completed"])}))):c==="sales"&&(n=[["Order ID","Date","Customer","Staff","Product Name","Qty","Total Amount","Payment Status","Status"]],Array.isArray(o)&&o.length>0&&(o[0].order_id||o[0].id&&o[0].cus_name?o.forEach(e=>{var f,t,a;n.push([`#${e.order_id||e.id}`,r(e.order_date||e.ord_date||e.date),e.customer_name||e.cus_name||((f=e.customer)==null?void 0:f.name)||"Unknown Customer",e.staff_name||((t=e.staff)==null?void 0:t.name)||e.full_name||"Unknown Staff",e.product_name||e.pro_name||((a=e.product)==null?void 0:a.name)||"Unknown Product",e.qty||0,p(e.amount||e.total||e.total_amount||0),e.payment_status||"Unpaid",e.status||"Completed"])}):o.forEach(e=>{var f,t;e.order_details&&e.order_details.length>0?e.order_details.forEach(a=>{var l,s,u;n.push([`#${e.id}`,r(e.ord_date||e.order_date),e.cus_name||((l=e.customer)==null?void 0:l.name)||"Unknown Customer",e.staff_name||((s=e.staff)==null?void 0:s.name)||e.full_name||"Unknown Staff",a.pro_name||((u=a.product)==null?void 0:u.name)||"Unknown Product",a.qty||0,p(a.amount||0),e.payment_status||"Unpaid",e.status||"Completed"])}):n.push([`#${e.id}`,r(e.ord_date||e.order_date),e.cus_name||((f=e.customer)==null?void 0:f.name)||"Unknown Customer",e.staff_name||((t=e.staff)==null?void 0:t.name)||e.full_name||"Unknown Staff","General Order",0,p(e.total||e.amount||0),e.payment_status||"Unpaid",e.status||"Completed"])}))),console.log("Final worksheet data:",n),console.log("Worksheet data length:",n.length),n.length<=1)throw new Error("No data rows to export (only headers)");let i=[];if(c==="import"){const e=new Set(n.slice(1).map(l=>l[0])).size,f=n.slice(1).reduce((l,s)=>{const u=s[6]||"0",m=parseFloat(u.toString().replace(/[^0-9.-]/g,""))||0;return l+m},0),t=n.slice(1).reduce((l,s)=>l+(parseInt(s[5])||0),0);i=[["Import Report","","","","","","","","",""],["Generated on:",r(new Date),"","","","","","","",""],["Total Imports:",e,"","","","","","","",""],["Total Value:",p(f),"","","","","","","",""],["Total Quantity:",t.toLocaleString(),"","","","","","","",""],["","","","","","","","","",""]];const a=[["","","","","","","","","",""],["","","","","TOTAL QUANTITY:",t.toLocaleString(),"","","",""],["","","","","TOTAL VALUE:",p(f),"","","",""],["","","","","TOTAL IMPORTS:",e,"","","",""]];n=[...i,...n,...a]}else if(c==="sales"){const e=new Set(n.slice(1).map(a=>a[0])).size,f=n.slice(1).reduce((a,l)=>{const s=l[6]||"0",u=parseFloat(s.toString().replace(/[^0-9.-]/g,""))||0;return a+u},0);i=[["Sales Report","","","","","","","",""],["Generated on:",r(new Date),"","","","","","",""],["Total Orders:",e,"","","","","","",""],["Total Sales:",p(f),"","","","","","",""],["","","","","","","","",""]];const t=[["","","","","","","","",""],["","","","","TOTAL ORDERS:",e,"","",""],["","","","","TOTAL SALES:",p(f),"","",""]];n=[...i,...n,...t]}const h=x.book_new(),_=x.aoa_to_sheet(n);return x.book_append_sheet(h,_,c==="import"?"Import Report":"Sales Report"),S(h,d),console.log("Excel file saved:",d),{success:!0,message:"Excel file exported successfully!"}}catch(n){return console.error("Excel export error:",n),{success:!1,message:"Failed to export Excel file: "+n.message}}},exportToPDF:(o,d,c)=>{try{if(console.log("PDF Export - Input data:",o),console.log("PDF Export - Type:",c),console.log("PDF Export - Filename:",d),!Array.isArray(o)||o.length===0)throw new Error("No data provided for export");const n=new b;let i=[],h=[];if(c==="import"?(h=["ID","Date","Staff","Supplier","Product Name","Qty","Amount","Batch","Expiry","Status"],Array.isArray(o)&&o.length>0&&(o[0].importId||o[0].id?o.forEach(t=>{i.push([`#${t.importId||t.id}`,r(t.date||t.imp_date),(t.staff||t.staff_name||"Unknown").substring(0,12),(t.supplier||t.supplier_name||"Unknown").substring(0,12),(t.productName||t.pro_name||"Unknown").substring(0,15),t.qty||0,p(t.amount||0),(t.batchNumber||t.batch_number||"N/A").substring(0,8),t.expirationDate&&t.expirationDate!=="N/A"?r(t.expirationDate).substring(0,10):"N/A",t.status||"Completed"])}):o.forEach(t=>{var a,l;t.import_details&&t.import_details.length>0?t.import_details.forEach(s=>{var u,m,g;i.push([`#${t.id}`,r(t.imp_date),(t.staff_name||((u=t.staff)==null?void 0:u.full_name)||"Unknown").substring(0,12),(t.supplier_name||((m=t.supplier)==null?void 0:m.supplier)||"Unknown").substring(0,12),(s.pro_name||((g=s.product)==null?void 0:g.pro_name)||"Unknown").substring(0,15),s.qty||0,p(s.amount||s.price||0),(s.batch_number||"N/A").substring(0,8),s.expiration_date&&s.expiration_date!=="N/A"?r(s.expiration_date).substring(0,10):"N/A",t.status||"Completed"])}):i.push([`#${t.id}`,r(t.imp_date),(t.staff_name||((a=t.staff)==null?void 0:a.full_name)||"Unknown").substring(0,12),(t.supplier_name||((l=t.supplier)==null?void 0:l.supplier)||"Unknown").substring(0,12),"General Import",t.qty||0,p(t.amount||t.total_amount||0),(t.batch_number||"N/A").substring(0,8),t.expiration_date&&t.expiration_date!=="N/A"?r(t.expiration_date).substring(0,10):"N/A",t.status||"Completed"])}))):c==="sales"&&(h=["ID","Date","Customer","Staff","Product Name","Qty","Amount","Payment","Status"],Array.isArray(o)&&o.length>0&&(o[0].order_id||o[0].id&&o[0].cus_name?o.forEach(t=>{var a,l,s;i.push([`#${t.order_id||t.id}`,r(t.order_date||t.ord_date||t.date),(t.customer_name||t.cus_name||((a=t.customer)==null?void 0:a.name)||"Unknown").substring(0,12),(t.staff_name||((l=t.staff)==null?void 0:l.name)||t.full_name||"Unknown").substring(0,12),(t.product_name||t.pro_name||((s=t.product)==null?void 0:s.name)||"Unknown").substring(0,15),t.qty||0,p(t.amount||t.total||t.total_amount||0),t.payment_status||"Unpaid",t.status||"Completed"])}):o.forEach(t=>{var a,l;t.order_details&&t.order_details.length>0?t.order_details.forEach(s=>{var u,m,g;i.push([`#${t.id}`,r(t.ord_date||t.order_date),(t.cus_name||((u=t.customer)==null?void 0:u.name)||"Unknown").substring(0,12),(t.staff_name||((m=t.staff)==null?void 0:m.name)||t.full_name||"Unknown").substring(0,12),(s.pro_name||((g=s.product)==null?void 0:g.name)||"Unknown").substring(0,15),s.qty||0,p(s.amount||0),t.payment_status||"Unpaid",t.status||"Completed"])}):i.push([`#${t.id}`,r(t.ord_date||t.order_date),(t.cus_name||((a=t.customer)==null?void 0:a.name)||"Unknown").substring(0,12),(t.staff_name||((l=t.staff)==null?void 0:l.name)||t.full_name||"Unknown").substring(0,12),"General Order",0,p(t.total||t.amount||0),t.payment_status||"Unpaid",t.status||"Completed"])}))),console.log("Final table data:",i),console.log("Table data length:",i.length),i.length===0)throw new Error("No data rows to export");let _={};if(c==="import"){const t=new Set(i.map(s=>s[0])).size,a=i.reduce((s,u)=>{const m=u[6]||"0",g=parseFloat(m.toString().replace(/[^0-9.-]/g,""))||0;return s+g},0),l=i.reduce((s,u)=>s+(parseInt(u[5])||0),0);_={totalImports:t,totalValue:a,totalQuantity:l}}else if(c==="sales"){const t=new Set(i.map(l=>l[0])).size,a=i.reduce((l,s)=>{const u=s[6]||"0",m=parseFloat(u.toString().replace(/[^0-9.-]/g,""))||0;return l+m},0);_={totalOrders:t,totalSales:a}}n.setFontSize(16),n.text(c==="import"?"Import Report":"Sales Report",14,22),n.setFontSize(10);let e=32;n.text(`Generated on: ${r(new Date)}`,14,e),e+=8,c==="import"?(n.text(`Total Imports: ${_.totalImports}`,14,e),e+=6,n.text(`Total Value: ${p(_.totalValue)}`,14,e),e+=6,n.text(`Total Quantity: ${_.totalQuantity.toLocaleString()}`,14,e),e+=6):c==="sales"&&(n.text(`Total Orders: ${_.totalOrders}`,14,e),e+=6,n.text(`Total Sales: ${p(_.totalSales)}`,14,e),e+=6);const f=c==="import"?58:50;return n.autoTable({head:[h],body:i,startY:f,styles:{fontSize:8},headStyles:{fillColor:[41,128,185]},margin:{top:f-10},didDrawPage:function(t){if(t.pageCount===t.pageNumber){const a=t.cursor.y+10;n.setFontSize(10),n.setFont(void 0,"bold"),c==="import"?(n.text(`Total Quantity: ${_.totalQuantity.toLocaleString()}`,14,a),n.text(`Total Value: ${p(_.totalValue)}`,80,a),n.text(`Total Imports: ${_.totalImports}`,140,a)):c==="sales"&&(n.text(`Total Orders: ${_.totalOrders}`,14,a),n.text(`Total Sales: ${p(_.totalSales)}`,80,a)),n.setFont(void 0,"normal")}}}),n.save(d),console.log("PDF file saved:",d),{success:!0,message:"PDF file exported successfully!"}}catch(n){return console.error("PDF export error:",n),{success:!1,message:"Failed to export PDF file: "+n.message}}}};export{E as exportService};
